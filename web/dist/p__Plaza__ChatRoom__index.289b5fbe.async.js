"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[57],{86:function(ct,Fe,v){var $e=v(5574),O=v.n($e),Le=v(32332),ne=v(38703),Ze=v(67294),m=v(85893),pe=function(a){var te=a.subtitle,He=a.handleClick,ce=a.lineClamp,Qe=ce===void 0?2:ce,q=a.textDetails,ve=a.title,Be=a.icon,De=a.iconType,Ie=De===void 0?"":De,Ae=a.operation,Ce=Ae===void 0?"":Ae,Se=a.progress,fe=a.status,Pe=a.backlogTips,Ee=(0,Ze.useState)(0),he=O()(Ee,2),Re=he[0],ke=he[1],ze=function(){ke(Se)},Ve=function(){ke(0)},Ue=function(e){return"rounded-[4px] border-l-[4px] ".concat(e==1?"border-[#1B64F3]":e==2?"border-[#52C41C]":"border-[#F04444]"," ")};return(0,m.jsxs)("div",{className:"flex  p-[10px] cursor-pointer overflow-hidden relative bg-[#fff] ".concat(fe!==void 0?Ue(fe):"graphicbox"),onClick:He,onMouseEnter:function(){Se!=null&&ze()},onMouseLeave:function(){Se!=null&&Ve()},children:[fe!==void 0&&(0,m.jsx)("div",{style:{width:"".concat(Re,"%"),transition:"width 0.5s "},className:"absolute bottom-0 left-0 top-0 bottom-0 h-full ".concat(fe==1?"bg-[#1B64F3]/[.03]":fe==2?"bg-[#52c41c]/[.05]":"bg-[#FAFAFA]"," ")}),(0,m.jsxs)("div",{className:"flex gap-x-[20px] w-full relative z-20",children:[(0,m.jsx)("div",{className:"shrink-0 flex gap-x-[7px] items-center",style:{fontSize:0},children:(0,m.jsxs)("div",{className:"w-[40px] h-[40px] rounded-[6px] flex items-center justify-center bg-[#F4F8F1] relative",children:[(0,m.jsx)("img",{src:(0,Le.s9)("single",Be),className:"w-[22px] h-[22px]"}),Ie&&(0,m.jsx)("div",{className:"w-[16px] h-[16px] absolute top-[28px] left-[28px] flex items-center justify-center bg-[#fff] rounded-[3px]",style:{boxShadow:"0px 0px 4px 0px rgba(0,0,0,0.1)"},children:(0,m.jsx)("img",{src:"/icons/".concat(Ie,".svg"),alt:"",className:"w-[12px] h-[12px]"})})]})}),(0,m.jsx)("div",{className:"flex flex-1 min-w-0",children:(0,m.jsxs)("div",{className:"flex justify-center flex-col gap-y-[5px] flex-1 min-w-0",children:[(0,m.jsxs)("span",{className:"text-[12px] flex items-center",style:{color:"#213044"},children:[(0,m.jsx)("span",{className:"truncate",children:ve}),(0,m.jsx)("span",{className:"flex items-center flex-1",children:te})]}),(0,m.jsx)("span",{className:"text-[12px] max-w-full truncate",style:{color:"#999999"},children:q})]})}),Pe||(0,m.jsx)(m.Fragment,{}),Ce&&(0,m.jsx)("div",{className:"flex items-center w-[24px]",children:(0,m.jsx)("span",{className:"operation",children:Ce})}),Se!=null&&(0,m.jsx)("div",{className:"graphic_progress flex items-center pl-[30px]",children:(0,m.jsx)(ne.Z,{type:"circle",percent:Se,size:29})})]})]})};Fe.Z=pe},53885:function(ct,Fe,v){v.r(Fe),v.d(Fe,{default:function(){return Ia}});var $e=v(15009),O=v.n($e),Le=v(99289),ne=v.n(Le),Ze=v(5574),m=v.n(Ze),pe=v(43722),ye=v(32983),a=v(67294),te=v(35312),He=v(19632),ce=v.n(He),Qe=v(97857),q=v.n(Qe),ve=v(32332),Be=v(82114),De=v(82826),Ie=v(63783),Ae=v(3471),Ce=v(45360),Se=v(85576),fe=v(28036),Pe=v(83062),Ee=v(72269),he=v(74330),Re=v(96486),ke=v(44010),ze=v(73445),Ve=v(782),Ue=(0,ze.Ue)((0,Ve.mW)(function(d,r){return{clearMemory:null,truncatable:!1,disableInput:!1,summaryParams:null,runsSummaryShow:!1,summaryClick:!0,setClearMemory:function(p){d({clearMemory:p})},setTruncatable:function(p){d({truncatable:p})},setDisableInput:function(p){d({disableInput:p})},setSummaryParams:function(p){d({summaryParams:p})},setRunsSummaryShow:function(p){d({runsSummaryShow:p})},setSummaryClick:function(p){console.log(p),d({summaryClick:p})}}})),Q=Ue,e=v(85893),ot=function(r){var n=(0,te.useIntl)(),p=r.roomDetail,w=r.setAgent,l=Ce.ZP.useMessage(),x=m()(l,2),h=x[0],R=x[1],g=(0,te.useParams)(),y=g.id,c=Q(function(i){return i.disableInput}),b=Q(function(i){return i.truncatable}),_=Q(function(i){return i.setClearMemory}),k=(0,a.useState)([]),t=m()(k,2),o=t[0],C=t[1],L=(0,a.useState)(q()({},p)),M=m()(L,2),S=M[0],$=M[1],z=(0,a.useState)([]),ae=m()(z,2),H=ae[0],A=ae[1],J=(0,a.useRef)(!1),ie=(0,a.useRef)(!1),X=(0,a.useState)(!1),V=m()(X,2),ee=V[0],Z=V[1],T=function(){var s=Se.Z.confirm;s({title:n.formatMessage({id:"app.chatroom.clear.title"}),icon:(0,e.jsx)(Be.Z,{}),content:n.formatMessage({id:"app.chatroom.clear.tips"}),okText:n.formatMessage({id:"app.chatroom.clear.confirm"}),okType:"danger",cancelText:n.formatMessage({id:"app.chatroom.clear.cancel"}),onOk:function(){_(["TRUNCATE","0"])}})},j=function(){var i=ne()(O()().mark(function s(){var u;return O()().wrap(function(N){for(;;)switch(N.prev=N.next){case 0:if(!y){N.next=5;break}return N.next=3,(0,pe.cH)({id:y});case 3:if(u=N.sent,u.code==0)try{$(function(){return q()(q()({},u.data.chat_info),{},{max_round:u.data.max_round,smart_selection:u.data.smart_selection})}),C(u.data.agent_list),J.current=!0}catch(F){}case 5:case"end":return N.stop()}},s)}));return function(){return i.apply(this,arguments)}}(),le=function(){var i=ne()(O()().mark(function s(){var u;return O()().wrap(function(N){for(;;)switch(N.prev=N.next){case 0:return N.next=2,(0,pe.j2)({id:y});case 2:u=N.sent,u.code==0&&(A(u.data.list),ie.current=!0);case 4:case"end":return N.stop()}},s)}));return function(){return i.apply(this,arguments)}}(),W=function(){var i=ne()(O()().mark(function s(u){var f,N,F;return O()().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:if(!y){E.next=11;break}if(f=u.active==1?0:1,f!=0){E.next=7;break}if(N=o.filter(function(U){return U.active==1}),N.length-1!=0){E.next=7;break}return h.open({type:"error",content:n.formatMessage({id:"app.chatroom.sidebar.agent_tips"}),duration:2}),E.abrupt("return",!1);case 7:return E.next=9,(0,pe.sT)({active:f},y,u.agent_id);case 9:F=E.sent,F.code==0&&C(function(U){return U.map(function(oe){return q()(q()({},oe),{},{active:oe.agent_id==u.agent_id?f:oe.active})})});case 11:case"end":return E.stop()}},s)}));return function(u){return i.apply(this,arguments)}}(),se=function(s){return s.length>6?s.length=6:s.lenth,s},G=function(s){s.type=="my_agent"?te.history.push("/Agents?app_id=".concat(s.app_id,"&type=false&from=chat_room")):te.history.push("/ReadOnlyAgent?app_id=".concat(s.app_id,"&type=true&from=chat_room"))},D=function(s){te.history.replace("/chat_room/".concat(s.chatroom_id)),window.location.reload()},K=function(){Z(!0)},Y=function(){Z(!1)},B=function(){var i=ne()(O()().mark(function s(u){var f,N,F;return O()().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:if(!(u.checkItem&&u.checkItem.length==0)){E.next=3;break}return h.open({type:"error",content:n.formatMessage({id:"app.chatroom.content.addAgentTips_fail"}),duration:2}),E.abrupt("return");case 3:return f=ce()(u.checkItem).map(function(U){var oe=U.agent_id,re=U.active,ue=re===void 0?1:re;return{agent_id:oe,active:ue}}),N={description:S.description,name:S.name,max_round:S.max_round},E.next=7,(0,pe.sI)(q()(q()({},N),{},{agent:f}),y);case 7:F=E.sent,F.code==0?(u.checkItem.map(function(U){U.active=U.active==null?1:U.active}),C(ce()(u.checkItem)),w.current=ce()(u.checkItem),h.open({type:"success",content:n.formatMessage({id:"app.chatroom.content.addAgentTips"}),duration:2})):h.open({type:"error",content:n.formatMessage({id:"app.chatroom.content.addAgentTips_fail"}),duration:2});case 9:case"end":return E.stop()}},s)}));return function(u){return i.apply(this,arguments)}}(),I=function(){var i=ne()(O()().mark(function s(){var u;return O()().wrap(function(N){for(;;)switch(N.prev=N.next){case 0:return u=S.smart_selection==1?0:1,N.next=3,(0,pe.r5)({smart_selection:u},y);case 3:$(function(F){return q()(q()({},F),{},{smart_selection:u})});case 4:case"end":return N.stop()}},s)}));return function(){return i.apply(this,arguments)}}();return(0,a.useEffect)(function(){j(),le()},[]),(0,e.jsxs)(e.Fragment,{children:[R,(0,e.jsxs)("div",{className:"h-full w-[320px] bg-[#fff] shrink-0",style:{boxShadow:"0px 2px 4px 0px rgba(0,0,0,0.1)"},id:"sider",children:[(0,e.jsxs)("div",{className:"flex flex-col  h-full",children:[(0,e.jsx)("div",{className:"w-full flex  justify-start px-[30px]",children:(0,e.jsxs)("div",{className:"py-[20px] text-[14px] text-[#213044] font-[500] flex gap-x-[10px] items-center w-full",children:[(0,e.jsxs)("div",{className:"cursor-pointer flex items-center shrink-0",onClick:function(){te.history.go(-1)},children:[(0,e.jsx)(fe.ZP,{type:"link",danger:!0,className:"p-0",children:(0,e.jsx)(De.Z,{className:"text-[#1B64F3] w-[16px] h-[16px]"})}),(0,e.jsx)("span",{className:"ml-[5px] text-[#213044] text-sm",children:n.formatMessage({id:"app.chatroom.sidebar.return"})})]}),(0,e.jsx)("div",{className:"h-full flex items-center shrink-0",children:(0,e.jsx)("div",{className:"w-[1px] h-[13px] bg-[#ebebeb]"})}),(0,e.jsx)("div",{className:"flex-1 min-w-0 truncate",children:S.name})]})}),(0,e.jsx)("div",{className:"h-[360px]",children:(0,e.jsxs)("div",{className:"pb-[20px] border-b-[1px] px-[10px]",children:[(0,e.jsxs)("div",{className:"flex items-center cursor-pointer px-[20px]",children:[(0,e.jsx)("div",{className:"flex gap-x-[5px] flex-1",children:(0,e.jsx)("span",{className:"text-[#666] text-[14px]",children:n.formatMessage({id:"app.chatroom.sidebar.agent_title"})})}),(0,e.jsxs)("div",{className:"shrink-0 flex items-center",children:[(0,e.jsx)(Pe.Z,{className:"pr-[2px]",overlayStyle:{fontSize:"12px"},title:n.formatMessage({id:"app.chatroom.sidebar.chatroom_switch_tips"}),children:(0,e.jsx)(Ie.Z,{className:"cursor-pointer text-[#666] text-[12px]"})}),(0,e.jsx)("span",{className:"text-[12px] text-[#666] pr-[5px]",children:n.formatHTMLMessage({id:"app.chatroom_list.switch"})}),(0,e.jsx)(Ee.Z,{size:"small",defaultChecked:!0,className:"w-[28px]",checked:S.smart_selection==1,onChange:I,disabled:c})]})]}),(0,e.jsx)("div",{className:"py-[20px] pt-[10px]",children:(0,e.jsx)("div",{className:"h-[220px] overflow-y-auto px-[10px]",children:J.current?(0,e.jsx)("div",{className:"flex flex-col",children:o&&o.length>0?o.map(function(i){return(0,e.jsxs)("div",{className:"flex items-center gap-x-[5px] hover:bg-[#FAFAFA] transition p-[10px] slider_agent_box",children:[(0,e.jsxs)("div",{className:"flex gap-x-[15px] flex-1 min-w-[0]",children:[(0,e.jsx)("div",{className:"w-[40px] h-[40px] bg-[#F4F8F1] rounded-[6px] flex items-center justify-center shrink-0",children:(0,e.jsx)("img",{src:(0,ve.s9)("single",i.icon),alt:"",className:"w-[18px]  h-[18px]"})}),(0,e.jsxs)("div",{className:"flex flex-col gap-y-[5px] justify-center flex-1 min-w-[0]",children:[(0,e.jsx)("span",{className:"text-[#213044] text-[12px] font-[500] truncate w-full",children:i.name}),(0,e.jsx)("span",{className:"text-[#999999] text-[12px] truncate",children:i.description})]})]}),(0,e.jsxs)("div",{className:"shrink-0 flex gap-x-[15px] items-center",children:[(0,e.jsx)("div",{className:"edit cursor-pointer w-[20px] h-[20px] flex justify-center items-center opacity-0 transition",onClick:function(){G(i)},children:(0,e.jsx)("img",{className:"w-[16px] h-[16px]",src:"/icons/edit_icon_1.svg"})}),(0,e.jsx)(Ee.Z,{size:"small",disabled:c,defaultChecked:!0,className:"w-[28px]",checked:i.active==1,onChange:function(){W(i)}})]})]},i.agent_id)}):(0,e.jsx)("div",{className:"w-full min-h-[220px] flex items-center justify-center",children:(0,e.jsx)(ye.Z,{image:ye.Z.PRESENTED_IMAGE_SIMPLE})})}):(0,e.jsx)("div",{className:"flex justify-center w-full h-full items-center",children:(0,e.jsx)(he.Z,{})})})}),(0,e.jsx)("div",{className:"px-[20px] ",children:(0,e.jsx)("div",{style:{border:"1px solid #1B64F3"},onClick:K,className:"w-full h-[30px] transition text-[#1B64F3] flex items-center justify-center cursor-pointer rounded-[6px] hover:text-[#fff] hover:bg-[#1B64F3]",children:(0,e.jsx)("span",{className:"text-[12px]",children:n.formatMessage({id:"app.chatroom.add.agent"})})})}),(0,e.jsx)("div",{className:"px-[20px] pt-[15px]",children:(0,e.jsx)("div",{style:b&&!c?{border:"1px solid #1B64F3"}:{background:"#d9d9d9",color:"rgba(0,0,0,0.25)",cursor:"not-allowed"},onClick:(0,Re.throttle)(function(){b&&!c&&T()}),className:"w-full h-[30px] transition text-[#1B64F3] flex items-center justify-center cursor-pointer rounded-[6px] hover:text-[#fff] hover:bg-[#1B64F3]",children:(0,e.jsx)("span",{className:"text-[12px]",children:n.formatMessage({id:"app.chatroom.sidebar.agent_button"})})})})]})}),(0,e.jsxs)("div",{className:"flex-1 min-h-[0] flex flex-col",children:[(0,e.jsx)("div",{className:"pt-[30px] px-[30px] text-[#666] text-[14px] shrink-0",children:n.formatMessage({id:"app.chatroom.sidebar.othe_title"})}),(0,e.jsx)("div",{className:"px-[10px] flex-1 min-h-[0] py-[10px]",children:(0,e.jsx)("div",{style:{height:"calc(100% - 20px)"},className:"px-[10px]  overflow-y-auto",children:ie.current?(0,e.jsx)("div",{className:"h-full flex flex-col",children:H&&H.length>0?H.map(function(i){return(0,e.jsxs)("div",{className:"w-full transition hover:bg-[#FAFAFA] p-[10px] cursor-pointer",onClick:function(){D(i)},children:[(0,e.jsxs)("div",{className:"flex pb-[10px]",children:[(0,e.jsx)("div",{className:"flex-1 min-w-[0] truncate text-[#333] text-[14px]",children:i.name}),i.active==0?(0,e.jsxs)("div",{className:"flex items-center gap-x-[6px]",children:[(0,e.jsx)("img",{className:"w-[12px] h-[12px]",src:"/icons/plaza_m2_c2.svg",alt:""}),(0,e.jsx)("span",{className:"text-[12px] text-[#aaa]",children:n.formatMessage({id:"app.chatroom.sidebar.othe_status"})})]}):(0,e.jsxs)("div",{className:"flex items-center gap-x-[6px]",children:[(0,e.jsx)("img",{className:"w-[12px] h-[12px]",src:"/icons/plaza_m2_c1.svg",alt:""}),(0,e.jsx)("span",{className:"text-[12px] text-[#aaa]",children:n.formatMessage({id:"app.chatroom.sidebar.othe_status_succeed"})})]})]}),(0,e.jsx)("div",{className:"flex gap-x-[10px]",children:i.agent_list&&i.agent_list.length>0?(0,e.jsxs)(e.Fragment,{children:[se(i.agent_list).map(function(s,u){return(0,e.jsx)("div",{className:"flex",children:(0,e.jsx)("div",{className:"w-[30px] h-[30px] bg-[#F4F8F1] rounded-[6px] flex items-center justify-center",children:(0,e.jsx)("img",{src:(0,ve.s9)("single",s.icon),alt:"",className:"w-[18px]  h-[18px]"})})},u)}),i.agent_list.length>=6?(0,e.jsx)(Ae.Z,{}):(0,e.jsx)(e.Fragment,{})]}):(0,e.jsx)(e.Fragment,{})})]},i.chatroom_id)}):(0,e.jsx)("div",{className:"w-full h-full",children:(0,e.jsx)(ye.Z,{image:ye.Z.PRESENTED_IMAGE_SIMPLE})})}):(0,e.jsx)("div",{className:"flex justify-center w-full h-full items-center",children:(0,e.jsx)(he.Z,{})})})})]})]}),(0,e.jsx)(ke.Z,{show:ee,popupClose:Y,popupSave:B,checkList:o,zIndex:99})]})]})},ut=(0,a.memo)(ot),dt=v(13769),pt=v.n(dt),xt=v(47635),xe=v(1413),ft={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M862 465.3h-81c-4.6 0-9 2-12.1 5.5L550 723.1V160c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v563.1L255.1 470.8c-3-3.5-7.4-5.5-12.1-5.5h-81c-6.8 0-10.5 8.1-6 13.2L487.9 861a31.96 31.96 0 0048.3 0L868 478.5c4.5-5.2.8-13.2-6-13.2z"}}]},name:"arrow-down",theme:"outlined"},mt=ft,Ne=v(91146),vt=function(r,n){return a.createElement(Ne.Z,(0,xe.Z)((0,xe.Z)({},r),{},{ref:n,icon:mt}))},ht=a.forwardRef(vt),gt=ht,jt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372zm-88-532h-48c-4.4 0-8 3.6-8 8v304c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V360c0-4.4-3.6-8-8-8zm224 0h-48c-4.4 0-8 3.6-8 8v304c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V360c0-4.4-3.6-8-8-8z"}}]},name:"pause-circle",theme:"outlined"},yt=jt,St=function(r,n){return a.createElement(Ne.Z,(0,xe.Z)((0,xe.Z)({},r),{},{ref:n,icon:yt}))},Nt=a.forwardRef(St),wt=Nt,_t=v(2068),bt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M312.1 591.5c3.1 3.1 8.2 3.1 11.3 0l101.8-101.8 86.1 86.2c3.1 3.1 8.2 3.1 11.3 0l226.3-226.5c3.1-3.1 3.1-8.2 0-11.3l-36.8-36.8a8.03 8.03 0 00-11.3 0L517 485.3l-86.1-86.2a8.03 8.03 0 00-11.3 0L275.3 543.4a8.03 8.03 0 000 11.3l36.8 36.8z"}},{tag:"path",attrs:{d:"M904 160H548V96c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v64H120c-17.7 0-32 14.3-32 32v520c0 17.7 14.3 32 32 32h356.4v32L311.6 884.1a7.92 7.92 0 00-2.3 11l30.3 47.2v.1c2.4 3.7 7.4 4.7 11.1 2.3L512 838.9l161.3 105.8c3.7 2.4 8.7 1.4 11.1-2.3v-.1l30.3-47.2a8 8 0 00-2.3-11L548 776.3V744h356c17.7 0 32-14.3 32-32V192c0-17.7-14.3-32-32-32zm-40 512H160V232h704v440z"}}]},name:"fund-projection-screen",theme:"outlined"},Ct=bt,Rt=function(r,n){return a.createElement(Ne.Z,(0,xe.Z)((0,xe.Z)({},r),{},{ref:n,icon:Ct}))},kt=a.forwardRef(Rt),Mt=kt,Xe=v(26915),Ft=v(20640),qe=v.n(Ft),ge=v(22683),je=v(97807),Dt=["node","className","children"],It=Xe.Z.TextArea,At=(0,a.memo)(function(d){var r=d.setInstruction,n=d.messageApi,p=d.isStop,w=d.scrollDomRef,l=d.upButtonDom,x=(0,te.useIntl)(),h=Q(function(t){return t.disableInput}),R=Q(function(t){return t.setDisableInput}),g=(0,a.useState)(""),y=m()(g,2),c=y[0],b=y[1],_=function(o){!o.shiftKey&&o.target.value==""&&(n.open({type:"warning",content:x.formatMessage({id:"app.chatroom.content.input"}),duration:10}),b(""),o.preventDefault()),!o.shiftKey&&o.keyCode==13&&o.target.value!=""&&(R(!0),b(""),r(["INPUT",o.target.value]),o.preventDefault())},k=(0,Re.throttle)(function(){r(["STOP",null])},300);return(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)("div",{className:"max-w-[920px] w-full min-h-[60px] mt-[20px] mb-[20px] mx-auto relative",children:[(0,e.jsx)("div",{ref:l,className:"w-[40px] h-[40px] rounded-[6px]  bg-[#fff] border border-[#ddd] cursor-pointer absolute top-[-67px] left-2/4 flex items-center justify-center hidden",onClick:function(o){w.current.scrollTo({top:w.current.scrollHeight,behavior:"smooth"})},children:(0,e.jsx)(gt,{className:"text-[16px]"})}),(0,e.jsxs)("div",{className:"flex items-center p-[12px] gap-[10px] box-border border border-[#ccc] bg-[#fff] rounded-[8px]",children:[(0,e.jsx)(It,{id:"userValue",className:"placeholder-text-[#aaa] placeholder-text-[14px]",autoSize:{minRows:1,maxRows:6},value:c,disabled:h,onChange:function(o){b(o.target.value)},onPressEnter:_,style:{height:"34px",border:"none",resize:"none",backgroundColor:"transparent"},placeholder:"".concat(x.formatMessage({id:"app.chatroom.content.input"}),"\u2026")}),p?(0,e.jsx)("div",{className:"min-w-[34px] h-[34px] bg-[#000] flex items-center justify-center cursor-pointer rounded-[4px]",onClick:k,children:(0,e.jsx)(wt,{style:{color:"#fff",fontSize:"20px"}})}):(0,e.jsx)("div",{className:"".concat(h||!c?"bg-[#ddd]":"bg-[#1B64F3]"," min-w-[30px] h-[30px]  flex items-center justify-center cursor-pointer rounded-[6px]"),onClick:(0,Re.throttle)(function(){if(h||!c)return!1;c||n.open({type:"warning",content:x.formatMessage({id:"app.chatroom.content.input"}),duration:10}),R(!0),r(["INPUT",c]),b("")},300),children:(0,e.jsx)("img",{src:"/icons/send_icon_w.svg",alt:"",className:"w-[18px] h-[18px]"})})]})]})})}),Pt=function d(r){return typeof r=="string"?r:Array.isArray(r)?r.map(d).join(""):a.isValidElement(r)?d(r.props.children):""},Et=function(r){return Pt(r)},We=function(r,n){return{code:function(w){var l=w.node,x=w.className,h=w.children,R=pt()(w,Dt),g=/language-(\w+)/.exec(x||"");if(g!=null&&g.length){var y=Math.random().toString(36).substr(2,9);return(0,e.jsxs)("div",{className:" rounded-md border overflow-hidden",children:[(0,e.jsxs)("div",{className:"flex h-12 items-center justify-between bg-zinc-100 px-4 bg-zinc-900",children:[(0,e.jsx)("div",{className:"flex items-center gap-2",children:(0,e.jsx)("p",{className:"text-sm  text-[#fff] mb-[0]",children:g[1]})}),(0,e.jsxs)("div",{className:"text-[12px] text-[#fff] mb-[0] cursor-pointer flex gap-x-[5px]",onClick:function(){var c=ne()(O()().mark(function b(_){var k;return O()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.prev=0,k=_.currentTarget,o.next=4,qe()(Et(h));case 4:k&&(k.children[1].innerText=n.formatMessage({id:"app.chatroom.content.copySucceed"})),setTimeout(function(){k&&(k.children[1].innerText=n.formatMessage({id:"app.chatroom.content.copycode"}))},200),o.next=11;break;case 8:o.prev=8,o.t0=o.catch(0),console.error("Failed to copy text: ",o.t0);case 11:case"end":return o.stop()}},b,null,[[0,8]])}));return function(b){return c.apply(this,arguments)}}(),children:[(0,e.jsx)("img",{src:"/icons/chat_copy_w.svg"}),(0,e.jsx)("span",{children:n.formatMessage({id:"app.chatroom.content.copycode"})})]})]}),(0,e.jsx)("div",{className:"overflow-x-auto bg-[#282c34] text-[#abb2bf]",children:(0,e.jsx)("div",{id:"".concat(y).concat(r),className:"p-4",children:h})})]})}else return(0,e.jsx)("code",q()(q()({},R),{},{children:h}))}}},et=(0,a.memo)(function(d){var r=d.messageApi,n=d.index,p=d.idName,w=d.cidName,l=(0,te.useIntl)(),x=(0,a.useState)(!1),h=m()(x,2),R=h[0],g=h[1];return(0,e.jsx)("div",{className:"flex gap-x-[4px]",children:(0,e.jsxs)("div",{onMouseEnter:function(){g(!0)},onMouseLeave:function(){g(!1)},className:" p-[2px] cursor-pointer rounded-md flex gap-x-[5px] items-center pt-[10px]",onClick:function(){var y=ne()(O()().mark(function c(b){var _,k;return O()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return _=b.target.closest("#".concat(p).concat(n)),k=_.querySelector("#".concat(w).concat(n)),o.prev=2,o.next=5,qe()(k.innerText);case 5:r.open({type:"success",content:l.formatMessage({id:"app.chatroom.content.copySucceed"}),duration:2}),o.next=11;break;case 8:o.prev=8,o.t0=o.catch(2),console.error("Failed to copy text: ",o.t0);case 11:case"end":return o.stop()}},c,null,[[2,8]])}));return function(c){return y.apply(this,arguments)}}(),children:[(0,e.jsx)("img",{src:"".concat(R?"/icons/chat_copy_check.svg":"/icons/chat_copy.svg"),className:"w-[16px] h-[16px]"}),(0,e.jsx)("span",{className:"text-[12px] ".concat(R?" text-[#1B64F3]":"text-[#666]"),children:l.formatMessage({id:"app.chatroom.content.copy"})})]})})}),tt=function(r){var n=r.id,p=r.index,w=r.idName,l=r.cidName,x=(0,te.useIntl)(),h=Q(function(k){return k.setSummaryClick}),R=(0,a.useState)(!0),g=m()(R,2),y=g[0],c=g[1],b=Q(function(k){return k.summaryClick});(0,a.useEffect)(function(){c(b)},[b]);var _=Q(function(k){return k.setSummaryParams});return(0,e.jsx)("div",{className:"flex gap-x-[4px] text-[#666] ".concat(y?"cursor-pointer hover:text-[#1B64F3]":"cursor-no-drop"),children:(0,e.jsxs)("div",{className:" p-[2px]  rounded-md flex gap-x-[5px] items-center pt-[10px]",onClick:function(t){if(y){var o=t.target.closest("#".concat(w).concat(p)),C=o.querySelector("#".concat(l).concat(p));_({id:n,message:C.innerText}),h(!1)}},children:[(0,e.jsx)(_t.Z,{className:"text-[16px]"}),(0,e.jsx)("span",{className:"text-[12px]",children:x.formatMessage({id:"app.chatroom.content.summary"})})]})})},Ot=function(r){var n=r.roomid,p=(0,te.useIntl)(),w=Q(function(c){return c.setSummaryClick}),l=(0,a.useState)(!0),x=m()(l,2),h=x[0],R=x[1],g=Q(function(c){return c.summaryClick});(0,a.useEffect)(function(){R(g)},[g]);var y=Q(function(c){return c.setSummaryParams});return(0,e.jsx)("div",{className:"bg-[#fff] text-[#999999]   items-center justify-center rounded-[8px] ".concat(h?"cursor-pointer hover:text-[#1B64F3]":"cursor-no-drop"),style:{boxShadow:"0px 0px 4px 0px rgba(0,0,0,0.1)"},children:(0,e.jsxs)("div",{className:" gap-x-[4px] flex items-center justify-center h-[40px] px-[20px]",onClick:function(){h&&(y({id:n}),w(!1))},children:[(0,e.jsx)(Mt,{className:"text-[16px]"}),(0,e.jsx)("span",{className:"text-[14px]",children:p.formatMessage({id:"app.chatroom.content.meetingSummary"})})]})})},Tt=(0,a.memo)(function(d){var r=d.messageApi,n=d.setCurrentMessageContent,p=d.sendValue,w=d.agentList,l=d.scrollDomRef,x=d.upButtonDom,h=d.setIsStop,R=d.setisEnd,g=d.setSendValue,y=(0,te.useIntl)(),c=(0,te.useParams)(),b=c.id,_=Q(function(J){return J.setDisableInput}),k=(0,a.useState)({}),t=m()(k,2),o=t[0],C=t[1],L=(0,a.useRef)(!1),M=(0,a.useRef)(""),S=Q(function(J){return J.setTruncatable}),$=function(ie){var X=ie.data;if(X.indexOf("--NEXUSAI-INSTRUCTION-")!==-1){var V=JSON.parse(X.slice(22,-2));switch(V[0]){case"ERROR":_(!1),h(!1),g(""),r.open({type:"error",content:"webSocket-".concat(V[1]),duration:10});break;case"CHAT":var ee={content:"".concat(V[1]),is_agent:0};n(function(j){return[].concat(ce()(j),[ee])}),setTimeout(function(){l.current.scrollTop=l.current.scrollHeight,x.current.style.display="none"});break;case"STOPPABLE":h(V[1]);break;case"TRUNCATABLE":S(V[1]),V[1]||r.open({type:"success",content:"".concat(y.formatMessage({id:"app.chatroom.sidebar.cleartips"})),duration:3});break;case"TRUNCATEOK":r.open({type:"success",content:"".concat(y.formatMessage({id:"app.chatroom.sidebar.cleartips"})),duration:3});break}}if(X.indexOf("REPLY")!==-1&&X.indexOf("--NEXUSAI-INSTRUCTION-")!==-1){var Z=JSON.parse(X.slice(22,-2))[1];M.current="",L.current=!0;var T=w.current.filter(function(j){return j.agent_id==Z})[0];Object.keys(o).length&&n(function(j){return[].concat(ce()(j),[o])}),C(function(j){return q()(q()({},j),{},{is_agent:1,icon:T==null?void 0:T.icon,name:T==null?void 0:T.name})}),h(!0),S(!1)}X.indexOf("--NEXUSAI-INSTRUCTION-")===-1&&L.current&&(l.current.scrollTop=l.current.scrollHeight,x.current.style.display="none",M.current+=X,C(function(j){return q()(q()({},j),{},{content:M.current})})),X.indexOf("ENDCHAT")!==-1&&(L.current=!1,M.current="",_(!1),h(!1),S(!0),Object.keys(o).length&&n(function(j){return[].concat(ce()(j),[o])}),C({}),R(!0),g(""))},z=(0,xt.Z)("chat",$),ae=z.runSocket,H=z.sendMessage,A=z.readyState;return(0,a.useEffect)(function(){A==1&&b&&H(JSON.stringify(["ENTER",parseInt(b)]))},[A]),(0,a.useEffect)(function(){p&&A==1&&H(p)},[p]),(0,a.useEffect)(function(){ae()},[]),(0,e.jsx)(e.Fragment,{children:o.name?(0,e.jsxs)("div",{className:"w-full flex gap-[15px] pt-[15px] pb-[15px] ".concat(o.is_agent!=1?"flex-row-reverse":""),children:[(0,e.jsx)("div",{className:"w-[40px] h-[40px] bg-[#F4F8F1] rounded-[6px] flex items-center justify-center shrink-0",children:o.is_agent==1?(0,e.jsx)("img",{src:(0,ve.s9)("single",o.icon),alt:"",className:"w-[18px]  h-[18px]"}):(0,e.jsx)("img",{src:"/icons/user_header.svg",className:"w-[18px]  h-[18px]"})}),(0,e.jsxs)("div",{className:"flex1 max-w-[560px] text-right",id:"addcontent",children:[(0,e.jsx)("div",{className:"".concat(o.is_agent==1?"text-left":"text-right"," font-[500] text-[14px] text-[#213044] pb-[8px]"),children:o.name?o.name:(0,ve.Qy)("GET").nickname}),(0,e.jsx)("div",{className:"flex ".concat(o.is_agent==1?"flex-row":"flex-row-reverse"),children:(0,e.jsx)("div",{className:"text-left inline-block markdown-container text-[14px] font-[400] text-[#213044] bg-[#F7F7F7] p-[15px] pb-[1px] leading-[22px]",style:o.is_agent==1?{borderRadius:" 0px 8px 8px 8px"}:{borderRadius:"8px 0px 8px 8px",background:"rgba(27,100,243,0.1)",whiteSpace:"pre-wrap"},id:"addchilContent",children:(0,e.jsx)(ge.U,{rehypePlugins:[je.Z],components:We("add",y),children:o.content})})})]})]}):(0,e.jsx)(e.Fragment,{})})}),$t=(0,a.memo)(function(d){var r=d.messageApi,n=d.setUserMessage,p=d.sendValue,w=d.agentList,l=d.scrollDomRef,x=d.upButtonDom,h=d.setIsStop,R=d.setSendValue,g=(0,te.useIntl)(),y=(0,a.useState)([]),c=m()(y,2),b=c[0],_=c[1],k=(0,a.useState)(!1),t=m()(k,2),o=t[0],C=t[1],L=(0,te.useParams)(),M=L.id;return(0,a.useEffect)(function(){o&&(n(function(S){return[].concat(ce()(S),ce()(b))}),_([]),setTimeout(function(){C(!1),l.current.scrollTop=l.current.scrollHeight},200))},[o]),(0,e.jsxs)(e.Fragment,{children:[b.length?b.map(function(S,$){return(0,e.jsxs)("div",{className:"w-full flex gap-[15px] pt-[15px] pb-[15px] ".concat(S.is_agent!=1?"flex-row-reverse":""),children:[(0,e.jsx)("div",{className:"w-[40px] h-[40px] bg-[#F4F8F1] rounded-[6px] flex items-center justify-center shrink-0",children:S.is_agent==1?(0,e.jsx)("img",{src:(0,ve.s9)("single",S.icon),alt:"",className:"w-[18px]  h-[18px]"}):(0,e.jsx)("img",{src:"/icons/user_header.svg",className:"w-[18px]  h-[18px]"})}),(0,e.jsxs)("div",{className:"flex1 max-w-[560px] text-right",id:"currentContent".concat($),children:[(0,e.jsx)("div",{className:"".concat(S.is_agent==1?"text-left":"text-right"," font-[500] text-[14px] text-[#213044] pb-[8px]"),children:S.name?S.name:(0,ve.Qy)("GET").nickname}),(0,e.jsx)("div",{className:"flex ".concat(S.is_agent==1?"flex-row":"flex-row-reverse"),children:(0,e.jsx)("div",{className:"text-left inline-block markdown-container text-[14px] font-[400] text-[#213044] bg-[#F7F7F7] p-[15px] pb-[1px] leading-[22px]",style:S.is_agent==1?{borderRadius:" 0px 8px 8px 8px"}:{borderRadius:"8px 0px 8px 8px",background:"rgba(27,100,243,0.1)",whiteSpace:"pre-wrap"},id:"currentChilContent".concat($),children:(0,e.jsx)(ge.U,{rehypePlugins:[je.Z],components:We($,g),children:S.content})})}),S.is_agent==1?(0,e.jsxs)("div",{className:"flex gap-x-[20px]",children:[(0,e.jsx)(et,{messageApi:r,index:$,idName:"currentContent",cidName:"currentChilContent"}),(0,e.jsx)(tt,{id:M,index:$,idName:"currentContent",cidName:"currentChilContent"})]}):(0,e.jsx)(e.Fragment,{})]})]},$)}):(0,e.jsx)(e.Fragment,{}),(0,e.jsx)(Tt,{messageApi:r,setCurrentMessageContent:_,sendValue:p,agentList:w,scrollDomRef:l,upButtonDom:x,setIsStop:h,setisEnd:C,setSendValue:R})]})}),Lt=(0,a.memo)(function(d){var r=d.messageApi,n=d.scrollDomRef,p=d.instruction,w=d.setIsStop,l=d.upButtonDom,x=d.setInstruction,h=d.agentList,R=(0,te.useIntl)(),g=(0,te.useParams)(),y=g.id,c=(0,a.useState)([]),b=m()(c,2),_=b[0],k=b[1],t=(0,a.useRef)(!1),o=(0,a.useState)(""),C=m()(o,2),L=C[0],M=C[1],S=(0,a.useRef)(null),$=(0,a.useRef)(null),z=(0,a.useRef)(!0),ae=(0,a.useRef)(2),H=(0,a.useRef)(1),A=(0,a.useRef)(0),J=function(){var Z=ne()(O()().mark(function T(j){var le,W,se=arguments;return O()().wrap(function(D){for(;;)switch(D.prev=D.next){case 0:if(le=se.length>1&&se[1]!==void 0?se[1]:function(){},!y){D.next=6;break}return D.next=4,(0,pe.KH)(y,{page:H.current,page_size:20});case 4:W=D.sent,W.code==0&&(ae.current=W.data.total_pages,k(function(K){return j?ce()(W.data.list):[].concat(ce()(W.data.list),ce()(K))}),j?setTimeout(function(){n.current.scrollTop=n.current.scrollHeight,l.current.style.display="none"}):A.current=W.data.list.length);case 6:case"end":return D.stop()}},T)}));return function(j){return Z.apply(this,arguments)}}(),ie=function(T){var j=T.target.scrollHeight-T.target.scrollTop-T.target.clientHeight;if(t.current!==Math.ceil(j)>50&&(t.current=Math.ceil(j)>50,l.current.style.display=t.current?"flex":"none"),T.target.scrollTop==0&&z.current){z.current=!1;var le=S.current.firstChild;H.current=H.current+1,$.current.style.display="flex",ae.current,ae.current>=H.current?J(!1):$.current.style.display="none"}},X=function(T,j){j==="0"&&(j=Number(j));var le=["".concat(T),j===0||j?j:null];M(JSON.stringify(le))},V=Q(function(Z){return Z.disableInput}),ee=Q(function(Z){return Z.clearMemory});return(0,a.useEffect)(function(){ee&&ee.length&&X(ee[0],ee[1])},[ee]),(0,a.useEffect)(function(){p&&p.length&&(X(p[0],p[1]?p[1]:""),x([]))},[p]),(0,a.useEffect)(function(){A.current&&S.current.children[A.current]&&(n.current.scrollTop=S.current.children[A.current].offsetTop,z.current=!0)},[_]),(0,a.useEffect)(function(){H.current=1,J(!0)},[]),(0,e.jsxs)("div",{className:"flex-1 box-border relative overflow-y-auto chatroom overflow-x-hidden",ref:n,onScroll:ie,children:[(0,e.jsx)("div",{className:"text-center justify-center items-center flex",style:{display:"none"},ref:$,children:(0,e.jsx)(he.Z,{})}),(0,e.jsxs)("div",{className:"max-w-[920px] mx-auto",style:{minHeight:"calc(100% - 50px)"},ref:S,children:[_.map(function(Z,T){return(0,e.jsxs)("div",{id:"c".concat(Z.id),className:"w-full flex gap-[15px] pt-[15px] pb-[15px] ".concat(Z.is_agent!=1?"flex-row-reverse":""),children:[(0,e.jsx)("div",{className:"w-[40px] h-[40px] bg-[#F4F8F1] rounded-[6px] flex items-center justify-center shrink-0",children:Z.is_agent==1?(0,e.jsx)("img",{src:(0,ve.s9)("single",Z.icon),alt:"",className:"w-[18px]  h-[18px]"}):(0,e.jsx)("img",{src:"/icons/user_header.svg",className:"w-[18px]  h-[18px]"})}),(0,e.jsxs)("div",{className:"flex1 max-w-[560px] text-right",id:"content".concat(T),children:[(0,e.jsx)("div",{className:"".concat(Z.is_agent==1?"text-left":"text-right"," font-[500] text-[14px] text-[#213044] pb-[8px]"),children:Z.name?Z.name:(0,ve.Qy)("GET").nickname}),(0,e.jsx)("div",{className:"flex ".concat(Z.is_agent==1?"flex-row":"flex-row-reverse"),children:(0,e.jsx)("div",{className:"text-left markdown-container inline-block text-[14px] font-[400] text-[#213044] bg-[#F7F7F7] p-[15px] pb-[1px] leading-[22px]",style:Z.is_agent==1?{borderRadius:" 0px 8px 8px 8px"}:{borderRadius:"8px 0px 8px 8px",background:"rgba(27,100,243,0.1)",whiteSpace:"pre-wrap"},id:"chilContent".concat(T),children:(0,e.jsx)(ge.U,{rehypePlugins:[je.Z],components:We(T,R),children:Z.content})})}),Z.is_agent==1?(0,e.jsxs)("div",{className:"flex gap-x-[20px]",children:[(0,e.jsx)(et,{messageApi:r,idName:"content",cidName:"chilContent",index:T}),(0,e.jsx)(tt,{id:y,index:T,idName:"content",cidName:"chilContent"})]}):(0,e.jsx)(e.Fragment,{})]})]},T)}),(0,e.jsx)($t,{messageApi:r,setUserMessage:k,sendValue:L,agentList:h,scrollDomRef:n,upButtonDom:l,setIsStop:w,setSendValue:M})]}),(0,e.jsx)("div",{className:"w-full flex justify-center pb-[10px]",children:!V&&_.length?(0,e.jsx)(Ot,{roomid:y}):(0,e.jsx)(e.Fragment,{})})]})}),Zt=(0,a.memo)(function(d){var r=d.agentList,n=(0,a.useRef)(null),p=(0,a.useRef)(null),w=(0,a.useState)(!1),l=m()(w,2),x=l[0],h=l[1],R=(0,a.useState)([]),g=m()(R,2),y=g[0],c=g[1],b=Ce.ZP.useMessage(),_=m()(b,2),k=_[0],t=_[1];return(0,e.jsxs)(e.Fragment,{children:[t,(0,e.jsx)("div",{className:"mx-[44px] flex justify-center relative box-border pt-[12px]   overflow-auto",style:{height:"calc(100% )"},children:(0,e.jsxs)("div",{className:"flex flex-col w-full",children:[(0,e.jsx)(Lt,{instruction:y,setInstruction:c,messageApi:k,scrollDomRef:n,setIsStop:h,upButtonDom:p,agentList:r}),(0,e.jsx)(At,{setInstruction:c,messageApi:k,isStop:x,upButtonDom:p,scrollDomRef:n})]})})]})}),Ht=v(42881),Bt=function(r){var n=r.children,p=r.className,w=p===void 0?"":p,l=r.dragDirection,x=l===void 0?"left":l,h=r.minWidth,R=h===void 0?415:h,g=r.maxWidth,y=g===void 0?820:g,c=r.minHeight,b=c===void 0?200:c,_=r.maxHeight,k=_===void 0?800:_,t=r.defaultWidth,o=t===void 0?415:t,C=r.defaultHeight,L=C===void 0?300:C,M=(0,a.useState)(o),S=m()(M,2),$=S[0],z=S[1],ae=(0,a.useState)(L),H=m()(ae,2),A=H[0],J=H[1],ie=(0,a.useCallback)(function(Z,T){z(Z),T&&J(T)},[z,J]),X=(0,Ht.W)({direction:["left","right"].includes(x)?"horizontal":"vertical",triggerDirection:x,minWidth:R,maxWidth:y,minHeight:b,maxHeight:k,onResize:ie}),V=X.triggerRef,ee=X.containerRef;return(0,e.jsxs)("div",{ref:ee,style:{width:["left","right"].includes(x)?"".concat($,"px"):void 0,height:["top","bottom"].includes(x)?"".concat(A,"px"):void 0},className:"flex flex-col p-4 shadow-lg rounded-md border border-blue-300 bg-white z-10 wrapPanel ".concat(w),children:[x==="left"&&(0,e.jsx)("div",{ref:V,className:"absolute top-1/2 -translate-y-1/2 -left-2 w-3 h-6 cursor-col-resize resize-x",children:(0,e.jsx)("div",{className:"w-1 h-6 bg-gray-300 rounded-sm"})}),x==="right"&&(0,e.jsx)("div",{ref:V,className:"absolute top-1/2 -translate-y-1/2 -right-2 flex justify-end w-3 h-6 cursor-col-resize resize-x",children:(0,e.jsx)("div",{className:"w-1 h-6 bg-gray-300 rounded-sm"})}),x==="top"&&(0,e.jsx)("div",{ref:V,className:"absolute left-1/2 -translate-x-1/2 -top-2 h-3 w-6 cursor-row-resize resize-y",children:(0,e.jsx)("div",{className:"h-1 w-6 bg-gray-300 rounded-sm"})}),x==="bottom"&&(0,e.jsx)("div",{ref:V,className:"absolute left-1/2 -translate-x-1/2 -bottom-2 h-3 w-6 cursor-row-resize resize-y",children:(0,e.jsx)("div",{className:"h-1 w-6 bg-gray-300 rounded-sm"})}),n]})},zt=(0,a.memo)(Bt),Vt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M762 164h-64c-4.4 0-8 3.6-8 8v688c0 4.4 3.6 8 8 8h64c4.4 0 8-3.6 8-8V172c0-4.4-3.6-8-8-8zm-508 0v72.4c0 9.5 4.2 18.4 11.4 24.5L564.6 512 265.4 763.1c-7.2 6.1-11.4 15-11.4 24.5V860c0 6.8 7.9 10.5 13.1 6.1L689 512 267.1 157.9A7.95 7.95 0 00254 164z"}}]},name:"vertical-left",theme:"outlined"},Ut=Vt,Wt=function(r,n){return a.createElement(Ne.Z,(0,xe.Z)((0,xe.Z)({},r),{},{ref:n,icon:Ut}))},Gt=a.forwardRef(Wt),Kt=Gt,Jt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M326 164h-64c-4.4 0-8 3.6-8 8v688c0 4.4 3.6 8 8 8h64c4.4 0 8-3.6 8-8V172c0-4.4-3.6-8-8-8zm444 72.4V164c0-6.8-7.9-10.5-13.1-6.1L335 512l421.9 354.1c5.2 4.4 13.1.7 13.1-6.1v-72.4c0-9.4-4.2-18.4-11.4-24.5L459.4 512l299.2-251.1c7.2-6.1 11.4-15.1 11.4-24.5z"}}]},name:"vertical-right",theme:"outlined"},Yt=Jt,Qt=function(r,n){return a.createElement(Ne.Z,(0,xe.Z)((0,xe.Z)({},r),{},{ref:n,icon:Yt}))},Xt=a.forwardRef(Qt),qt=Xt,ea=v(83159),ta={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M464 144H160c-8.8 0-16 7.2-16 16v304c0 8.8 7.2 16 16 16h304c8.8 0 16-7.2 16-16V160c0-8.8-7.2-16-16-16zm-52 268H212V212h200v200zm452-268H560c-8.8 0-16 7.2-16 16v304c0 8.8 7.2 16 16 16h304c8.8 0 16-7.2 16-16V160c0-8.8-7.2-16-16-16zm-52 268H612V212h200v200zm52 132H560c-8.8 0-16 7.2-16 16v304c0 8.8 7.2 16 16 16h304c8.8 0 16-7.2 16-16V560c0-8.8-7.2-16-16-16zm-52 268H612V612h200v200zM424 712H296V584c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v128H104c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h128v128c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V776h128c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8z"}}]},name:"appstore-add",theme:"outlined"},aa=ta,ra=function(r,n){return a.createElement(Ne.Z,(0,xe.Z)((0,xe.Z)({},r),{},{ref:n,icon:aa}))},na=a.forwardRef(ra),sa=na,Oe=v(86),at=v(34994),rt=v(2216),ia=v(85877),la=v(29432),ca=v(39944),oa=v(11551),Ge=v(55927),ua=function(r){var n,p,w,l=r.selectApp,x=r.runid,h=r.setBoxLoading,R=r.setinputShow,g=r.appId,y=r.id,c=r.setisRun,b=(0,te.useIntl)(),_=(0,a.useRef)(""),k=(0,a.useRef)(""),t=(0,a.useRef)(null),o=(0,a.useState)(""),C=m()(o,2),L=C[0],M=C[1],S=(0,a.useState)(null),$=m()(S,2),z=$[0],ae=$[1],H=(0,a.useState)([]),A=m()(H,2),J=A[0],ie=A[1],X=(0,a.useState)(""),V=m()(X,2),ee=V[0],Z=V[1],T=(0,Ge.Z)(function(G){return G.flowMessage}),j=function(D){k.current=le(D);var K={user:{value:le(D)}};Z(new ca.z(K))},le=function G(D){return D.map(function(K){return K.type==="mention"?K.id:K.children?G(K.children):K.text}).join("")},W=function(){var G=ne()(O()().mark(function D(K){var Y,B;return O()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return h(!0),Y=Object.keys(K),Y.forEach(function(s){t.current.properties[s]&&(t.current.properties[s].value=K[s])}),i.next=5,(0,oa.LH)({agent_id:l.checkItem[0].agent_id,ability_id:0,input_dict:t.current,prompt:ee,data_source_run_id:_.current});case 5:B=i.sent,B.code==0&&(M(B.data.outputs_md),h(!1),c(!1));case 7:case"end":return i.stop()}},D)}));return function(K){return G.apply(this,arguments)}}(),se=function(){var G=ne()(O()().mark(function D(K,Y){var B,I;return O()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,(0,pe.xT)(K,Y);case 2:B=s.sent,(B==null?void 0:B.code)==0&&(_.current=B==null||(I=B.data)===null||I===void 0?void 0:I.app_run_id);case 4:case"end":return s.stop()}},D)}));return function(K,Y){return G.apply(this,arguments)}}();return(0,a.useEffect)(function(){l&&l.checkItem.length&&(c(!0),se(y,{app_id:g,app_run_id:x,status:1,corrected_parameter:""}))},[l]),(0,a.useEffect)(function(){var G=T.filter(function(i){return i.data.app_run_id==x&&i.type.indexOf("generate_meeting_action_items")!==-1});if(G.length!=0){var D,K=(D=G[G.length-1])===null||D===void 0||(D=D.data)===null||D===void 0||(D=D.exec_data)===null||D===void 0||(D=D.outputs)===null||D===void 0?void 0:D.value;if(K){var Y=JSON.parse(K);t.current=Y;var B=Object.keys(Y.properties);if(B.length){ae(Y.properties);var I=B.map(function(i){return{value:"<<".concat(la.qX,".inputs.").concat(i,">>"),label:i}});ie(I)}R(!1),h(!1)}}},[T]),(0,e.jsxs)("div",{children:[(0,e.jsx)("div",{className:"py-[6px]",children:(0,e.jsx)(Oe.Z,{icon:l==null||(n=l.checkItem[0])===null||n===void 0?void 0:n.icon,title:l==null||(p=l.checkItem[0])===null||p===void 0?void 0:p.name,textDetails:l==null||(w=l.checkItem[0])===null||w===void 0?void 0:w.description,iconType:"robot_icon",handleClick:function(){}})}),z!=null?(0,e.jsxs)(at.A,{submitter:{resetButtonProps:!1,submitButtonProps:{className:"w-full",disabled:!k.current},searchConfig:{submitText:b.formatMessage({id:"workflow.button.run"})}},onFinish:function(D){W(D)},children:[(0,e.jsx)("div",{className:"py-[6px]",children:(0,e.jsx)(rt._,{data:z})}),(0,e.jsx)("div",{className:"h-[150px] overflow-y-auto border border-color-[#eee] py-[4px] px-[11px] mb-[8px]",children:(0,e.jsx)(ia.Z,{onChange:function(D){j(D)},options:J,placeholder:"\u8BF7\u8F93\u5165\u8FD0\u884C\u6307\u4EE4\uFF0C\u8F93\u5165@\u63D2\u5165\u53D8\u91CF"})})]}):(0,e.jsx)(e.Fragment,{}),L?(0,e.jsx)("div",{className:"max-h-[400px] overflow-y-auto mt-[16px]",children:(0,e.jsx)("div",{className:"p-[12px]  bg-[#F7F7F7] leading-[22px]",children:(0,e.jsx)(ge.U,{rehypePlugins:[je.Z],children:L})})}):(0,e.jsx)(e.Fragment,{})]})},da=(0,a.memo)(ua),pa=v(66309),nt=v(42237),xa=v(93696),fa=function(r,n){return a.createElement(Ne.Z,(0,xe.Z)((0,xe.Z)({},r),{},{ref:n,icon:xa.Z}))},ma=a.forwardRef(fa),va=ma,ha=v(4981),Ke=v(29608),ga=(0,a.memo)(function(d){var r=d.progressObj,n=function(){return parseFloat(r.elapsed_time).toFixed(6)},p=function(l){var x=new Date(l),h=x.getFullYear(),R=(x.getMonth()+1).toString().padStart(2,"0"),g=x.getDate().toString().padStart(2,"0"),y=x.getHours().toString().padStart(2,"0"),c=x.getMinutes().toString().padStart(2,"0"),b=x.getSeconds().toString().padStart(2,"0");return(0,e.jsx)(e.Fragment,{children:"".concat(h,".").concat(R,".").concat(g," ").concat(y,":").concat(c,":").concat(b)})};return(0,e.jsx)("div",{className:"inline-flex gap-x-4 justify-end max-w-[100%]",children:(0,e.jsxs)("div",{className:"inline-flex gap-x-[20px] max-w-[100%]",children:[(0,e.jsx)("div",{className:"truncate min-w-[70px]",children:r.created_time&&p(r.created_time)}),(0,e.jsx)("div",{className:"truncate",children:r.apps_name||r.app_name}),(0,e.jsxs)("div",{className:"flex items-center gap-x-[7px] truncate min-w-[50px]",children:[(0,e.jsx)("div",{className:"shrink-0 rounded-full ".concat(r.status==1?"bg-blue-600":r.status==2?"bg-green-500":"bg-red-500"),style:{width:"3px",height:"3px"}}),(0,e.jsxs)("div",{className:"truncate",children:[n(),"S"]})]})]})})}),ja=function(r){var n,p,w,l=r.selectApp,x=r.runid,h=r.setBoxLoading,R=r.setinputShow,g=r.appId,y=r.id,c=r.setisRun,b=(0,te.useIntl)(),_=(0,a.useRef)(""),k=(0,a.useRef)(null),t=(0,a.useState)(null),o=m()(t,2),C=o[0],L=o[1],M=(0,a.useState)(!1),S=m()(M,2),$=S[0],z=S[1],ae=(0,a.useState)(null),H=m()(ae,2),A=H[0],J=H[1],ie=(0,a.useState)(null),X=m()(ie,2),V=X[0],ee=X[1],Z=(0,a.useState)(null),T=m()(Z,2),j=T[0],le=T[1],W=(0,Ke.Z)(function(s){return s.setDealtWithData}),se=(0,Ke.Z)(function(s){return s.setRunPanelLogRecord}),G=function(){var s=ne()(O()().mark(function u(f){var N,F,P,E,U;return O()().wrap(function(re){for(;;)switch(re.prev=re.next){case 0:return h(!0),N=Object.keys(f),F={},N.forEach(function(ue){k.current.properties[ue]&&(k.current.properties[ue].value=f[ue]),V&&V.forEach(function(me){me.node_id==ue&&(F[ue]=f[ue])})}),P={inputs:k.current,node_confirm_users:F,run_name:"chatroom-".concat(y,"-run-").concat(_.current,"-driven"),run_type:1,data_source_run_id:_.current},re.next=7,(0,nt.UE)(g,P);case 7:E=re.sent,E.code==0&&(_.current=E==null||(U=E.data)===null||U===void 0?void 0:U.app_run_id,z(!0),c(!1));case 9:case"end":return re.stop()}},u)}));return function(f){return s.apply(this,arguments)}}(),D=function(){var s=ne()(O()().mark(function u(){var f,N;return O()().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:f=i==null?void 0:i.filter(function(E){return E.type=="workflow_run_progress"&&E.data.app_run_id==_.current}).map(function(E){var U=E.data;return U}),f&&f.length&&(N=f[f.length-1],L(N),h(!1));case 2:case"end":return P.stop()}},u)}));return function(){return s.apply(this,arguments)}}(),K=function(){var s=ne()(O()().mark(function u(){var f,N,F,P,E;return O()().wrap(function(oe){for(;;)switch(oe.prev=oe.next){case 0:N=i==null?void 0:i.filter(function(re){return re.type=="workflow_need_human_confirm"&&re.data.app_run_id==_.current}),F=(f=N.map(function(re){var ue=re.data,me=re.need_human_confirm;return{data:ue,need_human_confirm:me}}))===null||f===void 0?void 0:f.filter(function(re){return re.data.type!==1}),F&&F.length&&(E=F[F.length-1].data,E.exec_id=E==null||(P=E.node_exec_data)===null||P===void 0?void 0:P.node_exec_id,le(F[F.length-1]),h(!1));case 3:case"end":return oe.stop()}},u)}));return function(){return s.apply(this,arguments)}}(),Y=function(u){return u.completed_progress?parseInt(u.completed_progress.slice(0,-1)):!1},B=function(){var s=ne()(O()().mark(function u(f,N){var F,P;return O()().wrap(function(U){for(;;)switch(U.prev=U.next){case 0:return U.next=2,(0,pe.xT)(f,N);case 2:F=U.sent,(F==null?void 0:F.code)==0&&(_.current=F==null||(P=F.data)===null||P===void 0?void 0:P.app_run_id);case 4:case"end":return U.stop()}},u)}));return function(f,N){return s.apply(this,arguments)}}(),I=function(){var s=ne()(O()().mark(function u(){var f,N;return O()().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:return console.log(g),P.next=3,(0,nt.zO)(g);case 3:f=P.sent,f.code==0&&ee(f==null||(N=f.data)===null||N===void 0?void 0:N.need_confirm_nodes),B(y,{app_id:g,app_run_id:x,status:1,corrected_parameter:""});case 6:case"end":return P.stop()}},u)}));return function(){return s.apply(this,arguments)}}();(0,a.useEffect)(function(){l&&l.checkItem.length&&(c(!0),I())},[l]);var i=(0,Ge.Z)(function(s){return s.flowMessage});return(0,a.useEffect)(function(){D(),K();var s=i.filter(function(P){return P.data.app_run_id==x&&P.type.indexOf("generate_meeting_action_items")!==-1});if(s.length!=0){var u,f=(u=s[s.length-1])===null||u===void 0||(u=u.data)===null||u===void 0||(u=u.exec_data)===null||u===void 0||(u=u.outputs)===null||u===void 0?void 0:u.value;if(f){var N=JSON.parse(f);k.current=N;var F=Object.keys(N.properties);F.length&&(console.log(N.properties),J(N.properties)),R(!1),h(!1)}}},[i]),(0,e.jsxs)("div",{children:[(0,e.jsx)("div",{className:"py-[6px]",children:(0,e.jsx)(Oe.Z,{icon:l==null||(n=l.checkItem[0])===null||n===void 0?void 0:n.icon,title:l==null||(p=l.checkItem[0])===null||p===void 0?void 0:p.name,textDetails:l==null||(w=l.checkItem[0])===null||w===void 0?void 0:w.description,iconType:"workflow_icon",handleClick:function(){}})}),!$&&A!=null?(0,e.jsxs)(at.A,{submitter:{resetButtonProps:!1,submitButtonProps:{className:"w-full"},searchConfig:{submitText:b.formatMessage({id:"workflow.button.run"})}},onFinish:G,children:[(0,e.jsx)("div",{className:"py-[6px]",children:(0,e.jsx)(rt._,{data:A})}),(0,e.jsx)(ha.e,{data:V})]}):(0,e.jsx)(e.Fragment,{children:A!=null?(0,e.jsxs)("div",{children:[(0,e.jsxs)("div",{className:"text-[16px] color-[#000] font-[600] py-[12px]",children:[b.formatMessage({id:"app.summaryhistory.input"}),":"]}),Object.values(A).map(function(s){return(0,e.jsxs)("div",{className:"pb-[10px]",children:[(0,e.jsx)("div",{className:"pb-[8px] font-[600]",children:s.display_name||s.name}),(0,e.jsx)("div",{className:"py-[4px] px-[11px] text-[14px] leading-[1.5] ",children:s.value})]})})]}):(0,e.jsx)(e.Fragment,{})}),j&&j.need_human_confirm!=0?(0,e.jsx)("div",{className:"pt-[12px]",children:(0,e.jsxs)("div",{className:"flex gap-x-[6px] items-center h-[20px] cursor-pointer",onClick:function(){W(j.data)},children:[(0,e.jsx)("div",{children:(0,e.jsx)(va,{className:"text-[#1B64F3] text-[16px]"})}),(0,e.jsx)("span",{children:b.formatMessage({id:"app.summary.backlogTips"})})]})}):(0,e.jsx)(e.Fragment,{}),C?(0,e.jsx)("div",{className:"pt-[10px]",children:(0,e.jsx)(Oe.Z,{status:C.status,icon:C.icon,title:(0,e.jsxs)("div",{className:"items-center gap-x-[8px] inline-flex justify-end w-full",children:[(0,e.jsx)("span",{className:"flex-1 truncate",children:C.run_name}),C.need_human_confirm==1?(0,e.jsx)(pa.Z,{className:" text-[12px] flex items-center justify-center margin-0",color:"blue",children:b.formatMessage({id:"app.summaryhistory.tag"})}):(0,e.jsx)(e.Fragment,{})]}),textDetails:(0,e.jsx)(ga,{progressObj:C}),handleClick:function(){se(C)},progress:Y(C)})}):(0,e.jsx)(e.Fragment,{})]})},ya=(0,a.memo)(ja),Sa=function(r){var n,p,w,l=(0,te.useIntl)(),x=r.runid,h=r.id,R=r.setBoxLoading,g=r.scrollDom,y=r.setinputShow,c=(0,a.useRef)("agent"),b=(0,a.useRef)(""),_=(0,a.useState)(!1),k=m()(_,2),t=k[0],o=k[1],C=(0,a.useState)({type:"agent",checkItem:[],show:!1}),L=m()(C,2),M=L[0],S=L[1],$=[{key:"1",label:(0,e.jsx)("div",{className:"hover:text-[#1B64F3]",onClick:function(){S(function(A){return q()(q()({},A),{},{type:"agent",show:!0})})},children:l.formatMessage({id:"app.summary.SelectAgent"})})},{key:"2",label:(0,e.jsx)("div",{className:"hover:text-[#1B64F3]",onClick:function(){S(function(A){return q()(q()({},A),{},{type:"workflow",show:!0})})},children:l.formatMessage({id:"app.summary.SelectWorkflow"})})}],z=function(){S(function(A){return q()(q()({},A),{},{show:!1})})},ae=function(A){R(!0),S(function(J){return q()(q()({},J),{},{checkItem:A.checkItem})}),c.current=M.type,b.current=A.checkItem[0].app_id};return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)("div",{className:"pt-[24px]  border-[#ddd]",style:{minHeight:M!=null&&(n=M.checkItem)!==null&&n!==void 0&&n.length?g==null||(p=g.current)===null||p===void 0?void 0:p.offsetHeight:"100%"},children:[(0,e.jsxs)("div",{className:"text-[14px] font-[500] flex item-center",children:[(0,e.jsx)("div",{className:"flex-1",children:l.formatMessage({id:"app.summary.Runapp"})}),(0,e.jsx)("div",{className:"px-[10px]",children:t?(0,e.jsx)(ea.Z,{menu:{items:$},children:(0,e.jsx)(sa,{className:"transition cursor-pointer text-[#999] text-[18px] hover:text-[#1B64F3]"})}):(0,e.jsx)(e.Fragment,{})})]}),(0,e.jsx)("div",{children:M!=null&&(w=M.checkItem)!==null&&w!==void 0&&w.length?(0,e.jsx)(e.Fragment,{children:c.current=="agent"?(0,e.jsx)(da,{id:h,appId:b.current,selectApp:M,runid:x,setBoxLoading:R,scrollDom:g,setinputShow:y,setisRun:o}):(0,e.jsx)(ya,{id:h,appId:b.current,selectApp:M,runid:x,setBoxLoading:R,scrollDom:g,setinputShow:y,setisRun:o})}):(0,e.jsxs)("div",{className:"flex gap-x-[20px] min-h-[70px] items-center px-[20px]",children:[(0,e.jsxs)(fe.ZP,{className:"flex-1 text-[14px]",onClick:function(){S(function(A){return q()(q()({},A),{},{type:"agent",show:!0})})},children:[(0,e.jsx)("img",{src:"/icons/robot_icon.svg",alt:"",className:"w-[14px] h-[14px]"}),l.formatMessage({id:"app.summary.SelectAgent"})]}),(0,e.jsxs)(fe.ZP,{className:"flex-1 text-[14px]",onClick:function(){S(function(A){return q()(q()({},A),{},{type:"workflow",show:!0})})},children:[(0,e.jsx)("img",{src:"/icons/workflow_icon.svg",alt:"",className:"w-[14px] h-[14px]"}),l.formatMessage({id:"app.summary.SelectWorkflow"})]})]})})]}),(0,e.jsx)(ke.Z,{show:M.show,nodetype:M.type,popupClose:z,popupSave:ae,checkList:c.current==M.type?M.checkItem:[],zIndex:99,radio:!0})]})},Na=(0,a.memo)(Sa),st=v(87740),it=(0,a.memo)(function(d){var r=d.id,n=d.message,p=(0,te.useIntl)(),w=Q(function(c){return c.setSummaryClick}),l=(0,a.useState)(!0),x=m()(l,2),h=x[0],R=x[1],g=Q(function(c){return c.summaryClick}),y=Q(function(c){return c.setSummaryParams});return(0,a.useEffect)(function(){R(g)},[g]),(0,e.jsx)("div",{className:"flex flex-row-reverse",children:(0,e.jsxs)(fe.ZP,{type:"primary",className:"bg-[#1B64F3] rounded-[4px] my-3 h-[30px] w-[110px] gap-[6px]",onClick:function(b){h&&(y({id:r,message:n}),w(!1))},children:[(0,e.jsx)("span",{className:"text-[12px]",children:p.formatMessage({id:"app.summaryhistory.submitText"})}),(0,e.jsx)(st.Z,{className:"text-[14px]"})]})})}),wa=function(r){var n,p,w,l,x=r.setShow,h=r.inputShow,R=r.setBoxLoading,g=r.setAppRunId,y=r.scrollDom,c=(0,te.useIntl)(),b=(0,a.useState)(!1),_=m()(b,2),k=_[0],t=_[1],o=(0,a.useState)(""),C=m()(o,2),L=C[0],M=C[1],S=(0,a.useState)(""),$=m()(S,2),z=$[0],ae=$[1],H=(0,a.useRef)(""),A=(0,a.useRef)(""),J=(0,a.useRef)(!1),ie=(0,a.useState)(!1),X=m()(ie,2),V=X[0],ee=X[1],Z=(0,a.useState)(null),T=m()(Z,2),j=T[0],le=T[1],W=Q(function(I){return I.setSummaryClick}),se=function(){var I=ne()(O()().mark(function i(s){var u,f,N,F,P=arguments;return O()().wrap(function(U){for(;;)switch(U.prev=U.next){case 0:return u=P.length>1&&P[1]!==void 0?P[1]:{app_run_id:"",corrected_parameter:""},U.next=3,(0,pe.Rp)(s,u);case 3:f=U.sent,(f==null?void 0:f.code)==0&&(g(f==null||(N=f.data)===null||N===void 0?void 0:N.app_run_id),A.current=f==null||(F=f.data)===null||F===void 0?void 0:F.app_run_id,u.app_run_id&&(J.current=!0));case 5:case"end":return U.stop()}},i)}));return function(s){return I.apply(this,arguments)}}(),G=function(){var I=ne()(O()().mark(function i(s,u){var f,N,F,P,E;return O()().wrap(function(oe){for(;;)switch(oe.prev=oe.next){case 0:return oe.next=2,(0,pe.xM)(s,{message:u});case 2:f=oe.sent,(f==null?void 0:f.code)==0&&(A.current=f==null||(N=f.data)===null||N===void 0?void 0:N.app_run_id,g(f==null||(F=f.data)===null||F===void 0?void 0:F.app_run_id),f!=null&&(P=f.data)!==null&&P!==void 0&&(P=P.outputs)!==null&&P!==void 0&&P.value&&(M(f==null||(E=f.data)===null||E===void 0||(E=E.outputs)===null||E===void 0?void 0:E.value),x(!0),R(!1),W(!0)));case 4:case"end":return oe.stop()}},i)}));return function(s,u){return I.apply(this,arguments)}}(),D=function(){var I=ne()(O()().mark(function i(){var s;return O()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.next=2,(0,pe.Gh)({chatroom_id:H.current,app_run_id:A.current});case 2:s=f.sent,s&&s!==null&&s!==void 0&&s.data&&le(s.data);case 4:case"end":return f.stop()}},i)}));return function(){return I.apply(this,arguments)}}(),K=function(i){var s=new Date(i),u=s.getMonth()+1,f=s.getDate(),N=s.getHours(),F=s.getMinutes(),P=s.getSeconds();return s.getFullYear()+"-"+(u<10?"0"+u:u)+"-"+(f<10?"0"+f:f)+" "+(N<10?"0"+N:N)+":"+(F<10?"0"+F:F)+":"+(P<10?"0"+P:P)},Y=(0,Ge.Z)(function(I){return I.flowMessage});(0,a.useEffect)(function(){var I=Y.filter(function(u){return u.data.app_run_id==A.current&&u.type.indexOf("generate_meeting_summary")!==-1});if(I.length!=0){var i,s=(i=I[I.length-1])===null||i===void 0||(i=i.data)===null||i===void 0||(i=i.exec_data)===null||i===void 0||(i=i.outputs)===null||i===void 0?void 0:i.value;s&&(J.current&&D(),M(s),ee(!1),x(!0),W(!0),R(!1))}},[Y]);var B=Q(function(I){return I.summaryParams});return(0,a.useEffect)(function(){B&&B.id&&(H.current=B.id,j&&le(null),V&&ee(!1),L&&M(""),t(!0),B.message?(R(!0),G(B.id,B.message)):se(B.id))},[B]),(0,e.jsx)(e.Fragment,{children:k?(0,e.jsxs)("div",{className:"pb-[16px]",children:[(0,e.jsx)("div",{className:"text-[16px] font-[600] pt-[12px]",children:c.formatMessage({id:"app.summary.title"})}),(0,e.jsx)("div",{className:"text-[14px] pt-[12px] leading-[23px] px-[8px]",children:L?(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("div",{className:" ".concat("max-h-[400px]"," p-[12px]  bg-[#F7F7F7]  relative overflow-y-auto"),children:(0,e.jsx)(ge.U,{rehypePlugins:[je.Z],children:j?j==null||(n=j.source_run)===null||n===void 0?void 0:n.summary:L})}),j&&(j==null||(p=j.source_corrections)===null||p===void 0?void 0:p.length)>0||!h?(0,e.jsx)(it,{id:H.current,message:j?j==null||(w=j.source_run)===null||w===void 0?void 0:w.summary:L}):(0,e.jsx)(e.Fragment,{})]}):(0,e.jsx)("div",{className:"min-h-[120px] flex items-center justify-center",children:(0,e.jsx)(he.Z,{size:"large"})})}),j&&(j==null||(l=j.source_corrections)===null||l===void 0?void 0:l.length)>0?(0,e.jsxs)("div",{children:[(0,e.jsxs)("div",{className:"text-[16px] font-[600] py-[8px]",children:[c.formatMessage({id:"app.summaryhistory.orientation"}),":"]}),j.source_corrections.map(function(I,i){return(0,e.jsxs)("div",{className:"mb-[16px]",children:[(0,e.jsx)("div",{className:"rounded-[4px]  ".concat(j.source_corrections.length-1==i?"bg-blue-100":"bg-[#F7F7F7]"),children:(0,e.jsxs)("div",{className:"p-[12px]   leading-[22px]",children:[(0,e.jsxs)("div",{className:"tetx-[14px] font-[600] pb-[12px]",children:[c.formatMessage({id:"app.summaryhistory.userPrompt"}),": ",I.user_prompt]}),(0,e.jsxs)("div",{className:"tetx-[14px] font-[600] pb-[12px]",children:[c.formatMessage({id:"app.summaryhistory.time"}),": ",K(I.created_time)]}),(0,e.jsx)(ge.U,{rehypePlugins:[je.Z],children:I==null?void 0:I.corrected_summary})]})},I.created_time),!h||j.source_corrections.length-1!=i?(0,e.jsx)(it,{id:H.current,message:I==null?void 0:I.corrected_summary}):(0,e.jsx)(e.Fragment,{})]},I.created_time)})]}):(0,e.jsx)(e.Fragment,{}),h?(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("div",{className:"pt-[12px]",children:(0,e.jsx)(Xe.Z.TextArea,{onChange:function(i){ae(i.target.value)},value:z,disabled:!L||V,rows:4,placeholder:c.formatMessage({id:"app.summary.placeholder"})})}),(0,e.jsx)("div",{className:"flex pt-[12px] gap-x-[4px]",children:(0,e.jsx)(fe.ZP,{type:"primary",disabled:!L||!z,loading:V,className:"bg-[#1B64F3] rounded-[4px] w-[88px] h-[40px] flex-1",onClick:function(){se(H.current,{app_run_id:String(A.current),corrected_parameter:z}),ee(!0),ae(""),x("")},children:c.formatMessage({id:"app.summary.submitText"})})})]}):(0,e.jsx)(e.Fragment,{})]}):(0,e.jsx)(e.Fragment,{})})},_a=(0,a.memo)(wa),ba=(0,a.memo)(function(d){var r=d.progressObj;console.log(r);var n=function(){return parseFloat(r.elapsed_time).toFixed(6)},p=function(l){var x=new Date(l),h=x.getFullYear(),R=(x.getMonth()+1).toString().padStart(2,"0"),g=x.getDate().toString().padStart(2,"0"),y=x.getHours().toString().padStart(2,"0"),c=x.getMinutes().toString().padStart(2,"0"),b=x.getSeconds().toString().padStart(2,"0");return(0,e.jsx)(e.Fragment,{children:"".concat(h,".").concat(R,".").concat(g," ").concat(y,":").concat(c,":").concat(b)})};return(0,e.jsx)("div",{className:"inline-flex gap-x-4 justify-end max-w-[100%]",children:(0,e.jsxs)("div",{className:"inline-flex gap-x-[20px] max-w-[100%]",children:[(0,e.jsx)("div",{className:"truncate min-w-[70px]",children:r.created_time&&p(r.created_time)}),(0,e.jsx)("div",{className:"truncate",children:r.apps_name||r.app_name}),(0,e.jsxs)("div",{className:"flex items-center gap-x-[7px] truncate min-w-[50px]",children:[(0,e.jsx)("div",{className:"shrink-0 rounded-full ".concat(r.status==1?"bg-blue-600":r.status==2?"bg-green-500":"bg-red-500"),style:{width:"3px",height:"3px"}}),(0,e.jsxs)("div",{className:"truncate",children:[n(),"S"]})]})]})})}),lt=(0,a.memo)(function(d){var r=d.id,n=d.message,p=(0,te.useIntl)(),w=Q(function(c){return c.setSummaryClick}),l=(0,a.useState)(!0),x=m()(l,2),h=x[0],R=x[1],g=Q(function(c){return c.summaryClick}),y=Q(function(c){return c.setSummaryParams});return(0,a.useEffect)(function(){R(g)},[g]),(0,e.jsx)("div",{className:"flex flex-row-reverse",children:(0,e.jsxs)(fe.ZP,{type:"primary",className:"bg-[#1B64F3] rounded-[4px] my-3 h-[30px] w-[110px] gap-[6px]",onClick:function(b){h&&(y({id:r,message:n}),w(!1))},children:[(0,e.jsx)("span",{className:"text-[12px]",children:p.formatMessage({id:"app.summaryhistory.submitText"})}),(0,e.jsx)(st.Z,{className:"text-[14px]"})]})})}),Ca=function(r){var n=r.list,p=r.scrollDom,w=r.historyHeight,l=r.id,x=(0,te.useIntl)(),h=(0,a.useState)([]),R=m()(h,2),g=R[0],y=R[1],c=(0,a.useRef)("100%"),b=(0,Ke.Z)(function(t){return t.setRunPanelLogRecord}),_=function(o){var C=new Date(o),L=C.getMonth()+1,M=C.getDate(),S=C.getHours(),$=C.getMinutes(),z=C.getSeconds();return C.getFullYear()+"-"+(L<10?"0"+L:L)+"-"+(M<10?"0"+M:M)+" "+(S<10?"0"+S:S)+":"+($<10?"0"+$:$)+":"+(z<10?"0"+z:z)},k=function(o){var C=Object.keys(o),L=[];return C.forEach(function(M){L.push(o[M])}),L};return(0,a.useEffect)(function(){if(p){var t;c.current=p==null||(t=p.current)===null||t===void 0?void 0:t.offsetHeight}},[p]),(0,a.useEffect)(function(){w&&(c.current="auto")},[w]),(0,a.useEffect)(function(){y(ce()(n))},[n]),(0,e.jsx)(e.Fragment,{children:(0,e.jsx)("div",{className:"px-4",style:{minHeight:c.current},children:g&&g.length?g.map(function(t){var o,C,L,M,S,$,z,ae,H,A,J,ie,X,V,ee,Z,T,j,le;return t!=null&&t.source_run&&t!==null&&t!==void 0&&t.source_run.summary?(0,e.jsx)("div",{className:"pt-[16px] border-b-[1px] border-color-[#eee] ",children:(0,e.jsxs)("div",{className:"pb-[60px]",children:[(0,e.jsx)("div",{className:"text-[16px] font-[600] pb-[8px] flex items-center",children:(0,e.jsx)("span",{className:"flex-1",children:x.formatMessage({id:"app.summary.title"})})}),(0,e.jsx)("p",{className:"text-[12px] color-[#eee] mb-[8px]",children:_(t==null||(o=t.source_run)===null||o===void 0?void 0:o.created_time)}),(0,e.jsxs)("div",{children:[(0,e.jsx)("div",{className:"p-[12px]  leading-[22px] ".concat(t!=null&&t.source_corrections&&(t==null?void 0:t.source_corrections.length)>0?"bg-[#F7F7F7]":"bg-blue-100 rounded-[4px]"),children:(0,e.jsx)(ge.U,{rehypePlugins:[je.Z],children:t==null||(C=t.source_run)===null||C===void 0?void 0:C.summary})}),(0,e.jsx)(lt,{id:l,message:t==null||(L=t.source_run)===null||L===void 0?void 0:L.summary})]}),t!=null&&t.source_corrections&&(t==null?void 0:t.source_corrections.length)>0?(0,e.jsxs)("div",{children:[(0,e.jsxs)("div",{className:"text-[16px] font-[600] py-[8px]",children:[x.formatMessage({id:"app.summaryhistory.orientation"}),":"]}),t==null?void 0:t.source_corrections.map(function(W,se){return(0,e.jsxs)("div",{className:"mb-[16px] last-of-type:mb-0",children:[(0,e.jsx)("div",{className:"rounded-[4px]  ".concat((t==null?void 0:t.source_corrections.length)-1!=se?"bg-[#F7F7F7]":"bg-blue-100"),children:(0,e.jsxs)("div",{className:"p-[12px]   leading-[22px]",children:[(0,e.jsxs)("div",{className:"tetx-[14px] font-[600] pb-[12px]",children:[x.formatMessage({id:"app.summaryhistory.userPrompt"}),": ",W.user_prompt]}),(0,e.jsxs)("div",{className:"tetx-[14px] font-[600] pb-[12px]",children:[x.formatMessage({id:"app.summaryhistory.time"}),":"," ",_(W.created_time)]}),(0,e.jsx)(ge.U,{rehypePlugins:[je.Z],children:W==null?void 0:W.corrected_summary})]})}),(0,e.jsx)(lt,{id:l,message:W==null?void 0:W.corrected_summary})]},W.created_time)})]}):(0,e.jsx)(e.Fragment,{}),t!=null&&t.target_run?(0,e.jsxs)("div",{className:"py-[12px]",children:[(0,e.jsxs)("div",{className:"text-[16px] font-[600] py-[8px]",children:[x.formatMessage({id:"app.summaryhistory.runapp"}),":"]}),(0,e.jsx)("div",{children:(0,e.jsxs)("div",{className:"text-[14px] py-[6px]",children:[(0,e.jsx)("span",{className:"font-[500] ",children:t!=null&&(M=t.target_run)!==null&&M!==void 0&&M.agent_id?"agent":"workflow"}),(0,e.jsx)("span",{className:"px-[6px]",children:":"}),(0,e.jsx)("span",{children:t==null||(S=t.target_run)===null||S===void 0||(S=S.app)===null||S===void 0?void 0:S.name})]})}),(0,e.jsx)("div",{children:t!=null&&($=t.target_run)!==null&&$!==void 0&&($=$.inputs)!==null&&$!==void 0&&$.properties?(0,e.jsxs)("div",{children:[(0,e.jsxs)("div",{className:"text-[16px] color-[#000] font-[600] py-[12px]",children:[x.formatMessage({id:"app.summaryhistory.input"}),":"]}),k(t==null||(z=t.target_run)===null||z===void 0||(z=z.inputs)===null||z===void 0?void 0:z.properties).map(function(W){return(0,e.jsxs)("div",{children:[(0,e.jsx)("div",{className:"pb-[8px] font-[600]",children:W.display_name||W.name}),(0,e.jsx)("div",{className:"py-[4px] px-[11px] text-[14px] leading-[1.5] h-[]",children:W.value})]})})]}):(0,e.jsx)(e.Fragment,{})}),(0,e.jsx)("div",{children:t!=null&&(ae=t.target_run)!==null&&ae!==void 0&&ae.raw_user_prompt?(0,e.jsxs)("div",{children:[(0,e.jsxs)("div",{className:"text-[16px] color-[#000] font-[600] py-[12px] pb-[6px]",children:[x.formatMessage({id:"app.summaryhistory.prompt"}),":"]}),(0,e.jsx)("div",{className:"py-[4px] px-[11px] text-[14px] leading-[1.5] ",children:t==null||(H=t.target_run)===null||H===void 0?void 0:H.raw_user_prompt})]}):(0,e.jsx)(e.Fragment,{})}),(0,e.jsxs)("div",{children:[(0,e.jsxs)("div",{className:"text-[16px] font-[600] py-[8px]",children:[x.formatMessage({id:"app.summaryhistory.results"}),":"]}),(0,e.jsx)("div",{className:"p-[12px]  bg-[#F7F7F7]",children:(t==null||(A=t.target_run)===null||A===void 0?void 0:A.agent_id)!=0?(0,e.jsx)("div",{className:"p-[12px]  bg-[#F7F7F7] leading-[22px]",children:(0,e.jsx)(ge.U,{rehypePlugins:[je.Z],children:t==null||(J=t.target_run)===null||J===void 0||(J=J.outputs)===null||J===void 0?void 0:J.value})}):(0,e.jsx)(Oe.Z,{status:t==null||(ie=t.target_run)===null||ie===void 0?void 0:ie.status,icon:t==null||(X=t.target_run)===null||X===void 0?void 0:X.icon,title:t==null||(V=t.target_run)===null||V===void 0?void 0:V.name,textDetails:(0,e.jsx)(ba,{progressObj:{created_time:t==null||(ee=t.target_run)===null||ee===void 0?void 0:ee.created_time,elapsed_time:t==null||(Z=t.target_run)===null||Z===void 0?void 0:Z.elapsed_time,app_name:t==null||(T=t.target_run)===null||T===void 0?void 0:T.app.name,status:t==null||(j=t.target_run)===null||j===void 0?void 0:j.status}}),handleClick:function(){var se,G,D,K,Y,B,I,i,s,u;b({app_id:t==null||(se=t.target_run)===null||se===void 0||(se=se.app)===null||se===void 0?void 0:se.id,app_name:t==null||(G=t.target_run)===null||G===void 0||(G=G.app)===null||G===void 0?void 0:G.name,icon:t==null||(D=t.target_run)===null||D===void 0?void 0:D.icon,workflow_id:t==null||(K=t.target_run)===null||K===void 0?void 0:K.workflow_id,type:2,app_run_id:t==null||(Y=t.target_run)===null||Y===void 0?void 0:Y.id,run_name:t==null||(B=t.target_run)===null||B===void 0?void 0:B.name,status:t==null||(I=t.target_run)===null||I===void 0?void 0:I.status,created_time:t==null||(i=t.target_run)===null||i===void 0?void 0:i.created_time,elapsed_time:t==null||(s=t.target_run)===null||s===void 0?void 0:s.elapsed_time,completed_progress:"".concat(t==null||(u=t.target_run)===null||u===void 0?void 0:u.percentage,"%")})},progress:t==null||(le=t.target_run)===null||le===void 0?void 0:le.percentage})})]})]}):(0,e.jsx)(e.Fragment,{})]})},t.source_run.id):(0,e.jsx)(e.Fragment,{})}):(0,e.jsx)(e.Fragment,{})})})},Ra=(0,a.memo)(Ca),ka=function(r){var n,p=r.id,w=(0,a.useState)(""),l=m()(w,2),x=l[0],h=l[1],R=(0,a.useState)(!1),g=m()(R,2),y=g[0],c=g[1],b=(0,a.useState)([]),_=m()(b,2),k=_[0],t=_[1],o=(0,a.useState)(!1),C=m()(o,2),L=C[0],M=C[1],S=(0,a.useState)(!1),$=m()(S,2),z=$[0],ae=$[1],H=(0,a.useState)(""),A=m()(H,2),J=A[0],ie=A[1],X=(0,a.useState)(!1),V=m()(X,2),ee=V[0],Z=V[1],T=(0,a.useState)(!1),j=m()(T,2),le=j[0],W=j[1],se=(0,a.useState)(!0),G=m()(se,2),D=G[0],K=G[1],Y=(0,a.useRef)(null),B=(0,a.useRef)(1),I=(0,a.useRef)(!1),i=(0,a.useRef)(!0),s=(0,a.useRef)(0),u=(0,a.useState)(!1),f=m()(u,2),N=f[0],F=f[1],P=Q(function(re){return re.summaryParams}),E=Q(function(re){return re.setSummaryParams}),U=function(){var re=ne()(O()().mark(function ue(){var me,Te,de,Je,_e,Ye,be=arguments;return O()().wrap(function(we){for(;;)switch(we.prev=we.next){case 0:if(me=be.length>0&&be[0]!==void 0?be[0]:!0,Te=be.length>1&&be[1]!==void 0?be[1]:!0,!(s.current!=0&&s.current<B.current)){we.next=5;break}return F(!1),we.abrupt("return");case 5:return we.next=8,(0,pe.sh)({chatroom_id:p,page:B.current,page_size:10});case 8:de=we.sent,de.code==0&&(de!=null&&(Je=de.data)!==null&&Je!==void 0&&Je.list&&de!==null&&de!==void 0&&(_e=de.data)!==null&&_e!==void 0&&(_e=_e.list)!==null&&_e!==void 0&&_e.length&&(s.current=de==null||(Ye=de.data)===null||Ye===void 0?void 0:Ye.total_pages,t(function(Me){return Te?ce()(de.data.list.reverse()):[].concat(ce()(de.data.list.reverse()),ce()(Me))}),c(!0),F(!0),setTimeout(function(){i.current=!0},300)),Te&&setTimeout(function(){var Me;Y==null||(Me=Y.current)===null||Me===void 0||Me.scrollTo({top:0})},200),me||(h(P.id),E({})));case 10:case"end":return we.stop()}},ue)}));return function(){return re.apply(this,arguments)}}(),oe=function(){var re=ne()(O()().mark(function ue(me){return O()().wrap(function(de){for(;;)switch(de.prev=de.next){case 0:me.target.scrollHeight+(me.target.scrollTop-me.target.clientHeight)<10&&i.current&&(i.current=!1,F(!0),B.current=B.current+=1,U(!0,!1));case 1:case"end":return de.stop()}},ue)}));return function(me){return re.apply(this,arguments)}}();return(0,a.useEffect)(function(){B.current=1,U()},[p]),(0,a.useEffect)(function(){P&&P.id&&(c(!0),D||K(!0),L&&M(!1),ee&&Z(!1),B.current=1,ae(!0),U(!1),I.current=!0)},[P]),(0,e.jsx)(e.Fragment,{children:y?(0,e.jsxs)(zt,{minWidth:400,className:"relative h-full right-0 border-0 returned-0 px-[0] ".concat(ee?"translate-x-full flex-[0]":""),children:[le?(0,e.jsx)("div",{className:"h-full w-full absolute top-0 left-0 flex justify-center items-center z-[100] bg-[rgba(255,255,255,0.5)]",children:(0,e.jsx)(he.Z,{size:"large"})}):(0,e.jsx)(e.Fragment,{}),(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("div",{onClick:function(){Z(function(ue){return!ue})},className:`
                                        `.concat(ee?"right-[100%] top-[4px]":"right-[6px] top-[60px]",`
                                        fixed w-[40px] h-[40px]  flex justify-center items-center cursor-pointer z-[99]
                                    `),children:ee?(0,e.jsx)(qt,{className:"text-[20px]"}):(0,e.jsx)(Kt,{className:"text-[20px]"})}),(0,e.jsxs)("div",{className:"h-full min-h-full overflow-y-auto flex flex-col-reverse scroll-smooth relative",onScroll:oe,ref:Y,children:[(0,e.jsxs)("div",{children:[k.length?(0,e.jsx)(Ra,{id:p,scrollDom:Y,list:k,historyHeight:I.current}):(0,e.jsx)(e.Fragment,{}),(0,e.jsxs)("div",{className:"w-full px-4 h-full",style:{minHeight:z?Y==null||(n=Y.current)===null||n===void 0?void 0:n.offsetHeight:""},children:[(0,e.jsx)(_a,{setShow:M,inputShow:D,setBoxLoading:W,setAppRunId:ie,scrollDom:Y}),L?(0,e.jsx)(Na,{id:x,runid:J,setBoxLoading:W,scrollDom:Y,setinputShow:K}):(0,e.jsx)(e.Fragment,{})]})]}),N?(0,e.jsx)("div",{className:"text-center justify-center items-center flex",children:(0,e.jsx)(he.Z,{})}):(0,e.jsx)(e.Fragment,{})]})]})]}):(0,e.jsx)(e.Fragment,{})})},Ma=(0,a.memo)(ka),Fa=function(r){return(0,e.jsx)("div",{className:"flex items-center h-full justify-center",children:(0,e.jsx)(ye.Z,{image:ye.Z.PRESENTED_IMAGE_SIMPLE})})},Da=(0,a.memo)(function(){var d=(0,te.useParams)(),r=d.id,n=(0,a.useRef)([]),p=(0,a.useRef)(null),w=(0,a.useState)(!1),l=m()(w,2),x=l[0],h=l[1],R=function(){var g=ne()(O()().mark(function y(){var c;return O()().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:if(!r){_.next=5;break}return _.next=3,(0,pe.cH)({id:r});case 3:c=_.sent,c.code==0?(h(!0),p.current=c.data,n.current=c.data.agent_list):te.history.replace("/meeting");case 5:case"end":return _.stop()}},y)}));return function(){return g.apply(this,arguments)}}();return(0,a.useEffect)(function(){R()},[]),(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)("div",{className:"w-full flex bg-[#fff] overflow-hidden",style:{height:"calc(100vh - 56px)"},children:[(0,e.jsx)(ut,{roomDetail:p.current,setAgent:n}),(0,e.jsx)("div",{className:"flex-1 min-h-0 h-full",children:x?(0,e.jsx)(Zt,{agentList:n}):(0,e.jsx)(Fa,{})}),(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(Ma,{id:r})})]})})}),Ia=Da}}]);
