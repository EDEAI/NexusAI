(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[5944],{69243:function(I,x,e){"use strict";e.d(x,{Z:function(){return y}});var b=e(1413),M=e(67294),L={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M928 140H96c-17.7 0-32 14.3-32 32v496c0 17.7 14.3 32 32 32h380v112H304c-8.8 0-16 7.2-16 16v48c0 4.4 3.6 8 8 8h432c4.4 0 8-3.6 8-8v-48c0-8.8-7.2-16-16-16H548V700h380c17.7 0 32-14.3 32-32V172c0-17.7-14.3-32-32-32zm-40 488H136V212h752v416z"}}]},name:"desktop",theme:"outlined"},l=L,j=e(91146),g=function(T,D){return M.createElement(j.Z,(0,b.Z)((0,b.Z)({},T),{},{ref:D,icon:l}))},w=M.forwardRef(g),y=w},15360:function(I,x,e){"use strict";e.d(x,{Z:function(){return y}});var b=e(1413),M=e(67294),L={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M854.6 288.6L639.4 73.4c-6-6-14.1-9.4-22.6-9.4H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V311.3c0-8.5-3.4-16.7-9.4-22.7zM790.2 326H602V137.8L790.2 326zm1.8 562H232V136h302v216a42 42 0 0042 42h216v494zM504 618H320c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h184c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8zM312 490v48c0 4.4 3.6 8 8 8h384c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8H320c-4.4 0-8 3.6-8 8z"}}]},name:"file-text",theme:"outlined"},l=L,j=e(91146),g=function(T,D){return M.createElement(j.Z,(0,b.Z)((0,b.Z)({},T),{},{ref:D,icon:l}))},w=M.forwardRef(g),y=w},85877:function(I,x,e){"use strict";var b=e(19632),M=e.n(b),L=e(97857),l=e.n(L),j=e(5574),g=e.n(j),w=e(52677),y=e.n(w),V=e(35312),T=e(78234),D=e(77598),z=e(96486),K=e.n(z),f=e(67294),ae=e(73935),r=e(43413),W=e(92858),i=e(16845),B=e(15425),s=e(85893),H=function(n){var a=n.children;return(typeof document=="undefined"?"undefined":y()(document))==="object"?ae.createPortal(a,document.body):null},G=typeof navigator!="undefined"&&/Mac OS X/.test(navigator.userAgent),Y=function(n){var a=n.value,d=n.onChange,v=n.id,c=n.placeholder,_=n.options,p=(0,V.useIntl)(),U=(0,f.useRef)(),Q=(0,f.useState)(),q=g()(Q,2),E=q[0],C=q[1],A=(0,f.useState)(0),re=g()(A,2),R=re[0],ee=re[1],de=(0,f.useState)(""),se=g()(de,2),ce=se[0],me=se[1],fe=(0,f.useCallback)(function(t){return(0,s.jsx)($,l()({},t))},[]),ve=(0,f.useCallback)(function(t){return(0,s.jsx)(X,l()({},t))},[]),u=(0,f.useMemo)(function(){return F((0,i.BU)((0,W.VC)((0,r.Jh)())))},[]),pe=(0,f.useState)(null),oe=g()(pe,2),he=oe[0],ge=oe[1],Oe=(0,B.Z)(function(t){return t.selectedNode}),Pe=(0,B.Z)(function(t){return t.getOutputVariables}),Ie=(0,B.Z)(function(t){return t.getInputVariables}),Ee=(0,f.useState)([]),le=g()(Ee,2),P=le[0],ie=le[1];(0,T.Z)(function(){a&&a.length>0&&te(a),_!=null&&_.length&&ie(_.map(function(t){return l()(l()({},t),{},{name:t.label,id:t.value})}))}),(0,D.Z)(function(){var t=K().isEqual(he,a);t||(a&&a.length>0?te(a):a&&K().isArray(a)&&a.length==0&&te([{type:"paragraph",children:[]}]))},[a,v]),(0,D.Z)(function(){_.length&&ie(_.map(function(t){return l()(l()({},t),{},{name:t.label,id:t.value})})),console.log(_)},[_]);var te=function(o){ge(o),_e(u,{nodes:[{type:"paragraph",children:[]}]}),_e(u,{nodes:o})},Me=(0,f.useCallback)(function(t){if(E&&P.length>0)switch(t.key){case"ArrowDown":t.preventDefault();var o=R>=P.length-1?0:R+1;ee(o);return;case"ArrowUp":t.preventDefault();var m=R<=0?P.length-1:R-1;ee(m);return;case"Tab":case"Enter":t.preventDefault(),r.YR.select(u,E),h(u,P[R]),C(null);return;case"Escape":t.preventDefault(),C(null);return}else if(t.key==="@"){setTimeout(function(){return De()},10);return}C(null)},[P,u,R,E]),_e=function(o){var m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},ne=M()(o.children);if(ne.forEach(function(S){return o.apply({type:"remove_node",path:[0],node:S})}),m.nodes){var N=r.NB.isNode(m.nodes)?[m.nodes]:m.nodes;N.forEach(function(S,ue){return o.apply({type:"insert_node",path:[ue],node:S})})}var Z=m.at&&r.E9.isPoint(m.at)?m.at:r.ML.end(o,[]);Z&&r.YR.select(o,Z)};(0,f.useEffect)(function(){if(E&&P.length>0){var t=U.current,o=i.F3.toDOMRange(u,E),m=o.getBoundingClientRect();t.style.top="".concat(m.top+window.pageYOffset+24,"px"),t.style.left="".concat(m.left+window.pageXOffset,"px")}},[P.length,u,R,ce,E]);var De=function(){var o=u.selection;if(o&&r.e6.isCollapsed(o)){var m=r.e6.edges(o),ne=g()(m,1),N=ne[0],Z=r.ML.before(u,N),S=Z&&r.ML.range(u,Z,N),ue=S&&r.ML.string(u,S),xe=r.ML.after(u,N),be=r.ML.range(u,N,xe),Te=r.ML.string(u,be);C(S),me(""),ee(0);return}C(null)};return(0,s.jsxs)(i.mH,{editor:u,initialValue:J,onChange:function(o){d==null||d(o),C(null)},children:[(0,s.jsx)(i.CX,{renderElement:fe,renderLeaf:ve,onKeyDown:Me,className:"!outline-none",placeholder:c!=null?c:p.formatMessage({id:"workflow.placeholder.enterContent",defaultMessage:"\uFF0C@"})}),E&&(0,s.jsx)(H,{children:(0,s.jsx)("div",{ref:U,style:{top:"-9999px",left:"-9999px",position:"absolute",zIndex:10,padding:"3px",background:"white",borderRadius:"4px",boxShadow:"0 1px 5px rgba(0,0,0,.2)"},className:"px-1 pt-1 z-10","data-cy":"mentions-portal",children:P.length?P.map(function(t,o){return(0,s.jsx)("div",{onClick:function(){console.log(t),r.YR.select(u,E),h(u,t),C(null)},className:"hover:bg-blue-100 text-sm mb-1",style:{padding:"1px 3px",borderRadius:"3px",cursor:"pointer",background:o===R?"#B4D5FF":""},children:(0,s.jsx)("span",{children:t.name})},t.name+o)}):(0,s.jsx)(s.Fragment,{children:p.formatMessage({id:"workflow.message.noVariablesFound",defaultMessage:""})})})})]})},F=function(n){var a=n.isInline,d=n.isVoid,v=n.markableVoid;return n.isInline=function(c){return c.type==="mention"?!0:a(c)},n.isVoid=function(c){return c.type==="mention"?!0:d(c)},n.markableVoid=function(c){return c.type==="mention"||v(c)},n},h=function(n,a){var d={type:"mention",id:(a==null?void 0:a.id)||"",character:a.name,base:a,children:[{bold:!0,text:"11111"}]};r.YR.insertNodes(n,d),r.YR.move(n)},X=function(n){var a=n.attributes,d=n.children,v=n.leaf;return(0,s.jsx)("span",l()(l()({},a),{},{children:d}))},$=function(n){var a=n.attributes,d=n.children,v=n.element;switch(v.type){case"mention":return(0,s.jsx)(k,l()({},n));default:return(0,s.jsx)("p",l()(l()({},a),{},{children:d}))}},k=function(n){var a=n.attributes,d=n.children,v=n.element,c=(0,i.vt)(),_=(0,i.UE)(),p={padding:"3px 3px 2px",margin:"0 1px",verticalAlign:"baseline",display:"inline-block",borderRadius:"4px",backgroundColor:"#eee",fontSize:"0.9em",boxShadow:c&&_?"0 0 0 2px #B4D5FF":"none"};return v.children[0].bold&&(p.fontWeight="bold"),v.children[0].italic&&(p.fontStyle="italic"),(0,s.jsx)("span",l()(l()({},a),{},{className:"m-2",contentEditable:!1,"data-cy":"mention-".concat(v.character.replace(" ","-")),style:p,children:G?(0,s.jsxs)(f.Fragment,{children:["1",d,"/",v.character]}):(0,s.jsxs)(f.Fragment,{children:[(0,s.jsx)("span",{children:v.character}),d]})}))},J=[{type:"paragraph",children:[{text:""}]}];x.Z=Y},27842:function(I,x,e){"use strict";var b=e(5574),M=e.n(b),L=e(15009),l=e.n(L),j=e(99289),g=e.n(j),w=e(11551),y=e(29608),V=e(46944),T=e(35312),D=e(67294),z=e(4730),K=e(85893),f=null,ae=null;x.ZP=function(r){var W=r.agent_id,i=(0,T.useIntl)(),B=(0,T.useSearchParams)(),s=M()(B,1),H=s[0],G=(0,D.useRef)(null),Y=(0,D.useState)(null),F=M()(Y,2),h=F[0],X=F[1],$=(0,D.useState)(!1),k=M()($,2),J=k[0],O=k[1],n=H.get("app_id"),a=function(){O(!1)},d=function(p){X({app_id:n,app_run_id:p.id}),O(!0)},v=[{dataIndex:"index",valueType:"indexBorder",width:48},{disable:!0,title:i.formatMessage({id:"workflow.status",defaultMessage:""}),dataIndex:"status",ellipsis:!0,search:!1,valueEnum:{1:{text:i.formatMessage({id:"workflow.running",defaultMessage:""}),status:"Processing"},2:{text:i.formatMessage({id:"workflow.runSc",defaultMessage:""}),status:"Success"},3:{text:i.formatMessage({id:"workflow.runF",defaultMessage:""}),status:"Error"}}},{title:i.formatMessage({id:"workflow.created_time",defaultMessage:""}),dataIndex:"created_time",ellipsis:!0,tooltip:i.formatMessage({id:"workflow.created_time_des",defaultMessage:i.formatMessage({id:"workflow.created_time_des",defaultMessage:""})}),search:!1},{title:"".concat(i.formatMessage({id:"workflow.elapsed_time",defaultMessage:""}),"S"),dataIndex:"elapsed_time",ellipsis:!0,tooltip:i.formatMessage({id:"workflow.run_time"}),search:!1},{title:"Tokens",key:"showTime",dataIndex:"total_tokens",hideInSearch:!0},{title:i.formatMessage({id:"workflow.user"}),dataIndex:"nickname",search:!1,ellipsis:!0,key:"user"}],c=(0,y.Z)(function(_){return _.setRunPanelLogRecord});return(0,K.jsxs)("div",{className:"h-full",children:[(0,K.jsx)(V.Z,{columns:v,formRef:G,form:{submitter:!1},cardBordered:!0,style:{height:"calc(100% - 20px)"},scroll:{y:"calc(100vh - 230px)"},request:function(){var _=g()(l()().mark(function p(U,Q,q){var E;return l()().wrap(function(A){for(;;)switch(A.prev=A.next){case 0:return A.next=2,(0,w.My)(n,{page:U.current,page_size:U.pageSize});case 2:return E=A.sent,A.abrupt("return",{data:E.data.list,success:!0,total:E.data.total_count});case 4:case"end":return A.stop()}},p)}));return function(p,U,Q){return _.apply(this,arguments)}}(),onRow:function(p){return{onClick:function(){d(p)},className:(h==null?void 0:h.app_run_id)===p.id?"bg-blue-50":""}},editable:{type:"multiple"},rowKey:"app_runs_id",search:!1,options:{search:!1,setting:{listsHeight:600}},pagination:{pageSize:20,showSizeChanger:!1},dateFormatter:"string",headerTitle:i.formatMessage({id:"agent.log.list"})}),J&&(h==null?void 0:h.app_id)&&(h==null?void 0:h.app_run_id)&&(0,K.jsx)(z.Z,{data:h,onClose:a})]})}},49677:function(I){function x(e){if(e==null)throw new TypeError("Cannot destructure "+e)}I.exports=x,I.exports.__esModule=!0,I.exports.default=I.exports}}]);
