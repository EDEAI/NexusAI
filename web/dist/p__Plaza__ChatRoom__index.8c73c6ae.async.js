(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[57],{77171:function(ce,Q,t){"use strict";t.d(Q,{Z:function(){return V}});var L=t(1413),o=t(67294),X={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M862 465.3h-81c-4.6 0-9 2-12.1 5.5L550 723.1V160c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v563.1L255.1 470.8c-3-3.5-7.4-5.5-12.1-5.5h-81c-6.8 0-10.5 8.1-6 13.2L487.9 861a31.96 31.96 0 0048.3 0L868 478.5c4.5-5.2.8-13.2-6-13.2z"}}]},name:"arrow-down",theme:"outlined"},y=X,_=t(91146),d=function(a,D){return o.createElement(_.Z,(0,L.Z)((0,L.Z)({},a),{},{ref:D,icon:y}))},b=o.forwardRef(d),V=b},82826:function(ce,Q,t){"use strict";t.d(Q,{Z:function(){return V}});var L=t(1413),o=t(67294),X={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M872 474H286.9l350.2-304c5.6-4.9 2.2-14-5.2-14h-88.5c-3.9 0-7.6 1.4-10.5 3.9L155 487.8a31.96 31.96 0 000 48.3L535.1 866c1.5 1.3 3.3 2 5.2 2h91.5c7.4 0 10.8-9.2 5.2-14L286.9 550H872c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8z"}}]},name:"arrow-left",theme:"outlined"},y=X,_=t(91146),d=function(a,D){return o.createElement(_.Z,(0,L.Z)((0,L.Z)({},a),{},{ref:D,icon:y}))},b=o.forwardRef(d),V=b},52645:function(ce,Q,t){"use strict";t.d(Q,{Z:function(){return V}});var L=t(1413),o=t(67294),X={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M899.1 869.6l-53-305.6H864c14.4 0 26-11.6 26-26V346c0-14.4-11.6-26-26-26H618V138c0-14.4-11.6-26-26-26H432c-14.4 0-26 11.6-26 26v182H160c-14.4 0-26 11.6-26 26v192c0 14.4 11.6 26 26 26h17.9l-53 305.6a25.95 25.95 0 0025.6 30.4h723c1.5 0 3-.1 4.4-.4a25.88 25.88 0 0021.2-30zM204 390h272V182h72v208h272v104H204V390zm468 440V674c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v156H416V674c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v156H202.8l45.1-260H776l45.1 260H672z"}}]},name:"clear",theme:"outlined"},y=X,_=t(91146),d=function(a,D){return o.createElement(_.Z,(0,L.Z)((0,L.Z)({},a),{},{ref:D,icon:y}))},b=o.forwardRef(d),V=b},3471:function(ce,Q,t){"use strict";var L=t(1413),o=t(67294),X=t(29245),y=t(91146),_=function(V,ye){return o.createElement(y.Z,(0,L.Z)((0,L.Z)({},V),{},{ref:ye,icon:X.Z}))},d=o.forwardRef(_);Q.Z=d},41428:function(ce,Q,t){"use strict";t.d(Q,{Z:function(){return V}});var L=t(1413),o=t(67294),X={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M312.1 591.5c3.1 3.1 8.2 3.1 11.3 0l101.8-101.8 86.1 86.2c3.1 3.1 8.2 3.1 11.3 0l226.3-226.5c3.1-3.1 3.1-8.2 0-11.3l-36.8-36.8a8.03 8.03 0 00-11.3 0L517 485.3l-86.1-86.2a8.03 8.03 0 00-11.3 0L275.3 543.4a8.03 8.03 0 000 11.3l36.8 36.8z"}},{tag:"path",attrs:{d:"M904 160H548V96c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v64H120c-17.7 0-32 14.3-32 32v520c0 17.7 14.3 32 32 32h356.4v32L311.6 884.1a7.92 7.92 0 00-2.3 11l30.3 47.2v.1c2.4 3.7 7.4 4.7 11.1 2.3L512 838.9l161.3 105.8c3.7 2.4 8.7 1.4 11.1-2.3v-.1l30.3-47.2a8 8 0 00-2.3-11L548 776.3V744h356c17.7 0 32-14.3 32-32V192c0-17.7-14.3-32-32-32zm-40 512H160V232h704v440z"}}]},name:"fund-projection-screen",theme:"outlined"},y=X,_=t(91146),d=function(a,D){return o.createElement(_.Z,(0,L.Z)((0,L.Z)({},a),{},{ref:D,icon:y}))},b=o.forwardRef(d),V=b},30159:function(ce,Q,t){"use strict";t.d(Q,{Z:function(){return V}});var L=t(1413),o=t(67294),X={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372zm-88-532h-48c-4.4 0-8 3.6-8 8v304c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V360c0-4.4-3.6-8-8-8zm224 0h-48c-4.4 0-8 3.6-8 8v304c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V360c0-4.4-3.6-8-8-8z"}}]},name:"pause-circle",theme:"outlined"},y=X,_=t(91146),d=function(a,D){return o.createElement(_.Z,(0,L.Z)((0,L.Z)({},a),{},{ref:D,icon:y}))},b=o.forwardRef(d),V=b},88484:function(ce,Q,t){"use strict";t.d(Q,{Z:function(){return V}});var L=t(1413),o=t(67294),X={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M400 317.7h73.9V656c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V317.7H624c6.7 0 10.4-7.7 6.3-12.9L518.3 163a8 8 0 00-12.6 0l-112 141.7c-4.1 5.3-.4 13 6.3 13zM878 626h-60c-4.4 0-8 3.6-8 8v154H214V634c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v198c0 17.7 14.3 32 32 32h684c17.7 0 32-14.3 32-32V634c0-4.4-3.6-8-8-8z"}}]},name:"upload",theme:"outlined"},y=X,_=t(91146),d=function(a,D){return o.createElement(_.Z,(0,L.Z)((0,L.Z)({},a),{},{ref:D,icon:y}))},b=o.forwardRef(d),V=b},88872:function(ce,Q,t){"use strict";t.r(Q),t.d(Q,{default:function(){return _t}});var L=t(15009),o=t.n(L),X=t(99289),y=t.n(X),_=t(5574),d=t.n(_),b=t(43722),V=t(32983),ye=t(55026),a=t(67294),D=t(35312),Qe=t(19632),Re=t.n(Qe),Xe=t(97857),z=t.n(Xe),Be=t(80459),_e=t(82114),qe=t(82826),et=t(63783),tt=t(3471),at=t(45360),nt=t(85576),Ie=t(28036),rt=t(83062),Te=t(72269),Oe=t(74330),st=t(96486),Ve=t(44010),fe=t(39e3),e=t(85893),it=function(u){var f=(0,D.useIntl)(),A=u.roomDetail,E=u.setAgent,R=at.ZP.useMessage(),c=d()(R,2),Z=c[0],F=c[1],P=(0,D.useParams)(),w=P.id,x=(0,fe.Z)(function(s){return s.disableInput}),U=(0,fe.Z)(function(s){return s.truncatable}),$=(0,fe.Z)(function(s){return s.setClearMemory}),W=(0,a.useState)([]),ee=d()(W,2),G=ee[0],te=ee[1],k=(0,a.useState)(z()({},A)),C=d()(k,2),B=C[0],ae=C[1],ne=(0,a.useState)([]),re=d()(ne,2),T=re[0],I=re[1],K=(0,a.useRef)(!1),pe=(0,a.useRef)(!1),ve=(0,a.useState)(!1),se=d()(ve,2),J=se[0],ie=se[1],me=function(){var i=nt.Z.confirm;i({title:f.formatMessage({id:"app.chatroom.clear.title"}),icon:(0,e.jsx)(_e.Z,{}),content:f.formatMessage({id:"app.chatroom.clear.tips"}),okText:f.formatMessage({id:"app.chatroom.clear.confirm"}),okType:"danger",cancelText:f.formatMessage({id:"app.chatroom.clear.cancel"}),onOk:function(){$(["TRUNCATE","0"])}})},N=function(){var s=y()(o()().mark(function i(){var n;return o()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(!w){l.next=5;break}return l.next=3,(0,b.cH)({id:w});case 3:if(n=l.sent,n.code==0)try{ae(function(){return z()(z()({},n.data.chat_info),{},{max_round:n.data.max_round,smart_selection:n.data.smart_selection})}),te(n.data.agent_list),K.current=!0}catch(m){}case 5:case"end":return l.stop()}},i)}));return function(){return s.apply(this,arguments)}}(),ue=function(){var s=y()(o()().mark(function i(){var n;return o()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,(0,b.j2)({id:w});case 2:n=l.sent,n.code==0&&(I(n.data.list),pe.current=!0);case 4:case"end":return l.stop()}},i)}));return function(){return s.apply(this,arguments)}}(),de=function(){var s=y()(o()().mark(function i(n){var r,l,m;return o()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:if(!w){p.next=11;break}if(r=n.active==1?0:1,r!=0){p.next=7;break}if(l=G.filter(function(g){return g.active==1}),l.length-1!=0){p.next=7;break}return Z.open({type:"error",content:f.formatMessage({id:"app.chatroom.sidebar.agent_tips"}),duration:2}),p.abrupt("return",!1);case 7:return p.next=9,(0,b.sT)({active:r},w,n.agent_id);case 9:m=p.sent,m.code==0&&te(function(g){return g.map(function(O){return z()(z()({},O),{},{active:O.agent_id==n.agent_id?r:O.active})})});case 11:case"end":return p.stop()}},i)}));return function(n){return s.apply(this,arguments)}}(),he=function(i){return i.length>6?i.length=6:i.lenth,i},xe=function(i){i.type=="my_agent"?D.history.push("/Agents?app_id=".concat(i.app_id,"&type=false&from=chat_room")):D.history.push("/ReadOnlyAgent?app_id=".concat(i.app_id,"&type=true&from=chat_room"))},H=function(i){D.history.replace("/chat_room/".concat(i.chatroom_id)),window.location.reload()},j=function(){ie(!0)},S=function(){ie(!1)},M=function(){var s=y()(o()().mark(function i(n){var r,l,m;return o()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:if(!(n.checkItem&&n.checkItem.length==0)){p.next=3;break}return Z.open({type:"error",content:f.formatMessage({id:"app.chatroom.content.addAgentTips_fail"}),duration:2}),p.abrupt("return");case 3:return r=Re()(n.checkItem).map(function(g){var O=g.agent_id,je=g.active,Y=je===void 0?1:je;return{agent_id:O,active:Y}}),l={description:B.description,name:B.name,max_round:B.max_round},p.next=7,(0,b.sI)(z()(z()({},l),{},{agent:r}),w);case 7:m=p.sent,m.code==0?(n.checkItem.map(function(g){g.active=g.active==null?1:g.active}),te(Re()(n.checkItem)),E.current=Re()(n.checkItem),Z.open({type:"success",content:f.formatMessage({id:"app.chatroom.content.addAgentTips"}),duration:2})):Z.open({type:"error",content:f.formatMessage({id:"app.chatroom.content.addAgentTips_fail"}),duration:2});case 9:case"end":return p.stop()}},i)}));return function(n){return s.apply(this,arguments)}}(),v=function(){var s=y()(o()().mark(function i(){var n;return o()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return n=B.smart_selection==1?0:1,l.next=3,(0,b.r5)({smart_selection:n},w);case 3:ae(function(m){return z()(z()({},m),{},{smart_selection:n})});case 4:case"end":return l.stop()}},i)}));return function(){return s.apply(this,arguments)}}();return(0,a.useEffect)(function(){N(),ue()},[]),(0,e.jsxs)(e.Fragment,{children:[F,(0,e.jsxs)("div",{className:"h-full w-[320px] bg-[#fff] shrink-0",style:{boxShadow:"0px 2px 4px 0px rgba(0,0,0,0.1)"},id:"sider",children:[(0,e.jsxs)("div",{className:"flex flex-col  h-full",children:[(0,e.jsx)("div",{className:"w-full flex  justify-start px-[30px]",children:(0,e.jsxs)("div",{className:"py-[20px] text-[14px] text-[#213044] font-[500] flex gap-x-[10px] items-center w-full",children:[(0,e.jsxs)("div",{className:"cursor-pointer flex items-center shrink-0",onClick:function(){D.history.go(-1)},children:[(0,e.jsx)(Ie.ZP,{type:"link",danger:!0,className:"p-0",children:(0,e.jsx)(qe.Z,{className:"text-[#1B64F3] w-[16px] h-[16px]"})}),(0,e.jsx)("span",{className:"ml-[5px] text-[#213044] text-sm",children:f.formatMessage({id:"app.chatroom.sidebar.return"})})]}),(0,e.jsx)("div",{className:"h-full flex items-center shrink-0",children:(0,e.jsx)("div",{className:"w-[1px] h-[13px] bg-[#ebebeb]"})}),(0,e.jsx)("div",{className:"flex-1 min-w-0 truncate",children:B.name})]})}),(0,e.jsx)("div",{className:"h-[360px]",children:(0,e.jsxs)("div",{className:"pb-[20px] border-b-[1px] px-[10px]",children:[(0,e.jsxs)("div",{className:"flex items-center cursor-pointer px-[20px]",children:[(0,e.jsx)("div",{className:"flex gap-x-[5px] flex-1",children:(0,e.jsx)("span",{className:"text-[#666] text-[14px]",children:f.formatMessage({id:"app.chatroom.sidebar.agent_title"})})}),(0,e.jsxs)("div",{className:"shrink-0 flex items-center",children:[(0,e.jsx)(rt.Z,{className:"pr-[2px]",overlayStyle:{fontSize:"12px"},title:f.formatMessage({id:"app.chatroom.sidebar.chatroom_switch_tips"}),children:(0,e.jsx)(et.Z,{className:"cursor-pointer text-[#666] text-[12px]"})}),(0,e.jsx)("span",{className:"text-[12px] text-[#666] pr-[5px]",children:f.formatHTMLMessage({id:"app.chatroom_list.switch"})}),(0,e.jsx)(Te.Z,{size:"small",defaultChecked:!0,className:"w-[28px]",checked:B.smart_selection==1,onChange:v,disabled:x})]})]}),(0,e.jsx)("div",{className:"py-[20px] pt-[10px]",children:(0,e.jsx)("div",{className:"h-[220px] overflow-y-auto px-[10px]",children:K.current?(0,e.jsx)("div",{className:"flex flex-col",children:G&&G.length>0?G.map(function(s){return(0,e.jsxs)("div",{className:"flex items-center gap-x-[5px] hover:bg-[#FAFAFA] transition p-[10px] slider_agent_box",children:[(0,e.jsxs)("div",{className:"flex gap-x-[15px] flex-1 min-w-[0]",children:[(0,e.jsx)(Be.Z,{data:s}),(0,e.jsxs)("div",{className:"flex flex-col gap-y-[5px] justify-center flex-1 min-w-[0]",children:[(0,e.jsx)("span",{className:"text-[#213044] text-[12px] font-[500] truncate w-full",children:s.name}),(0,e.jsx)("span",{className:"text-[#999999] text-[12px] truncate",children:s.description})]})]}),(0,e.jsxs)("div",{className:"shrink-0 flex gap-x-[15px] items-center",children:[(0,e.jsx)("div",{className:"edit cursor-pointer w-[20px] h-[20px] flex justify-center items-center opacity-0 transition",onClick:function(){xe(s)},children:(0,e.jsx)("img",{className:"w-[16px] h-[16px]",src:"/icons/edit_icon_1.svg"})}),(0,e.jsx)(Te.Z,{size:"small",disabled:x,defaultChecked:!0,className:"w-[28px]",checked:s.active==1,onChange:function(){de(s)}})]})]},s.agent_id)}):(0,e.jsx)("div",{className:"w-full min-h-[220px] flex items-center justify-center",children:(0,e.jsx)(V.Z,{image:V.Z.PRESENTED_IMAGE_SIMPLE})})}):(0,e.jsx)("div",{className:"flex justify-center w-full h-full items-center",children:(0,e.jsx)(Oe.Z,{})})})}),(0,e.jsx)("div",{className:"px-[20px] ",children:(0,e.jsx)("div",{style:{border:"1px solid #1B64F3"},onClick:j,className:"w-full h-[30px] transition text-[#1B64F3] flex items-center justify-center cursor-pointer rounded-[6px] hover:text-[#fff] hover:bg-[#1B64F3]",children:(0,e.jsx)("span",{className:"text-[12px]",children:f.formatMessage({id:"app.chatroom.add.agent"})})})}),(0,e.jsx)("div",{className:"px-[20px] pt-[15px]",children:(0,e.jsx)("div",{style:U&&!x?{border:"1px solid #1B64F3"}:{background:"#d9d9d9",color:"rgba(0,0,0,0.25)",cursor:"not-allowed"},onClick:(0,st.throttle)(function(){U&&!x&&me()}),className:"w-full h-[30px] transition text-[#1B64F3] flex items-center justify-center cursor-pointer rounded-[6px] hover:text-[#fff] hover:bg-[#1B64F3]",children:(0,e.jsx)("span",{className:"text-[12px]",children:f.formatMessage({id:"app.chatroom.sidebar.agent_button"})})})})]})}),(0,e.jsxs)("div",{className:"flex-1 min-h-[0] flex flex-col",children:[(0,e.jsx)("div",{className:"pt-[30px] px-[30px] text-[#666] text-[14px] shrink-0",children:f.formatMessage({id:"app.chatroom.sidebar.othe_title"})}),(0,e.jsx)("div",{className:"px-[10px] flex-1 min-h-[0] py-[10px]",children:(0,e.jsx)("div",{style:{height:"calc(100% - 20px)"},className:"px-[10px]  overflow-y-auto",children:pe.current?(0,e.jsx)("div",{className:"h-full flex flex-col",children:T&&T.length>0?T.map(function(s){return(0,e.jsxs)("div",{className:"w-full transition hover:bg-[#FAFAFA] p-[10px] cursor-pointer",onClick:function(){H(s)},children:[(0,e.jsxs)("div",{className:"flex pb-[10px]",children:[(0,e.jsx)("div",{className:"flex-1 min-w-[0] truncate text-[#333] text-[14px]",children:s.name}),s.active==0?(0,e.jsxs)("div",{className:"flex items-center gap-x-[6px]",children:[(0,e.jsx)("img",{className:"w-[12px] h-[12px]",src:"/icons/plaza_m2_c2.svg",alt:""}),(0,e.jsx)("span",{className:"text-[12px] text-[#aaa]",children:f.formatMessage({id:"app.chatroom.sidebar.othe_status"})})]}):(0,e.jsxs)("div",{className:"flex items-center gap-x-[6px]",children:[(0,e.jsx)("img",{className:"w-[12px] h-[12px]",src:"/icons/plaza_m2_c1.svg",alt:""}),(0,e.jsx)("span",{className:"text-[12px] text-[#aaa]",children:f.formatMessage({id:"app.chatroom.sidebar.othe_status_succeed"})})]})]}),(0,e.jsx)("div",{className:"flex gap-x-[10px]",children:s.agent_list&&s.agent_list.length>0?(0,e.jsxs)(e.Fragment,{children:[he(s.agent_list).map(function(i,n){return(0,e.jsx)("div",{className:"flex",children:(0,e.jsx)(Be.Z,{data:i,width:"30px"})},n)}),s.agent_list.length>=6?(0,e.jsx)(tt.Z,{}):(0,e.jsx)(e.Fragment,{})]}):(0,e.jsx)(e.Fragment,{})})]},s.chatroom_id)}):(0,e.jsx)("div",{className:"w-full h-full",children:(0,e.jsx)(V.Z,{image:V.Z.PRESENTED_IMAGE_SIMPLE})})}):(0,e.jsx)("div",{className:"flex justify-center w-full h-full items-center",children:(0,e.jsx)(Oe.Z,{})})})})]})]}),(0,e.jsx)(Ve.Z,{show:J,popupClose:S,popupSave:M,checkList:G,zIndex:99})]})]})},lt=(0,a.memo)(it),ot=t(94813),ct=t(39873),we=t(1413),ut={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM142.4 642.1L298.7 519a8.84 8.84 0 000-13.9L142.4 381.9c-5.8-4.6-14.4-.5-14.4 6.9v246.3a8.9 8.9 0 0014.4 7z"}}]},name:"menu-unfold",theme:"outlined"},dt=ut,ke=t(91146),ft=function(u,f){return a.createElement(ke.Z,(0,we.Z)((0,we.Z)({},u),{},{ref:f,icon:dt}))},pt=a.forwardRef(ft),vt=pt,mt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 000 13.8z"}}]},name:"menu-fold",theme:"outlined"},ht=mt,xt=function(u,f){return a.createElement(ke.Z,(0,we.Z)((0,we.Z)({},u),{},{ref:f,icon:ht}))},gt=a.forwardRef(xt),jt=gt,St=t(83159),yt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M464 144H160c-8.8 0-16 7.2-16 16v304c0 8.8 7.2 16 16 16h304c8.8 0 16-7.2 16-16V160c0-8.8-7.2-16-16-16zm-52 268H212V212h200v200zm452-268H560c-8.8 0-16 7.2-16 16v304c0 8.8 7.2 16 16 16h304c8.8 0 16-7.2 16-16V160c0-8.8-7.2-16-16-16zm-52 268H612V212h200v200zm52 132H560c-8.8 0-16 7.2-16 16v304c0 8.8 7.2 16 16 16h304c8.8 0 16-7.2 16-16V560c0-8.8-7.2-16-16-16zm-52 268H612V612h200v200zM424 712H296V584c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v128H104c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h128v128c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V776h128c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8z"}}]},name:"appstore-add",theme:"outlined"},wt=yt,Nt=function(u,f){return a.createElement(ke.Z,(0,we.Z)((0,we.Z)({},u),{},{ref:f,icon:wt}))},Rt=a.forwardRef(Nt),Mt=Rt,be=t(86),Ue=t(34994),We=t(2216),At=t(85877),Ct=t(29432),It=t(39944),Ot=t(11551),De=t(55927),Ee=t(22683),Le=t(97807),Zt=function(u){var f,A,E,R,c=u.selectApp,Z=u.runid,F=u.setBoxLoading,P=u.setinputShow,w=u.appId,x=u.id,U=u.setisRun,$=(0,D.useIntl)(),W=(0,a.useRef)(""),ee=(0,a.useRef)(""),G=(0,a.useRef)(null),te=(0,a.useState)(""),k=d()(te,2),C=k[0],B=k[1],ae=(0,a.useState)(null),ne=d()(ae,2),re=ne[0],T=ne[1],I=(0,a.useState)([]),K=d()(I,2),pe=K[0],ve=K[1],se=(0,a.useState)(""),J=d()(se,2),ie=J[0],me=J[1],N=(0,De.Z)(function(H){return H.flowMessage}),ue=function(j){ee.current=de(j);var S={user:{value:de(j)}};me(new It.z(S))},de=function H(j){return j.map(function(S){return S.type==="mention"?S.id:S.children?H(S.children):S.text}).join("")},he=function(){var H=y()(o()().mark(function j(S){var M,v;return o()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return F(!0),M=Object.keys(S),M.forEach(function(n){G.current.properties[n]&&(G.current.properties[n].value=S[n])}),i.next=5,(0,Ot.LH)({agent_id:c.checkItem[0].agent_id,ability_id:0,input_dict:G.current,prompt:ie,data_source_run_id:W.current});case 5:v=i.sent,v.code==0&&(B(v.data.outputs_md),F(!1),U(!1));case 7:case"end":return i.stop()}},j)}));return function(S){return H.apply(this,arguments)}}(),xe=function(){var H=y()(o()().mark(function j(S,M){var v,s;return o()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,b.xT)(S,M);case 2:v=n.sent,(v==null?void 0:v.code)==0&&(W.current=v==null||(s=v.data)===null||s===void 0?void 0:s.app_run_id);case 4:case"end":return n.stop()}},j)}));return function(S,M){return H.apply(this,arguments)}}();return(0,a.useEffect)(function(){c&&c.checkItem.length&&(U(!0),xe(x,{app_id:w,app_run_id:Z,status:1,corrected_parameter:""}))},[c]),(0,a.useEffect)(function(){var H=N.filter(function(i){return i.data.app_run_id==Z&&i.type.indexOf("generate_meeting_action_items")!==-1});if(H.length!=0){var j,S=(j=H[H.length-1])===null||j===void 0||(j=j.data)===null||j===void 0||(j=j.exec_data)===null||j===void 0||(j=j.outputs)===null||j===void 0?void 0:j.value;if(S){var M=JSON.parse(S);G.current=M;var v=Object.keys(M.properties);if(v.length){T(M.properties);var s=v.map(function(i){return{value:"<<".concat(Ct.qX,".inputs.").concat(i,">>"),label:i}});ve(s)}P(!1),F(!1)}}},[N]),console.log(c),(0,e.jsxs)("div",{children:[(0,e.jsx)("div",{className:"py-[6px]",children:(0,e.jsx)(be.Z,{icon:c==null||(f=c.checkItem[0])===null||f===void 0?void 0:f.icon,title:c==null||(A=c.checkItem[0])===null||A===void 0?void 0:A.name,textDetails:c==null||(E=c.checkItem[0])===null||E===void 0?void 0:E.description,iconType:"robot_icon",avatar:c==null||(R=c.checkItem[0])===null||R===void 0?void 0:R.avatar,handleClick:function(){}})}),re!=null?(0,e.jsxs)(Ue.A,{submitter:{resetButtonProps:!1,submitButtonProps:{className:"w-full",disabled:!ee.current},searchConfig:{submitText:$.formatMessage({id:"workflow.button.run"})}},onFinish:function(j){he(j)},children:[(0,e.jsx)("div",{className:"py-[6px]",children:(0,e.jsx)(We._,{data:re})}),(0,e.jsx)("div",{className:"h-[150px] overflow-y-auto border border-color-[#eee] py-[4px] px-[11px] mb-[8px]",children:(0,e.jsx)(At.Z,{onChange:function(j){ue(j)},options:pe,placeholder:"\u8BF7\u8F93\u5165\u8FD0\u884C\u6307\u4EE4\uFF0C\u8F93\u5165@\u63D2\u5165\u53D8\u91CF"})})]}):(0,e.jsx)(e.Fragment,{}),C?(0,e.jsx)("div",{className:"max-h-[400px] overflow-y-auto mt-[16px]",children:(0,e.jsx)("div",{className:"p-[12px]  bg-[#F7F7F7] leading-[22px]",children:(0,e.jsx)(Ee.U,{rehypePlugins:[Le.Z],children:C})})}):(0,e.jsx)(e.Fragment,{})]})},Ft=(0,a.memo)(Zt),kt=t(66309),Ge=t(42237),bt=t(93696),Dt=function(u,f){return a.createElement(ke.Z,(0,we.Z)((0,we.Z)({},u),{},{ref:f,icon:bt.Z}))},Et=a.forwardRef(Dt),Lt=Et,Pt=t(4981),Ke=t(29608),Ht=(0,a.memo)(function(q){var u=q.progressObj,f=function(){return parseFloat(u.elapsed_time).toFixed(6)},A=function(R){var c=new Date(R),Z=c.getFullYear(),F=(c.getMonth()+1).toString().padStart(2,"0"),P=c.getDate().toString().padStart(2,"0"),w=c.getHours().toString().padStart(2,"0"),x=c.getMinutes().toString().padStart(2,"0"),U=c.getSeconds().toString().padStart(2,"0");return(0,e.jsx)(e.Fragment,{children:"".concat(Z,".").concat(F,".").concat(P," ").concat(w,":").concat(x,":").concat(U)})};return(0,e.jsx)("div",{className:"inline-flex gap-x-4 justify-end max-w-[100%]",children:(0,e.jsxs)("div",{className:"inline-flex gap-x-[20px] max-w-[100%]",children:[(0,e.jsx)("div",{className:"truncate min-w-[70px]",children:u.created_time&&A(u.created_time)}),(0,e.jsx)("div",{className:"truncate",children:u.apps_name||u.app_name}),(0,e.jsxs)("div",{className:"flex items-center gap-x-[7px] truncate min-w-[50px]",children:[(0,e.jsx)("div",{className:"shrink-0 rounded-full ".concat(u.status==1?"bg-blue-600":u.status==2?"bg-green-500":"bg-red-500"),style:{width:"3px",height:"3px"}}),(0,e.jsxs)("div",{className:"truncate",children:[f(),"S"]})]})]})})}),$t=function(u){var f,A,E,R,c=u.selectApp,Z=u.runid,F=u.setBoxLoading,P=u.setinputShow,w=u.appId,x=u.id,U=u.setisRun,$=(0,D.useIntl)(),W=(0,a.useRef)(""),ee=(0,a.useRef)(null),G=(0,a.useState)(null),te=d()(G,2),k=te[0],C=te[1],B=(0,a.useState)(!1),ae=d()(B,2),ne=ae[0],re=ae[1],T=(0,a.useState)(null),I=d()(T,2),K=I[0],pe=I[1],ve=(0,a.useState)(null),se=d()(ve,2),J=se[0],ie=se[1],me=(0,a.useState)(null),N=d()(me,2),ue=N[0],de=N[1],he=(0,Ke.Z)(function(n){return n.setDealtWithData}),xe=(0,Ke.Z)(function(n){return n.setRunPanelLogRecord}),H=function(){var n=y()(o()().mark(function r(l){var m,h,p,g,O;return o()().wrap(function(Y){for(;;)switch(Y.prev=Y.next){case 0:return F(!0),m=Object.keys(l),h={},m.forEach(function(ge){ee.current.properties[ge]&&(ee.current.properties[ge].value=l[ge]),J&&J.forEach(function(Me){Me.node_id==ge&&(h[ge]=l[ge])})}),p={inputs:ee.current,node_confirm_users:h,run_name:"chatroom-".concat(x,"-run-").concat(W.current,"-driven"),run_type:1,data_source_run_id:W.current},Y.next=7,(0,Ge.UE)(w,p);case 7:g=Y.sent,g.code==0&&(W.current=g==null||(O=g.data)===null||O===void 0?void 0:O.app_run_id,re(!0),U(!1));case 9:case"end":return Y.stop()}},r)}));return function(l){return n.apply(this,arguments)}}(),j=function(){var n=y()(o()().mark(function r(){var l,m;return o()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:l=i==null?void 0:i.filter(function(g){return g.type=="workflow_run_progress"&&g.data.app_run_id==W.current}).map(function(g){var O=g.data;return O}),l&&l.length&&(m=l[l.length-1],C(m),F(!1));case 2:case"end":return p.stop()}},r)}));return function(){return n.apply(this,arguments)}}(),S=function(){var n=y()(o()().mark(function r(){var l,m,h,p,g;return o()().wrap(function(je){for(;;)switch(je.prev=je.next){case 0:m=i==null?void 0:i.filter(function(Y){return Y.type=="workflow_need_human_confirm"&&Y.data.app_run_id==W.current}),h=(l=m.map(function(Y){var ge=Y.data,Me=Y.need_human_confirm;return{data:ge,need_human_confirm:Me}}))===null||l===void 0?void 0:l.filter(function(Y){return Y.data.type!==1}),h&&h.length&&(g=h[h.length-1].data,g.exec_id=g==null||(p=g.node_exec_data)===null||p===void 0?void 0:p.node_exec_id,de(h[h.length-1]),F(!1));case 3:case"end":return je.stop()}},r)}));return function(){return n.apply(this,arguments)}}(),M=function(r){return r.completed_progress?parseInt(r.completed_progress.slice(0,-1)):!1},v=function(){var n=y()(o()().mark(function r(l,m){var h,p;return o()().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:return O.next=2,(0,b.xT)(l,m);case 2:h=O.sent,(h==null?void 0:h.code)==0&&(W.current=h==null||(p=h.data)===null||p===void 0?void 0:p.app_run_id);case 4:case"end":return O.stop()}},r)}));return function(l,m){return n.apply(this,arguments)}}(),s=function(){var n=y()(o()().mark(function r(){var l,m;return o()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return console.log(w),p.next=3,(0,Ge.zO)(w);case 3:l=p.sent,l.code==0&&ie(l==null||(m=l.data)===null||m===void 0?void 0:m.need_confirm_nodes),v(x,{app_id:w,app_run_id:Z,status:1,corrected_parameter:""});case 6:case"end":return p.stop()}},r)}));return function(){return n.apply(this,arguments)}}();(0,a.useEffect)(function(){c&&c.checkItem.length&&(U(!0),s())},[c]);var i=(0,De.Z)(function(n){return n.flowMessage});return(0,a.useEffect)(function(){j(),S();var n=i.filter(function(p){return p.data.app_run_id==Z&&p.type.indexOf("generate_meeting_action_items")!==-1});if(n.length!=0){var r,l=(r=n[n.length-1])===null||r===void 0||(r=r.data)===null||r===void 0||(r=r.exec_data)===null||r===void 0||(r=r.outputs)===null||r===void 0?void 0:r.value;if(l){var m=JSON.parse(l);ee.current=m;var h=Object.keys(m.properties);h.length&&(console.log(m.properties),pe(m.properties)),P(!1),F(!1)}}},[i]),(0,e.jsxs)("div",{children:[(0,e.jsx)("div",{className:"py-[6px]",children:(0,e.jsx)(be.Z,{icon:c==null||(f=c.checkItem[0])===null||f===void 0?void 0:f.icon,title:c==null||(A=c.checkItem[0])===null||A===void 0?void 0:A.name,textDetails:c==null||(E=c.checkItem[0])===null||E===void 0?void 0:E.description,iconType:"workflow_icon",avatar:c==null||(R=c.checkItem[0])===null||R===void 0?void 0:R.avatar,handleClick:function(){}})}),!ne&&K!=null?(0,e.jsxs)(Ue.A,{submitter:{resetButtonProps:!1,submitButtonProps:{className:"w-full"},searchConfig:{submitText:$.formatMessage({id:"workflow.button.run"})}},onFinish:H,children:[(0,e.jsx)("div",{className:"py-[6px]",children:(0,e.jsx)(We._,{data:K})}),(0,e.jsx)(Pt.e,{data:J})]}):(0,e.jsx)(e.Fragment,{children:K!=null?(0,e.jsxs)("div",{children:[(0,e.jsxs)("div",{className:"text-[16px] color-[#000] font-[600] py-[12px]",children:[$.formatMessage({id:"app.summaryhistory.input"}),":"]}),Object.values(K).map(function(n){return(0,e.jsxs)("div",{className:"pb-[10px]",children:[(0,e.jsx)("div",{className:"pb-[8px] font-[600]",children:n.display_name||n.name}),(0,e.jsx)("div",{className:"py-[4px] px-[11px] text-[14px] leading-[1.5] ",children:n.value})]})})]}):(0,e.jsx)(e.Fragment,{})}),ue&&ue.need_human_confirm!=0?(0,e.jsx)("div",{className:"pt-[12px]",children:(0,e.jsxs)("div",{className:"flex gap-x-[6px] items-center h-[20px] cursor-pointer",onClick:function(){he(ue.data)},children:[(0,e.jsx)("div",{children:(0,e.jsx)(Lt,{className:"text-[#1B64F3] text-[16px]"})}),(0,e.jsx)("span",{children:$.formatMessage({id:"app.summary.backlogTips"})})]})}):(0,e.jsx)(e.Fragment,{}),k?(0,e.jsx)("div",{className:"pt-[10px]",children:(0,e.jsx)(be.Z,{status:k.status,icon:k.icon,title:(0,e.jsxs)("div",{className:"items-center gap-x-[8px] inline-flex justify-end w-full",children:[(0,e.jsx)("span",{className:"flex-1 truncate",children:k.run_name}),k.need_human_confirm==1?(0,e.jsx)(kt.Z,{className:" text-[12px] flex items-center justify-center margin-0",color:"blue",children:$.formatMessage({id:"app.summaryhistory.tag"})}):(0,e.jsx)(e.Fragment,{})]}),textDetails:(0,e.jsx)(Ht,{progressObj:k}),handleClick:function(){xe(k)},progress:M(k)})}):(0,e.jsx)(e.Fragment,{})]})},zt=(0,a.memo)($t),Bt=function(u){var f,A,E,R=(0,D.useIntl)(),c=u.runid,Z=u.id,F=u.setBoxLoading,P=u.scrollDom,w=u.setinputShow,x=(0,a.useRef)("agent"),U=(0,a.useRef)(""),$=(0,a.useState)(!1),W=d()($,2),ee=W[0],G=W[1],te=(0,a.useState)({type:"agent",checkItem:[],show:!1}),k=d()(te,2),C=k[0],B=k[1],ae=[{key:"1",label:(0,e.jsx)("div",{className:"hover:text-[#1B64F3]",onClick:function(){B(function(I){return z()(z()({},I),{},{type:"agent",show:!0})})},children:R.formatMessage({id:"app.summary.SelectAgent"})})},{key:"2",label:(0,e.jsx)("div",{className:"hover:text-[#1B64F3]",onClick:function(){B(function(I){return z()(z()({},I),{},{type:"workflow",show:!0})})},children:R.formatMessage({id:"app.summary.SelectWorkflow"})})}],ne=function(){B(function(I){return z()(z()({},I),{},{show:!1})})},re=function(I){F(!0),B(function(K){return z()(z()({},K),{},{checkItem:I.checkItem})}),x.current=C.type,U.current=I.checkItem[0].app_id};return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)("div",{className:"pt-[24px]  border-[#ddd]",style:{minHeight:C!=null&&(f=C.checkItem)!==null&&f!==void 0&&f.length?P==null||(A=P.current)===null||A===void 0?void 0:A.offsetHeight:"100%"},children:[(0,e.jsxs)("div",{className:"text-[14px] font-[500] flex item-center",children:[(0,e.jsx)("div",{className:"flex-1",children:R.formatMessage({id:"app.summary.Runapp"})}),(0,e.jsx)("div",{className:"px-[10px]",children:ee?(0,e.jsx)(St.Z,{menu:{items:ae},children:(0,e.jsx)(Mt,{className:"transition cursor-pointer text-[#999] text-[18px] hover:text-[#1B64F3]"})}):(0,e.jsx)(e.Fragment,{})})]}),(0,e.jsx)("div",{children:C!=null&&(E=C.checkItem)!==null&&E!==void 0&&E.length?(0,e.jsx)(e.Fragment,{children:x.current=="agent"?(0,e.jsx)(Ft,{id:Z,appId:U.current,selectApp:C,runid:c,setBoxLoading:F,scrollDom:P,setinputShow:w,setisRun:G}):(0,e.jsx)(zt,{id:Z,appId:U.current,selectApp:C,runid:c,setBoxLoading:F,scrollDom:P,setinputShow:w,setisRun:G})}):(0,e.jsxs)("div",{className:"flex gap-x-[20px] min-h-[70px] items-center px-[20px]",children:[(0,e.jsxs)(Ie.ZP,{className:"flex-1 text-[14px]",onClick:function(){B(function(I){return z()(z()({},I),{},{type:"agent",show:!0})})},children:[(0,e.jsx)("img",{src:"/icons/robot_icon.svg",alt:"",className:"w-[14px] h-[14px]"}),R.formatMessage({id:"app.summary.SelectAgent"})]}),(0,e.jsxs)(Ie.ZP,{className:"flex-1 text-[14px]",onClick:function(){B(function(I){return z()(z()({},I),{},{type:"workflow",show:!0})})},children:[(0,e.jsx)("img",{src:"/icons/workflow_icon.svg",alt:"",className:"w-[14px] h-[14px]"}),R.formatMessage({id:"app.summary.SelectWorkflow"})]})]})})]}),(0,e.jsx)(Ve.Z,{show:C.show,nodetype:C.type,popupClose:ne,popupSave:re,checkList:x.current==C.type?C.checkItem:[],zIndex:99,radio:!0})]})},Tt=(0,a.memo)(Bt),Vt=t(26915),Ut=t(87740),Je=(0,a.memo)(function(q){var u=q.id,f=q.message,A=(0,D.useIntl)(),E=(0,fe.Z)(function(x){return x.setSummaryClick}),R=(0,a.useState)(!0),c=d()(R,2),Z=c[0],F=c[1],P=(0,fe.Z)(function(x){return x.summaryClick}),w=(0,fe.Z)(function(x){return x.setSummaryParams});return(0,a.useEffect)(function(){F(P)},[P]),(0,e.jsx)("div",{className:"flex flex-row-reverse",children:(0,e.jsxs)(Ie.ZP,{type:"primary",className:"bg-[#1B64F3] rounded-[4px] my-3 h-[30px] w-[110px] gap-[6px]",onClick:function(U){Z&&(w({id:u,message:f}),E(!1))},children:[(0,e.jsx)("span",{className:"text-[12px]",children:A.formatMessage({id:"app.summaryhistory.submitText"})}),(0,e.jsx)(Ut.Z,{className:"text-[14px]"})]})})}),Wt=function(u){var f,A,E,R,c=u.setShow,Z=u.inputShow,F=u.setBoxLoading,P=u.setAppRunId,w=u.scrollDom,x=(0,D.useIntl)(),U=(0,a.useState)(!1),$=d()(U,2),W=$[0],ee=$[1],G=(0,a.useState)(""),te=d()(G,2),k=te[0],C=te[1],B=(0,a.useState)(""),ae=d()(B,2),ne=ae[0],re=ae[1],T=(0,a.useRef)(""),I=(0,a.useRef)(""),K=(0,a.useRef)(!1),pe=(0,a.useState)(!1),ve=d()(pe,2),se=ve[0],J=ve[1],ie=(0,a.useState)(null),me=d()(ie,2),N=me[0],ue=me[1],de=(0,fe.Z)(function(v){return v.setSummaryClick}),he=function(){var v=y()(o()().mark(function s(i){var n,r,l,m,h=arguments;return o()().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return n=h.length>1&&h[1]!==void 0?h[1]:{app_run_id:"",corrected_parameter:""},g.next=3,(0,b.Rp)(i,n);case 3:r=g.sent,(r==null?void 0:r.code)==0&&(P(r==null||(l=r.data)===null||l===void 0?void 0:l.app_run_id),I.current=r==null||(m=r.data)===null||m===void 0?void 0:m.app_run_id,n.app_run_id&&(K.current=!0));case 5:case"end":return g.stop()}},s)}));return function(i){return v.apply(this,arguments)}}(),xe=function(){var v=y()(o()().mark(function s(i,n){var r,l,m,h,p;return o()().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:return O.next=2,(0,b.xM)(i,{message:n});case 2:r=O.sent,(r==null?void 0:r.code)==0&&(I.current=r==null||(l=r.data)===null||l===void 0?void 0:l.app_run_id,P(r==null||(m=r.data)===null||m===void 0?void 0:m.app_run_id),r!=null&&(h=r.data)!==null&&h!==void 0&&(h=h.outputs)!==null&&h!==void 0&&h.value&&(C(r==null||(p=r.data)===null||p===void 0||(p=p.outputs)===null||p===void 0?void 0:p.value),c(!0),F(!1),de(!0),w.current.scrollTo({top:0})));case 4:case"end":return O.stop()}},s)}));return function(i,n){return v.apply(this,arguments)}}(),H=function(){var v=y()(o()().mark(function s(){var i;return o()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,(0,b.Gh)({chatroom_id:T.current,app_run_id:I.current});case 2:i=r.sent,i&&i!==null&&i!==void 0&&i.data&&ue(i.data);case 4:case"end":return r.stop()}},s)}));return function(){return v.apply(this,arguments)}}(),j=function(s){var i=new Date(s),n=i.getMonth()+1,r=i.getDate(),l=i.getHours(),m=i.getMinutes(),h=i.getSeconds();return i.getFullYear()+"-"+(n<10?"0"+n:n)+"-"+(r<10?"0"+r:r)+" "+(l<10?"0"+l:l)+":"+(m<10?"0"+m:m)+":"+(h<10?"0"+h:h)},S=(0,De.Z)(function(v){return v.flowMessage});(0,a.useEffect)(function(){var v=S.filter(function(n){return n.data.app_run_id==I.current&&n.type.indexOf("generate_meeting_summary")!==-1});if(v.length!=0){var s,i=(s=v[v.length-1])===null||s===void 0||(s=s.data)===null||s===void 0||(s=s.exec_data)===null||s===void 0||(s=s.outputs)===null||s===void 0?void 0:s.value;i&&(K.current&&H(),C(i),J(!1),c(!0),de(!0),F(!1),w.current.scrollTo({top:0}))}},[S]);var M=(0,fe.Z)(function(v){return v.summaryParams});return(0,a.useEffect)(function(){M&&M.id&&(T.current=M.id,N&&ue(null),se&&J(!1),k&&C(""),ee(!0),M.message?(F(!0),xe(M.id,M.message)):he(M.id))},[M]),(0,e.jsx)(e.Fragment,{children:W?(0,e.jsxs)("div",{className:"pb-[16px]",children:[(0,e.jsx)("div",{className:"text-[16px] font-[600] pt-[12px]",children:x.formatMessage({id:"app.summary.title"})}),(0,e.jsx)("div",{className:"text-[14px] pt-[12px] leading-[23px] px-[8px]",children:k?(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("div",{className:" ".concat("max-h-[400px]"," p-[12px]  bg-[#F7F7F7]  relative overflow-y-auto"),children:(0,e.jsx)(Ee.U,{rehypePlugins:[Le.Z],children:N?N==null||(f=N.source_run)===null||f===void 0?void 0:f.summary:k})}),N&&(N==null||(A=N.source_corrections)===null||A===void 0?void 0:A.length)>0||!Z?(0,e.jsx)(Je,{id:T.current,message:N?N==null||(E=N.source_run)===null||E===void 0?void 0:E.summary:k}):(0,e.jsx)(e.Fragment,{})]}):(0,e.jsx)("div",{className:"min-h-[120px] flex items-center justify-center",children:(0,e.jsx)(Oe.Z,{size:"large"})})}),N&&(N==null||(R=N.source_corrections)===null||R===void 0?void 0:R.length)>0?(0,e.jsxs)("div",{children:[(0,e.jsxs)("div",{className:"text-[16px] font-[600] py-[8px]",children:[x.formatMessage({id:"app.summaryhistory.orientation"}),":"]}),N.source_corrections.map(function(v,s){return(0,e.jsxs)("div",{className:"mb-[16px]",children:[(0,e.jsx)("div",{className:"rounded-[4px]  ".concat(N.source_corrections.length-1==s?"bg-blue-100":"bg-[#F7F7F7]"),children:(0,e.jsxs)("div",{className:"p-[12px]   leading-[22px]",children:[(0,e.jsxs)("div",{className:"tetx-[14px] font-[600] pb-[12px]",children:[x.formatMessage({id:"app.summaryhistory.userPrompt"}),": ",v.user_prompt]}),(0,e.jsxs)("div",{className:"tetx-[14px] font-[600] pb-[12px]",children:[x.formatMessage({id:"app.summaryhistory.time"}),": ",j(v.created_time)]}),(0,e.jsx)(Ee.U,{rehypePlugins:[Le.Z],children:v==null?void 0:v.corrected_summary})]})},v.created_time),!Z||N.source_corrections.length-1!=s?(0,e.jsx)(Je,{id:T.current,message:v==null?void 0:v.corrected_summary}):(0,e.jsx)(e.Fragment,{})]},v.created_time)})]}):(0,e.jsx)(e.Fragment,{}),Z?(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("div",{className:"pt-[12px]",children:(0,e.jsx)(Vt.Z.TextArea,{onChange:function(s){re(s.target.value)},value:ne,disabled:!k||se,rows:4,placeholder:x.formatMessage({id:"app.summary.placeholder"})})}),(0,e.jsx)("div",{className:"flex pt-[12px] gap-x-[4px]",children:(0,e.jsx)(Ie.ZP,{type:"primary",disabled:!k||!ne,loading:se,className:"bg-[#1B64F3] rounded-[4px] w-[88px] h-[40px] flex-1",onClick:function(){he(T.current,{app_run_id:String(I.current),corrected_parameter:ne}),J(!0),re(""),c("")},children:x.formatMessage({id:"app.summary.submitText"})})})]}):(0,e.jsx)(e.Fragment,{})]}):(0,e.jsx)(e.Fragment,{})})},Gt=(0,a.memo)(Wt),Kt=t(38027),Jt=function(u){var f,A=u.id,E=(0,a.useState)(""),R=d()(E,2),c=R[0],Z=R[1],F=(0,a.useState)(!1),P=d()(F,2),w=P[0],x=P[1],U=(0,a.useState)([]),$=d()(U,2),W=$[0],ee=$[1],G=(0,a.useState)(!1),te=d()(G,2),k=te[0],C=te[1],B=(0,a.useState)(!1),ae=d()(B,2),ne=ae[0],re=ae[1],T=(0,a.useState)(""),I=d()(T,2),K=I[0],pe=I[1],ve=(0,a.useState)(!1),se=d()(ve,2),J=se[0],ie=se[1],me=(0,a.useState)(!1),N=d()(me,2),ue=N[0],de=N[1],he=(0,a.useState)(!0),xe=d()(he,2),H=xe[0],j=xe[1],S=(0,a.useRef)(null),M=(0,a.useRef)(1),v=(0,a.useRef)(!1),s=(0,a.useRef)(!0),i=(0,a.useRef)(0),n=(0,a.useState)(!1),r=d()(n,2),l=r[0],m=r[1],h=(0,a.useState)(800),p=d()(h,2),g=p[0],O=p[1],je=(0,a.useState)(!1),Y=d()(je,2),ge=Y[0],Me=Y[1],Ze=(0,fe.Z)(function(le){return le.summaryParams}),qt=(0,fe.Z)(function(le){return le.setSummaryParams}),Pe=function(){var le=y()(o()().mark(function Se(){var Ye,He,oe,$e,Ae,ze,Ce=arguments;return o()().wrap(function(Ne){for(;;)switch(Ne.prev=Ne.next){case 0:if(Ye=Ce.length>0&&Ce[0]!==void 0?Ce[0]:!0,He=Ce.length>1&&Ce[1]!==void 0?Ce[1]:!0,!(i.current!=0&&i.current<M.current)){Ne.next=5;break}return m(!1),Ne.abrupt("return");case 5:return Ne.next=8,(0,b.sh)({chatroom_id:A,page:M.current,page_size:10});case 8:oe=Ne.sent,oe.code==0&&(oe!=null&&($e=oe.data)!==null&&$e!==void 0&&$e.list&&oe!==null&&oe!==void 0&&(Ae=oe.data)!==null&&Ae!==void 0&&(Ae=Ae.list)!==null&&Ae!==void 0&&Ae.length&&(i.current=oe==null||(ze=oe.data)===null||ze===void 0?void 0:ze.total_pages,ee(function(Fe){return He?Re()(oe.data.list.reverse()):[].concat(Re()(oe.data.list.reverse()),Re()(Fe))}),s.current=!0,x(!0),m(!0)),He&&setTimeout(function(){var Fe;S==null||(Fe=S.current)===null||Fe===void 0||Fe.scrollTo({top:0})},200),Ye||(Z(Ze.id),qt({})));case 10:case"end":return Ne.stop()}},Se)}));return function(){return le.apply(this,arguments)}}(),ea=function(Se){Se.target.scrollHeight+(Se.target.scrollTop-Se.target.clientHeight)<400&&s.current&&(s.current=!1,m(!0),M.current=M.current+=1,Pe(!0,!1))};(0,a.useEffect)(function(){M.current=1,Pe()},[A]),(0,a.useEffect)(function(){console.log(Ze),Ze&&Ze.id&&(x(!0),H||j(!0),k&&C(!1),J&&ie(!1),M.current=1,re(!0),Pe(!1),v.current=!0)},[Ze]);var ta=(0,fe.Z)(function(le){return le.setOrientationShow});return(0,a.useEffect)(function(){w&&ta(!0)},[w]),(0,a.useEffect)(function(){console.log(l);var le=function(){window.innerWidth<1280?(O(400),Me(!0),console.log(S),setTimeout(function(){ie(!0)},200)):(O((window.innerWidth-320)/2),Me(!1),ie(!1))};return le(),window.addEventListener("resize",le),function(){window.removeEventListener("resize",le)}},[]),(0,e.jsx)(e.Fragment,{children:w?(0,e.jsxs)("div",{style:{overflow:J?"hidden":"initial"},className:"pl-[32px] box-border ".concat(ge?"fixed  right-0 bottom-0 top-[56px]":"relative"),children:[(0,e.jsx)("div",{onClick:function(){ie(function(Se){return!Se})},className:`
                                `.concat(J?"absolute left-[2px]  top-[60px]":"absolute left-[2px] top-[60px]",`
                                history_packup
                                hover:text-[#1B64F3]
                                w-[30px] h-[60px] bg-[rgba(255,255,255,1)] shadow-md flex justify-center items-center cursor-pointer z-[99]
                            `),children:J?(0,e.jsx)(jt,{className:"text-[18px]"}):(0,e.jsx)(vt,{className:"text-[18px]"})}),(0,e.jsxs)(ct.Z,{minWidth:400,maxWidth:g,className:"relative h-full right-0 border-0 returned-0 px-[0] ".concat(J?"hidden flex-[0]":"block"),children:[ue?(0,e.jsx)("div",{className:"h-full w-full absolute top-0 left-0 flex justify-center items-center z-[100] bg-[rgba(255,255,255,0.5)]",children:(0,e.jsx)(Oe.Z,{size:"large"})}):(0,e.jsx)(e.Fragment,{}),(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)("div",{className:"h-full min-h-full overflow-y-auto flex flex-col-reverse scroll-smooth relative",onScroll:ea,ref:S,children:[(0,e.jsxs)("div",{children:[W.length?(0,e.jsx)(Kt.ZP,{id:A,runid:K,scrollDom:S,list:W,historyHeight:v.current}):(0,e.jsx)(e.Fragment,{}),(0,e.jsxs)("div",{className:"w-full px-4 h-full",style:{minHeight:ne?S==null||(f=S.current)===null||f===void 0?void 0:f.offsetHeight:""},children:[(0,e.jsx)(Gt,{setShow:C,inputShow:H,setBoxLoading:de,setAppRunId:pe,scrollDom:S}),k?(0,e.jsx)(Tt,{id:c,runid:K,setBoxLoading:de,scrollDom:S,setinputShow:j}):(0,e.jsx)(e.Fragment,{})]})]}),l?(0,e.jsx)("div",{className:"text-center justify-center items-center flex",children:(0,e.jsx)(Oe.Z,{})}):(0,e.jsx)(e.Fragment,{})]})})]})]}):(0,e.jsx)(e.Fragment,{})})},Yt=(0,a.memo)(Jt),Qt=function(u){return(0,e.jsx)("div",{className:"flex items-center h-full justify-center",children:(0,e.jsx)(V.Z,{image:V.Z.PRESENTED_IMAGE_SIMPLE})})},Xt=(0,a.memo)(function(){var q=(0,D.useParams)(),u=q.id,f=(0,a.useRef)([]),A=(0,a.useRef)(null),E=(0,a.useState)(!1),R=d()(E,2),c=R[0],Z=R[1],F=function(){var P=y()(o()().mark(function w(){var x;return o()().wrap(function($){for(;;)switch($.prev=$.next){case 0:if(!u){$.next=5;break}return $.next=3,(0,b.cH)({id:u});case 3:x=$.sent,x.code==0?(Z(!0),A.current=x.data,f.current=x.data.agent_list):D.history.replace("/meeting");case 5:case"end":return $.stop()}},w)}));return function(){return P.apply(this,arguments)}}();return(0,a.useEffect)(function(){F()},[]),(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)("div",{className:"w-full flex bg-[#fff] overflow-hidden overflow-x-auto",style:{height:"calc(100vh - 56px)"},children:[(0,e.jsx)(lt,{roomDetail:A.current,setAgent:f}),(0,e.jsx)("div",{className:"flex-1 min-h-0 h-full",children:c?(0,e.jsx)(ot.F,{agentList:f}):(0,e.jsx)(Qt,{})}),(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(Yt,{id:u})})]})})}),_t=Xt},55026:function(){"use strict"},61227:function(ce,Q,t){var L=t(82187),o=t(96936),X=t(96263),y=t(69094);function _(d){return L(d)||o(d)||X(d)||y()}ce.exports=_,ce.exports.__esModule=!0,ce.exports.default=ce.exports}}]);
