"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[57],{86:function(ot,Ee,o){var Ve=o(5574),D=o.n(Ve),Ue=o(32332),ne=o(38703),We=o(67294),u=o(85893),xe=function(a){var K=a.subtitle,Ge=a.handleClick,oe=a.lineClamp,at=oe===void 0?2:oe,V=a.textDetails,ve=a.title,Ke=a.icon,Te=a.iconType,$e=Te===void 0?"":Te,Le=a.operation,Ae=Le===void 0?"":Le,Me=a.progress,he=a.status,Ze=a.backlogTips,He=(0,We.useState)(0),ye=D()(He,2),Oe=ye[0],Pe=ye[1],Je=function(){Pe(Me)},Qe=function(){Pe(0)},Xe=function(e){return"rounded-[4px] border-l-[4px] ".concat(e==1?"border-[#1B64F3]":e==2?"border-[#52C41C]":"border-[#F04444]"," ")};return(0,u.jsxs)("div",{className:"flex  p-[10px] cursor-pointer overflow-hidden relative bg-[#fff] ".concat(he!==void 0?Xe(he):"graphicbox"),onClick:Ge,onMouseEnter:function(){Me!=null&&Je()},onMouseLeave:function(){Me!=null&&Qe()},children:[he!==void 0&&(0,u.jsx)("div",{style:{width:"".concat(Oe,"%"),transition:"width 0.5s "},className:"absolute bottom-0 left-0 top-0 bottom-0 h-full ".concat(he==1?"bg-[#1B64F3]/[.03]":he==2?"bg-[#52c41c]/[.05]":"bg-[#FAFAFA]"," ")}),(0,u.jsxs)("div",{className:"flex gap-x-[20px] w-full relative z-20",children:[(0,u.jsx)("div",{className:"shrink-0 flex gap-x-[7px] items-center",style:{fontSize:0},children:(0,u.jsxs)("div",{className:"w-[40px] h-[40px] rounded-[6px] flex items-center justify-center bg-[#F4F8F1] relative",children:[(0,u.jsx)("img",{src:(0,Ue.s9)("single",Ke),className:"w-[22px] h-[22px]"}),$e&&(0,u.jsx)("div",{className:"w-[16px] h-[16px] absolute top-[28px] left-[28px] flex items-center justify-center bg-[#fff] rounded-[3px]",style:{boxShadow:"0px 0px 4px 0px rgba(0,0,0,0.1)"},children:(0,u.jsx)("img",{src:"/icons/".concat($e,".svg"),alt:"",className:"w-[12px] h-[12px]"})})]})}),(0,u.jsx)("div",{className:"flex flex-1 min-w-0",children:(0,u.jsxs)("div",{className:"flex justify-center flex-col gap-y-[5px] flex-1 min-w-0",children:[(0,u.jsxs)("span",{className:"text-[12px] flex items-center",style:{color:"#213044"},children:[(0,u.jsx)("span",{className:"truncate",children:ve}),(0,u.jsx)("span",{className:"flex items-center flex-1",children:K})]}),(0,u.jsx)("span",{className:"text-[12px] max-w-full truncate",style:{color:"#999999"},children:V})]})}),Ze||(0,u.jsx)(u.Fragment,{}),Ae&&(0,u.jsx)("div",{className:"flex items-center w-[24px]",children:(0,u.jsx)("span",{className:"operation",children:Ae})}),Me!=null&&(0,u.jsx)("div",{className:"graphic_progress flex items-center pl-[30px]",children:(0,u.jsx)(ne.Z,{type:"circle",percent:Me,size:29})})]})]})};Ee.Z=xe},78129:function(ot,Ee,o){o.r(Ee),o.d(Ee,{default:function(){return Fa}});var Ve=o(15009),D=o.n(Ve),Ue=o(99289),ne=o.n(Ue),We=o(5574),u=o.n(We),xe=o(43722),Re=o(32983),a=o(67294),K=o(35312),Ge=o(19632),oe=o.n(Ge),at=o(97857),V=o.n(at),ve=o(32332),Ke=o(82114),Te=o(82826),$e=o(63783),Le=o(3471),Ae=o(45360),Me=o(85576),he=o(28036),Ze=o(83062),He=o(72269),ye=o(74330),Oe=o(96486),Pe=o(44010),Je=o(73445),Qe=o(782),Xe=(0,Je.Ue)((0,Qe.mW)(function(i,n){return{clearMemory:null,truncatable:!1,disableInput:!1,summaryParams:null,runsSummaryShow:!1,summaryClick:!0,setClearMemory:function(c){i({clearMemory:c})},setTruncatable:function(c){i({truncatable:c})},setDisableInput:function(c){i({disableInput:c})},setSummaryParams:function(c){i({summaryParams:c})},setRunsSummaryShow:function(c){i({runsSummaryShow:c})},setSummaryClick:function(c){console.log(c),i({summaryClick:c})}}})),G=Xe,e=o(85893),ut=function(n){var r=(0,K.useIntl)(),c=n.roomDetail,b=n.setAgent,S=Ae.ZP.useMessage(),p=u()(S,2),y=p[0],t=p[1],h=(0,K.useParams)(),d=h.id,l=G(function(M){return M.disableInput}),m=G(function(M){return M.truncatable}),v=G(function(M){return M.setClearMemory}),j=(0,a.useState)([]),_=u()(j,2),s=_[0],L=_[1],J=(0,a.useState)(V()({},c)),Z=u()(J,2),C=Z[0],U=Z[1],Q=(0,a.useState)([]),ee=u()(Q,2),H=ee[0],z=ee[1],O=(0,a.useRef)(!1),I=(0,a.useRef)(!1),x=(0,a.useState)(!1),F=u()(x,2),g=F[0],k=F[1],R=function(){var w=Me.Z.confirm;w({title:r.formatMessage({id:"app.chatroom.clear.title"}),icon:(0,e.jsx)(Ke.Z,{}),content:r.formatMessage({id:"app.chatroom.clear.tips"}),okText:r.formatMessage({id:"app.chatroom.clear.confirm"}),okType:"danger",cancelText:r.formatMessage({id:"app.chatroom.clear.cancel"}),onOk:function(){v(["TRUNCATE","0"])}})},N=function(){var M=ne()(D()().mark(function w(){var P;return D()().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:if(!d){E.next=5;break}return E.next=3,(0,xe.cH)({id:d});case 3:if(P=E.sent,P.code==0)try{U(function(){return V()(V()({},P.data.chat_info),{},{max_round:P.data.max_round,smart_selection:P.data.smart_selection})}),L(P.data.agent_list),O.current=!0}catch(ie){}case 5:case"end":return E.stop()}},w)}));return function(){return M.apply(this,arguments)}}(),q=function(){var M=ne()(D()().mark(function w(){var P;return D()().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return E.next=2,(0,xe.j2)({id:d});case 2:P=E.sent,P.code==0&&(z(P.data.list),I.current=!0);case 4:case"end":return E.stop()}},w)}));return function(){return M.apply(this,arguments)}}(),W=function(){var M=ne()(D()().mark(function w(P){var le,E,ie;return D()().wrap(function(X){for(;;)switch(X.prev=X.next){case 0:if(!d){X.next=11;break}if(le=P.active==1?0:1,le!=0){X.next=7;break}if(E=s.filter(function(pe){return pe.active==1}),E.length-1!=0){X.next=7;break}return y.open({type:"error",content:r.formatMessage({id:"app.chatroom.sidebar.agent_tips"}),duration:2}),X.abrupt("return",!1);case 7:return X.next=9,(0,xe.sT)({active:le},d,P.agent_id);case 9:ie=X.sent,ie.code==0&&L(function(pe){return pe.map(function(ce){return V()(V()({},ce),{},{active:ce.agent_id==P.agent_id?le:ce.active})})});case 11:case"end":return X.stop()}},w)}));return function(P){return M.apply(this,arguments)}}(),re=function(w){return w.length>6?w.length=6:w.lenth,w},me=function(w){w.type=="my_agent"?K.history.push("/Agents?app_id=".concat(w.app_id,"&type=false&from=chat_room")):K.history.push("/ReadOnlyAgent?app_id=".concat(w.app_id,"&type=true&from=chat_room"))},se=function(w){K.history.replace("/chat_room/".concat(w.chatroom_id)),window.location.reload()},je=function(){k(!0)},de=function(){k(!1)},Ie=function(){var M=ne()(D()().mark(function w(P){var le,E,ie;return D()().wrap(function(X){for(;;)switch(X.prev=X.next){case 0:if(!(P.checkItem&&P.checkItem.length==0)){X.next=3;break}return y.open({type:"error",content:r.formatMessage({id:"app.chatroom.content.addAgentTips_fail"}),duration:2}),X.abrupt("return");case 3:return le=oe()(P.checkItem).map(function(pe){var ce=pe.agent_id,be=pe.active,ze=be===void 0?1:be;return{agent_id:ce,active:ze}}),E={description:C.description,name:C.name,max_round:C.max_round},X.next=7,(0,xe.sI)(V()(V()({},E),{},{agent:le}),d);case 7:ie=X.sent,ie.code==0?(P.checkItem.map(function(pe){pe.active=pe.active==null?1:pe.active}),L(oe()(P.checkItem)),b.current=oe()(P.checkItem),y.open({type:"success",content:r.formatMessage({id:"app.chatroom.content.addAgentTips"}),duration:2})):y.open({type:"error",content:r.formatMessage({id:"app.chatroom.content.addAgentTips_fail"}),duration:2});case 9:case"end":return X.stop()}},w)}));return function(P){return M.apply(this,arguments)}}(),we=function(){var M=ne()(D()().mark(function w(){var P;return D()().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return P=C.smart_selection==1?0:1,E.next=3,(0,xe.r5)({smart_selection:P},d);case 3:U(function(ie){return V()(V()({},ie),{},{smart_selection:P})});case 4:case"end":return E.stop()}},w)}));return function(){return M.apply(this,arguments)}}();return(0,a.useEffect)(function(){N(),q()},[]),(0,e.jsxs)(e.Fragment,{children:[t,(0,e.jsxs)("div",{className:"h-full w-[320px] bg-[#fff] shrink-0",style:{boxShadow:"0px 2px 4px 0px rgba(0,0,0,0.1)"},id:"sider",children:[(0,e.jsxs)("div",{className:"flex flex-col  h-full",children:[(0,e.jsx)("div",{className:"w-full flex  justify-start px-[30px]",children:(0,e.jsxs)("div",{className:"py-[20px] text-[14px] text-[#213044] font-[500] flex gap-x-[10px] items-center w-full",children:[(0,e.jsxs)("div",{className:"cursor-pointer flex items-center shrink-0",onClick:function(){K.history.go(-1)},children:[(0,e.jsx)(he.ZP,{type:"link",danger:!0,className:"p-0",children:(0,e.jsx)(Te.Z,{className:"text-[#1B64F3] w-[16px] h-[16px]"})}),(0,e.jsx)("span",{className:"ml-[5px] text-[#213044] text-sm",children:r.formatMessage({id:"app.chatroom.sidebar.return"})})]}),(0,e.jsx)("div",{className:"h-full flex items-center shrink-0",children:(0,e.jsx)("div",{className:"w-[1px] h-[13px] bg-[#ebebeb]"})}),(0,e.jsx)("div",{className:"flex-1 min-w-0 truncate",children:C.name})]})}),(0,e.jsx)("div",{className:"h-[360px]",children:(0,e.jsxs)("div",{className:"pb-[20px] border-b-[1px] px-[10px]",children:[(0,e.jsxs)("div",{className:"flex items-center cursor-pointer px-[20px]",children:[(0,e.jsx)("div",{className:"flex gap-x-[5px] flex-1",children:(0,e.jsx)("span",{className:"text-[#666] text-[14px]",children:r.formatMessage({id:"app.chatroom.sidebar.agent_title"})})}),(0,e.jsxs)("div",{className:"shrink-0 flex items-center",children:[(0,e.jsx)(Ze.Z,{className:"pr-[2px]",overlayStyle:{fontSize:"12px"},title:r.formatMessage({id:"app.chatroom.sidebar.chatroom_switch_tips"}),children:(0,e.jsx)($e.Z,{className:"cursor-pointer text-[#666] text-[12px]"})}),(0,e.jsx)("span",{className:"text-[12px] text-[#666] pr-[5px]",children:r.formatHTMLMessage({id:"app.chatroom_list.switch"})}),(0,e.jsx)(He.Z,{size:"small",defaultChecked:!0,className:"w-[28px]",checked:C.smart_selection==1,onChange:we,disabled:l})]})]}),(0,e.jsx)("div",{className:"py-[20px] pt-[10px]",children:(0,e.jsx)("div",{className:"h-[220px] overflow-y-auto px-[10px]",children:O.current?(0,e.jsx)("div",{className:"flex flex-col",children:s&&s.length>0?s.map(function(M){return(0,e.jsxs)("div",{className:"flex items-center gap-x-[5px] hover:bg-[#FAFAFA] transition p-[10px] slider_agent_box",children:[(0,e.jsxs)("div",{className:"flex gap-x-[15px] flex-1 min-w-[0]",children:[(0,e.jsx)("div",{className:"w-[40px] h-[40px] bg-[#F4F8F1] rounded-[6px] flex items-center justify-center shrink-0",children:(0,e.jsx)("img",{src:(0,ve.s9)("single",M.icon),alt:"",className:"w-[18px]  h-[18px]"})}),(0,e.jsxs)("div",{className:"flex flex-col gap-y-[5px] justify-center flex-1 min-w-[0]",children:[(0,e.jsx)("span",{className:"text-[#213044] text-[12px] font-[500] truncate w-full",children:M.name}),(0,e.jsx)("span",{className:"text-[#999999] text-[12px] truncate",children:M.description})]})]}),(0,e.jsxs)("div",{className:"shrink-0 flex gap-x-[15px] items-center",children:[(0,e.jsx)("div",{className:"edit cursor-pointer w-[20px] h-[20px] flex justify-center items-center opacity-0 transition",onClick:function(){me(M)},children:(0,e.jsx)("img",{className:"w-[16px] h-[16px]",src:"/icons/edit_icon_1.svg"})}),(0,e.jsx)(He.Z,{size:"small",disabled:l,defaultChecked:!0,className:"w-[28px]",checked:M.active==1,onChange:function(){W(M)}})]})]},M.agent_id)}):(0,e.jsx)("div",{className:"w-full min-h-[220px] flex items-center justify-center",children:(0,e.jsx)(Re.Z,{image:Re.Z.PRESENTED_IMAGE_SIMPLE})})}):(0,e.jsx)("div",{className:"flex justify-center w-full h-full items-center",children:(0,e.jsx)(ye.Z,{})})})}),(0,e.jsx)("div",{className:"px-[20px] ",children:(0,e.jsx)("div",{style:{border:"1px solid #1B64F3"},onClick:je,className:"w-full h-[30px] transition text-[#1B64F3] flex items-center justify-center cursor-pointer rounded-[6px] hover:text-[#fff] hover:bg-[#1B64F3]",children:(0,e.jsx)("span",{className:"text-[12px]",children:r.formatMessage({id:"app.chatroom.add.agent"})})})}),(0,e.jsx)("div",{className:"px-[20px] pt-[15px]",children:(0,e.jsx)("div",{style:m&&!l?{border:"1px solid #1B64F3"}:{background:"#d9d9d9",color:"rgba(0,0,0,0.25)",cursor:"not-allowed"},onClick:(0,Oe.throttle)(function(){m&&!l&&R()}),className:"w-full h-[30px] transition text-[#1B64F3] flex items-center justify-center cursor-pointer rounded-[6px] hover:text-[#fff] hover:bg-[#1B64F3]",children:(0,e.jsx)("span",{className:"text-[12px]",children:r.formatMessage({id:"app.chatroom.sidebar.agent_button"})})})})]})}),(0,e.jsxs)("div",{className:"flex-1 min-h-[0] flex flex-col",children:[(0,e.jsx)("div",{className:"pt-[30px] px-[30px] text-[#666] text-[14px] shrink-0",children:r.formatMessage({id:"app.chatroom.sidebar.othe_title"})}),(0,e.jsx)("div",{className:"px-[10px] flex-1 min-h-[0] py-[10px]",children:(0,e.jsx)("div",{style:{height:"calc(100% - 20px)"},className:"px-[10px]  overflow-y-auto",children:I.current?(0,e.jsx)("div",{className:"h-full flex flex-col",children:H&&H.length>0?H.map(function(M){return(0,e.jsxs)("div",{className:"w-full transition hover:bg-[#FAFAFA] p-[10px] cursor-pointer",onClick:function(){se(M)},children:[(0,e.jsxs)("div",{className:"flex pb-[10px]",children:[(0,e.jsx)("div",{className:"flex-1 min-w-[0] truncate text-[#333] text-[14px]",children:M.name}),M.active==0?(0,e.jsxs)("div",{className:"flex items-center gap-x-[6px]",children:[(0,e.jsx)("img",{className:"w-[12px] h-[12px]",src:"/icons/plaza_m2_c2.svg",alt:""}),(0,e.jsx)("span",{className:"text-[12px] text-[#aaa]",children:r.formatMessage({id:"app.chatroom.sidebar.othe_status"})})]}):(0,e.jsxs)("div",{className:"flex items-center gap-x-[6px]",children:[(0,e.jsx)("img",{className:"w-[12px] h-[12px]",src:"/icons/plaza_m2_c1.svg",alt:""}),(0,e.jsx)("span",{className:"text-[12px] text-[#aaa]",children:r.formatMessage({id:"app.chatroom.sidebar.othe_status_succeed"})})]})]}),(0,e.jsx)("div",{className:"flex gap-x-[10px]",children:M.agent_list&&M.agent_list.length>0?(0,e.jsxs)(e.Fragment,{children:[re(M.agent_list).map(function(w,P){return(0,e.jsx)("div",{className:"flex",children:(0,e.jsx)("div",{className:"w-[30px] h-[30px] bg-[#F4F8F1] rounded-[6px] flex items-center justify-center",children:(0,e.jsx)("img",{src:(0,ve.s9)("single",w.icon),alt:"",className:"w-[18px]  h-[18px]"})})},P)}),M.agent_list.length>=6?(0,e.jsx)(Le.Z,{}):(0,e.jsx)(e.Fragment,{})]}):(0,e.jsx)(e.Fragment,{})})]},M.chatroom_id)}):(0,e.jsx)("div",{className:"w-full h-full",children:(0,e.jsx)(Re.Z,{image:Re.Z.PRESENTED_IMAGE_SIMPLE})})}):(0,e.jsx)("div",{className:"flex justify-center w-full h-full items-center",children:(0,e.jsx)(ye.Z,{})})})})]})]}),(0,e.jsx)(Pe.Z,{show:g,popupClose:de,popupSave:Ie,checkList:s,zIndex:99})]})]})},dt=(0,a.memo)(ut),pt=o(13769),xt=o.n(pt),ft=o(47635),ue=o(1413),mt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M862 465.3h-81c-4.6 0-9 2-12.1 5.5L550 723.1V160c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v563.1L255.1 470.8c-3-3.5-7.4-5.5-12.1-5.5h-81c-6.8 0-10.5 8.1-6 13.2L487.9 861a31.96 31.96 0 0048.3 0L868 478.5c4.5-5.2.8-13.2-6-13.2z"}}]},name:"arrow-down",theme:"outlined"},vt=mt,ke=o(91146),ht=function(n,r){return a.createElement(ke.Z,(0,ue.Z)((0,ue.Z)({},n),{},{ref:r,icon:vt}))},gt=a.forwardRef(ht),jt=gt,yt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372zm-88-532h-48c-4.4 0-8 3.6-8 8v304c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V360c0-4.4-3.6-8-8-8zm224 0h-48c-4.4 0-8 3.6-8 8v304c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V360c0-4.4-3.6-8-8-8z"}}]},name:"pause-circle",theme:"outlined"},St=yt,Nt=function(n,r){return a.createElement(ke.Z,(0,ue.Z)((0,ue.Z)({},n),{},{ref:r,icon:St}))},wt=a.forwardRef(Nt),bt=wt,_t=o(2068),Ct={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M312.1 591.5c3.1 3.1 8.2 3.1 11.3 0l101.8-101.8 86.1 86.2c3.1 3.1 8.2 3.1 11.3 0l226.3-226.5c3.1-3.1 3.1-8.2 0-11.3l-36.8-36.8a8.03 8.03 0 00-11.3 0L517 485.3l-86.1-86.2a8.03 8.03 0 00-11.3 0L275.3 543.4a8.03 8.03 0 000 11.3l36.8 36.8z"}},{tag:"path",attrs:{d:"M904 160H548V96c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v64H120c-17.7 0-32 14.3-32 32v520c0 17.7 14.3 32 32 32h356.4v32L311.6 884.1a7.92 7.92 0 00-2.3 11l30.3 47.2v.1c2.4 3.7 7.4 4.7 11.1 2.3L512 838.9l161.3 105.8c3.7 2.4 8.7 1.4 11.1-2.3v-.1l30.3-47.2a8 8 0 00-2.3-11L548 776.3V744h356c17.7 0 32-14.3 32-32V192c0-17.7-14.3-32-32-32zm-40 512H160V232h704v440z"}}]},name:"fund-projection-screen",theme:"outlined"},Rt=Ct,Mt=function(n,r){return a.createElement(ke.Z,(0,ue.Z)((0,ue.Z)({},n),{},{ref:r,icon:Rt}))},kt=a.forwardRef(Mt),Ft=kt,nt=o(26915),Dt=o(20640),rt=o.n(Dt),Se=o(22683),Ne=o(97807),It=["node","className","children"],At=nt.Z.TextArea,Ot=(0,a.memo)(function(i){var n=i.setInstruction,r=i.messageApi,c=i.isStop,b=i.scrollDomRef,S=i.upButtonDom,p=(0,K.useIntl)(),y=G(function(_){return _.disableInput}),t=G(function(_){return _.setDisableInput}),h=(0,a.useState)(""),d=u()(h,2),l=d[0],m=d[1],v=function(s){!s.shiftKey&&s.target.value==""&&(r.open({type:"warning",content:p.formatMessage({id:"app.chatroom.content.input"}),duration:10}),m(""),s.preventDefault()),!s.shiftKey&&s.keyCode==13&&s.target.value!=""&&(t(!0),m(""),n(["INPUT",s.target.value]),s.preventDefault())},j=(0,Oe.throttle)(function(){n(["STOP",null])},300);return(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)("div",{className:"max-w-[920px] w-full min-h-[60px] mt-[20px] mb-[20px] mx-auto relative",children:[(0,e.jsx)("div",{ref:S,className:"w-[40px] h-[40px] rounded-[6px]  bg-[#fff] border border-[#ddd] cursor-pointer absolute top-[-67px] left-2/4 flex items-center justify-center hidden",onClick:function(s){b.current.scrollTo({top:b.current.scrollHeight,behavior:"smooth"})},children:(0,e.jsx)(jt,{className:"text-[16px]"})}),(0,e.jsxs)("div",{className:"flex items-center p-[12px] gap-[10px] box-border border border-[#ccc] bg-[#fff] rounded-[8px]",children:[(0,e.jsx)(At,{id:"userValue",className:"placeholder-text-[#aaa] placeholder-text-[14px]",autoSize:{minRows:1,maxRows:6},value:l,disabled:y,onChange:function(s){m(s.target.value)},onPressEnter:v,style:{height:"34px",border:"none",resize:"none",backgroundColor:"transparent"},placeholder:"".concat(p.formatMessage({id:"app.chatroom.content.input"}),"\u2026")}),c?(0,e.jsx)("div",{className:"min-w-[34px] h-[34px] bg-[#000] flex items-center justify-center cursor-pointer rounded-[4px]",onClick:j,children:(0,e.jsx)(bt,{style:{color:"#fff",fontSize:"20px"}})}):(0,e.jsx)("div",{className:"".concat(y||!l?"bg-[#ddd]":"bg-[#1B64F3]"," min-w-[30px] h-[30px]  flex items-center justify-center cursor-pointer rounded-[6px]"),onClick:(0,Oe.throttle)(function(){if(y||!l)return!1;l||r.open({type:"warning",content:p.formatMessage({id:"app.chatroom.content.input"}),duration:10}),t(!0),n(["INPUT",l]),m("")},300),children:(0,e.jsx)("img",{src:"/icons/send_icon_w.svg",alt:"",className:"w-[18px] h-[18px]"})})]})]})})}),Pt=function i(n){return typeof n=="string"?n:Array.isArray(n)?n.map(i).join(""):a.isValidElement(n)?i(n.props.children):""},Et=function(n){return Pt(n)},Ye=function(n,r){return{code:function(b){var S=b.node,p=b.className,y=b.children,t=xt()(b,It),h=/language-(\w+)/.exec(p||"");if(h!=null&&h.length){var d=Math.random().toString(36).substr(2,9);return(0,e.jsxs)("div",{className:" rounded-md border overflow-hidden",children:[(0,e.jsxs)("div",{className:"flex h-12 items-center justify-between bg-zinc-100 px-4 bg-zinc-900",children:[(0,e.jsx)("div",{className:"flex items-center gap-2",children:(0,e.jsx)("p",{className:"text-sm  text-[#fff] mb-[0]",children:h[1]})}),(0,e.jsxs)("div",{className:"text-[12px] text-[#fff] mb-[0] cursor-pointer flex gap-x-[5px]",onClick:function(){var l=ne()(D()().mark(function m(v){var j;return D()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.prev=0,j=v.currentTarget,s.next=4,rt()(Et(y));case 4:j&&(j.children[1].innerText=r.formatMessage({id:"app.chatroom.content.copySucceed"})),setTimeout(function(){j&&(j.children[1].innerText=r.formatMessage({id:"app.chatroom.content.copycode"}))},200),s.next=11;break;case 8:s.prev=8,s.t0=s.catch(0),console.error("Failed to copy text: ",s.t0);case 11:case"end":return s.stop()}},m,null,[[0,8]])}));return function(m){return l.apply(this,arguments)}}(),children:[(0,e.jsx)("img",{src:"/icons/chat_copy_w.svg"}),(0,e.jsx)("span",{children:r.formatMessage({id:"app.chatroom.content.copycode"})})]})]}),(0,e.jsx)("div",{className:"overflow-x-auto bg-[#282c34] text-[#abb2bf]",children:(0,e.jsx)("div",{id:"".concat(d).concat(n),className:"p-4",children:y})})]})}else return(0,e.jsx)("code",V()(V()({},t),{},{children:y}))}}},st=(0,a.memo)(function(i){var n=i.messageApi,r=i.index,c=i.idName,b=i.cidName,S=(0,K.useIntl)(),p=(0,a.useState)(!1),y=u()(p,2),t=y[0],h=y[1];return(0,e.jsx)("div",{className:"flex gap-x-[4px]",children:(0,e.jsxs)("div",{onMouseEnter:function(){h(!0)},onMouseLeave:function(){h(!1)},className:" p-[2px] cursor-pointer rounded-md flex gap-x-[5px] items-center pt-[10px]",onClick:function(){var d=ne()(D()().mark(function l(m){var v,j;return D()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return v=m.target.closest("#".concat(c).concat(r)),j=v.querySelector("#".concat(b).concat(r)),s.prev=2,s.next=5,rt()(j.innerText);case 5:n.open({type:"success",content:S.formatMessage({id:"app.chatroom.content.copySucceed"}),duration:2}),s.next=11;break;case 8:s.prev=8,s.t0=s.catch(2),console.error("Failed to copy text: ",s.t0);case 11:case"end":return s.stop()}},l,null,[[2,8]])}));return function(l){return d.apply(this,arguments)}}(),children:[(0,e.jsx)("img",{src:"".concat(t?"/icons/chat_copy_check.svg":"/icons/chat_copy.svg"),className:"w-[16px] h-[16px]"}),(0,e.jsx)("span",{className:"text-[12px] ".concat(t?" text-[#1B64F3]":"text-[#666]"),children:S.formatMessage({id:"app.chatroom.content.copy"})})]})})}),it=function(n){var r=n.id,c=n.index,b=n.idName,S=n.cidName,p=(0,K.useIntl)(),y=G(function(j){return j.setSummaryClick}),t=(0,a.useState)(!0),h=u()(t,2),d=h[0],l=h[1],m=G(function(j){return j.summaryClick});(0,a.useEffect)(function(){l(m)},[m]);var v=G(function(j){return j.setSummaryParams});return(0,e.jsx)("div",{className:"flex gap-x-[4px] text-[#666] ".concat(d?"cursor-pointer hover:text-[#1B64F3]":"cursor-no-drop"),children:(0,e.jsxs)("div",{className:" p-[2px]  rounded-md flex gap-x-[5px] items-center pt-[10px]",onClick:function(_){if(d){var s=_.target.closest("#".concat(b).concat(c)),L=s.querySelector("#".concat(S).concat(c));v({id:r,message:L.innerText}),y(!1)}},children:[(0,e.jsx)(_t.Z,{className:"text-[16px]"}),(0,e.jsx)("span",{className:"text-[12px]",children:p.formatMessage({id:"app.chatroom.content.summary"})})]})})},Tt=function(n){var r=n.roomid,c=(0,K.useIntl)(),b=G(function(l){return l.setSummaryClick}),S=(0,a.useState)(!0),p=u()(S,2),y=p[0],t=p[1],h=G(function(l){return l.summaryClick});(0,a.useEffect)(function(){t(h)},[h]);var d=G(function(l){return l.setSummaryParams});return(0,e.jsx)("div",{className:"bg-[#fff] text-[#999999]   items-center justify-center rounded-[8px] ".concat(y?"cursor-pointer hover:text-[#1B64F3]":"cursor-no-drop"),style:{boxShadow:"0px 0px 4px 0px rgba(0,0,0,0.1)"},children:(0,e.jsxs)("div",{className:" gap-x-[4px] flex items-center justify-center h-[40px] px-[20px]",onClick:function(){y&&(d({id:r}),b(!1))},children:[(0,e.jsx)(Ft,{className:"text-[16px]"}),(0,e.jsx)("span",{className:"text-[14px]",children:c.formatMessage({id:"app.chatroom.content.meetingSummary"})})]})})},$t=(0,a.memo)(function(i){var n=i.messageApi,r=i.setCurrentMessageContent,c=i.sendValue,b=i.agentList,S=i.scrollDomRef,p=i.upButtonDom,y=i.setIsStop,t=i.setisEnd,h=i.setSendValue,d=(0,K.useIntl)(),l=(0,K.useParams)(),m=l.id,v=G(function(O){return O.setDisableInput}),j=(0,a.useState)({}),_=u()(j,2),s=_[0],L=_[1],J=(0,a.useRef)(!1),Z=(0,a.useRef)(""),C=G(function(O){return O.setTruncatable}),U=function(I){var x=I.data;if(x.indexOf("--NEXUSAI-INSTRUCTION-")!==-1){var F=JSON.parse(x.slice(22,-2));switch(F[0]){case"ERROR":v(!1),y(!1),h(""),n.open({type:"error",content:"webSocket-".concat(F[1]),duration:10});break;case"CHAT":var g={content:"".concat(F[1]),is_agent:0};r(function(N){return[].concat(oe()(N),[g])}),setTimeout(function(){S.current.scrollTop=S.current.scrollHeight,p.current.style.display="none"});break;case"STOPPABLE":y(F[1]);break;case"TRUNCATABLE":C(F[1]),F[1]||n.open({type:"success",content:"".concat(d.formatMessage({id:"app.chatroom.sidebar.cleartips"})),duration:3});break;case"TRUNCATEOK":n.open({type:"success",content:"".concat(d.formatMessage({id:"app.chatroom.sidebar.cleartips"})),duration:3});break}}if(x.indexOf("REPLY")!==-1&&x.indexOf("--NEXUSAI-INSTRUCTION-")!==-1){var k=JSON.parse(x.slice(22,-2))[1];Z.current="",J.current=!0;var R=b.current.filter(function(N){return N.agent_id==k})[0];Object.keys(s).length&&r(function(N){return[].concat(oe()(N),[s])}),L(function(N){return V()(V()({},N),{},{is_agent:1,icon:R==null?void 0:R.icon,name:R==null?void 0:R.name})}),y(!0),C(!1)}x.indexOf("--NEXUSAI-INSTRUCTION-")===-1&&J.current&&(S.current.scrollTop=S.current.scrollHeight,p.current.style.display="none",Z.current+=x,L(function(N){return V()(V()({},N),{},{content:Z.current})})),x.indexOf("ENDCHAT")!==-1&&(J.current=!1,Z.current="",v(!1),y(!1),C(!0),Object.keys(s).length&&r(function(N){return[].concat(oe()(N),[s])}),L({}),t(!0),h(""))},Q=(0,ft.Z)("chat",U),ee=Q.runSocket,H=Q.sendMessage,z=Q.readyState;return(0,a.useEffect)(function(){z==1&&m&&H(JSON.stringify(["ENTER",parseInt(m)]))},[z]),(0,a.useEffect)(function(){c&&z==1&&H(c)},[c]),(0,a.useEffect)(function(){ee()},[]),(0,e.jsx)(e.Fragment,{children:s.name?(0,e.jsxs)("div",{className:"w-full flex gap-[15px] pt-[15px] pb-[15px] ".concat(s.is_agent!=1?"flex-row-reverse":""),children:[(0,e.jsx)("div",{className:"w-[40px] h-[40px] bg-[#F4F8F1] rounded-[6px] flex items-center justify-center shrink-0",children:s.is_agent==1?(0,e.jsx)("img",{src:(0,ve.s9)("single",s.icon),alt:"",className:"w-[18px]  h-[18px]"}):(0,e.jsx)("img",{src:"/icons/user_header.svg",className:"w-[18px]  h-[18px]"})}),(0,e.jsxs)("div",{className:"flex1 max-w-[560px] text-right",id:"addcontent",children:[(0,e.jsx)("div",{className:"".concat(s.is_agent==1?"text-left":"text-right"," font-[500] text-[14px] text-[#213044] pb-[8px]"),children:s.name?s.name:(0,ve.Qy)("GET").nickname}),(0,e.jsx)("div",{className:"text-left inline-block markdown-container text-[14px] font-[400] text-[#213044] bg-[#F7F7F7] p-[15px] pb-[1px] leading-[22px]",style:s.is_agent==1?{borderRadius:" 0px 8px 8px 8px"}:{borderRadius:"8px 0px 8px 8px",background:"rgba(27,100,243,0.1)",whiteSpace:"pre-wrap"},id:"addchilContent",children:(0,e.jsx)(Se.U,{rehypePlugins:[Ne.Z],components:Ye("add",d),children:s.content})})]})]}):(0,e.jsx)(e.Fragment,{})})}),Lt=(0,a.memo)(function(i){var n=i.messageApi,r=i.setUserMessage,c=i.sendValue,b=i.agentList,S=i.scrollDomRef,p=i.upButtonDom,y=i.setIsStop,t=i.setSendValue,h=(0,K.useIntl)(),d=(0,a.useState)([]),l=u()(d,2),m=l[0],v=l[1],j=(0,a.useState)(!1),_=u()(j,2),s=_[0],L=_[1],J=(0,K.useParams)(),Z=J.id;return(0,a.useEffect)(function(){s&&(r(function(C){return[].concat(oe()(C),oe()(m))}),v([]),setTimeout(function(){L(!1),S.current.scrollTop=S.current.scrollHeight},200))},[s]),(0,e.jsxs)(e.Fragment,{children:[m.length?m.map(function(C,U){return(0,e.jsxs)("div",{className:"w-full flex gap-[15px] pt-[15px] pb-[15px] ".concat(C.is_agent!=1?"flex-row-reverse":""),children:[(0,e.jsx)("div",{className:"w-[40px] h-[40px] bg-[#F4F8F1] rounded-[6px] flex items-center justify-center shrink-0",children:C.is_agent==1?(0,e.jsx)("img",{src:(0,ve.s9)("single",C.icon),alt:"",className:"w-[18px]  h-[18px]"}):(0,e.jsx)("img",{src:"/icons/user_header.svg",className:"w-[18px]  h-[18px]"})}),(0,e.jsxs)("div",{className:"flex1 max-w-[560px] text-right",id:"currentContent".concat(U),children:[(0,e.jsx)("div",{className:"".concat(C.is_agent==1?"text-left":"text-right"," font-[500] text-[14px] text-[#213044] pb-[8px]"),children:C.name?C.name:(0,ve.Qy)("GET").nickname}),(0,e.jsx)("div",{className:"text-left inline-block markdown-container text-[14px] font-[400] text-[#213044] bg-[#F7F7F7] p-[15px] pb-[1px] leading-[22px]",style:C.is_agent==1?{borderRadius:" 0px 8px 8px 8px"}:{borderRadius:"8px 0px 8px 8px",background:"rgba(27,100,243,0.1)",whiteSpace:"pre-wrap"},id:"currentChilContent".concat(U),children:(0,e.jsx)(Se.U,{rehypePlugins:[Ne.Z],components:Ye(U,h),children:C.content})}),C.is_agent==1?(0,e.jsxs)("div",{className:"flex gap-x-[20px]",children:[(0,e.jsx)(st,{messageApi:n,index:U,idName:"currentContent",cidName:"currentChilContent"}),(0,e.jsx)(it,{id:Z,index:U,idName:"currentContent",cidName:"currentChilContent"})]}):(0,e.jsx)(e.Fragment,{})]})]},U)}):(0,e.jsx)(e.Fragment,{}),(0,e.jsx)($t,{messageApi:n,setCurrentMessageContent:v,sendValue:c,agentList:b,scrollDomRef:S,upButtonDom:p,setIsStop:y,setisEnd:L,setSendValue:t})]})}),Zt=(0,a.memo)(function(i){var n=i.messageApi,r=i.scrollDomRef,c=i.instruction,b=i.setIsStop,S=i.upButtonDom,p=i.setInstruction,y=i.agentList,t=(0,K.useIntl)(),h=(0,K.useParams)(),d=h.id,l=(0,a.useState)([]),m=u()(l,2),v=m[0],j=m[1],_=(0,a.useRef)(!1),s=(0,a.useState)(""),L=u()(s,2),J=L[0],Z=L[1],C=(0,a.useRef)(null),U=(0,a.useRef)(null),Q=(0,a.useRef)(!0),ee=(0,a.useRef)(2),H=(0,a.useRef)(1),z=(0,a.useRef)(0),O=function(){var k=ne()(D()().mark(function R(N){var q,W,re=arguments;return D()().wrap(function(se){for(;;)switch(se.prev=se.next){case 0:if(q=re.length>1&&re[1]!==void 0?re[1]:function(){},!d){se.next=6;break}return se.next=4,(0,xe.KH)(d,{page:H.current,page_size:20});case 4:W=se.sent,W.code==0&&(ee.current=W.data.total_pages,j(function(je){return N?oe()(W.data.list):[].concat(oe()(W.data.list),oe()(je))}),N?setTimeout(function(){r.current.scrollTop=r.current.scrollHeight,S.current.style.display="none"}):z.current=W.data.list.length);case 6:case"end":return se.stop()}},R)}));return function(N){return k.apply(this,arguments)}}(),I=function(R){var N=R.target.scrollHeight-R.target.scrollTop-R.target.clientHeight;if(_.current!==Math.ceil(N)>50&&(_.current=Math.ceil(N)>50,S.current.style.display=_.current?"flex":"none"),R.target.scrollTop==0&&Q.current){Q.current=!1;var q=C.current.firstChild;H.current=H.current+1,U.current.style.display="flex",ee.current,ee.current>=H.current?O(!1):U.current.style.display="none"}},x=function(R,N){N==="0"&&(N=Number(N));var q=["".concat(R),N===0||N?N:null];Z(JSON.stringify(q))},F=G(function(k){return k.disableInput}),g=G(function(k){return k.clearMemory});return(0,a.useEffect)(function(){g&&g.length&&x(g[0],g[1])},[g]),(0,a.useEffect)(function(){c&&c.length&&(x(c[0],c[1]?c[1]:""),p([]))},[c]),(0,a.useEffect)(function(){z.current&&C.current.children[z.current]&&(r.current.scrollTop=C.current.children[z.current].offsetTop,Q.current=!0)},[v]),(0,a.useEffect)(function(){H.current=1,O(!0)},[]),(0,e.jsxs)("div",{className:"flex-1 box-border relative overflow-y-auto chatroom overflow-x-hidden",ref:r,onScroll:I,children:[(0,e.jsx)("div",{className:"text-center justify-center items-center flex",style:{display:"none"},ref:U,children:(0,e.jsx)(ye.Z,{})}),(0,e.jsxs)("div",{className:"max-w-[920px] mx-auto",style:{minHeight:"calc(100% - 50px)"},ref:C,children:[v.map(function(k,R){return(0,e.jsxs)("div",{id:"c".concat(k.id),className:"w-full flex gap-[15px] pt-[15px] pb-[15px] ".concat(k.is_agent!=1?"flex-row-reverse":""),children:[(0,e.jsx)("div",{className:"w-[40px] h-[40px] bg-[#F4F8F1] rounded-[6px] flex items-center justify-center shrink-0",children:k.is_agent==1?(0,e.jsx)("img",{src:(0,ve.s9)("single",k.icon),alt:"",className:"w-[18px]  h-[18px]"}):(0,e.jsx)("img",{src:"/icons/user_header.svg",className:"w-[18px]  h-[18px]"})}),(0,e.jsxs)("div",{className:"flex1 max-w-[560px] text-right",id:"content".concat(R),children:[(0,e.jsx)("div",{className:"".concat(k.is_agent==1?"text-left":"text-right"," font-[500] text-[14px] text-[#213044] pb-[8px]"),children:k.name?k.name:(0,ve.Qy)("GET").nickname}),(0,e.jsx)("div",{className:"text-left markdown-container inline-block text-[14px] font-[400] text-[#213044] bg-[#F7F7F7] p-[15px] pb-[1px] leading-[22px]",style:k.is_agent==1?{borderRadius:" 0px 8px 8px 8px"}:{borderRadius:"8px 0px 8px 8px",background:"rgba(27,100,243,0.1)",whiteSpace:"pre-wrap"},id:"chilContent".concat(R),children:(0,e.jsx)(Se.U,{rehypePlugins:[Ne.Z],components:Ye(R,t),children:k.content})}),k.is_agent==1?(0,e.jsxs)("div",{className:"flex gap-x-[20px]",children:[(0,e.jsx)(st,{messageApi:n,idName:"content",cidName:"chilContent",index:R}),(0,e.jsx)(it,{id:d,index:R,idName:"content",cidName:"chilContent"})]}):(0,e.jsx)(e.Fragment,{})]})]},R)}),(0,e.jsx)(Lt,{messageApi:n,setUserMessage:j,sendValue:J,agentList:y,scrollDomRef:r,upButtonDom:S,setIsStop:b,setSendValue:Z})]}),(0,e.jsx)("div",{className:"w-full flex justify-center pb-[10px]",children:!F&&v.length?(0,e.jsx)(Tt,{roomid:d}):(0,e.jsx)(e.Fragment,{})})]})}),Ht=(0,a.memo)(function(i){var n=i.agentList,r=(0,a.useRef)(null),c=(0,a.useRef)(null),b=(0,a.useState)(!1),S=u()(b,2),p=S[0],y=S[1],t=(0,a.useState)([]),h=u()(t,2),d=h[0],l=h[1],m=Ae.ZP.useMessage(),v=u()(m,2),j=v[0],_=v[1];return(0,e.jsxs)(e.Fragment,{children:[_,(0,e.jsx)("div",{className:"mx-[44px] flex justify-center relative box-border pt-[12px]   overflow-auto",style:{height:"calc(100% )"},children:(0,e.jsxs)("div",{className:"flex flex-col w-full",children:[(0,e.jsx)(Zt,{instruction:d,setInstruction:l,messageApi:j,scrollDomRef:r,setIsStop:y,upButtonDom:c,agentList:n}),(0,e.jsx)(Ot,{setInstruction:l,messageApi:j,isStop:p,upButtonDom:c,scrollDomRef:r})]})})]})}),zt=o(42881),Bt=function(n){var r=n.children,c=n.className,b=c===void 0?"":c,S=n.dragDirection,p=S===void 0?"left":S,y=n.minWidth,t=y===void 0?415:y,h=n.maxWidth,d=h===void 0?820:h,l=n.minHeight,m=l===void 0?200:l,v=n.maxHeight,j=v===void 0?800:v,_=n.defaultWidth,s=_===void 0?415:_,L=n.defaultHeight,J=L===void 0?300:L,Z=(0,a.useState)(s),C=u()(Z,2),U=C[0],Q=C[1],ee=(0,a.useState)(J),H=u()(ee,2),z=H[0],O=H[1],I=(0,a.useCallback)(function(k,R){Q(k),R&&O(R)},[Q,O]),x=(0,zt.W)({direction:["left","right"].includes(p)?"horizontal":"vertical",triggerDirection:p,minWidth:t,maxWidth:d,minHeight:m,maxHeight:j,onResize:I}),F=x.triggerRef,g=x.containerRef;return(0,e.jsxs)("div",{ref:g,style:{width:["left","right"].includes(p)?"".concat(U,"px"):void 0,height:["top","bottom"].includes(p)?"".concat(z,"px"):void 0},className:"flex flex-col p-4 shadow-lg rounded-md border border-blue-300 bg-white z-10 wrapPanel ".concat(b),children:[p==="left"&&(0,e.jsx)("div",{ref:F,className:"absolute top-1/2 -translate-y-1/2 -left-2 w-3 h-6 cursor-col-resize resize-x",children:(0,e.jsx)("div",{className:"w-1 h-6 bg-gray-300 rounded-sm"})}),p==="right"&&(0,e.jsx)("div",{ref:F,className:"absolute top-1/2 -translate-y-1/2 -right-2 flex justify-end w-3 h-6 cursor-col-resize resize-x",children:(0,e.jsx)("div",{className:"w-1 h-6 bg-gray-300 rounded-sm"})}),p==="top"&&(0,e.jsx)("div",{ref:F,className:"absolute left-1/2 -translate-x-1/2 -top-2 h-3 w-6 cursor-row-resize resize-y",children:(0,e.jsx)("div",{className:"h-1 w-6 bg-gray-300 rounded-sm"})}),p==="bottom"&&(0,e.jsx)("div",{ref:F,className:"absolute left-1/2 -translate-x-1/2 -bottom-2 h-3 w-6 cursor-row-resize resize-y",children:(0,e.jsx)("div",{className:"h-1 w-6 bg-gray-300 rounded-sm"})}),r]})},Vt=(0,a.memo)(Bt),Ut={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M762 164h-64c-4.4 0-8 3.6-8 8v688c0 4.4 3.6 8 8 8h64c4.4 0 8-3.6 8-8V172c0-4.4-3.6-8-8-8zm-508 0v72.4c0 9.5 4.2 18.4 11.4 24.5L564.6 512 265.4 763.1c-7.2 6.1-11.4 15-11.4 24.5V860c0 6.8 7.9 10.5 13.1 6.1L689 512 267.1 157.9A7.95 7.95 0 00254 164z"}}]},name:"vertical-left",theme:"outlined"},Wt=Ut,Gt=function(n,r){return a.createElement(ke.Z,(0,ue.Z)((0,ue.Z)({},n),{},{ref:r,icon:Wt}))},Kt=a.forwardRef(Gt),Jt=Kt,Qt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M326 164h-64c-4.4 0-8 3.6-8 8v688c0 4.4 3.6 8 8 8h64c4.4 0 8-3.6 8-8V172c0-4.4-3.6-8-8-8zm444 72.4V164c0-6.8-7.9-10.5-13.1-6.1L335 512l421.9 354.1c5.2 4.4 13.1.7 13.1-6.1v-72.4c0-9.4-4.2-18.4-11.4-24.5L459.4 512l299.2-251.1c7.2-6.1 11.4-15.1 11.4-24.5z"}}]},name:"vertical-right",theme:"outlined"},Xt=Qt,Yt=function(n,r){return a.createElement(ke.Z,(0,ue.Z)((0,ue.Z)({},n),{},{ref:r,icon:Xt}))},qt=a.forwardRef(Yt),ea=qt,ta=o(83159),lt=o(42237),aa={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M464 144H160c-8.8 0-16 7.2-16 16v304c0 8.8 7.2 16 16 16h304c8.8 0 16-7.2 16-16V160c0-8.8-7.2-16-16-16zm-52 268H212V212h200v200zm452-268H560c-8.8 0-16 7.2-16 16v304c0 8.8 7.2 16 16 16h304c8.8 0 16-7.2 16-16V160c0-8.8-7.2-16-16-16zm-52 268H612V212h200v200zm52 132H560c-8.8 0-16 7.2-16 16v304c0 8.8 7.2 16 16 16h304c8.8 0 16-7.2 16-16V560c0-8.8-7.2-16-16-16zm-52 268H612V612h200v200zM424 712H296V584c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v128H104c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h128v128c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V776h128c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8z"}}]},name:"appstore-add",theme:"outlined"},na=aa,ra=function(n,r){return a.createElement(ke.Z,(0,ue.Z)((0,ue.Z)({},n),{},{ref:r,icon:na}))},sa=a.forwardRef(ra),ia=sa,la=o(93696),ca=function(n,r){return a.createElement(ke.Z,(0,ue.Z)((0,ue.Z)({},n),{},{ref:r,icon:la.Z}))},oa=a.forwardRef(ca),ua=oa,qe=o(86),da=o(34994),pa=o(4981),xa=o(2216),fa=o(85877),ma=o(29432),va=o(39944),ha=o(11551),et=o(29608),ct=o(55927),ga=(0,a.memo)(function(i){var n=i.progressObj;console.log(n);var r=function(){return parseFloat(n.elapsed_time).toFixed(6)},c=function(S){var p=new Date(S),y=p.getFullYear(),t=(p.getMonth()+1).toString().padStart(2,"0"),h=p.getDate().toString().padStart(2,"0"),d=p.getHours().toString().padStart(2,"0"),l=p.getMinutes().toString().padStart(2,"0"),m=p.getSeconds().toString().padStart(2,"0");return(0,e.jsx)(e.Fragment,{children:"".concat(y,".").concat(t,".").concat(h," ").concat(d,":").concat(l,":").concat(m)})};return(0,e.jsx)("div",{className:"inline-flex gap-x-4 justify-end max-w-[100%]",children:(0,e.jsxs)("div",{className:"inline-flex gap-x-[20px] max-w-[100%]",children:[(0,e.jsx)("div",{className:"truncate min-w-[70px]",children:n.created_time&&c(n.created_time)}),(0,e.jsx)("div",{className:"truncate",children:n.apps_name||n.app_name}),(0,e.jsxs)("div",{className:"flex items-center gap-x-[7px] truncate min-w-[50px]",children:[(0,e.jsx)("div",{className:"shrink-0 rounded-full ".concat(n.status==1?"bg-blue-600":n.status==2?"bg-green-500":"bg-red-500"),style:{width:"3px",height:"3px"}}),(0,e.jsxs)("div",{className:"truncate",children:[r(),"S"]})]})]})})}),ja=function(n){var r,c,b,S,p,y,t=(0,K.useIntl)(),h=n.runid,d=n.id,l=n.setBoxLoading,m=n.scrollDom,v=n.setinputShow,j=(0,a.useState)(null),_=u()(j,2),s=_[0],L=_[1],J=(0,a.useState)(null),Z=u()(J,2),C=Z[0],U=Z[1],Q=(0,a.useState)("agent"),ee=u()(Q,2),H=ee[0],z=ee[1],O=(0,a.useState)({type:"agent",checkItem:[],show:!1}),I=u()(O,2),x=I[0],F=I[1],g=(0,a.useState)([]),k=u()(g,2),R=k[0],N=k[1],q=(0,a.useState)(""),W=u()(q,2),re=W[0],me=W[1],se=(0,a.useState)(!1),je=u()(se,2),de=je[0],Ie=je[1],we=(0,a.useState)(null),M=u()(we,2),w=M[0],P=M[1],le=(0,a.useState)(null),E=u()(le,2),ie=E[0],ge=E[1],X=(0,a.useState)(""),pe=u()(X,2),ce=pe[0],be=pe[1],ze=(0,a.useRef)(""),Fe=(0,a.useRef)(null),De=(0,a.useRef)(""),Da=(0,et.Z)(function(T){return T.setDealtWithData}),Ia=(0,et.Z)(function(T){return T.setRunPanelLogRecord}),Aa=[{key:"1",label:(0,e.jsx)("div",{className:"hover:text-[#1B64F3]",onClick:function(){F(function(f){return V()(V()({},f),{},{type:"agent",show:!0})})},children:t.formatMessage({id:"app.summary.SelectAgent"})})},{key:"2",label:(0,e.jsx)("div",{className:"hover:text-[#1B64F3]",onClick:function(){F(function(f){return V()(V()({},f),{},{type:"workflow",show:!0})})},children:t.formatMessage({id:"app.summary.SelectWorkflow"})})}],Oa=function(){var T=ne()(D()().mark(function f(A,te){var $,ae;return D()().wrap(function(Y){for(;;)switch(Y.prev=Y.next){case 0:return Y.next=2,(0,xe.xT)(A,te);case 2:$=Y.sent,($==null?void 0:$.code)==0&&(De.current=$==null||(ae=$.data)===null||ae===void 0?void 0:ae.app_run_id);case 4:case"end":return Y.stop()}},f)}));return function(A,te){return T.apply(this,arguments)}}(),Pa=function(){var T=ne()(D()().mark(function f(A,te){var $,ae;return D()().wrap(function(Y){for(;;)switch(Y.prev=Y.next){case 0:if(te=="agent"){Y.next=5;break}return Y.next=3,(0,lt.zO)(A);case 3:$=Y.sent,$.code==0&&U($==null||(ae=$.data)===null||ae===void 0?void 0:ae.need_confirm_nodes);case 5:Oa(d,{app_id:A,app_run_id:h,status:1,corrected_parameter:""});case 6:case"end":return Y.stop()}},f)}));return function(A,te){return T.apply(this,arguments)}}(),Ea=function(){F(function(f){return V()(V()({},f),{},{show:!1})})},Ta=function(f){l(!0),L(null),F(function(A){return V()(V()({},A),{},{checkItem:f.checkItem})}),z(x.type),Pa(f.checkItem[0].app_id,x.type),ze.current=f.checkItem[0].app_id,setTimeout(function(){m.current.scrollTo({top:m.current.scrollHeight})},300)},$a=function(f){return f.completed_progress?parseInt(f.completed_progress.slice(0,-1)):!1},La=function(f){var A={user:{value:Za(f)}};me(new va.z(A))},Za=function T(f){return f.map(function(A){return A.type==="mention"?A.id:A.children?T(A.children):A.text}).join("")},Ha=function(){var T=ne()(D()().mark(function f(){var A,te;return D()().wrap(function(ae){for(;;)switch(ae.prev=ae.next){case 0:A=_e==null?void 0:_e.filter(function(B){return B.type=="workflow_run_progress"&&B.data.app_run_id==De.current}).map(function(B){var Y=B.data;return Y}),A&&A.length&&(te=A[A.length-1],P(te),l(!1));case 2:case"end":return ae.stop()}},f)}));return function(){return T.apply(this,arguments)}}(),za=function(){var T=ne()(D()().mark(function f(){var A,te,$,ae,B;return D()().wrap(function(Be){for(;;)switch(Be.prev=Be.next){case 0:te=_e==null?void 0:_e.filter(function(fe){return fe.type=="workflow_need_human_confirm"&&fe.data.app_run_id==De.current}),$=(A=te.map(function(fe){var Ce=fe.data,tt=fe.need_human_confirm;return{data:Ce,need_human_confirm:tt}}))===null||A===void 0?void 0:A.filter(function(fe){return fe.data.type!==1}),$&&$.length&&(B=$[$.length-1].data,B.exec_id=B==null||(ae=B.node_exec_data)===null||ae===void 0?void 0:ae.node_exec_id,ge($[$.length-1]),l(!1));case 3:case"end":return Be.stop()}},f)}));return function(){return T.apply(this,arguments)}}(),Ba=function(){var T=ne()(D()().mark(function f(A){var te,$,ae,B,Y;return D()().wrap(function(fe){for(;;)switch(fe.prev=fe.next){case 0:return l(!0),te=Object.keys(A),$={},te.forEach(function(Ce){Fe.current.properties[Ce]&&(Fe.current.properties[Ce].value=A[Ce]),C&&C.forEach(function(tt){tt.node_id==Ce&&($[Ce]=A[Ce])})}),ae={inputs:Fe.current,node_confirm_users:$,run_name:"chatroom-".concat(d,"-run-").concat(De.current,"-driven"),run_type:1,data_source_run_id:De.current},fe.next=7,(0,lt.UE)(ze.current,ae);case 7:B=fe.sent,B.code==0&&(De.current=B==null||(Y=B.data)===null||Y===void 0?void 0:Y.app_run_id,Ie(!0));case 9:case"end":return fe.stop()}},f)}));return function(A){return T.apply(this,arguments)}}(),Va=function(){var T=ne()(D()().mark(function f(A){var te,$;return D()().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:return l(!0),te=Object.keys(A),te.forEach(function(Y){Fe.current.properties[Y]&&(Fe.current.properties[Y].value=A[Y])}),B.next=5,(0,ha.LH)({agent_id:x.checkItem[0].agent_id,ability_id:0,input_dict:Fe.current,prompt:re,data_source_run_id:De.current});case 5:$=B.sent,$.code==0&&(be($.data.outputs_md),l(!1));case 7:case"end":return B.stop()}},f)}));return function(A){return T.apply(this,arguments)}}(),_e=(0,ct.Z)(function(T){return T.flowMessage});return(0,a.useEffect)(function(){Ha(),za();var T=_e.filter(function(B){return B.data.app_run_id==h&&B.type.indexOf("generate_meeting_action_items")!==-1});if(T.length!=0){var f,A=(f=T[T.length-1])===null||f===void 0||(f=f.data)===null||f===void 0||(f=f.exec_data)===null||f===void 0||(f=f.outputs)===null||f===void 0?void 0:f.value;if(A){var te=JSON.parse(A);Fe.current=te;var $=Object.keys(te.properties);if($.length&&(L(te.properties),H=="agent")){var ae=$.map(function(B){return{value:"<<".concat(ma.qX,".inputs.").concat(B,">>"),label:B}});N(ae)}v(!1),l(!1)}}},[_e]),(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)("div",{className:"pt-[24px]  border-[#ddd]",style:{minHeight:x!=null&&(r=x.checkItem)!==null&&r!==void 0&&r.length?m==null||(c=m.current)===null||c===void 0?void 0:c.offsetHeight:"100%"},children:[(0,e.jsxs)("div",{className:"text-[14px] font-[500] flex item-center",children:[(0,e.jsx)("div",{className:"flex-1",children:t.formatMessage({id:"app.summary.Runapp"})}),(0,e.jsx)("div",{className:"px-[10px]",children:!de&&!ce?(0,e.jsx)(ta.Z,{menu:{items:Aa},children:(0,e.jsx)(ia,{className:"transition cursor-pointer text-[#999] text-[18px] hover:text-[#1B64F3]"})}):(0,e.jsx)(e.Fragment,{})})]}),(0,e.jsx)("div",{children:x!=null&&(b=x.checkItem)!==null&&b!==void 0&&b.length?(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("div",{className:"py-[6px]",children:(0,e.jsx)(qe.Z,{icon:x==null||(S=x.checkItem[0])===null||S===void 0?void 0:S.icon,title:x==null||(p=x.checkItem[0])===null||p===void 0?void 0:p.name,textDetails:x==null||(y=x.checkItem[0])===null||y===void 0?void 0:y.description,iconType:H=="agent"?"robot_icon":"workflow_icon",handleClick:function(){}})}),ce?(0,e.jsx)("div",{className:"max-h-[400px] overflow-y-auto",children:(0,e.jsx)("div",{className:"p-[12px]  bg-[#F7F7F7] leading-[22px]",children:(0,e.jsx)(Se.U,{rehypePlugins:[Ne.Z],children:ce})})}):(0,e.jsx)(e.Fragment,{}),!de&&s!=null?(0,e.jsxs)(da.A,{submitter:{resetButtonProps:!1,submitButtonProps:{className:"w-full"},searchConfig:{submitText:t.formatMessage({id:"workflow.button.run"})}},onFinish:function(f){H=="workflow"?Ba(f):Va(f)},children:[(0,e.jsx)("div",{className:"py-[6px]",children:(0,e.jsx)(xa._,{data:s})}),H=="workflow"?(0,e.jsx)(pa.e,{data:C}):(0,e.jsx)("div",{className:"h-[150px] overflow-y-auto border border-color-[#eee] py-[4px] px-[11px] mb-[8px]",children:(0,e.jsx)(fa.Z,{onChange:function(f){La(f)},options:R})})]}):(0,e.jsx)(e.Fragment,{}),ie&&ie.need_human_confirm!=0?(0,e.jsx)("div",{className:"pt-[12px]",children:(0,e.jsxs)("div",{className:"flex gap-x-[6px] items-center h-[20px] cursor-pointer",onClick:function(){Da(ie.data)},children:[(0,e.jsx)("div",{children:(0,e.jsx)(ua,{className:"text-[#1B64F3] text-[16px]"})}),(0,e.jsx)("span",{children:t.formatMessage({id:"app.summary.backlogTips"})})]})}):(0,e.jsx)(e.Fragment,{}),w?(0,e.jsx)("div",{className:"pt-[10px]",children:(0,e.jsx)(qe.Z,{status:w.status,icon:w.icon,title:w.run_name,textDetails:(0,e.jsx)(ga,{progressObj:w}),handleClick:function(){Ia(w)},progress:$a(w)})}):(0,e.jsx)(e.Fragment,{})]}):(0,e.jsxs)("div",{className:"flex gap-x-[20px] min-h-[70px] items-center px-[20px]",children:[(0,e.jsxs)(he.ZP,{className:"flex-1 text-[14px]",onClick:function(){F(function(f){return V()(V()({},f),{},{type:"agent",show:!0})})},children:[(0,e.jsx)("img",{src:"/icons/robot_icon.svg",alt:"",className:"w-[14px] h-[14px]"}),t.formatMessage({id:"app.summary.SelectAgent"})]}),(0,e.jsxs)(he.ZP,{className:"flex-1 text-[14px]",onClick:function(){F(function(f){return V()(V()({},f),{},{type:"workflow",show:!0})})},children:[(0,e.jsx)("img",{src:"/icons/workflow_icon.svg",alt:"",className:"w-[14px] h-[14px]"}),t.formatMessage({id:"app.summary.SelectWorkflow"})]})]})})]}),(0,e.jsx)(Pe.Z,{show:x.show,nodetype:x.type,popupClose:Ea,popupSave:Ta,checkList:H==x.type?x.checkItem:[],zIndex:99,radio:!0})]})},ya=(0,a.memo)(ja),Sa=function(n){var r=n.setShow,c=n.inputShow,b=n.setBoxLoading,S=n.setAppRunId,p=(0,K.useIntl)(),y=(0,a.useState)(!1),t=u()(y,2),h=t[0],d=t[1],l=(0,a.useState)(""),m=u()(l,2),v=m[0],j=m[1],_=(0,a.useState)(""),s=u()(_,2),L=s[0],J=s[1],Z=(0,a.useRef)(""),C=(0,a.useRef)(""),U=G(function(O){return O.setSummaryClick}),Q=function(){var O=ne()(D()().mark(function I(x){var F,g,k,R,N=arguments;return D()().wrap(function(W){for(;;)switch(W.prev=W.next){case 0:return F=N.length>1&&N[1]!==void 0?N[1]:{app_run_id:"",corrected_parameter:""},W.next=3,(0,xe.Rp)(x,F);case 3:g=W.sent,(g==null?void 0:g.code)==0&&(S(g==null||(k=g.data)===null||k===void 0?void 0:k.app_run_id),C.current=g==null||(R=g.data)===null||R===void 0?void 0:R.app_run_id);case 5:case"end":return W.stop()}},I)}));return function(x){return O.apply(this,arguments)}}(),ee=function(){var O=ne()(D()().mark(function I(x,F){var g,k,R,N,q;return D()().wrap(function(re){for(;;)switch(re.prev=re.next){case 0:return re.next=2,(0,xe.xM)(x,{message:F});case 2:g=re.sent,(g==null?void 0:g.code)==0&&(C.current=g==null||(k=g.data)===null||k===void 0?void 0:k.app_run_id,S(g==null||(R=g.data)===null||R===void 0?void 0:R.app_run_id),g!=null&&(N=g.data)!==null&&N!==void 0&&(N=N.outputs)!==null&&N!==void 0&&N.value&&(j(g==null||(q=g.data)===null||q===void 0||(q=q.outputs)===null||q===void 0?void 0:q.value),r(!0),b(!1),U(!0)));case 4:case"end":return re.stop()}},I)}));return function(x,F){return O.apply(this,arguments)}}(),H=(0,ct.Z)(function(O){return O.flowMessage});(0,a.useEffect)(function(){var O=H.filter(function(F){return F.data.app_run_id==C.current&&F.type.indexOf("generate_meeting_summary")!==-1});if(O.length!=0){var I,x=(I=O[O.length-1])===null||I===void 0||(I=I.data)===null||I===void 0||(I=I.exec_data)===null||I===void 0||(I=I.outputs)===null||I===void 0?void 0:I.value;x&&(j(x),r(!0),U(!0),b(!1))}},[H]);var z=G(function(O){return O.summaryParams});return(0,a.useEffect)(function(){z&&z.id&&(Z.current=z.id,v&&j(""),d(!0),z.message?(b(!0),ee(z.id,z.message)):Q(z.id))},[z]),(0,e.jsx)(e.Fragment,{children:h?(0,e.jsxs)("div",{className:"pb-[16px]",children:[(0,e.jsx)("div",{className:"text-[16px] font-[600] pt-[12px]",children:p.formatMessage({id:"app.summary.title"})}),(0,e.jsx)("div",{className:"text-[14px] pt-[12px] leading-[23px] px-[8px]",children:v?(0,e.jsx)("div",{className:" ".concat("max-h-[400px]"," p-[12px]  bg-[#F7F7F7]  relative overflow-y-auto"),children:(0,e.jsx)(Se.U,{rehypePlugins:[Ne.Z],children:v})}):(0,e.jsx)("div",{className:"min-h-[120px] flex items-center justify-center",children:(0,e.jsx)(ye.Z,{size:"large"})})}),c?(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("div",{className:"pt-[12px]",children:(0,e.jsx)(nt.Z.TextArea,{onChange:function(I){J(I.target.value)},value:L,disabled:!v,rows:4,placeholder:p.formatMessage({id:"app.summary.placeholder"})})}),(0,e.jsx)("div",{className:"flex pt-[12px] gap-x-[4px]",children:(0,e.jsx)(he.ZP,{type:"primary",disabled:!v||!L,className:"bg-[#1B64F3] rounded-[4px] w-[88px] h-[40px] flex-1",onClick:function(){Q(Z.current,{app_run_id:String(C.current),corrected_parameter:L}),b(!0),J(""),r("")},children:p.formatMessage({id:"app.summary.submitText"})})})]}):(0,e.jsx)(e.Fragment,{})]}):(0,e.jsx)(e.Fragment,{})})},Na=(0,a.memo)(Sa),wa=(0,a.memo)(function(i){var n=i.progressObj;console.log(n);var r=function(){return parseFloat(n.elapsed_time).toFixed(6)},c=function(S){var p=new Date(S),y=p.getFullYear(),t=(p.getMonth()+1).toString().padStart(2,"0"),h=p.getDate().toString().padStart(2,"0"),d=p.getHours().toString().padStart(2,"0"),l=p.getMinutes().toString().padStart(2,"0"),m=p.getSeconds().toString().padStart(2,"0");return(0,e.jsx)(e.Fragment,{children:"".concat(y,".").concat(t,".").concat(h," ").concat(d,":").concat(l,":").concat(m)})};return(0,e.jsx)("div",{className:"inline-flex gap-x-4 justify-end max-w-[100%]",children:(0,e.jsxs)("div",{className:"inline-flex gap-x-[20px] max-w-[100%]",children:[(0,e.jsx)("div",{className:"truncate min-w-[70px]",children:n.created_time&&c(n.created_time)}),(0,e.jsx)("div",{className:"truncate",children:n.apps_name||n.app_name}),(0,e.jsxs)("div",{className:"flex items-center gap-x-[7px] truncate min-w-[50px]",children:[(0,e.jsx)("div",{className:"shrink-0 rounded-full ".concat(n.status==1?"bg-blue-600":n.status==2?"bg-green-500":"bg-red-500"),style:{width:"3px",height:"3px"}}),(0,e.jsxs)("div",{className:"truncate",children:[r(),"S"]})]})]})})}),ba=function(n){var r=n.list,c=(0,K.useIntl)(),b=r.reverse(),S=(0,et.Z)(function(t){return t.setRunPanelLogRecord}),p=function(h){var d=new Date(h),l=d.getMonth()+1,m=d.getDate(),v=d.getHours(),j=d.getMinutes(),_=d.getSeconds();return d.getFullYear()+"-"+(l<10?"0"+l:l)+"-"+(m<10?"0"+m:m)+" "+(v<10?"0"+v:v)+":"+(j<10?"0"+j:j)+":"+(_<10?"0"+_:_)},y=function(h){var d=Object.keys(h),l=[];return d.forEach(function(m){l.push(h[m])}),l};return(0,e.jsx)(e.Fragment,{children:(0,e.jsx)("div",{className:"px-4",children:b&&b.length?b.map(function(t){var h,d,l,m,v,j,_,s,L,J,Z,C,U,Q,ee,H,z,O,I;return t!=null&&t.source_run&&t!==null&&t!==void 0&&t.source_run.summary?(0,e.jsx)("div",{className:"pt-[16px] border-b-[1px] border-color-[#eee] ",children:(0,e.jsxs)("div",{className:"pb-[60px]",children:[(0,e.jsx)("div",{className:"text-[16px] font-[600] pb-[8px] flex items-center",children:(0,e.jsx)("span",{className:"flex-1",children:(t==null||(h=t.source_run)===null||h===void 0?void 0:h.name)||c.formatMessage({id:"app.summary.title"})})}),(0,e.jsx)("p",{className:"text-[12px] color-[#eee] mb-[8px]",children:p(t==null||(d=t.source_run)===null||d===void 0?void 0:d.created_time)}),(0,e.jsx)("div",{className:"p-[12px]  bg-[#F7F7F7] leading-[22px]",children:(0,e.jsx)(Se.U,{rehypePlugins:[Ne.Z],children:t==null||(l=t.source_run)===null||l===void 0?void 0:l.summary})}),t!=null&&t.source_corrections&&(t==null?void 0:t.source_corrections.length)>0?(0,e.jsxs)("div",{children:[(0,e.jsxs)("div",{className:"text-[16px] font-[600] py-[8px]",children:[c.formatMessage({id:"app.summaryhistory.orientation"}),":"]}),t==null?void 0:t.source_corrections.map(function(x){return(0,e.jsx)("div",{children:(0,e.jsxs)("div",{className:"p-[12px]  bg-[#F7F7F7] leading-[22px]",children:[(0,e.jsxs)("div",{className:"tetx-[14px] font-[600] pb-[12px]",children:[c.formatMessage({id:"app.summaryhistory.time"}),": ",p(x.created_time)]}),(0,e.jsx)(Se.U,{rehypePlugins:[Ne.Z],children:x==null?void 0:x.corrected_summary})]})},x.created_time)})]}):(0,e.jsx)(e.Fragment,{}),t!=null&&t.target_run?(0,e.jsxs)("div",{className:"py-[12px]",children:[(0,e.jsxs)("div",{className:"text-[16px] font-[600] py-[8px]",children:[c.formatMessage({id:"app.summaryhistory.runapp"}),":"]}),(0,e.jsx)("div",{children:(0,e.jsxs)("div",{className:"text-[14px] py-[6px]",children:[(0,e.jsx)("span",{className:"font-[500] ",children:t!=null&&(m=t.target_run)!==null&&m!==void 0&&m.agent_id?"agent":"workflow"}),(0,e.jsx)("span",{className:"px-[6px]",children:":"}),(0,e.jsx)("span",{children:t==null||(v=t.target_run)===null||v===void 0||(v=v.app)===null||v===void 0?void 0:v.name})]})}),(0,e.jsx)("div",{children:t!=null&&(j=t.target_run)!==null&&j!==void 0&&(j=j.inputs)!==null&&j!==void 0&&j.properties?y(t==null||(_=t.target_run)===null||_===void 0||(_=_.inputs)===null||_===void 0?void 0:_.properties).map(function(x){return(0,e.jsxs)("div",{children:[(0,e.jsxs)("div",{className:"text-[16px] color-[#000] font-[600] py-[12px]",children:[c.formatMessage({id:"app.summaryhistory.input"}),":"]}),(0,e.jsx)("div",{className:"pb-[8px] font-[600]",children:x.name}),(0,e.jsx)("div",{className:"py-[4px] px-[11px] text-[14px] leading-[1.5] h-[]",children:x.value})]})}):(0,e.jsx)(e.Fragment,{})}),(0,e.jsx)("div",{children:t!=null&&(s=t.target_run)!==null&&s!==void 0&&s.raw_user_prompt?(0,e.jsxs)("div",{children:[(0,e.jsxs)("div",{className:"text-[16px] color-[#000] font-[600] py-[12px] pb-[6px]",children:[c.formatMessage({id:"app.summaryhistory.prompt"}),":"]}),(0,e.jsx)("div",{className:"py-[4px] px-[11px] text-[14px] leading-[1.5] ",children:t==null||(L=t.target_run)===null||L===void 0?void 0:L.raw_user_prompt})]}):(0,e.jsx)(e.Fragment,{})}),(0,e.jsxs)("div",{children:[(0,e.jsxs)("div",{className:"text-[16px] font-[600] py-[8px]",children:[c.formatMessage({id:"app.summaryhistory.results"}),":"]}),(0,e.jsx)("div",{className:"p-[12px]  bg-[#F7F7F7]",children:(t==null||(J=t.target_run)===null||J===void 0?void 0:J.agent_id)!=0?(0,e.jsx)("div",{className:"p-[12px]  bg-[#F7F7F7] leading-[22px]",children:(0,e.jsx)(Se.U,{rehypePlugins:[Ne.Z],children:t==null||(Z=t.target_run)===null||Z===void 0||(Z=Z.outputs)===null||Z===void 0?void 0:Z.value})}):(0,e.jsx)(qe.Z,{status:t==null||(C=t.target_run)===null||C===void 0?void 0:C.status,icon:t==null||(U=t.target_run)===null||U===void 0?void 0:U.icon,title:t==null||(Q=t.target_run)===null||Q===void 0?void 0:Q.name,textDetails:(0,e.jsx)(wa,{progressObj:{created_time:t==null||(ee=t.target_run)===null||ee===void 0?void 0:ee.created_time,elapsed_time:t==null||(H=t.target_run)===null||H===void 0?void 0:H.elapsed_time,app_name:t==null||(z=t.target_run)===null||z===void 0?void 0:z.app.name,status:t==null||(O=t.target_run)===null||O===void 0?void 0:O.status}}),handleClick:function(){var F,g,k,R,N,q,W,re,me,se;S({app_id:t==null||(F=t.target_run)===null||F===void 0||(F=F.app)===null||F===void 0?void 0:F.id,app_name:t==null||(g=t.target_run)===null||g===void 0||(g=g.app)===null||g===void 0?void 0:g.name,icon:t==null||(k=t.target_run)===null||k===void 0?void 0:k.icon,workflow_id:t==null||(R=t.target_run)===null||R===void 0?void 0:R.workflow_id,type:2,app_run_id:t==null||(N=t.target_run)===null||N===void 0?void 0:N.id,run_name:t==null||(q=t.target_run)===null||q===void 0?void 0:q.name,status:t==null||(W=t.target_run)===null||W===void 0?void 0:W.status,created_time:t==null||(re=t.target_run)===null||re===void 0?void 0:re.created_time,elapsed_time:t==null||(me=t.target_run)===null||me===void 0?void 0:me.elapsed_time,completed_progress:"".concat(t==null||(se=t.target_run)===null||se===void 0?void 0:se.percentage,"%")})},progress:t==null||(I=t.target_run)===null||I===void 0?void 0:I.percentage})})]})]}):(0,e.jsx)(e.Fragment,{})]})},t.source_run.id):(0,e.jsx)(e.Fragment,{})}):(0,e.jsx)(e.Fragment,{})})})},_a=(0,a.memo)(ba),Ca=function(n){var r,c=n.id,b=(0,a.useState)(""),S=u()(b,2),p=S[0],y=S[1],t=(0,a.useState)(!1),h=u()(t,2),d=h[0],l=h[1],m=(0,a.useState)([]),v=u()(m,2),j=v[0],_=v[1],s=(0,a.useState)(!1),L=u()(s,2),J=L[0],Z=L[1],C=(0,a.useState)(!1),U=u()(C,2),Q=U[0],ee=U[1],H=(0,a.useState)(""),z=u()(H,2),O=z[0],I=z[1],x=(0,a.useState)(!1),F=u()(x,2),g=F[0],k=F[1],R=(0,a.useState)(!1),N=u()(R,2),q=N[0],W=N[1],re=(0,a.useState)(!0),me=u()(re,2),se=me[0],je=me[1],de=(0,a.useRef)(null),Ie=function(){var w=ne()(D()().mark(function P(){var le,E,ie,ge,X=arguments;return D()().wrap(function(ce){for(;;)switch(ce.prev=ce.next){case 0:return le=X.length>0&&X[0]!==void 0?X[0]:!0,ce.next=3,(0,xe.sh)({chatroom_id:c,page:1,page_size:9999});case 3:E=ce.sent,E.code==0&&(E!=null&&(ie=E.data)!==null&&ie!==void 0&&ie.list&&E!==null&&E!==void 0&&(ge=E.data)!==null&&ge!==void 0&&(ge=ge.list)!==null&&ge!==void 0&&ge.length&&(_(E.data.list),l(!0)),le||(setTimeout(function(){var be;de==null||(be=de.current)===null||be===void 0||be.scrollTo({top:de.current.scrollHeight})},200),y(we.id),M({})));case 5:case"end":return ce.stop()}},P)}));return function(){return w.apply(this,arguments)}}();(0,a.useEffect)(function(){Ie()},[c]);var we=G(function(w){return w.summaryParams}),M=G(function(w){return w.setSummaryParams});return(0,a.useEffect)(function(){we&&we.id&&(l(!0),se||je(!0),J&&Z(!1),g&&k(!1),ee(!0),Ie(!1))},[we]),(0,e.jsx)(e.Fragment,{children:d?(0,e.jsxs)(Vt,{minWidth:400,className:"relative h-full right-0 border-0 returned-0 px-[0] ".concat(g?"translate-x-full flex-[0]":""),children:[q?(0,e.jsx)("div",{className:"h-full w-full absolute top-0 left-0 flex justify-center items-center z-20 bg-[rgba(255,255,255,0.5)]",children:(0,e.jsx)(ye.Z,{size:"large"})}):(0,e.jsx)(e.Fragment,{}),(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("div",{onClick:function(){k(function(P){return!P})},className:`
                                        `.concat(g?"right-[100%] top-[4px]":"right-[6px] top-[60px]",`
                                        fixed w-[40px] h-[40px]  flex justify-center items-center cursor-pointer z-[99]
                                    `),children:g?(0,e.jsx)(ea,{className:"text-[20px]"}):(0,e.jsx)(Jt,{className:"text-[20px]"})}),(0,e.jsx)("div",{className:"h-full overflow-y-auto flex flex-col-reverse scroll-smooth",ref:de,children:(0,e.jsxs)("div",{children:[j.length?(0,e.jsx)(_a,{list:j}):(0,e.jsx)(e.Fragment,{}),(0,e.jsxs)("div",{className:"w-full px-4 h-full",style:{minHeight:Q?de==null||(r=de.current)===null||r===void 0?void 0:r.offsetHeight:"100%"},children:[(0,e.jsx)(Na,{setShow:Z,inputShow:se,setBoxLoading:W,setAppRunId:I}),J?(0,e.jsx)(ya,{id:p,runid:O,setBoxLoading:W,scrollDom:de,setinputShow:je}):(0,e.jsx)(e.Fragment,{})]})]})})]})]}):(0,e.jsx)(e.Fragment,{})})},Ra=(0,a.memo)(Ca),Ma=function(n){return(0,e.jsx)("div",{className:"flex items-center h-full justify-center",children:(0,e.jsx)(Re.Z,{image:Re.Z.PRESENTED_IMAGE_SIMPLE})})},ka=(0,a.memo)(function(){var i=(0,K.useParams)(),n=i.id,r=(0,a.useRef)([]),c=(0,a.useRef)(null),b=(0,a.useState)(!1),S=u()(b,2),p=S[0],y=S[1],t=function(){var h=ne()(D()().mark(function d(){var l;return D()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(!n){v.next=5;break}return v.next=3,(0,xe.cH)({id:n});case 3:l=v.sent,l.code==0?(y(!0),c.current=l.data,r.current=l.data.agent_list):K.history.replace("/meeting");case 5:case"end":return v.stop()}},d)}));return function(){return h.apply(this,arguments)}}();return(0,a.useEffect)(function(){t()},[]),(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)("div",{className:"w-full flex bg-[#fff] overflow-hidden",style:{height:"calc(100vh - 56px)"},children:[(0,e.jsx)(dt,{roomDetail:c.current,setAgent:r}),(0,e.jsx)("div",{className:"flex-1",children:p?(0,e.jsx)(Ht,{agentList:r}):(0,e.jsx)(Ma,{})}),(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(Ra,{id:n})})]})})}),Fa=ka}}]);
