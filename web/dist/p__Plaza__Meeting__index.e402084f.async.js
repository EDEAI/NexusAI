"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[979],{52700:function(Ue,ae,t){t.r(ae),t.d(ae,{default:function(){return Ie}});var pe=t(97857),r=t.n(pe),xe=t(15009),j=t.n(xe),ue=t(99289),I=t.n(ue),me=t(5574),y=t.n(me),T=t(43722),he=t(72406),se=t(32332),fe=t(82114),ge=t(3471),Q=t(35312),O=t(15746),re=t(2453),ve=t(17788),je=t(72269),Ne=t(83159),q=t(71230),ne=t(32983),ye=t(74330),u=t(67294),Ce=t(19632),Me=t.n(Ce),Se=t(28508),le=t(26915),G=t(40741),be=t(37804),ie=t(28036),we=t(96486),Fe=t(92004),e=t(85893),Re=le.Z.TextArea,Ze=function(l){var a=(0,Q.useIntl)(),w=l.show,d=l.id,E=l.close,H=l.save,v=l.isUpdata,z=G.Z.useForm(),$=y()(z,1),F=$[0],C=(0,u.useRef)(!1),R=(0,Q.useLocation)(),V=(0,u.useRef)(null),Y=re.ZP.useMessage(),A=y()(Y,2),L=A[0],U=A[1],N=(0,u.useState)({name:"",description:"",max_round:10,agent:[]}),m=y()(N,2),s=m[0],c=m[1],M=(0,u.useState)([]),k=y()(M,2),S=k[0],J=k[1],Z=(0,u.useRef)(!1),_=(0,we.throttle)(function(){var p=I()(j()().mark(function x(P){var f,b;return j()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!Z.current){n.next=2;break}return n.abrupt("return");case 2:if(Z.current=!0,f=S.map(function(ce){var ze=ce.agent_id,de=ce.active,$e=de===void 0?1:de;return{agent_id:ze,active:$e}}),s.name){n.next=7;break}return Z.current=!1,n.abrupt("return");case 7:if(f.length!=0){n.next=11;break}return Z.current=!1,L.open({type:"error",content:a.formatMessage({id:"app.create_chatroom.label_4_tips"})}),n.abrupt("return");case 11:if(c(r()(r()({},s),{},{agent:f})),L.open({key:"create",type:"loading",content:"Loading..."}),C.current){n.next=19;break}return n.next=16,(0,T.dB)(r()(r()({},s),{},{agent:f}));case 16:n.t0=n.sent,n.next=22;break;case 19:return n.next=21,(0,T.sI)(r()(r()({},s),{},{agent:f}),d);case 21:n.t0=n.sent;case 22:b=n.t0,b.code==0&&(L.open({key:"create",type:"success",content:C.current?a.formatMessage({id:"app.edit_chatroom.succeed"}):a.formatMessage({id:"app.create_chatroom.succeed"}),duration:2}),H(!0),te()),Z.current=!1;case 25:case"end":return n.stop()}},x)}));return function(x){return p.apply(this,arguments)}}(),300),ee=(0,u.useState)(!1),X=y()(ee,2),o=X[0],h=X[1],g=function(x){var P={};return x.slice(1).split("&").forEach(function(f){var b=f.split("=");P[b[0]]=b[1]}),P},i=function(){var p=I()(j()().mark(function x(P){var f,b;return j()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,T.cH)({id:P});case 2:f=n.sent,f.code==0&&(b=f.data.chat_info,c(r()(r()({},s),{},{name:b.name,description:b.description,max_round:f.data.max_round?f.data.max_round:10,agent:f.data.agent_list})),J(f.data.agent_list));case 4:case"end":return n.stop()}},x)}));return function(P){return p.apply(this,arguments)}}(),K=function(){h(!0)},oe=function(){h(!1)},B=function(x){J(Me()(x.checkAgent))},D=function(){C.current=!1,v&&d!=0&&(C.current=!0,i(d))},te=function(){F.setFieldsValue({Title:"",Description:"",MaxRound:10}),c(r()(r()({},s),{},{name:"",description:"",max_round:10,agent:[]})),J([]),Z.current=!1,E()};return(0,u.useEffect)(function(){w&&D()},[w]),(0,u.useEffect)(function(){F.setFieldsValue({Title:s.name,Description:s.description,MaxRound:s.max_round})},[s,F]),(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)("div",{ref:V,className:"w-full h-full fixed top-[0] left-[0] bg-[rgba(0,0,0,0.5)] flex items-center justify-center z-20",children:[(0,e.jsxs)("div",{className:"w-[980px] h-[646px] bg-[#fff] rounded-[6px]",children:[U,(0,e.jsx)("div",{className:"w-full flex relative",style:{height:"100%"},children:(0,e.jsx)("div",{className:"w-full relative box-border flex-1",style:{height:"100%"},children:(0,e.jsx)(G.Z,{form:F,className:"h-full",initialValues:{Title:s.name,Description:s.description,MaxRound:s.max_round},children:(0,e.jsxs)("div",{className:"flex flex-col h-full",children:[(0,e.jsxs)("div",{className:"text-[16px] flex items-center p-[20px]",style:{borderBottom:"1px solid #ebebeb"},children:[(0,e.jsx)("span",{className:"flex-1 text-[14px] font-[500] text-[#213044]",children:C.current?a.formatMessage({id:"app.edit_chatroom.title"}):a.formatMessage({id:"app.create_chatroom.title"})}),(0,e.jsx)(Se.Z,{className:"text-[16px] cursor-pointer",onClick:te})]}),(0,e.jsx)("div",{className:"flex-1 min-h-[0] overflow-auto",children:(0,e.jsxs)("div",{className:"pt-[20px] px-[20px]",children:[(0,e.jsxs)("div",{className:"text-[12px] text-[#213044]",children:[(0,e.jsx)("span",{style:{color:"red",paddingRight:"4px"},children:"*"}),a.formatMessage({id:"app.create_chatroom.label_1"})]}),(0,e.jsx)("div",{className:"pt-[15px]",children:(0,e.jsx)(G.Z.Item,{name:"Title",rules:[{required:!0,message:a.formatMessage({id:"app.create_chatroom.label_1_tips"})}],style:{marginBottom:"0px"},children:(0,e.jsx)(le.Z,{placeholder:a.formatMessage({id:"app.create_chatroom.label_1_pl"}),maxLength:20,style:{height:40,background:"#F7F7F7"},className:"placeholder:text-[#bbb] placeholder:text-[12px] h-[40px] border-[#eee] text-[#213044]",onChange:function(x){c(r()(r()({},s),{},{name:x.target.value}))}})})}),(0,e.jsx)("div",{className:"text-[12px] text-[#213044] pt-[20px]",children:a.formatMessage({id:"app.create_chatroom.label_2"})}),(0,e.jsx)("div",{className:"pt-[10px]",children:(0,e.jsx)(G.Z.Item,{name:"Description",style:{marginBottom:"0px"},children:(0,e.jsx)(Re,{showCount:!0,maxLength:100,placeholder:a.formatMessage({id:"app.create_chatroom.label_2_pl"}),value:s.description,style:{height:57,resize:"none",background:"#F7F7F7"},className:"placeholder:text-[#bbb] placeholder:text-[12px] h-[40px] border-[#eee] text-[#213044]",onChange:function(x){c(r()(r()({},s),{},{description:x.target.value}))}})})}),(0,e.jsxs)("div",{className:"text-[12px] text-[#213044] pt-[20px]",children:[(0,e.jsx)("span",{style:{color:"red",paddingRight:"4px"},children:"*"}),a.formatMessage({id:"app.create_chatroom.label_3"})]}),(0,e.jsx)("div",{className:"pt-[10px]",children:(0,e.jsx)(G.Z.Item,{name:"MaxRound",rules:[{required:!0,message:a.formatMessage({id:"app.create_chatroom.label_3_tips"})}],style:{marginBottom:"0px"},children:(0,e.jsx)(be.Z,{min:10,step:1,max:100,size:"large",style:{background:"#F7F7F7"},className:"placeholder:text-[#bbb] placeholder:text-[12px]  border-[#eee] text-[#213044] w-full",onChange:function(x){c(r()(r()({},s),{},{max_round:x}))},formatter:function(x){return x!==void 0?Math.floor(x).toString():s.max_round.toString()}})})}),(0,e.jsxs)("div",{className:"text-[14px]  pt-[20px] flex",children:[(0,e.jsx)("span",{style:{color:"red",paddingRight:"4px"},children:"*"}),(0,e.jsx)("span",{className:"text-[12px] text-[#213044]",children:a.formatMessage({id:"app.create_chatroom.label_4"})})]}),(0,e.jsx)("div",{className:"pt-[15px] pb-[20px] overflow-hidden w-full",children:(0,e.jsxs)(q.Z,{gutter:[15,15],children:[(0,e.jsx)(O.Z,{span:6,children:(0,e.jsx)("div",{className:"text-[12px] text-[#BBBBBB] h-[62px] rounded-[4px] bg-[#F7F7F7] leading-[62px] text-center cursor-pointer",onClick:K,style:{border:"1px solid #EEEEEE"},children:a.formatMessage({id:"app.create_chatroom.add_button"})})}),S&&S.length?S.map(function(p){return(0,e.jsx)(O.Z,{span:6,children:(0,e.jsxs)("div",{className:"bg-[#fff] flex gap-x-[20px] p-[10px] cursor-pointer border-solid border-[1px] rounded-[4px] border-[#eee]",children:[(0,e.jsx)("div",{className:"w-[40px] h-[40px] bg-[#F4F8F1] rounded-[6px] relative flex items-center justify-center shrink-0",children:(0,e.jsx)("img",{src:(0,se.s9)("single",p.icon),alt:"",className:"w-[20px]  h-[20px]"})}),(0,e.jsxs)("div",{className:"flex flex-col gap-y-[5px] justify-center flex-1 min-w-[0]",children:[(0,e.jsx)("div",{className:"text-[#213044] text-[12px] font-[500] w-full truncate",children:p.name}),(0,e.jsx)("div",{className:"text-[#999] text-[12px] w-full truncate",children:p.description})]})]})},p.agent_id)}):(0,e.jsx)(e.Fragment,{})]})})]})}),(0,e.jsxs)("div",{className:"p-[20px] flex gap-x-[20px] justify-end",style:{borderTop:"1px solid #e8e8e8"},children:[(0,e.jsx)(ie.ZP,{className:"text-[14px] text-[#213044] w-[88px] h-[40px]",style:{border:"1px solid #D8D8D8"},onClick:te,children:a.formatMessage({id:"app.create_chatroom.cancel"})}),(0,e.jsx)(ie.ZP,{type:"primary",className:"bg-[#1B64F3] rounded-[4px] w-[88px] h-[40px]",htmlType:"submit",onClick:_,children:a.formatMessage({id:"app.create_chatroom.save"})})]})]})})})})]}),o?(0,e.jsx)(Fe.Z,{show:o,popupClose:oe,popupSave:B,checkList:S}):(0,e.jsx)(e.Fragment,{})]})})},Ee=Ze,Ae=function(l){return(0,e.jsx)(O.Z,{className:"gutter-row",xs:24,sm:24,md:12,lg:8,xl:6,children:(0,e.jsxs)("div",{className:"h-[236px] rounded-[8px] bg-[#EFF0F2] flex flex-col items-center justify-center gap-y-[10px] cursor-pointer",style:{border:"1px solid #E9E9E9"},onClick:function(){l.setCreateShow(!0),l.isUpdataChatRoom.current=!1,l.upDataId.current=0},children:[(0,e.jsx)("img",{src:"/icons/plaza_m2_c2.svg",className:"w-[42px] h-[42px]",alt:""}),(0,e.jsx)("span",{className:"text-[#213044] text-[12px]",children:l.intl.formatMessage({id:"app.chatroom_list.create"})})]})})},Le=function(l){var a=l.item,w=l.resetList,d=l.setCreateShow,E=l.isUpdataChatRoom,H=l.upDataId,v=l.intl,z=re.ZP.useMessage(),$=y()(z,2),F=$[0],C=$[1],R=ve.Z.confirm,V=function(){R({title:v.formatMessage({id:"app.chatroom.del.title"}),icon:(0,e.jsx)(fe.Z,{}),content:v.formatMessage({id:"app.chatroom.del.tips"}),okText:v.formatMessage({id:"app.chatroom.del.confirm"}),okType:"danger",cancelText:v.formatMessage({id:"app.chatroom.del.cancel"}),onOk:function(){Y()}})},Y=function(){var N=I()(j()().mark(function m(){var s;return j()().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:return M.next=2,(0,T.Gn)({id:a.chatroom_id});case 2:s=M.sent,s.code==0&&(F.open({key:"del",type:"success",content:v.formatMessage({id:"app.chatroom.del.delsuccess"}),duration:10}),w(a.chatroom_id));case 4:case"end":return M.stop()}},m)}));return function(){return N.apply(this,arguments)}}(),A=function(){var N=I()(j()().mark(function m(){return j()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:d(!0),E.current=!0,H.current=a.chatroom_id;case 3:case"end":return c.stop()}},m)}));return function(){return N.apply(this,arguments)}}(),L=[{key:"1",label:(0,e.jsx)("div",{className:"py-[3px] px-[3px]",children:(0,e.jsxs)("div",{className:"flex gap-x-[5px] text-[12px] text-[#213044] items-center p-y-[8]",onClick:A,children:[(0,e.jsx)("img",{src:"/icons/edit_icon.svg",className:"w-[16px] h-[16px]"}),(0,e.jsx)("span",{children:v.formatMessage({id:"app.chatroom_list.fun_button_1"})})]})})},{key:"2",label:(0,e.jsx)("div",{className:"py-[3px] px-[3px]",children:(0,e.jsxs)("div",{className:"flex gap-x-[5px] text-[12px] text-[#E12222] items-center",onClick:V,children:[(0,e.jsx)("img",{src:"/icons/delete_icon.svg",className:"w-[16px] h-[16px]"}),(0,e.jsx)("span",{children:v.formatMessage({id:"app.chatroom_list.fun_button_2"})})]})})}],U=function(){var N=I()(j()().mark(function m(){return j()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,(0,T.r5)({smart_selection:a.smart_selection==1?0:1},a.chatroom_id);case 2:w(a.chatroom_id,a.smart_selection==1?0:1);case 3:case"end":return c.stop()}},m)}));return function(){return N.apply(this,arguments)}}();return(0,e.jsxs)(e.Fragment,{children:[C,(0,e.jsxs)("div",{className:"flex  items-center",children:[(0,e.jsxs)("div",{className:"flex gap-x-[6px] items-center flex-1",children:[(0,e.jsx)("span",{className:"text-[12px] text-[#666] line",children:v.formatMessage({id:"app.chatroom_list.switch"})}),(0,e.jsx)(je.Z,{size:"small",value:a.smart_selection==1,onChange:U})]}),(0,e.jsx)(Ne.Z,{menu:{items:L},placement:"topRight",className:"cursor-pointer",children:(0,e.jsx)("div",{className:"w-[18px] h-[18px] bg-[#ebebeb] rounded-[4px] flex justify-center items-center",children:(0,e.jsx)(ge.Z,{className:"hover:text-[#1B64F3]",style:{fontSize:"14px"}})})})]})]})},Be=function(){var l=(0,Q.useIntl)(),a=(0,u.useState)(null),w=y()(a,2),d=w[0],E=w[1],H=(0,u.useState)(!1),v=y()(H,2),z=v[0],$=v[1],F=(0,u.useState)({page:1,page_size:20,name:""}),C=y()(F,2),R=C[0],V=C[1],Y=(0,u.useState)(!0),A=y()(Y,2),L=A[0],U=A[1],N=(0,u.useRef)(!1),m=(0,u.useRef)(0),s=(0,u.useState)(!1),c=y()(s,2),M=c[0],k=c[1],S=function(){var o=I()(j()().mark(function h(){var g,i,K=arguments;return j()().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:return g=K.length>0&&K[0]!==void 0?K[0]:!1,B.next=3,(0,T.vu)(R);case 3:i=B.sent,g&&$(!0),i.code==0&&(U(i.data.total_pages>R.page),i.data.total_pages>=R.page&&!g&&(i.data.list=d.list.concat(i.data.list)),i.data.list&&i.data.list.length&&i.data.list.forEach(function(D){D.agent_list&&D.agent_list.length&&(D.agent_list.length=D.agent_list.length>6?6:D.agent_list.length)}),E(i.data));case 6:case"end":return B.stop()}},h)}));return function(){return o.apply(this,arguments)}}();(0,u.useEffect)(function(){S(!0),U(!0)},[]);var J=function(h){V(function(g){return r()(r()({},g),{},{page:R.page++})}),S()},Z=function(h){var g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0;d&&d.list.length&&(g!=null?E(r()(r()({},d),{},{list:d.list.map(function(i){return r()(r()({},i),{},{smart_selection:i.chatroom_id===h?g:i.smart_selection})})})):E(r()(r()({},d),{},{list:d.list.filter(function(i){return i.chatroom_id!==h})})))},_=function(h){Q.history.push("/chat_room/".concat(h.chatroom_id))},ee=function(){k(!1)},X=function(h){h&&S(!0)};return(0,e.jsx)("div",{className:"pt-0 w-full",id:"Meeting",style:{height:"calc(100vh - 94px)",overflowY:"auto"},children:(0,e.jsx)(he.Z,{dataLength:d&&d.list.length,elid:"Meeting",ishasMore:L,upSlide:J,isFooter:!0,pageNumber:R.page,children:(0,e.jsx)("div",{className:"px-[30px] pt-[30px]",children:(0,e.jsxs)(q.Z,{gutter:[20,20],style:{margin:0},children:[z&&(0,e.jsx)(Ae,{setCreateShow:k,isUpdataChatRoom:N,intl:l,upDataId:m}),d&&d.list.length?d.list.map(function(o,h){return(0,e.jsx)(O.Z,{className:"gutter-row",xs:24,sm:24,md:12,lg:8,xl:6,xxl:6,children:(0,e.jsx)("div",{className:"relative h-[236px] rounded-[8px] cursor-pointer shadow-lg shadow-gray-100 hover:shadow-gray-200",onClick:function(){_(o)},children:(0,e.jsxs)("div",{className:"bg-[#fff] rounded-[8px] h-full",style:{boxShadow:"0px 2px 4px 0px rgba(0,0,0,0.05)"},children:[(0,e.jsxs)("div",{className:"flex pt-[20px] pb-[15px] px-[20px] text-[#213044] text-[14px] font-[500] gap-x-[6px]",children:[(0,e.jsx)("span",{className:"flex-1 min-w-[0px] truncate",children:o.name}),(0,e.jsxs)("div",{className:"flex gap-x-[5px] items-center",children:[(0,e.jsx)("img",{src:"".concat(o.active==0?"/icons/plaza_m2_c2.svg":"/icons/plaza_m2_c1.svg"),className:"w-[14px] h-[14px]"}),(0,e.jsx)("span",{className:"text-[12px]",children:o.active==0?(0,e.jsx)("span",{className:"text-[#aaa]",children:l.formatMessage({id:"app.chatroom_list.status"})}):(0,e.jsx)("span",{className:"text-[#1B64F3]",children:l.formatMessage({id:"app.chatroom_list.status_succeed"})})})]})]}),(0,e.jsxs)("div",{children:[(0,e.jsx)("div",{className:"px-[20px]",children:(0,e.jsxs)("div",{style:{borderBottom:"1px solid #eee"},children:[o.description?(0,e.jsx)("div",{className:"text-[#666666] text-[12px] font-[400] w-full truncate min-h-[14px]",children:o.description}):(0,e.jsx)(e.Fragment,{}),(0,e.jsx)("div",{className:"py-[20px] h-[115px] overflow-hidden",children:o.agent_list&&o.agent_list.length?(0,e.jsx)(q.Z,{gutter:[20,18],children:o.agent_list.map(function(g,i){return(0,e.jsx)(O.Z,{md:12,lg:12,xl:12,xxl:8,children:(0,e.jsxs)("div",{className:"flex gap-x-[10px] items-center",children:[(0,e.jsx)("div",{className:"w-[30px] h-[30px] shrink-0 flex items-center rounded-[6px] justify-center bg-[#F4F8F1]",children:(0,e.jsx)("img",{src:(0,se.s9)("single",g.icon),alt:"",className:"w-[18px]  h-[18px]"})}),(0,e.jsx)("div",{className:"text-[#666] text-[12px] truncate",children:g.name})]})},i)})}):(0,e.jsx)(ne.Z,{style:{margin:"0px",fontSize:"12px"},imageStyle:{width:"60px",margin:"0 auto",marginBottom:"2px"},description:l.formatMessage({id:"app.dashboard.None"}),image:ne.Z.PRESENTED_IMAGE_SIMPLE})})]})}),(0,e.jsx)("div",{className:"pt-[15px] pb-[16px] px-[20px]",onClick:function(i){return i.stopPropagation(),!1},children:(0,e.jsx)(Le,{item:o,resetList:Z,setCreateShow:k,isUpdataChatRoom:N,upDataId:m,intl:l})})]})]})})},h)}):(0,e.jsx)(e.Fragment,{children:!z&&(0,e.jsx)("div",{className:"w-full h-full flex items-center justify-center ",style:{height:"calc(100vh - 300px)"},children:(0,e.jsx)(ye.Z,{size:"large"})})}),M?(0,e.jsx)(Ee,{show:M,id:m.current,close:ee,save:X,isUpdata:N.current}):(0,e.jsx)(e.Fragment,{})]})})})})},De=function(){return(0,e.jsx)(e.Fragment,{children:(0,e.jsx)("div",{className:"w-full",children:(0,e.jsx)(Be,{})})})},Ie=De}}]);
