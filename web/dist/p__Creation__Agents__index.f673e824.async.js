"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[178],{83510:function(ta,Qe,n){n.d(Qe,{LK:function(){return qe},bs:function(){return De},go:function(){return ht},uy:function(){return Re}});var mt=n(15009),ye=n.n(mt),ft=n(99289),Y=n.n(ft),ze=n(47520),je="/v1/apps/apps_list",pt="/v1/agent/agent_delete/",a="/v1/workflow/workflow_app_delete/",gt="/v1/vector/delete_dataset/",z="/v1/skill/delete_skill_by_app_id/",ve="/v1/apps/apps_create",vt="/v1/apps/app_update/",ht=function(){var _e=Y()(ye()().mark(function ce(Q){var ue;return ye()().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return w.next=2,(0,ze.ZP)("".concat(je),{method:"GET",data:Q});case 2:return ue=w.sent,w.abrupt("return",ue);case 4:case"end":return w.stop()}},ce)}));return function(Q){return _e.apply(this,arguments)}}(),qe=function(){var _e=Y()(ye()().mark(function ce(Q){var ue;return ye()().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return console.log(Q),w.next=3,Q.mode;case 3:if(w.t0=w.sent,w.t0!=1){w.next=8;break}w.t1=(0,ze.ZP)("".concat(pt).concat(Q.app_id),{method:"DELETE"}),w.next=9;break;case 8:w.t1=Q.mode==2?(0,ze.ZP)("".concat(a).concat(Q.app_id),{method:"DELETE"}):Q.mode==3?(0,ze.ZP)("".concat(gt).concat(Q.app_id),{method:"DELETE"}):(0,ze.ZP)("".concat(z).concat(Q.app_id),{method:"DELETE",data:{is_soft:1}});case 9:return ue=w.t1,w.abrupt("return",ue);case 11:case"end":return w.stop()}},ce)}));return function(Q){return _e.apply(this,arguments)}}(),Re=function(){var _e=Y()(ye()().mark(function ce(Q){var ue;return ye()().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return w.next=2,(0,ze.ZP)("".concat(ve),{method:"POST",data:Q});case 2:return ue=w.sent,w.abrupt("return",ue);case 4:case"end":return w.stop()}},ce)}));return function(Q){return _e.apply(this,arguments)}}(),De=function(){var _e=Y()(ye()().mark(function ce(Q){var ue;return ye()().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return w.next=2,(0,ze.ZP)("".concat(vt).concat(Q.app_id),{method:"PUT",data:Q});case 2:return ue=w.sent,w.abrupt("return",ue);case 4:case"end":return w.stop()}},ce)}));return function(Q){return _e.apply(this,arguments)}}()},10631:function(ta,Qe,n){n.r(Qe),n.d(Qe,{default:function(){return ss}});var mt=n(19632),ye=n.n(mt),ft=n(15009),Y=n.n(ft),ze=n(99289),je=n.n(ze),pt=n(97857),a=n.n(pt),gt=n(5574),z=n.n(gt),ve=n(11551),vt=n(83510),ht=n(47520),qe=n(29432),Re=n(10759),De=n(32332),_e=n(2068),ce=n(89035),Q=n(15360),ue=n(82826),Ge=n(69243),w=n(35312),U=n(40741),ae=n(45360),Pe=n(28036),aa=n(50136),l=n(67294),sa=n(93967),Oe=n.n(sa);const na=(0,l.forwardRef)((i,s)=>{const{prefixCls:N,className:o,children:d,size:u,style:c={}}=i,B=Oe()(`${N}-panel`,{[`${N}-panel-hidden`]:u===0},o),j=u!==void 0;return l.createElement("div",{ref:s,className:B,style:Object.assign(Object.assign({},c),{flexBasis:j?u:"auto",flexGrow:j?0:1})},d)});var ia=()=>null,la=n(9220),et=n(66680),ra=n(53124),oa=n(35792),da=n(50344),ca=function(i,s){var N={};for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&s.indexOf(o)<0&&(N[o]=i[o]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var d=0,o=Object.getOwnPropertySymbols(i);d<o.length;d++)s.indexOf(o[d])<0&&Object.prototype.propertyIsEnumerable.call(i,o[d])&&(N[o[d]]=i[o[d]]);return N};function ua(i){if(i&&typeof i=="object")return i;const s=!!i;return{start:s,end:s}}function ma(i){return l.useMemo(()=>(0,da.Z)(i).filter(l.isValidElement).map(N=>{const{props:o}=N,{collapsible:d}=o,u=ca(o,["collapsible"]);return Object.assign(Object.assign({},u),{collapsible:ua(d)})}),[i])}function fa(i,s){return l.useMemo(()=>{const N=[];for(let o=0;o<i.length-1;o+=1){const d=i[o],u=i[o+1],c=s[o],B=s[o+1],{resizable:j=!0,min:t,collapsible:_}=d,{resizable:$=!0,min:f,collapsible:g}=u,x=j&&$&&(c!==0||!t)&&(B!==0||!f),P=_.end&&c>0||g.start&&B===0&&c>0,R=g.start&&B>0||_.end&&c===0&&B>0;N[o]={resizable:x,startCollapsible:!!P,endCollapsible:!!R}}return N},[s,i])}var pa=n(74902);function tt(i){return Number(i.slice(0,-1))/100}function xt(i){return typeof i=="string"&&i.endsWith("%")}function ga(i,s){const N=i.map(x=>x.size),o=i.length,d=s||0,u=x=>x*d,[c,B]=l.useState(()=>i.map(x=>x.defaultSize)),j=l.useMemo(()=>{var x;const P=[];for(let R=0;R<o;R+=1)P[R]=(x=N[R])!==null&&x!==void 0?x:c[R];return P},[o,c,N]),t=l.useMemo(()=>{let x=[],P=0;for(let D=0;D<o;D+=1){const p=j[D];if(xt(p))x[D]=tt(p);else if(p||p===0){const H=Number(p);Number.isNaN(H)||(x[D]=H/d)}else P+=1,x[D]=void 0}const R=x.reduce((D,p)=>D+(p||0),0);if(R>1||!P){const D=1/R;x=x.map(p=>p===void 0?0:p*D)}else{const D=(1-R)/P;x=x.map(p=>p===void 0?D:p)}return x},[j,d]),_=l.useMemo(()=>t.map(u),[t,d]),$=l.useMemo(()=>i.map(x=>xt(x.min)?tt(x.min):(x.min||0)/d),[i,d]),f=l.useMemo(()=>i.map(x=>xt(x.max)?tt(x.max):(x.max||d)/d),[i,d]);return[l.useMemo(()=>s?_:j,[_,s]),_,t,$,f,B]}function va(i,s,N,o,d){const u=i.map(p=>[p.min,p.max]),c=o||0,B=p=>p*c;function j(p,H){return typeof p=="string"?B(tt(p)):p!=null?p:H}const[t,_]=l.useState([]),[$,f]=l.useState(null),g=()=>N.map(B);return[p=>{_(g()),f({index:p,confirmed:!1})},(p,H)=>{var W;let v=null;if((!$||!$.confirmed)&&H!==0){if(H>0)v=p,f({index:p,confirmed:!0});else for(let V=p;V>=0;V-=1)if(t[V]>0&&s[V].resizable){v=V,f({index:V,confirmed:!0});break}}const Z=(W=v!=null?v:$==null?void 0:$.index)!==null&&W!==void 0?W:p,I=(0,pa.Z)(t),m=Z+1,se=j(u[Z][0],0),G=j(u[m][0],0),F=j(u[Z][1],c),X=j(u[m][1],c);let k=H;return I[Z]+k<se&&(k=se-I[Z]),I[m]-k<G&&(k=I[m]-G),I[Z]+k>F&&(k=F-I[Z]),I[m]-k>X&&(k=I[m]-X),I[Z]+=k,I[m]-=k,d(I),I},()=>{f(null)},(p,H)=>{const W=g(),v=H==="start"?p:p+1,Z=H==="start"?p+1:p,I=W[v],m=W[Z];if(I!==0&&m!==0)W[v]=0,W[Z]+=I;else{const se=I+m,G=j(u[v][0],0),F=j(u[v][1],c),X=j(u[Z][0],0),k=j(u[Z][1],c),V=Math.max(G,se-k),Se=(Math.min(F,se-X)-V)/2;W[v]-=Se,W[Z]+=Se}return d(W),W},$==null?void 0:$.index]}var ha=n(13622),xa=n(62946),ba=n(62994),ya=n(25494);function bt(i){return typeof i=="number"&&!Number.isNaN(i)?Math.round(i):0}var ja=i=>{const{prefixCls:s,vertical:N,index:o,active:d,ariaNow:u,ariaMin:c,ariaMax:B,resizable:j,startCollapsible:t,endCollapsible:_,onOffsetStart:$,onOffsetUpdate:f,onOffsetEnd:g,onCollapse:x}=i,P=`${s}-bar`,[R,D]=(0,l.useState)(null),p=Z=>{j&&Z.currentTarget&&(D([Z.pageX,Z.pageY]),$(o))},H=Z=>{if(j&&Z.touches.length===1){const I=Z.touches[0];D([I.pageX,I.pageY]),$(o)}};l.useEffect(()=>{if(R){const Z=G=>{const{pageX:F,pageY:X}=G,k=F-R[0],V=X-R[1];f(o,k,V)},I=()=>{D(null),g()},m=G=>{if(G.touches.length===1){const F=G.touches[0],X=F.pageX-R[0],k=F.pageY-R[1];f(o,X,k)}},se=()=>{D(null),g()};return window.addEventListener("touchmove",m),window.addEventListener("touchend",se),window.addEventListener("mousemove",Z),window.addEventListener("mouseup",I),()=>{window.removeEventListener("mousemove",Z),window.removeEventListener("mouseup",I),window.removeEventListener("touchmove",m),window.removeEventListener("touchend",se)}}},[R]);const W=N?ya.Z:xa.Z,v=N?ha.Z:ba.Z;return l.createElement("div",{className:P,role:"separator","aria-valuenow":bt(u),"aria-valuemin":bt(c),"aria-valuemax":bt(B)},l.createElement("div",{className:Oe()(`${P}-dragger`,{[`${P}-dragger-disabled`]:!j,[`${P}-dragger-active`]:d}),onMouseDown:p,onTouchStart:H}),t&&l.createElement("div",{className:Oe()(`${P}-collapse-bar`,`${P}-collapse-bar-start`),onClick:()=>x(o,"start")},l.createElement(W,{className:Oe()(`${P}-collapse-icon`,`${P}-collapse-start`)})),_&&l.createElement("div",{className:Oe()(`${P}-collapse-bar`,`${P}-collapse-bar-end`),onClick:()=>x(o,"end")},l.createElement(v,{className:Oe()(`${P}-collapse-icon`,`${P}-collapse-end`)})))},Sa=n(14747),wa=n(83559);const Na=i=>{const{componentCls:s}=i;return{[`&-rtl${s}-horizontal`]:{[`> ${s}-bar`]:{[`${s}-bar-collapse-previous`]:{insetInlineEnd:0,insetInlineStart:"unset"},[`${s}-bar-collapse-next`]:{insetInlineEnd:"unset",insetInlineStart:0}}},[`&-rtl${s}-vertical`]:{[`> ${s}-bar`]:{[`${s}-bar-collapse-previous`]:{insetInlineEnd:"50%",insetInlineStart:"unset"},[`${s}-bar-collapse-next`]:{insetInlineEnd:"50%",insetInlineStart:"unset"}}}}},at={position:"absolute",top:"50%",left:{_skip_check_:!0,value:"50%"},transform:"translate(-50%, -50%)"},Ma=i=>{const{componentCls:s,colorFill:N,splitBarDraggableSize:o,splitBarSize:d,splitTriggerSize:u,controlItemBgHover:c,controlItemBgActive:B,controlItemBgActiveHover:j}=i,t=`${s}-bar`,_=`${s}-mask`,$=`${s}-panel`,f=i.calc(u).div(2).equal();return{[s]:Object.assign(Object.assign(Object.assign({},(0,Sa.Wf)(i)),{display:"flex",width:"100%",height:"100%",alignItems:"stretch",[`> ${t}`]:{flex:"none",position:"relative",userSelect:"none",[`${t}-dragger`]:Object.assign(Object.assign({},at),{zIndex:1,"&::before":Object.assign({content:'""',background:c},at),"&::after":Object.assign({content:'""',background:N},at),[`&:hover:not(${t}-dragger-active)`]:{"&::before":{background:B}},"&-active":{zIndex:2,"&::before":{background:j}},[`&-disabled${t}-dragger`]:{zIndex:0,"&, &:hover, &-active":{cursor:"default","&::before":{background:c}},"&::after":{display:"none"}}}),[`${t}-collapse-bar`]:Object.assign(Object.assign({},at),{zIndex:1,background:c,fontSize:i.fontSizeSM,borderRadius:i.borderRadiusXS,color:i.colorText,cursor:"pointer",opacity:0,display:"flex",alignItems:"center",justifyContent:"center","&:hover":{background:B},"&:active":{background:j}}),"&:hover, &:active":{[`${t}-collapse-bar`]:{opacity:1}}},[_]:{position:"fixed",zIndex:i.zIndexPopupBase,inset:0,"&-horizontal":{cursor:"col-resize"},"&-vertical":{cursor:"row-resize"}},"&-horizontal":{flexDirection:"row",[`> ${t}`]:{width:0,[`${t}-dragger`]:{cursor:"col-resize",height:"100%",width:u,"&::before":{height:"100%",width:d},"&::after":{height:o,width:d}},[`${t}-collapse-bar`]:{width:i.fontSizeSM,height:i.controlHeightSM,"&-start":{left:{_skip_check_:!0,value:"auto"},right:{_skip_check_:!0,value:f},transform:"translateY(-50%)"},"&-end":{left:{_skip_check_:!0,value:f},right:{_skip_check_:!0,value:"auto"},transform:"translateY(-50%)"}}}},"&-vertical":{flexDirection:"column",[`> ${t}`]:{height:0,[`${t}-dragger`]:{cursor:"row-resize",width:"100%",height:u,"&::before":{width:"100%",height:d},"&::after":{width:o,height:d}},[`${t}-collapse-bar`]:{height:i.fontSizeSM,width:i.controlHeightSM,"&-start":{top:"auto",bottom:f,transform:"translateX(-50%)"},"&-end":{top:f,bottom:"auto",transform:"translateX(-50%)"}}}},[$]:{overflow:"auto",padding:"0 1px",scrollbarWidth:"thin",boxSizing:"border-box","&-hidden":{padding:0,overflow:"hidden"},[`&:has(${s}:only-child)`]:{overflow:"hidden"}}}),Na(i))}},Ca=i=>{var s;const N=i.splitBarSize||2,o=i.splitTriggerSize||6,d=i.resizeSpinnerSize||20,u=(s=i.splitBarDraggableSize)!==null&&s!==void 0?s:d;return{splitBarSize:N,splitTriggerSize:o,splitBarDraggableSize:u,resizeSpinnerSize:d}};var Fa=(0,wa.I$)("Splitter",i=>[Ma(i)],Ca),Za=i=>{const{prefixCls:s,className:N,style:o,layout:d="horizontal",children:u,rootClassName:c,onResizeStart:B,onResize:j,onResizeEnd:t}=i,{getPrefixCls:_,direction:$,splitter:f}=l.useContext(ra.E_),g=_("splitter",s),x=(0,oa.Z)(g),[P,R,D]=Fa(g,x),p=d==="vertical",H=$==="rtl",W=!p&&H,v=ma(u),[Z,I]=(0,l.useState)(),m=ne=>{const{offsetWidth:L,offsetHeight:le}=ne,pe=p?le:L;pe!==0&&I(pe)},[se,G,F,X,k,V]=ga(v,Z),me=fa(v,G),[Se,fe,xe,we,be]=va(v,me,F,Z,V),Be=(0,et.Z)(ne=>{Se(ne),B==null||B(G)}),ee=(0,et.Z)((ne,L)=>{const le=fe(ne,L);j==null||j(le)}),O=(0,et.Z)(()=>{xe(),t==null||t(G)}),T=(0,et.Z)((ne,L)=>{const le=we(ne,L);j==null||j(le),t==null||t(le)}),ie=Oe()(g,N,`${g}-${d}`,{[`${g}-rtl`]:H},c,f==null?void 0:f.className,D,x,R),te=`${g}-mask`,K=l.useMemo(()=>{const ne=[];let L=0;for(let le=0;le<v.length;le+=1)L+=F[le],ne.push(L);return ne},[F]),oe=Object.assign(Object.assign({},f==null?void 0:f.style),o);return P(l.createElement(la.default,{onResize:m},l.createElement("div",{style:oe,className:ie},v.map((ne,L)=>{const le=l.createElement(na,Object.assign({},ne,{prefixCls:g,size:se[L]}));let pe=null;const Ne=me[L];if(Ne){const Ee=(K[L-1]||0)+X[L],de=(K[L+1]||100)-k[L+1],Fe=(K[L-1]||0)+k[L],it=(K[L+1]||100)-X[L+1];pe=l.createElement(ja,{index:L,active:be===L,prefixCls:g,vertical:p,resizable:Ne.resizable,ariaNow:K[L]*100,ariaMin:Math.max(Ee,de)*100,ariaMax:Math.min(Fe,it)*100,startCollapsible:Ne.startCollapsible,endCollapsible:Ne.endCollapsible,onOffsetStart:Be,onOffsetUpdate:(lt,rt,Le)=>{let $e=p?Le:rt;W&&($e=-$e),ee(lt,$e)},onOffsetEnd:O,onCollapse:T})}return l.createElement(l.Fragment,{key:`split-panel-${L}`},le,pe)}),typeof be=="number"&&l.createElement("div",{"aria-hidden":!0,className:Oe()(te,`${te}-${d}`)}))))};const Ot=Za;Ot.Panel=ia;var yt=Ot,$t=n(74330),ke=n(92939),za=n(85750),_a=n(5608),Pa=n(64599),ka=n.n(Pa),Ea=n(73445),Ia=n(42237),st=(0,Ea.Ue)(function(i){return{models:[],loading:!1,error:null,initialized:!1,fetchModels:function(){var s=je()(Y()().mark(function o(){var d;return Y()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.prev=0,i({loading:!0}),c.next=4,(0,Ia.fZ)();case 4:if(d=c.sent,d.code!==0){c.next=9;break}i({models:Array.isArray(d.data.data)?d.data.data:[],initialized:!0}),c.next=10;break;case 9:throw new Error(d.message||"Failed to fetch models");case 10:c.next=16;break;case 12:c.prev=12,c.t0=c.catch(0),i({error:c.t0.message}),ae.ZP.error("Failed to fetch models");case 16:return c.prev=16,i({loading:!1}),c.finish(16);case 19:case"end":return c.stop()}},o,null,[[0,12,16,19]])}));function N(){return s.apply(this,arguments)}return N}()}}),Aa=function(){var s=st(function(c){return c.models}),N=st(function(c){return c.loading}),o=st(function(c){return c.initialized}),d=st(function(c){return c.fetchModels});(0,l.useEffect)(function(){o||d()},[o,d]);var u=(0,l.useMemo)(function(){var c=Array.isArray(s)?s:[],B=c.map(function(g){return{label:g.supplier_name,options:Array.isArray(g.model_list)?g.model_list.map(function(x){return a()({label:x.model_name,value:x.model_config_id},x)}):[]}}),j,t=ka()(c),_;try{for(t.s();!(_=t.n()).done;){var $=_.value;if(Array.isArray($.model_list)){var f=$.model_list.find(function(g){return g.model_default_used===1});if(f){j=f.model_config_id;break}}}}catch(g){t.e(g)}finally{t.f()}return{options:B,defaultValue:j}},[s]);return a()(a()({},u),{},{loading:N})},Te=n(26915),nt=n(72269),jt=n(34041),Dt=n(66309),he=n(78045),Tt=n(44010),Ke=n(51042),St=n(82061),Rt=n(80459),e=n(85893),Oa=Te.Z.TextArea,$a=function(s){var N,o,d,u,c,B=s.loading,j=s.FirstValue,t=s.Detaillist,_=s.setDetaillist,$=s.repository,f=s.setRepository,g=s.Operationbentate,x=s.Ffromref,P=s.setFourthly_config_id,R=s.Fourthly_config_id,D=s.Fourthly_select_list,p=s.Newproperties,H=s.setNewproperties,W=s.pageKeyfun,v=s.firstjudgingcondition,Z=s.setAgentmunudisabled,I=s.agentmenudisabled,m=(0,w.useIntl)(),se=(0,l.useState)([]),G=z()(se,2),F=G[0],X=G[1],k=(0,l.useState)(!1),V=z()(k,2),me=V[0],Se=V[1],fe=(0,l.useState)([]),xe=z()(fe,2),we=xe[0],be=xe[1],Be=(0,l.useState)([]),ee=z()(Be,2),O=ee[0],T=ee[1],ie=(0,l.useState)(!1),te=z()(ie,2),K=te[0],oe=te[1],ne=(0,l.useState)(!1),L=z()(ne,2),le=L[0],pe=L[1],Ne=(0,l.useState)({agent_id:0,data:{is_public:1,enable_api:0,obligations:null,input_variables:{},dataset_ids:[],attrs_are_visible:1}}),Ee=z()(Ne,2),de=Ee[0],Fe=Ee[1];(0,l.useEffect)(function(){var h,r;if(Mt(),t!=null&&(h=t.agent)!==null&&h!==void 0&&h.selected_skills&&be(t.agent.selected_skills),t!=null&&(r=t.agent)!==null&&r!==void 0&&r.selected_workflows){var A;T(t==null||(A=t.agent)===null||A===void 0?void 0:A.selected_workflows)}},[t,t==null?void 0:t.agent]);var it=function(r){P(r)},lt=function(r){Fe(a()(a()({},de),{},{data:a()(a()({},de.data),{},{obligations:r.target.value})})),_(a()(a()({},t),{},{agent:a()(a()({},t.agent),{},{obligations:r.target.value})}))},rt=function(r,A){var re=new Set;return r.some(function(ge){var Ce=ge[A];return re.has(Ce)?re.add(Ce):re.add(Ce)&&!1})},Le=function(r){_(a()(a()({},t),{},{app:a()(a()({},t.app),{},{is_public:r?1:0})})),Fe(a()(a()({},de),{},{data:a()(a()({},de.data),{},{is_public:r?1:0})}))},$e=function(r){_(a()(a()({},t),{},{app:a()(a()({},t.app),{},{enable_api:r?1:0})})),Fe(a()(a()({},de),{},{data:a()(a()({},de.data),{},{enable_api:r?1:0})}))},wt=function(r){_(a()(a()({},t),{},{app:a()(a()({},t.app),{},{attrs_are_visible:r?1:0})})),Fe(a()(a()({},de),{},{data:a()(a()({},de.data),{},{attrs_are_visible:r?1:0})}))},Vt=function(r){_(a()(a()({},t),{},{agent:a()(a()({},t.agent),{},{allow_upload_file:r?1:0})}))},Nt=function(r){_(a()(a()({},t),{},{agent:a()(a()({},t.agent),{},{mcp:r?1:0})}))},Ie=function(r){Fe(a()(a()({},de),{},{data:a()(a()({},de.data),{},{dataset_ids:r})})),f(r)},Mt=function(){var h=je()(Y()().mark(function r(){var A;return Y()().wrap(function(ge){for(;;)switch(ge.prev=ge.next){case 0:return ge.next=2,(0,ve.zl)();case 2:A=ge.sent,X(A.data.data.map(function(Ce){return{value:Ce.dataset_id,label:Ce.name}}));case 4:case"end":return ge.stop()}},r)}));return function(){return h.apply(this,arguments)}}(),Ut=function(r){be(r),_(a()(a()({},t),{},{agent:a()(a()({},t.agent),{},{selected_skills:r})}))},Ct=function(r){T(r),_(a()(a()({},t),{},{agent:a()(a()({},t.agent),{},{selected_workflows:r})}))},Me=function(){var h=je()(Y()().mark(function r(){return Y()().wrap(function(re){for(;;)switch(re.prev=re.next){case 0:v()||(W("2"),Z(a()(a()({},I),{},{first:!1,second:!1})));case 1:case"end":return re.stop()}},r)}));return function(){return h.apply(this,arguments)}}(),Ve=function(r){_(a()(a()({},t),{},{agent:a()(a()({},t.agent),{},{default_output_format:r.target.value})}))},Ft=function(r){_(a()(a()({},t),{},{agent:a()(a()({},t==null?void 0:t.agent),{},{input_variables:r.free})}))},He=Aa(),ot=He.options,Zt=He.defaultValue,zt=function(r){be(r.checkItem),_(a()(a()({},t),{},{agent:a()(a()({},t.agent),{},{selected_skills:r.checkItem})})),oe(!1)},dt=function(r){T(r.checkItem),_(a()(a()({},t),{},{agent:a()(a()({},t.agent),{},{selected_workflows:r.checkItem})})),pe(!1)},_t=function(){oe(!1)},Pt=function(){pe(!1)},kt=function(r){var A=we.filter(function(re){return re.app_id!==r.app_id});be(A),_(a()(a()({},t),{},{agent:a()(a()({},t.agent),{},{selected_skills:A})}))},ct=function(r){var A=O.filter(function(re){return re.app_id!==r.app_id});T(A),_(a()(a()({},t),{},{agent:a()(a()({},t.agent),{},{selected_workflows:A})}))};return(0,e.jsxs)("div",{style:{height:"100%",width:"100%",marginBottom:"30px"},children:[(0,e.jsx)("div",{className:"flex align-center justify-between mt-[30px]",children:(0,e.jsx)("div",{className:"text-base font-medium mb-[30px] text-[#333333]",children:m.formatMessage({id:"agent.menu.basicsetup"})})}),(0,e.jsx)("div",{className:"w-full",children:(0,e.jsxs)(U.Z,{name:"dynamic_form_nest_item",style:{width:"100%"},autoComplete:"off",form:x,children:[(0,e.jsx)(U.Z.Item,{className:"mb-[30px]",children:(0,e.jsxs)("div",{className:"text-[#555555] text-xs",children:[(0,e.jsx)("div",{className:"font-medium  mb-[15px]",children:m.formatMessage({id:"agent.appname"})}),(0,e.jsxs)("div",{className:"w-full p-[15px] flex font-normal items-center bg-[#F7F7F7] rounded-lg",children:[(0,e.jsxs)("div",{children:[t&&t.app&&t.app.name,"\xA0"]}),(0,e.jsx)("div",{className:"",children:g==="true"?m.formatMessage({id:"agent.cannotmodify"}):""})]})]})}),(0,e.jsx)(U.Z.Item,{className:"mb-[30px]",children:(0,e.jsxs)("div",{className:"text-[#555555] text-xs",children:[(0,e.jsx)("div",{className:"font-medium  mb-[15px]",children:m.formatMessage({id:"agent.appdescription"})}),(0,e.jsx)("div",{className:"w-full p-[15px] flex font-normal items-center bg-[#F7F7F7] rounded-lg",children:t&&t.app&&t.app.description})]})}),(0,e.jsx)(U.Z.Item,{className:"mb-[30px]",children:(0,e.jsxs)("div",{children:[(0,e.jsxs)("div",{className:"mb-[30px]",children:[(0,e.jsx)("div",{className:"mb-[15px] text-[#555555] text-xs",children:(0,e.jsx)(ke.Z,{className:"font-medium",name:m.formatMessage({id:"agent.teamvisibility"}),title:m.formatMessage({id:"agent.explain.teamvisibility"})})}),(0,e.jsx)(nt.Z,{size:"small",onChange:Le,checked:!!(t&&((N=t.app)===null||N===void 0?void 0:N.is_public)===1)})]}),(0,e.jsxs)("div",{className:"mb-[30px]  font-medium",children:[(0,e.jsx)("div",{className:"mb-[15px] text-[#555555] text-xs",children:(0,e.jsx)(ke.Z,{className:"font-medium",name:m.formatMessage({id:"agent.attrVisible"}),title:m.formatMessage({id:"agent.explain.attrVisible"})})}),(0,e.jsx)(nt.Z,{size:"small",onChange:wt,checked:t&&((o=t.app)===null||o===void 0?void 0:o.attrs_are_visible)===1})]}),(0,e.jsxs)("div",{className:"mb-[30px]  font-medium",children:[(0,e.jsx)("div",{className:"mb-[15px] text-[#555555] text-xs",children:m.formatMessage({id:"agent.APIswitch"})}),(0,e.jsx)(nt.Z,{size:"small",onChange:$e,checked:t&&((d=t.app)===null||d===void 0?void 0:d.enable_api)===1,disabled:(t==null||(u=t.app)===null||u===void 0?void 0:u.publish_status)!==1})]})]})}),(0,e.jsx)(U.Z.Item,{className:"mb-[30px]",children:(0,e.jsxs)("div",{children:[(0,e.jsxs)("div",{className:"mb-[15px] text-[#555555] text-xs font-medium",children:[(0,e.jsx)("span",{className:"text-[#E80000]",children:"* "}),m.formatMessage({id:"agent.LLMmodel"})]}),(0,e.jsx)(jt.Z,{placeholder:m.formatMessage({id:"agent.pleaseselect"}),value:R==0?m.formatMessage({id:"agent.pleaseselect"}):R,variant:"filled",onChange:it,options:ot,optionRender:function(r){var A;return(0,e.jsxs)("div",{children:[r.label," ",(r==null||(A=r.data)===null||A===void 0?void 0:A.support_image)==1&&(0,e.jsx)(Dt.Z,{color:"blue",className:"text-xs",children:m.formatMessage({id:"workflow.tag.imageUnderstanding",defaultMessage:"Image Understanding"})})]})},labelRender:function(r){var A;return(0,e.jsxs)("div",{children:[r==null?void 0:r.label," ",((A=(0,za.ti)(r==null?void 0:r.value,{options:ot}))===null||A===void 0?void 0:A.support_image)==1&&(0,e.jsx)(Dt.Z,{color:"blue",className:"text-xs",children:m.formatMessage({id:"workflow.tag.imageUnderstanding",defaultMessage:"Image Understanding"})})]})}})]})}),(0,e.jsx)(U.Z.Item,{className:"mb-[30px]",name:"obligations",children:(0,e.jsxs)("div",{className:"w-full",children:[(0,e.jsx)("div",{className:"mb-[15px] text-[#555555] text-xs",children:(0,e.jsx)(ke.Z,{className:"font-medium",required:!0,name:m.formatMessage({id:"agent.functiondescription"}),title:m.formatMessage({id:"agent.explain.function"})})}),(0,e.jsx)(Oa,{onChange:lt,value:t&&t.agent&&t.agent.obligations,placeholder:"Agent".concat(m.formatMessage({id:"agent.functiondescription"})),autoSize:{minRows:8,maxRows:10}})]})}),!me&&(0,e.jsx)("div",{className:"mb-[30px]",children:(0,e.jsx)(_a.Z,{title:(0,e.jsx)("div",{className:"text-[#555555] text-xs",children:(0,e.jsx)(ke.Z,{className:"font-medium",required:!0,name:m.formatMessage({id:"agent.inputvariable"}),title:m.formatMessage({id:"agent.explain.inputvariable"})})}),variables:Object.values((t==null||(c=t.agent)===null||c===void 0||(c=c.input_variables)===null||c===void 0?void 0:c.properties)||{}),onChange:Ft})}),(0,e.jsx)(U.Z.List,{name:"users",children:function(r,A){var re=A.add,ge=A.remove;return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(U.Z.Item,{className:"mb-[30px]",children:[(0,e.jsx)("div",{className:"text-[#555555] text-xs mb-[15px]",children:(0,e.jsx)(ke.Z,{className:"font-medium",name:m.formatMessage({id:"agent.associatedknowledgebase"}),title:m.formatMessage({id:"agent.explain.associatedknowledgebase"})})}),(0,e.jsx)(jt.Z,{size:"large",mode:"multiple",showSearch:!0,style:{width:"100%",fontSize:"12px"},placeholder:m.formatMessage({id:"agent.pleaseselect"}),filterOption:function(Xe,Ue){var We;return((We=Ue==null?void 0:Ue.label)!==null&&We!==void 0?We:"").toLowerCase().includes(Xe.toLowerCase())},value:$,onChange:Ie,options:F})]}),(0,e.jsx)(U.Z.Item,{className:"mb-[30px]",children:(0,e.jsxs)("div",{className:"",children:[(0,e.jsxs)("div",{className:"text-[#555555] text-xs mb-[15px]",children:[" ",m.formatMessage({id:"agent.defaultoutputformat"})]}),(0,e.jsxs)(he.ZP.Group,{value:t&&t.agent.default_output_format,onChange:function(Xe){Ve(Xe)},children:[(0,e.jsx)(he.ZP,{value:1,children:(0,e.jsx)("div",{className:"text-[#555555] text-xs font-normal",children:"text"})}),(0,e.jsx)(he.ZP,{value:2,children:(0,e.jsx)("div",{className:"text-[#555555] text-xs font-normal",children:"json"})}),(0,e.jsx)(he.ZP,{value:3,children:(0,e.jsx)("div",{className:"text-[#555555] text-xs font-normal",children:"code"})})]})]})})]})}}),(0,e.jsxs)(U.Z.Item,{className:"mb-[30px]",children:[(0,e.jsx)("div",{className:"text-[#555555] text-base mb-[15px]",children:m.formatMessage({id:"agent.mcp.resources"})}),(0,e.jsxs)("div",{className:"pl-4 ",children:[(0,e.jsxs)("div",{className:"mb-[30px]",children:[(0,e.jsxs)("div",{className:"flex items-center justify-between mb-[15px]",children:[(0,e.jsx)("div",{className:"text-[#555555] text-xs",children:(0,e.jsx)(ke.Z,{className:"font-medium",name:m.formatMessage({id:"agent.selectSkills"}),title:m.formatMessage({id:"agent.explain.selectSkills"})})}),(0,e.jsx)(Pe.ZP,{type:"link",icon:(0,e.jsx)(Ke.Z,{}),onClick:function(){return oe(!0)},className:"text-xs",children:m.formatMessage({id:"agent.addSkill"})})]}),we.length>0?(0,e.jsx)("div",{className:"flex flex-col gap-4 mb-4",children:we.map(function(h){return(0,e.jsxs)("div",{className:"group relative flex items-center cursor-pointer w-full p-2 bg-white rounded-lg shadow-sm transition-shadow",children:[(0,e.jsx)(Rt.Z,{rounded:"6px",data:h,bg:h.icon_background}),(0,e.jsxs)("div",{className:"flex flex-col ml-2 truncate",children:[(0,e.jsx)("span",{className:"text-sm font-medium text-[#333333]",children:h.name}),(0,e.jsx)("span",{className:"text-xs text-[#666666] truncate",children:h.description})]}),(0,e.jsx)("div",{className:"absolute right-2 top-1/2 -translate-y-1/2 opacity-0 group-hover:opacity-100 transition-opacity cursor-pointer hover:text-red-500",onClick:function(A){A.stopPropagation(),kt(h)},children:(0,e.jsx)(St.Z,{})})]},h.app_id)})}):(0,e.jsx)("div",{onClick:function(){return oe(!0)},className:"w-full h-[120px] flex items-center justify-center border border-dashed border-[#e8e8e8] rounded-lg bg-[#fafafa] cursor-pointer hover:border-[#1b64f3] transition-colors",children:(0,e.jsxs)("div",{className:"flex flex-col items-center gap-2",children:[(0,e.jsx)(Ke.Z,{className:"text-[#999999] text-lg"}),(0,e.jsx)("span",{className:"text-[#999999] text-sm",children:m.formatMessage({id:"agent.addSkill"})})]})}),(0,e.jsx)(Tt.Z,{show:K,popupClose:_t,popupSave:zt,checkList:we,radio:!1,nodetype:"skill",zIndex:30})]}),(0,e.jsxs)("div",{className:"mb-[30px]",children:[(0,e.jsxs)("div",{className:"flex items-center justify-between mb-[15px]",children:[(0,e.jsx)("div",{className:"text-[#555555] text-xs",children:(0,e.jsx)(ke.Z,{className:"font-medium",name:m.formatMessage({id:"agent.selectWorkflows"}),title:m.formatMessage({id:"agent.explain.selectWorkflows"})})}),(0,e.jsx)(Pe.ZP,{type:"link",icon:(0,e.jsx)(Ke.Z,{}),onClick:function(){return pe(!0)},className:"text-xs",children:m.formatMessage({id:"agent.addWorkflow"})})]}),O.length>0?(0,e.jsx)("div",{className:"flex flex-col gap-4 mb-4",children:O.map(function(h){return(0,e.jsxs)("div",{className:"group relative flex items-center cursor-pointer w-full p-2 bg-white rounded-lg shadow-sm transition-shadow",children:[(0,e.jsx)(Rt.Z,{rounded:"6px",data:h,bg:h.icon_background}),(0,e.jsxs)("div",{className:"flex flex-col ml-2 truncate",children:[(0,e.jsx)("span",{className:"text-sm font-medium text-[#333333]",children:h.name}),(0,e.jsx)("span",{className:"text-xs text-[#666666] truncate",children:h.description})]}),(0,e.jsx)("div",{className:"absolute right-2 top-1/2 -translate-y-1/2 opacity-0 group-hover:opacity-100 transition-opacity cursor-pointer hover:text-red-500",onClick:function(A){A.stopPropagation(),ct(h)},children:(0,e.jsx)(St.Z,{})})]},h.app_id)})}):(0,e.jsx)("div",{onClick:function(){return pe(!0)},className:"w-full h-[120px] flex items-center justify-center border border-dashed border-[#e8e8e8] rounded-lg bg-[#fafafa] cursor-pointer hover:border-[#1b64f3] transition-colors",children:(0,e.jsxs)("div",{className:"flex flex-col items-center gap-2",children:[(0,e.jsx)(Ke.Z,{className:"text-[#999999] text-lg"}),(0,e.jsx)("span",{className:"text-[#999999] text-sm",children:m.formatMessage({id:"agent.addWorkflow"})})]})}),(0,e.jsx)(Tt.Z,{show:le,popupClose:Pt,popupSave:dt,checkList:O,radio:!1,nodetype:"workflow",zIndex:30})]})]})]}),(0,e.jsxs)("div",{children:[(0,e.jsx)(Pe.ZP,{type:"primary",className:"mr-[20px]",onClick:function(){Me()},children:m.formatMessage({id:"agent.btn.nextstep"})}),(0,e.jsx)(Pe.ZP,{onClick:function(){history.back()},children:m.formatMessage({id:"agent.btn.back"})})]}),(0,e.jsx)("div",{className:"h-[30px] w-1"})]})})]})},Da=$a,Ta=n(13769),Bt=n.n(Ta),Ra=n(49677),Ba=n.n(Ra),La=n(24216),Va=n(85877),Lt=n(39944),Ua=n(71471),Wa=["key","name"],vs=Ua.Z.Title,hs=Te.Z.TextArea,xs=Te.Z.Search,Ga=function(s){var N=s.handleBack,o=s.Detaillist,d=s.setDetaillist,u=s.Fourthly_select_list,c=s.setFourthly_config_id,B=s.Fourthly_config_id,j=s.Fourthlyref,t=s.Fourthly_abilities_list,_=s.Operationbentate,$=s.callwordlist,f=s.newagentid,g=(0,w.useIntl)(),x=(0,l.useState)(0),P=z()(x,2),R=P[0],D=P[1],p=(0,l.useState)(""),H=z()(p,2),W=H[0],v=H[1],Z=(0,l.useState)(""),I=z()(Z,2),m=I[0],se=I[1],G=(0,l.useState)(!1),F=z()(G,2),X=F[0],k=F[1],V=function(O){var T={user:{value:xe(O)}};v(new Lt.z(T))},me=function(O){var T={user:{value:O.target.value}};v(new Lt.z(T))},Se=function(O){D(O)},fe=function(O){var T=O.users.filter(function(K,oe){return K.type=="number"&&!Number(K.value)&&!!K.value});if(!W.user)ae.ZP.warning(g.formatMessage({id:"agent.message.warning.callword"}));else if(T.length>0)ae.ZP.warning(g.formatMessage({id:"agent.message.warning.datatype"}));else{k(!0);var ie=new Re.Kr("input","","");O.users.forEach(function(K){var oe=new Re._w(K.name,K.type?K.type:"string",K.type=="string"?K.value:Number(K.value),K.content,K.status);ie.addProperty(K.name,oe)});var te={agent_id:f||o.agent.agent_id,ability_id:R,input_dict:ie,prompt:W};we(te)}},xe=function ee(O){return O.map(function(T){return T.type==="mention"?T.id:T.children?ee(T.children):T.text}).join("")},we=function(O){(0,ve.LH)(O).then(function(T){ae.ZP.success(g.formatMessage({id:"agent.message.success.runpublish"})),se(T.data.outputs.text),k(!1)}).catch(function(T){k(!1)})},be=function(){var ee=je()(Y()().mark(function O(){var T;return Y()().wrap(function(te){for(;;)switch(te.prev=te.next){case 0:return te.next=2,(0,ve.Dh)(f||o.agent.agent_id);case 2:T=te.sent,T.code==0?ae.ZP.success(g.formatMessage({id:"agent.message.success.publish"})):ae.ZP.error(g.formatMessage({id:"agent.message.fail.publish"}));case 4:case"end":return te.stop()}},O)}));return function(){return ee.apply(this,arguments)}}(),Be=function(){var ee=je()(Y()().mark(function O(){return Y()().wrap(function(ie){for(;;)switch(ie.prev=ie.next){case 0:w.history.push("/Agents?app_id=".concat(o.app.app_id,"&type=false")),location.reload();case 2:case"end":return ie.stop()}},O)}));return function(){return ee.apply(this,arguments)}}();return(0,l.useEffect)(function(){},[]),(0,e.jsxs)("div",{style:{height:"100%"},children:[(0,e.jsx)("div",{className:"text-base font-medium text-[#333333] my-[30px]",children:g.formatMessage({id:"agent.operationrun"})}),(0,e.jsxs)("div",{className:"mb-[30px]",children:[(0,e.jsx)("div",{className:"mb-[15px] text-[#555555] text-xs font-medium",children:g.formatMessage({id:"agent.selectivepower"})}),(0,e.jsx)(jt.Z,{placeholder:g.formatMessage({id:"agent.pleaseselect"}),defaultValue:g.formatMessage({id:"agent.allability"}),style:{width:390,fontSize:"12px",color:"#BBBBBB",fontWeight:"400"},onChange:Se,options:t})]}),(0,e.jsx)("div",{children:(0,e.jsxs)(U.Z,{name:"dynamic_form_nest_item",onFinish:fe,style:{width:"100%"},autoComplete:"off",form:j,children:[(0,e.jsx)("div",{className:"mb-[15px] text-[#555555] text-xs font-medium",children:g.formatMessage({id:"agent.inputvariable"})}),(0,e.jsx)(U.Z.List,{name:"users",children:function(O,T){return Ba()(T),(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)("div",{className:"w-full flex justify-start items-center text-xs font-medium px-[10px] text-[#213044] h-12 bg-[#F7F7F7]  rounded-t-lg",children:[(0,e.jsx)("div",{className:"mr-5 ml-2.5",children:g.formatMessage({id:"agent.variable.name"})}),(0,e.jsx)("div",{className:"",children:g.formatMessage({id:"agent.variable.value"})})]}),(0,e.jsx)("div",{className:"mb-[30px]",children:O.map(function(ie){var te=ie.key,K=ie.name,oe=Bt()(ie,Wa);return(0,e.jsxs)("div",{className:"w-full h-20 flex justify-start  px-2.5 border-b border-x pt-7 last:rounded-b-lg",children:[(0,e.jsx)(U.Z.Item,a()(a()({},oe),{},{name:[K,"content"],children:(0,e.jsx)(Te.Z,{className:"mr-5",style:{color:"#213044",fontWeight:"400",fontSize:"12px"},variant:"borderless",disabled:!0})})),(0,e.jsx)(U.Z.Item,a()(a()({},oe),{},{name:[K,"value"],rules:[{required:!!(j.getFieldsValue()&&j.getFieldsValue().users[te].status==!0),message:g.formatMessage({id:"agent.rules.veriablevalue"})}],children:(0,e.jsx)(Te.Z,{placeholder:j.getFieldsValue()&&j.getFieldsValue().users[te].status==!0?g.formatMessage({id:"agent.variable.required.value"}):g.formatMessage({id:"agent.variable.value"})})}))]})})})]})}}),(0,e.jsxs)(U.Z.Item,{rules:[{required:!0,message:g.formatMessage({id:"agent.rules.callwordvalue"})}],children:[(0,e.jsx)("div",{className:"mb-[15px] text-[#555555] text-xs font-medium",children:g.formatMessage({id:"agent.runpreview"})}),(0,e.jsx)($t.Z,{spinning:X,children:(0,e.jsxs)("div",{className:"bg-[#F7F7F7] p-3.5 rounded-lg",children:[(0,e.jsx)("div",{className:"h-[345px] mb-[30px]",children:m?(0,e.jsx)(La.Z,{language:"python3",value:m&&JSON.stringify(m)}):null}),(0,e.jsxs)("div",{className:"agents-input p-2 bg-white border rounded-md my-2 flex items-center justify-between",style:{border:"1px solid #EEE"},children:[(0,e.jsx)("div",{className:"w-full",children:(0,e.jsx)(Va.Z,{onChange:function(O){V(O)},options:$})}),(0,e.jsx)("div",{className:"w-8 h-8 bg-[#e8effc] rounded-md",children:(0,e.jsx)(Pe.ZP,{className:"bg-[#e8effc]",icon:(0,e.jsx)("img",{src:"/icons/fs.svg"}),type:"link",htmlType:"submit",block:!0})})]})]})})]})]})}),(0,e.jsx)("div",{className:"w-28",children:(o==null?void 0:o.agent.publish_status)===1&&(o==null?void 0:o.is_creator)===1?(0,e.jsx)("div",{children:(0,e.jsx)(Pe.ZP,{type:"primary",htmlType:"submit",className:"w-full",onClick:Be,children:g.formatMessage({id:"agent.amend"})})}):(0,e.jsx)("div",{children:(0,e.jsx)(Pe.ZP,{type:"primary",htmlType:"submit",className:"w-full",disabled:_!="false",onClick:be,children:g.formatMessage({id:"agent.publish"})})})}),(0,e.jsx)("div",{className:"h-[30px] w-1"})]})},Ka=Ga,Ha=["key","name"],Xa=Te.Z.TextArea,Ya=function(s){var N=s.SecondValue,o=s.handleBack,d=s.Detaillist,u=s.setDetaillist,c=s.Sformref,B=s.Operationbentate,j=s.pageKeyfun,t=s.secondjudgingcondition,_=s.SkillMenuClick,$=s.agentupdata,f=(0,w.useIntl)(),g=ae.ZP.useMessage(),x=z()(g,2),P=x[0],R=x[1],D=(0,l.useRef)(null),p=(0,l.useState)({auto_match_ability:0,agent_abilities:[{agent_ability_id:0,name:"string",content:"string",status:0}]}),H=z()(p,2),W=H[0],v=H[1];(0,l.useEffect)(function(){});var Z=function(F){if(F.users.length==1&&(!F.users[0].content&&F.users[0].name||F.users[0].content&&!F.users[0].name))return ae.ZP.warning(f.formatMessage({id:"agent.message.warning.selectknowledgebase"}));var X=F.users.map(function(V){return a()(a()({},V),{},{status:V.status?1:2,agent_ability_id:V.agent_ability_id?V.agent_ability_id:0})}),k={agent_id:d.agent.agent_id,data:{auto_match_ability:d.agent.auto_match_ability,agent_abilities:F.users.length==1&&!F.users[0].content&&!F.users[0].name?[]:X}};B=="false"&&I(),N(a()({},W))},I=function(){var G=je()(Y()().mark(function F(){return Y()().wrap(function(k){for(;;)switch(k.prev=k.next){case 0:t()||$();case 1:case"end":return k.stop()}},F)}));return function(){return G.apply(this,arguments)}}(),m=function(F){u(a()(a()({},d),{},{agent:a()(a()({},d.agent),{},{auto_match_ability:F?1:0})}))},se=function(){setTimeout(function(){D.current&&D.current.scrollTo({top:D.current.scrollHeight,behavior:"smooth"})},100)};return(0,e.jsxs)("div",{style:{height:"100%"},className:"w-full flex-1 sticky top-0",children:[(0,e.jsx)("div",{className:"text-base font-medium text-[#333333] my-[30px]",children:f.formatMessage({id:"agent.Applicationcapabilitysetting"})}),(0,e.jsxs)("div",{className:"mb-[30px]",children:[(0,e.jsx)("div",{className:"mb-[15px] text-[#555555] text-xs font-medium",children:(0,e.jsx)(ke.Z,{name:f.formatMessage({id:"agent.automatch"}),title:f.formatMessage({id:"agent.explain.automatch"})})}),(0,e.jsx)(nt.Z,{size:"small",checked:!!(d&&d.agent.auto_match_ability==1),onChange:m})]}),(0,e.jsx)("div",{className:"w-full",children:(0,e.jsxs)(U.Z,{name:"dynamic_form_nest_item",onFinish:Z,style:{width:"100%"},autoComplete:"off",form:c,children:[(0,e.jsx)(U.Z.List,{name:"users",children:function(F,X){var k=X.add,V=X.remove;return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)("div",{className:"w-full flex items-center justify-between mb-[11px]",children:[(0,e.jsx)("div",{className:" text-[#555555] text-xs font-medium",children:f.formatMessage({id:"agent.capability"})}),(0,e.jsx)("div",{children:(0,e.jsx)(Pe.ZP,{type:"link",onClick:function(){k(),se()},block:!0,icon:(0,e.jsx)(Ke.Z,{}),children:f.formatMessage({id:"agent.add"})})})]}),(0,e.jsx)("div",{style:{height:"calc(100vh - 206px)",overflowY:"auto"},className:"overflow-y-auto",ref:D,children:F.map(function(me){var Se=me.key,fe=me.name,xe=Bt()(me,Ha);return(0,e.jsxs)("div",{className:"bg-[#F7F7F7] p-[15px] rounded-lg mb-[20px]",children:[(0,e.jsx)(U.Z.Item,{className:"mb-0",children:(0,e.jsxs)("div",{className:"w-full flex justify-between items-center mb-[15px]",children:[(0,e.jsx)("div",{className:"text-[#555555] text-xs font-medium",children:f.formatMessage({id:"agent.capabilityname"})}),(0,e.jsxs)("div",{children:[" ",(0,e.jsx)(St.Z,{onClick:function(){return V(fe)}})]})]})}),(0,e.jsx)(U.Z.Item,a()(a()({className:"mb-[20px]"},xe),{},{name:[fe,"name"],rules:[{required:F.length!==1,message:f.formatMessage({id:"agent.capabilityname"})}],children:(0,e.jsx)(Te.Z,{placeholder:f.formatMessage({id:"agent.capabilityname"}),maxLength:50,className:"w-full"})})),(0,e.jsx)("div",{className:"mb-[15px]",children:(0,e.jsx)(ke.Z,{className:"text-[#555555] text-xs font-medium",name:f.formatMessage({id:"agent.capabilitydescription"}),title:f.formatMessage({id:"agent.explain.capabilitydescription"})})}),(0,e.jsx)(U.Z.Item,a()(a()({className:"w-full mb-[20px]"},xe),{},{name:[fe,"content"],rules:[{required:F.length!==1,message:f.formatMessage({id:"agent.capabilitydescription"})}],children:(0,e.jsx)(Xa,{placeholder:f.formatMessage({id:"agent.capabilitydescription"}),autoSize:{minRows:3,maxRows:10},className:"w-full"})})),(0,e.jsx)("div",{className:"text-[#555555] text-xs font-medium mb-[15px]",children:f.formatMessage({id:"agent.capabilitystatus"})}),(0,e.jsx)(U.Z.Item,a()(a()({className:"mb-[20px]"},xe),{},{name:[fe,"status"],children:(0,e.jsxs)(he.ZP.Group,{optionType:"button",buttonStyle:"solid",defaultValue:!0,children:[(0,e.jsx)(he.ZP,{value:!0,children:f.formatMessage({id:"agent.capabilitystatus.enable"})}),(0,e.jsx)(he.ZP,{value:!1,children:f.formatMessage({id:"agent.capabilitystatus.disable"})})]})})),(0,e.jsx)("div",{className:"text-[#555555] text-xs font-medium mb-[11px]",children:f.formatMessage({id:"agent.enableall"})}),(0,e.jsx)(U.Z.Item,{className:"mb-0",name:[fe,"output_format"],children:(0,e.jsxs)(he.ZP.Group,{defaultValue:0,children:[(0,e.jsx)(he.ZP,{value:0,children:(0,e.jsx)("div",{className:"text-[#555555] text-xs font-normal",children:f.formatMessage({id:"agent.menu"})})}),(0,e.jsx)(he.ZP,{value:1,children:(0,e.jsx)("div",{className:"text-[#555555] text-xs font-normal",children:"text string"})}),(0,e.jsx)(he.ZP,{value:2,children:(0,e.jsx)("div",{className:"text-[#555555] text-xs font-normal",children:"format json"})}),(0,e.jsx)(he.ZP,{value:3,children:(0,e.jsx)("div",{className:"text-[#555555] text-xs font-normal",children:"code"})})]})})]})})})]})}}),(0,e.jsx)("div",{className:"h-[30px] w-1"})]})})]})},Ja=Ya,Qa=n(10696),qa=n(27842),es=n(96486),ts=n.n(es),as=function(){var s,N,o,d,u=(0,w.useIntl)(),c=(0,l.useRef)(null),B=U.Z.useForm(),j=z()(B,1),t=j[0],_=U.Z.useForm(),$=z()(_,1),f=$[0],g=U.Z.useForm(),x=z()(g,1),P=x[0],R=U.Z.useForm(),D=z()(R,1),p=D[0],H=(0,l.useState)(null),W=z()(H,2),v=W[0],Z=W[1],I=(0,l.useState)(0),m=z()(I,2),se=m[0],G=m[1],F=(0,l.useState)(null),X=z()(F,2),k=X[0],V=X[1],me=(0,l.useState)(null),Se=z()(me,2),fe=Se[0],xe=Se[1],we=(0,l.useState)(null),be=z()(we,2),Be=be[0],ee=be[1],O=(0,l.useState)(null),T=z()(O,2),ie=T[0],te=T[1],K=(0,l.useState)(null),oe=z()(K,2),ne=oe[0],L=oe[1],le=(0,l.useState)(null),pe=z()(le,2),Ne=pe[0],Ee=pe[1],de=(0,l.useState)(null),Fe=z()(de,2),it=Fe[0],lt=Fe[1],rt=(0,l.useState)(null),Le=z()(rt,2),$e=Le[0],wt=Le[1],Vt=(0,l.useState)(null),Nt=z()(Vt,2),Ie=Nt[0],Mt=Nt[1],Ut=(0,l.useState)("1"),Ct=z()(Ut,2),Me=Ct[0],Ve=Ct[1],Ft=(0,l.useState)(null),He=z()(Ft,2),ot=He[0],Zt=He[1],zt=(0,l.useState)(null),dt=z()(zt,2),_t=dt[0],Pt=dt[1],kt=(0,l.useState)(null),ct=z()(kt,2),h=ct[0],r=ct[1],A=(0,l.useState)(null),re=z()(A,2),ge=re[0],Ce=re[1],Xe=(0,l.useState)(!0),Ue=z()(Xe,2),We=Ue[0],Ye=Ue[1],ns=(0,l.useState)({first:!1,second:!1,fourthly:!1}),Wt=z()(ns,2),Je=Wt[0],ut=Wt[1],is=[{key:"1",icon:(0,e.jsx)(_e.Z,{}),label:u.formatMessage({id:"agent.menu.basicsetup"}),disabled:Je.first,style:{padding:"15px",width:"100%",margin:"0px",marginBottom:"10px",fontSize:"16px",fontWeight:"500",lineHeight:"22px",color:Me=="1"?"#1B64F3":"#213044"}},{key:"2",disabled:Je.second,icon:(0,e.jsx)(ce.Z,{}),label:u.formatMessage({id:"agent.menu.Capacityoutput"}),style:{padding:"15px",width:"100%",margin:"0px",marginBottom:"10px",fontSize:"16px",lineHeight:"22px",fontWeight:"500",color:Me=="2"?"#1B64F3":"#213044"}},{key:"5",disabled:Je.fourthly,icon:(0,e.jsx)(Q.Z,{}),label:u.formatMessage({id:"app.dashboard.run_log_agent"}),style:{padding:"15px",width:"100%",margin:"0px",marginBottom:"10px",fontSize:"16px",lineHeight:"22px",fontWeight:"500",color:Me=="5"?"#1B64F3":"#213044"}}];(0,l.useEffect)(function(){var q=new URLSearchParams(window.location.search);q.get("app_id")||(ut(a()(a()({},Je),{},{first:!1,second:!0,fourthly:!0})),Ye(!1)),Et()},[]);var Et=function(){var q=je()(Y()().mark(function M(S){var b,E,y,C,Ze,At,qt,ea;return Y()().wrap(function(Ae){for(;;)switch(Ae.prev=Ae.next){case 0:if(E=new URLSearchParams(window.location.search),E.get("from")&&Pt(E.get("from")),y=null,!(E.get("app_id")||S)){Ae.next=10;break}return Ae.next=6,(0,ve.ek)(S||E.get("app_id"),E.get("type"));case 6:y=Ae.sent,Ce(y.data.app.app_id),Ae.next=13;break;case 10:return Ae.next=12,(0,De.cI)();case 12:y=Ae.sent;case 13:C=y.data,Ze=(b=y.data)===null||b===void 0||(b=b.agent_dataset_relation_list)===null||b===void 0?void 0:b.map(function(J){return J.dataset_id}),V(Ze),y.data.callable_items&&(y.data.agent.selected_skills=[],y.data.agent.selected_workflows=[],y.data.callable_items.forEach(function(J){J.item_type==1?y.data.agent.selected_skills.push(a()(a()({},J),{},{mode:4})):y.data.agent.selected_workflows.push(a()(a()({},J),{},{mode:2}))})),Z(y.data),Mt(y.data.agent.publish_status===0&&y.data.is_creator===1?"false":"true"),y.data.agent.publish_status===1&&ae.ZP.warning(u.formatMessage({id:"agent.message.listwarning"}),5),t.setFieldsValue(Gt(C.agent.input_variables)),At=y.data.agent_abilities_list.map(function(J){return J.status==1?a()(a()({},J),{},{status:!0}):a()(a()({},J),{},{status:!1})}),P.setFieldsValue({users:At[0]?At:[{agent_ability_id:0,name:"",content:"",status:!0,output_format:0}]}),ee(It(C.agent_abilities_list)),te(It(C.agent_abilities_list)),qt=C.agent_abilities_list.filter(function(J){return J.output_format!==0}),f.setFieldsValue({users:qt.map(function(J){return{agent_ability_id:J.agent_ability_id,output_format:J.output_format}})}),p.setFieldsValue(Gt(C.agent.input_variables)),L(C.m_configurations_list.map(function(J){return{value:J.m_config_id?J.m_config_id:J.model_config_id,label:J.m_name?J.m_name:J.model_name}})),C.agent.m_config_id||C.agent.model_config_id?Ee(C.agent.m_config_id?C.agent.m_config_id:C.agent.model_config_id):Ee(C.m_configurations_list[0].model_config_id),ea=C.agent_abilities_list.filter(function(J,ys){return J.status===1}),wt(It(ea).concat([{value:0,label:u.formatMessage({id:"agent.allability"})}])),Ye(!1);case 33:case"end":return Ae.stop()}},M)}));return function(S){return q.apply(this,arguments)}}(),Gt=function(M){var S={users:M&&M.properties?Object.values(M.properties).map(function(b){return a()({name:b.name,type:b.type,content:b.display_name,status:b.required},b)}):[{name:"",content:"",type:"string",agent_ability_id:0,output_format:0,status:0}]};return S},It=function(M){return M.map(function(S){return{value:S.agent_ability_id,label:S.name}})},ls=function(M){Qt(M,1),p.setFieldsValue(t.getFieldsValue())},rs=function(){Et()},Kt=function(M){G(M)},os=function(){w.history.back()},Ht=function(){if(!v.agent.input_variables)return ae.ZP.warning(u.formatMessage({id:"agent.message.warning.variable"})),!0;if(ts().isEmpty(v.agent.input_variables.properties))return ae.ZP.warning(u.formatMessage({id:"agent.message.warning.variable"})),!0;if(Ne)if(v.agent.obligations){if(us(t.getFieldsValue().users,"name"))return ae.ZP.warning(u.formatMessage({id:"agent.message.warning.repetition"})),!0}else return ae.ZP.warning(u.formatMessage({id:"agent.message.warning.functiondescribe"})),!0;else return ae.ZP.warning(u.formatMessage({id:"agent.message.warning.LLM"})),!0;return!1},Xt=function(){var M=P.getFieldsValue().users.filter(function(b){return!!b}),S=M.filter(function(b){return!b.name||!b.content});return S.length!==0&&!(S.length==1&&S[0].name==""&&S[0].content=="")?(ae.ZP.warning(u.formatMessage({id:"agent.message.warning.integritycapacity"})),!0):!1},Yt=function(M){if((M==null?void 0:M.key)=="4"){var S=t.getFieldsValue().users.map(function(b){return{value:"<<".concat(qe.qX,".inputs.").concat(b.name,">>"),label:b.name}});Zt(S)}Ve(M.key)},Jt=function(){Ye(!0);var M=0;return new Promise(function(S){var b=function(y){return(0,ve.ek)(y,!1).then(function(C){return M=C.data.agent.agent_id,ds(M),ge||w.history.replace("/Agents?app_id=".concat(y,"&type=false")),setTimeout(function(){cs(M),ae.ZP.success(u.formatMessage({id:"skill.conserve.success"}))},500),setTimeout(function(){if(Et(y),!ge){var Ze=a()(a()({},(0,De.Go)("GET")),{},{app_id:y});(0,De.Go)("SET",Ze)}},1e3),r(M),C}).catch(function(){return""})};ge?b(ge).then(function(E){return S(E)}).catch(function(E){console.error("Error during agent update:",E),S("")}):(0,vt.uy)((0,De.Go)("GET")).then(function(E){Ce(E.data.app_id),b(E.data.app_id).then(function(y){return S(y)}).catch(function(y){console.error("Error during agent creation:",y),S("")})}).catch(function(E){console.error("Error creating app:",E),Ye(!1),S("")})})},ds=function(M,S){t.validateFields().then(function(b){var E=[].concat(ye()(v.agent.selected_skills||[]),ye()(v.agent.selected_workflows||[])).map(function(Ze){return{app_id:Ze.app_id,item_type:Ze.mode==4?1:2}}),y={agent_id:M,data:{is_public:v.app.is_public,enable_api:v.app.enable_api,attrs_are_visible:v.app.attrs_are_visible,obligations:v.agent.obligations,input_variables:v.agent.input_variables?v.agent.input_variables:ms(t.getFieldsValue()),dataset_ids:k,m_config_id:Ne,allow_upload_file:v.agent.allow_upload_file,default_output_format:v.agent.default_output_format,callable_list:E}};Ie=="false"&&Qt(y,1),p.setFieldsValue(t.getFieldsValue());var C=t.getFieldsValue().users.map(function(Ze){return{value:"<<".concat(qe.qX,".inputs.").concat(Ze.name,">>"),label:Ze.name}});Zt(C),S&&Ve(S.key)}).catch(function(b){})},cs=function(M){var S=P.getFieldsValue().users.filter(function(y){return!!y}),b=S.map(function(y){return a()(a()({},y),{},{status:y.status==!1?2:1,agent_ability_id:y.agent_ability_id?y.agent_ability_id:0,output_format:y.output_format?y.output_format:0})}),E={agent_id:M,data:{auto_match_ability:v.agent.auto_match_ability,agent_abilities:b}};Ie=="false"&&(b.length==1&&b[0].name==""&&b[0].content==""?ut({first:!1,second:!1,fourthly:!1}):(0,ve.Iw)(E).then(function(y){y.code==0&&ut({first:!1,second:!1,fourthly:!1})}).catch(function(y){}))},Qt=function(){var q=je()(Y()().mark(function M(S,b){var E;return Y()().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:if(Ie!=="false"){C.next=19;break}if(b!==1){C.next=7;break}return C.next=4,(0,ve.XB)(S);case 4:C.t0=C.sent,C.next=17;break;case 7:if(b!==2){C.next=13;break}return C.next=10,(0,ve.Iw)(S);case 10:C.t1=C.sent,C.next=16;break;case 13:return C.next=15,(0,ve.Ce)(S);case 15:C.t1=C.sent;case 16:C.t0=C.t1;case 17:E=C.t0,E&&E.code===0&&Ye(!1);case 19:case"end":return C.stop()}},M)}));return function(S,b){return q.apply(this,arguments)}}(),us=function(M,S){var b=new Set;return M.some(function(E){var y=E[S];return b.has(y)?b.add(y):b.add(y)&&!1})},ms=function(M){var S=new Re.Kr("input","","");return M.users.forEach(function(b){var E=new Re._w(b.name,b.type?b.type:"string",b.value?b.value:"",b.content,b.status);S.addProperty(b.name,E)}),S};return(0,e.jsxs)("div",{className:" flex bg-white",style:{height:"calc(100vh - 56px)"},children:[(0,e.jsxs)("div",{className:"flex flex-col w-[300px]",style:{height:"calc(100vh - 56px)"},children:[(0,e.jsx)("div",{className:"flex w-full items-center bg-white px-[30px] pt-[30px] border-[#e5e7eb] border-solid border-r",children:(0,e.jsxs)(Pe.ZP,{type:"link",shape:"circle",size:"middle",className:"",onClick:os,children:[(0,e.jsx)(ue.Z,{}),(0,e.jsx)("span",{className:"text-sm font-medium text-[#213044]",children:_t=="chat_room"?u.formatMessage({id:"agent.back_meeting"}):u.formatMessage({id:"agent.back"})})]})}),(0,e.jsxs)("div",{className:"w-full flex-1 px-[30px] py-[30px] bg-white border-[#e5e7eb] border-solid border-r",children:[(0,e.jsx)(aa.Z,{selectedKeys:[Me],onClick:Yt,style:{width:"100%",borderInlineEnd:"1px solid rgba(0,0,0,0)"},defaultSelectedKeys:[Me],mode:"inline",items:is}),v&&((s=v.app)===null||s===void 0?void 0:s.enable_api)===1&&((N=v.app)===null||N===void 0?void 0:N.publish_status)===1?(0,e.jsx)("div",{className:"w-full h-[40px] rounded-lg text-[#000] hover:bg-[#f0f0f0] p-[12px] pl-[16px] cursor-pointer",onClick:je()(Y()().mark(function q(){var M,S;return Y()().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:if(M=new URLSearchParams(window.location.search),S=null,!M.get("app_id")){E.next=6;break}return E.next=5,(0,ve.ek)(M.get("app_id"),M.get("type"));case 5:S=E.sent;case 6:S!=null&&S.data.app.enable_api===1&&S.data.app.publish_status===1?window.open(ht._n+v.app.api_url):ae.ZP.warning(u.formatMessage({id:"agent.save.and.click"}),5);case 7:case"end":return E.stop()}},q)})),children:(0,e.jsxs)("div",{className:"mr-[20px] text-base font-medium text-[#213044] -mt-1",children:[(0,e.jsx)(Ge.Z,{className:"mr-3"}),u.formatMessage({id:"agent.visit"})," API"]})}):null]})]}),(0,e.jsx)("div",{className:"flex-1 relative w-[calc(100%-300px)]",children:(0,e.jsxs)(yt,{style:{height:"100%",boxShadow:"0 0 10px rgba(0, 0, 0, 0.1)"},children:[(0,e.jsx)(yt.Panel,{defaultSize:"50%",min:"40%",max:"70%",children:(0,e.jsx)($t.Z,{spinning:We,size:"large",className:"mt-[112px] mr-4",children:(0,e.jsx)("div",{className:"flex flex-col",style:{height:"calc(100vh - 56px)",overflowY:"scroll",scrollbarWidth:"none"},children:(0,e.jsxs)("div",{className:"px-[30px] ",style:{overflowX:"auto",height:"100%"},children:[(0,e.jsx)("div",{className:"w-full flex justify-center  mt-[30px]",children:(0,e.jsxs)("div",{className:"flex items-center w-full ",children:[(0,e.jsx)("div",{className:"mr-[10px] w-[16px] h-[16px]",children:(0,e.jsx)("img",{src:"/icons/flag.svg",alt:"",className:"w-[16px] h-[16px]"})}),(0,e.jsxs)("div",{className:"flex items-center",children:[(0,e.jsxs)("div",{className:"mr-[6px] text-lg text-[#213044] font-medium",children:[(o=(0,De.Go)("GET"))!==null&&o!==void 0&&o.app_id?u.formatMessage({id:"agent.compile"}):u.formatMessage({id:"agent.created"})," ",u.formatMessage({id:"agent"})]}),(v==null||(d=v.app)===null||d===void 0?void 0:d.publish_status)===1?(0,e.jsx)("div",{className:"bg-[#1B64F3] px-[7px] text-[#fff] rounded font-normal text-xs flex items-center justify-center h-[18px]",children:u.formatMessage({id:"agent.havepublished"})}):(0,e.jsx)("div",{className:" bg-[#EEE] px-[7px]  text-[#999] rounded font-normal text-xs flex items-center justify-center h-[18px]",children:u.formatMessage({id:"agent.unpublish"})})]})]})}),(0,e.jsx)("div",{style:{display:Me==="1"?"flex":"none",height:"calc(100vh - 146px)",justifyContent:"center"},children:!We&&(0,e.jsx)(Da,{FirstValue:ls,Ffromref:t,Detaillist:v,setDetaillist:Z,repository:k,setRepository:V,Newproperties:fe,setNewproperties:xe,Operationbentate:Ie,Fourthly_config_id:Ne,setFourthly_config_id:Ee,Fourthly_select_list:ne,pageKeyfun:Ve,firstjudgingcondition:Ht,agentmenudisabled:Je,setAgentmunudisabled:ut})}),(0,e.jsx)("div",{style:{display:Me==="2"?"flex":"none",height:"calc(100vh - 146px)",justifyContent:"center",position:"sticky",top:"-150px"},children:(0,e.jsx)(Ja,{SecondValue:rs,Detaillist:v,setDetaillist:Z,Sformref:P,Operationbentate:Ie,handleBack:Kt,pageKeyfun:Ve,SkillMenuClick:Yt,secondjudgingcondition:Xt,agentupdata:Jt})}),(0,e.jsx)("div",{style:{display:Me==="4"?"flex":"none",height:"calc(100vh - 146px)",justifyContent:"center"},children:(0,e.jsx)(Ka,{handleBack:Kt,Detaillist:v,setDetaillist:Z,Fourthly_select_list:ne,Fourthly_config_id:Ne,setFourthly_config_id:Ee,Fourthlyref:p,Fourthly_abilities_list:$e,Operationbentate:Ie,callwordlist:ot,newagentid:h})})]})})})}),(0,e.jsx)(yt.Panel,{children:(0,e.jsx)("div",{children:(0,e.jsx)(Qa.Z,{saveInfo:{firstjudgingcondition:Ht,secondjudgingcondition:Xt,agentupdata:Jt},operationbentate:Ie,data:{abilitiesList:$e,detailList:v}})})}),Me=="5"&&(0,e.jsx)("div",{className:"absolute bottom-0 left-0 right-0 bg-slate-50 w-full h-full z-10",children:(0,e.jsx)(qa.ZP,{agent_id:v.agent.agent_id})})]})})]})},ss=as}}]);
