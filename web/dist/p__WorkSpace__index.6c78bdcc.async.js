"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[316],{11475:function(F,M,a){a.d(M,{Z:function(){return k}});var P=a(1413),S=a(67294),p={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}},{tag:"path",attrs:{d:"M464 688a48 48 0 1096 0 48 48 0 10-96 0zm24-112h48c4.4 0 8-3.6 8-8V296c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v272c0 4.4 3.6 8 8 8z"}}]},name:"exclamation-circle",theme:"outlined"},I=p,C=a(91146),E=function(b,D){return S.createElement(C.Z,(0,P.Z)((0,P.Z)({},b),{},{ref:D,icon:I}))},N=S.forwardRef(E),k=N},35790:function(F,M,a){var P=a(1413),S=a(67294),p=a(19369),I=a(91146),C=function(k,L){return S.createElement(I.Z,(0,P.Z)((0,P.Z)({},k),{},{ref:L,icon:p.Z}))},E=S.forwardRef(C);M.Z=E},78697:function(F,M,a){var P=a(67294),S=a(85893),p=function(C){var E=C.Image,N=C.icon;return(0,P.useEffect)(function(){},[]),(0,S.jsxs)("div",{className:"w-[42px] h-[42px] bg-[#F4F8F1] rounded-md flex items-center justify-center relative",children:[(0,S.jsx)("div",{children:(0,S.jsx)("img",{src:E,alt:""})}),N?(0,S.jsx)("div",{className:"absolute bottom-[-3px] right-[-3px] w-4 h-4 bg-white rounded-sm flex items-center justify-center shadow-[0_0_4px_-0_rgba(0,0,0,0.2)]",children:(0,S.jsx)("img",{className:" w-[12px] h-[12px]",src:N,alt:""})}):null]})};M.Z=p},46569:function(F,M,a){a.r(M),a.d(M,{default:function(){return Ee}});var P=a(56264),S=a(91962),p=a(67294),I=a(15009),C=a.n(I),E=a(99289),N=a.n(E),k=a(5574),L=a.n(k),b=a(42237),D=a(29608),ee=a(35790),ae=a(11475),te=a(8751),ne=a(9577),re=a(52982),se=(0,ne.f)(function(){return re.Z?sessionStorage:void 0}),ie=se,R=a(97582),$=a(22638),le=a(3917),oe=function(v,r){var s;r===void 0&&(r={});var j=r.defaultPageSize,g=j===void 0?10:j,i=r.defaultCurrent,c=i===void 0?1:i,y=(0,R._T)(r,["defaultPageSize","defaultCurrent"]),l=(0,le.Z)(v,(0,R.pi)({defaultParams:[{current:c,pageSize:g}],refreshDepsAction:function(){n(1)}},y)),m=l.params[0]||{},x=m.current,h=x===void 0?1:x,d=m.pageSize,o=d===void 0?g:d,t=((s=l.data)===null||s===void 0?void 0:s.total)||0,w=(0,p.useMemo)(function(){return Math.ceil(t/o)},[o,t]),f=function(u,A){var W=u<=0?1:u,T=A<=0?1:A,J=Math.ceil(t/T);W>J&&(W=Math.max(1,J));var z=(0,R.CR)(l.params||[]),_=z[0],De=_===void 0?{}:_,Ie=z.slice(1);l.run.apply(l,(0,R.ev)([(0,R.pi)((0,R.pi)({},De),{current:W,pageSize:T})],(0,R.CR)(Ie),!1))},n=function(u){f(u,o)},Z=function(u){f(h,u)};return(0,R.pi)((0,R.pi)({},l),{pagination:{current:h,pageSize:o,total:t,totalPage:w,onChange:(0,$.Z)(f),changeCurrent:(0,$.Z)(n),changePageSize:(0,$.Z)(Z)}})},H=oe,ce=a(77598),U=a(78697),K=a(32332),O=a(35312),Q=a(74330),X=a(83062),V=a(32983),de=a(29432),ue=a(72252),Y=a(71471),e=a(85893),G=function(r){var s=r.iconSrc,j=r.titleText,g=r.pagination,i=(0,O.useIntl)();return(0,e.jsxs)("div",{className:"flex items-center gap-4",children:[(0,e.jsx)("img",{src:s,alt:""}),(0,e.jsx)("div",{children:j}),(0,e.jsx)("div",{children:(0,e.jsx)(ue.Z,{size:"small",simple:!0,showTotal:function(y,l){return"".concat(i.formatMessage({id:"app.workflow.title.1"})).concat(l[0],"-").concat(l[1]).concat(i.formatMessage({id:"app.workflow.title.2"})," / ").concat(i.formatMessage({id:"app.workflow.title.3"})).concat(y," ").concat(i.formatMessage({id:"app.workflow.title.2"}))},current:g.current,pageSize:g.pageSize,onShowSizeChange:null,total:g.total,onChange:g.onChange})})]})},ve=function(r){var s=r.item;console.log(s);var j=(0,O.useIntl)(),g="/icons/creation/",i="",c="";switch(s.type){case 1:c=j.formatMessage({id:"app.itemHeader.agent"}),i="Agent";break;case 2:c=j.formatMessage({id:"app.itemHeader.chatRoom"}),i="ChatRoom";break;case 3:c=j.formatMessage({id:"app.itemHeader.workFlow"}),i="WorkFlow";break;default:break}return g+=de.Le[i],(0,e.jsxs)("div",{className:"flex gap-5 shrink-0",children:[(0,e.jsx)("div",{className:"shrink-0",children:(0,e.jsx)(U.Z,{Image:s.type==2?"/icons/chat_room.svg":(0,K.s9)("single",s.icon),icon:"".concat(g,".svg")})}),(0,e.jsxs)("div",{className:"flex flex-col justify-center",children:[(0,e.jsx)("div",{className:"text-sm text-[#213044]",children:(0,e.jsx)(Y.Z.Paragraph,{ellipsis:{rows:2,tooltip:s.name},className:"!mb-0",children:s.name})}),(0,e.jsx)("div",{className:"text-xs text-[#999999]",children:c})]})]})},ge=function(){var v,r,s=(0,D.Z)(function(n){return n.setDealtWithData}),j=(0,D.Z)(function(n){return n.setRunPanelLogRecord}),g=(0,D.Z)(function(n){return n.submitPromptId}),i=(0,O.useIntl)(),c=(0,p.useRef)(null),y=ie("pageNumber"),l=L()(y,2),m=l[0],x=l[1],h=function(Z){console.log(Z),s(Z)},d=function(){var n=N()(C()().mark(function Z(u){var A,W,T;return C()().wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return A=u.current,W=u.pageSize,z.next=3,(0,b.VE)({current:A,pageSize:W});case 3:return T=z.sent,z.abrupt("return",{list:T.data.list,success:!0,total:T.data.total_count});case 5:case"end":return z.stop()}},Z)}));return function(u){return n.apply(this,arguments)}}(),o=H(d,{defaultPageSize:10}),t=o.data,w=o.loading,f=o.pagination;return(0,ce.Z)(function(){c.current&&c.current.reload()},[g]),(0,e.jsx)(Q.Z,{spinning:w,children:(0,e.jsxs)("div",{style:{height:"calc(100vh - 596px)"},children:[(0,e.jsx)(G,{iconSrc:"/icons/back_log.svg",titleText:i.formatMessage({id:"app.workflow.backlogs.title"}),pagination:f}),(0,e.jsxs)("div",{className:"bg-white rounded-lg p-2.5 mt-4 overflow-y-auto h-full",style:{boxShadow:" 0px 2px 4px 0px rgba(0,0,0,0.05)"},children:[t==null||(v=t.list)===null||v===void 0?void 0:v.map(function(n,Z){return n.type=3,(0,e.jsxs)("div",{onClick:function(){n.need_human_confirm&&(s(n),j(!1))},className:"flex items-center gap-5 cursor-pointer duration-200 rounded-lg  p-2.5 hover:bg-[#fafafa]",children:[(0,e.jsx)(U.Z,{Image:(0,K.s9)("single",n.icon)}),(0,e.jsxs)("div",{className:"flex flex-col gap-1 truncate flex-1",children:[(0,e.jsxs)("div",{children:[(0,e.jsx)("span",{children:n.app_name})," ",(0,e.jsx)(ee.Z,{}),(0,e.jsx)("span",{className:n.need_human_confirm?"text-[#1B64F3]":"text-[#808183]",children:n.node_name})]}),(0,e.jsx)("div",{className:"text-[#999999] text-xs truncate",children:n.app_run_name})]}),(0,e.jsx)("div",{children:n.need_human_confirm?(0,e.jsx)(X.Z,{title:i.formatMessage({id:"workflow.needHumanConfirm"}),children:(0,e.jsx)(ae.Z,{className:"text-[#1B64F3]"})}):(0,e.jsx)(X.Z,{title:i.formatMessage({id:"workflow.noHumanConfirm"}),children:(0,e.jsx)(te.Z,{className:"text-[#808183]"})})})]},n.exec_id)}),!w&&(t==null||(r=t.list)===null||r===void 0?void 0:r.length)===0&&(0,e.jsx)("div",{className:"h-full flex items-center justify-center",children:(0,e.jsx)(V.Z,{image:"/images/empty.svg",description:i.formatMessage({id:"app.workflow.backlogs.empty"})})})]})]})})},fe=a(29933),pe=a(4393),We=pe.Z.Meta,me=function(){var v,r,s=(0,O.useIntl)(),j=function(x){console.log(x);var h=x.app_id||x.apps_id;switch(x.type){case 1:O.history.push("/Agents?app_id=".concat(h));break;case 2:O.history.push("/chat_room/".concat(x.chatroom_id));break;case 3:O.history.push("/workspace/workflow?app_id=".concat(h));break;default:break}},g=function(){var m=N()(C()().mark(function x(h){var d,o,t;return C()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return d=h.current,o=h.pageSize,f.next=3,(0,b.vu)({current:d,pageSize:o});case 3:return t=f.sent,f.abrupt("return",{list:t.data.list,success:!0,total:t.data.total_count});case 5:case"end":return f.stop()}},x)}));return function(h){return m.apply(this,arguments)}}(),i=H(g,{defaultPageSize:8}),c=i.data,y=i.loading,l=i.pagination;return console.log(y),(0,e.jsxs)("div",{className:"flex-grow-0",children:[(0,e.jsx)(G,{iconSrc:"/icons/recently_active.svg",titleText:s.formatMessage({id:"app.workflow.ra.title"}),pagination:l}),(0,e.jsx)("div",{className:"grid grid-cols-4  gap-4 mt-4",children:c==null||(v=c.list)===null||v===void 0?void 0:v.map(function(m,x){var h=m.type==3?m.process_name:m.last_agent_name;return(0,e.jsx)(fe.Z,{className:"h-[160px] cursor-pointer transition shadow-lg shadow-gray-100 hover:shadow-gray-200",title:(0,e.jsx)(ve,{item:m}),onClick:function(){return j(m)},bodyStyle:{padding:"15px 20px"},children:(0,e.jsx)(Y.Z.Paragraph,{ellipsis:{rows:2,tooltip:h},children:h})},m.app_id)})}),!(c!=null&&(r=c.list)!==null&&r!==void 0&&r.length)&&(0,e.jsxs)("div",{className:"h-[400px] w-full flex items-center justify-center",children:[!y&&(0,e.jsx)(V.Z,{imageStyle:{display:"flex",justifyContent:"center"},image:"/images/empty.svg",description:s.formatMessage({id:"app.workflow.ra.empty"})}),(0,e.jsx)(Q.Z,{spinning:y})]})]})},B=a(1413),xe=a(99011),q=a(91146),he=function(r,s){return p.createElement(q.Z,(0,B.Z)((0,B.Z)({},r),{},{ref:s,icon:xe.Z}))},je=p.forwardRef(he),Se=je,Ce=a(88284),ye={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M464 720a48 48 0 1096 0 48 48 0 10-96 0zm16-304v184c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V416c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8zm475.7 440l-416-720c-6.2-10.7-16.9-16-27.7-16s-21.6 5.3-27.7 16l-416 720C56 877.4 71.4 904 96 904h832c24.6 0 40-26.6 27.7-48zm-783.5-27.9L512 239.9l339.8 588.2H172.2z"}}]},name:"warning",theme:"outlined"},Ze=ye,we=function(r,s){return p.createElement(q.Z,(0,B.Z)((0,B.Z)({},r),{},{ref:s,icon:Ze}))},Pe=p.forwardRef(we),Ne=Pe,Re=a(44720),ze=a(38703),Me=(0,p.memo)(function(){var v,r,s=(0,D.Z)(function(d){return d.setDealtWithData}),j=(0,D.Z)(function(d){return d.setRunPanelLogRecord}),g=(0,O.useIntl)(),i=function(o){var t=o.text;switch(t){case 1:return(0,e.jsx)(Se,{className:"text-blue-500"});case 2:return(0,e.jsx)(Ce.Z,{className:"text-green-500"});case 3:return(0,e.jsx)(Ne,{className:"text-red-500"})}return(0,e.jsx)("span",{children:t})},c=function(){var d=N()(C()().mark(function o(t){var w,f,n;return C()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return w=t.current,f=t.pageSize,u.next=3,(0,b.PE)({current:w,pageSize:f});case 3:return n=u.sent,u.abrupt("return",{list:n.data.list,success:!0,total:n.data.total_count});case 5:case"end":return u.stop()}},o)}));return function(t){return d.apply(this,arguments)}}(),y=H(c,{defaultPageSize:10}),l=y.data,m=y.loading,x=y.pagination,h=(0,p.memo)(function(d){var o,t=d.item,w=t.status==1?"#1B64F3":t.status==2?"#22C55F":"#F04444",f=t.status==1?"#f9fafe":t.status==2?"#f6fcf3":"#fafafa",n=(0,p.useRef)(null),Z=(0,Re.Z)(n);return(0,e.jsxs)("div",{onClick:function(){j(t),s(null)},ref:n,className:"flex relative rounded truncate gap-5  items-center shrink-0 cursor-pointer duration-200  box-border py-2.5 pr-5 ",children:[(0,e.jsx)("div",{style:{backgroundColor:Z?f:"",width:Z?"".concat(t.completed_steps/t.total_steps*100,"%"):"0%",transition:"0.5s"},className:"w-full h-full absolute left-0 duration-500"}),(0,e.jsx)("div",{style:{backgroundColor:w},className:"w-[4px] h-full z-10 mr-[10px] absolute"}),(0,e.jsx)("div",{className:"ml-5",children:(0,e.jsx)(U.Z,{Image:(0,K.s9)("single",t.icon)})}),(0,e.jsxs)("div",{className:"flex flex-col gap-1 truncate flex-1  z-10",children:[(0,e.jsx)("div",{children:(0,e.jsx)("span",{children:t.app_runs_name})}),(0,e.jsx)("div",{className:"text-[#999999] text-xs truncate  max-w-7/8",children:(0,e.jsxs)("div",{className:"flex items-center truncate",children:[(0,e.jsxs)("span",{children:[" ",t.created_time," "]}),(0,e.jsx)("span",{style:{maxWidth:"calc(100% - 200px)"},className:"truncate ml-2 ",children:t.apps_name}),(0,e.jsxs)("span",{className:"inline-flex items-center ml-2 gap-2",children:[(0,e.jsx)("span",{style:{backgroundColor:w},className:"inline-block w-1 h-1 rounded-sm"}),(o=t.elapsed_time)===null||o===void 0?void 0:o.toFixed(6),"S"]})]})})]}),(0,e.jsx)("div",{className:"flex items-center justify-center",children:(0,e.jsx)(ze.Z,{type:"circle",size:30,percent:parseInt(t.completed_steps/t.total_steps*100)})})]},t.app_run_id)});return(0,e.jsxs)("div",{style:{height:"calc(100vh - 596px)"},children:[(0,e.jsx)(G,{iconSrc:"/icons/workflows.svg",titleText:g.formatMessage({id:"app.workflow.log.title"}),pagination:x}),(0,e.jsxs)("div",{className:"bg-white rounded-lg p-4 h-full mt-4 overflow-y-auto box-border relative flex flex-col gap-5",style:{boxShadow:" 0px 2px 4px 0px rgba(0,0,0,0.05)"},children:[l==null||(v=l.list)===null||v===void 0?void 0:v.map(function(d,o){return(0,e.jsx)(h,{item:d})}),!m&&(l==null||(r=l.list)===null||r===void 0?void 0:r.length)===0&&(0,e.jsx)("div",{className:"h-full flex items-center justify-center",children:(0,e.jsx)(V.Z,{image:"/images/empty.svg",description:g.formatMessage({id:"app.workflow.log.empty"})})})]})]})}),Oe=function(){return(0,e.jsxs)("div",{style:{height:"calc(100vh - 56px)"},className:"w-full p-[30px] flex flex-col gap-6 overflow-x-auto box-border",children:[(0,e.jsx)(me,{}),(0,e.jsxs)("div",{className:"grid grid-cols-2 gap-6 flex-1",children:[(0,e.jsx)(ge,{}),(0,e.jsx)(Me,{})]}),(0,e.jsx)(P.$_,{}),(0,e.jsx)(S.Z,{})]})},Ee=Oe}}]);
