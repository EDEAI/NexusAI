"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[178],{83510:function(Ht,ze,s){s.d(ze,{LK:function(){return Ge},bs:function(){return Fe},go:function(){return dt},uy:function(){return Ae}});var nt=s(15009),ee=s.n(nt),it=s(99289),Z=s.n(it),ue=s(47520),te="/v1/apps/apps_list",lt="/v1/agent/agent_delete/",t="/v1/workflow/workflow_app_delete/",rt="/v1/vector/delete_dataset/",p="/v1/skill/delete_skill_by_app_id/",K="/v1/apps/apps_create",ot="/v1/apps/app_update/",dt=function(){var ce=Z()(ee()().mark(function W(A){var U;return ee()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,(0,ue.ZP)("".concat(te),{method:"GET",data:A});case 2:return U=c.sent,c.abrupt("return",U);case 4:case"end":return c.stop()}},W)}));return function(A){return ce.apply(this,arguments)}}(),Ge=function(){var ce=Z()(ee()().mark(function W(A){var U;return ee()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return console.log(A),c.next=3,A.mode;case 3:if(c.t0=c.sent,c.t0!=1){c.next=8;break}c.t1=(0,ue.ZP)("".concat(lt).concat(A.app_id),{method:"DELETE"}),c.next=9;break;case 8:c.t1=A.mode==2?(0,ue.ZP)("".concat(t).concat(A.app_id),{method:"DELETE"}):A.mode==3?(0,ue.ZP)("".concat(rt).concat(A.app_id),{method:"DELETE"}):(0,ue.ZP)("".concat(p).concat(A.app_id),{method:"DELETE",data:{is_soft:1}});case 9:return U=c.t1,c.abrupt("return",U);case 11:case"end":return c.stop()}},W)}));return function(A){return ce.apply(this,arguments)}}(),Ae=function(){var ce=Z()(ee()().mark(function W(A){var U;return ee()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,(0,ue.ZP)("".concat(K),{method:"POST",data:A});case 2:return U=c.sent,c.abrupt("return",U);case 4:case"end":return c.stop()}},W)}));return function(A){return ce.apply(this,arguments)}}(),Fe=function(){var ce=Z()(ee()().mark(function W(A){var U;return ee()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,(0,ue.ZP)("".concat(ot).concat(A.app_id),{method:"PUT",data:A});case 2:return U=c.sent,c.abrupt("return",U);case 4:case"end":return c.stop()}},W)}));return function(A){return ce.apply(this,arguments)}}()},48528:function(Ht,ze,s){s.r(ze),s.d(ze,{default:function(){return Na}});var nt=s(19632),ee=s.n(nt),it=s(15009),Z=s.n(it),ue=s(99289),te=s.n(ue),lt=s(97857),t=s.n(lt),rt=s(5574),p=s.n(rt),K=s(11551),ot=s(83510),dt=s(47520),Ge=s(29432),Ae=s(10759),Fe=s(32332),ce=s(2068),W=s(89035),A=s(15360),U=s(82826),Be=s(69243),c=s(35312),_=s(40741),I=s(45360),me=s(28036),Xt=s(50136),ut=s(25409),Mt=s(74330),g=s(67294),fe=s(92939),Yt=s(85750),Jt=s(5608),Qt=s(64599),qt=s.n(Qt),ea=s(73445),ta=s(42237),Ke=(0,ea.Ue)(function(ge){return{models:[],loading:!1,error:null,initialized:!1,fetchModels:function(){var i=te()(Z()().mark(function k(){var M;return Z()().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.prev=0,ge({loading:!0}),h.next=4,(0,ta.fZ)();case 4:if(M=h.sent,M.code!==0){h.next=9;break}ge({models:Array.isArray(M.data.data)?M.data.data:[],initialized:!0}),h.next=10;break;case 9:throw new Error(M.message||"Failed to fetch models");case 10:h.next=16;break;case 12:h.prev=12,h.t0=h.catch(0),ge({error:h.t0.message}),I.ZP.error("Failed to fetch models");case 16:return h.prev=16,ge({loading:!1}),h.finish(16);case 19:case"end":return h.stop()}},k,null,[[0,12,16,19]])}));function L(){return i.apply(this,arguments)}return L}()}}),aa=function(){var i=Ke(function(h){return h.models}),L=Ke(function(h){return h.loading}),k=Ke(function(h){return h.initialized}),M=Ke(function(h){return h.fetchModels});(0,g.useEffect)(function(){k||M()},[k,M]);var j=(0,g.useMemo)(function(){var h=Array.isArray(i)?i:[],Ze=h.map(function(x){return{label:x.supplier_name,options:Array.isArray(x.model_list)?x.model_list.map(function(Y){return t()({label:Y.model_name,value:Y.model_config_id},Y)}):[]}}),X,a=qt()(h),C;try{for(a.s();!(C=a.n()).done;){var ie=C.value;if(Array.isArray(ie.model_list)){var y=ie.model_list.find(function(x){return x.model_default_used===1});if(y){X=y.model_config_id;break}}}}catch(x){a.e(x)}finally{a.f()}return{options:Ze,defaultValue:X}},[i]);return t()(t()({},j),{},{loading:L})},Me=s(26915),He=s(72269),ct=s(34041),Zt=s(66309),H=s(78045),kt=s(44010),Le=s(51042),mt=s(82061),Pt=s(80459),e=s(85893),sa=Me.Z.TextArea,na=function(i){var L,k,M,j,h,Ze=i.loading,X=i.FirstValue,a=i.Detaillist,C=i.setDetaillist,ie=i.repository,y=i.setRepository,x=i.Operationbentate,Y=i.Ffromref,le=i.setFourthly_config_id,ke=i.Fourthly_config_id,pe=i.Fourthly_select_list,he=i.Newproperties,we=i.setNewproperties,ve=i.pageKeyfun,b=i.firstjudgingcondition,re=i.setAgentmunudisabled,Ne=i.agentmenudisabled,d=(0,c.useIntl)(),De=(0,g.useState)([]),J=p()(De,2),F=J[0],Q=J[1],V=(0,g.useState)(!1),R=p()(V,2),xe=R[0],Ee=R[1],ae=(0,g.useState)([]),oe=p()(ae,2),be=oe[0],je=oe[1],Xe=(0,g.useState)([]),T=p()(Xe,2),S=T[0],w=T[1],$=(0,g.useState)(!1),B=p()($,2),E=B[0],z=B[1],Ye=(0,g.useState)(!1),Je=p()(Ye,2),ft=Je[0],Pe=Je[1],Ie=(0,g.useState)({agent_id:0,data:{is_public:1,enable_api:0,obligations:null,input_variables:{},dataset_ids:[],attrs_are_visible:1}}),Ce=p()(Ie,2),q=Ce[0],_e=Ce[1];(0,g.useEffect)(function(){ht(),a.agent.selected_skills&&je(a.agent.selected_skills),a.agent.selected_workflows&&w(a.agent.selected_workflows)},[a,a==null?void 0:a.agent]);var Dt=function(n){le(n)},Et=function(n){_e(t()(t()({},q),{},{data:t()(t()({},q.data),{},{obligations:n.target.value})})),C(t()(t()({},a),{},{agent:t()(t()({},a.agent),{},{obligations:n.target.value})}))},It=function(n,N){var O=new Set;return n.some(function(G){var ne=G[N];return O.has(ne)?O.add(ne):O.add(ne)&&!1})},Qe=function(n){C(t()(t()({},a),{},{app:t()(t()({},a.app),{},{is_public:n?1:0})})),_e(t()(t()({},q),{},{data:t()(t()({},q.data),{},{is_public:n?1:0})}))},qe=function(n){C(t()(t()({},a),{},{app:t()(t()({},a.app),{},{enable_api:n?1:0})})),_e(t()(t()({},q),{},{data:t()(t()({},q.data),{},{enable_api:n?1:0})}))},gt=function(n){C(t()(t()({},a),{},{app:t()(t()({},a.app),{},{attrs_are_visible:n?1:0})})),_e(t()(t()({},q),{},{data:t()(t()({},q.data),{},{attrs_are_visible:n?1:0})}))},Tt=function(n){C(t()(t()({},a),{},{agent:t()(t()({},a.agent),{},{allow_upload_file:n?1:0})}))},pt=function(n){C(t()(t()({},a),{},{agent:t()(t()({},a.agent),{},{mcp:n?1:0})}))},ye=function(n){_e(t()(t()({},q),{},{data:t()(t()({},q.data),{},{dataset_ids:n})})),y(n)},ht=function(){var r=te()(Z()().mark(function n(){var N;return Z()().wrap(function(G){for(;;)switch(G.prev=G.next){case 0:return G.next=2,(0,K.zl)();case 2:N=G.sent,Q(N.data.data.map(function(ne){return{value:ne.dataset_id,label:ne.name}}));case 4:case"end":return G.stop()}},n)}));return function(){return r.apply(this,arguments)}}(),Ot=function(n){je(n),C(t()(t()({},a),{},{agent:t()(t()({},a.agent),{},{selected_skills:n})}))},vt=function(n){w(n),C(t()(t()({},a),{},{agent:t()(t()({},a.agent),{},{selected_workflows:n})}))},se=function(){var r=te()(Z()().mark(function n(){return Z()().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:b()||(ve("2"),re(t()(t()({},Ne),{},{first:!1,second:!1})));case 1:case"end":return O.stop()}},n)}));return function(){return r.apply(this,arguments)}}(),Te=function(n){C(t()(t()({},a),{},{agent:t()(t()({},a.agent),{},{default_output_format:n.target.value})}))},xt=function(n){C(t()(t()({},a),{},{agent:t()(t()({},a==null?void 0:a.agent),{},{input_variables:n.free})}))},Re=aa(),et=Re.options,bt=Re.defaultValue,jt=function(n){je(n.checkItem),C(t()(t()({},a),{},{agent:t()(t()({},a.agent),{},{selected_skills:n.checkItem})})),z(!1)},tt=function(n){w(n.checkItem),C(t()(t()({},a),{},{agent:t()(t()({},a.agent),{},{selected_workflows:n.checkItem})})),Pe(!1)},yt=function(){z(!1)},St=function(){Pe(!1)},wt=function(n){var N=be.filter(function(O){return O.app_id!==n.app_id});je(N),C(t()(t()({},a),{},{agent:t()(t()({},a.agent),{},{selected_skills:N})}))},at=function(n){var N=S.filter(function(O){return O.app_id!==n.app_id});w(N),C(t()(t()({},a),{},{agent:t()(t()({},a.agent),{},{selected_workflows:N})}))};return(0,e.jsxs)("div",{style:{height:"100%",width:"100%",marginBottom:"30px"},children:[(0,e.jsx)("div",{className:"flex align-center justify-between mt-[30px]",children:(0,e.jsx)("div",{className:"text-base font-medium mb-[30px] text-[#333333]",children:d.formatMessage({id:"agent.menu.basicsetup"})})}),(0,e.jsx)("div",{className:"w-full",children:(0,e.jsxs)(_.Z,{name:"dynamic_form_nest_item",style:{width:"100%"},autoComplete:"off",form:Y,children:[(0,e.jsx)(_.Z.Item,{className:"mb-[30px]",children:(0,e.jsxs)("div",{className:"text-[#555555] text-xs",children:[(0,e.jsx)("div",{className:"font-medium  mb-[15px]",children:d.formatMessage({id:"agent.appname"})}),(0,e.jsxs)("div",{className:"w-full p-[15px] flex font-normal items-center bg-[#F7F7F7] rounded-lg",children:[(0,e.jsxs)("div",{children:[a&&a.app&&a.app.name,"\xA0"]}),(0,e.jsx)("div",{className:"",children:x==="true"?d.formatMessage({id:"agent.cannotmodify"}):""})]})]})}),(0,e.jsx)(_.Z.Item,{className:"mb-[30px]",children:(0,e.jsxs)("div",{className:"text-[#555555] text-xs",children:[(0,e.jsx)("div",{className:"font-medium  mb-[15px]",children:d.formatMessage({id:"agent.appdescription"})}),(0,e.jsx)("div",{className:"w-full p-[15px] flex font-normal items-center bg-[#F7F7F7] rounded-lg",children:a&&a.app&&a.app.description})]})}),(0,e.jsx)(_.Z.Item,{className:"mb-[30px]",children:(0,e.jsxs)("div",{children:[(0,e.jsxs)("div",{className:"mb-[30px]",children:[(0,e.jsx)("div",{className:"mb-[15px] text-[#555555] text-xs",children:(0,e.jsx)(fe.Z,{className:"font-medium",name:d.formatMessage({id:"agent.teamvisibility"}),title:d.formatMessage({id:"agent.explain.teamvisibility"})})}),(0,e.jsx)(He.Z,{size:"small",onChange:Qe,checked:!!(a&&((L=a.app)===null||L===void 0?void 0:L.is_public)===1)})]}),(0,e.jsxs)("div",{className:"mb-[30px]  font-medium",children:[(0,e.jsx)("div",{className:"mb-[15px] text-[#555555] text-xs",children:(0,e.jsx)(fe.Z,{className:"font-medium",name:d.formatMessage({id:"agent.attrVisible"}),title:d.formatMessage({id:"agent.explain.attrVisible"})})}),(0,e.jsx)(He.Z,{size:"small",onChange:gt,checked:a&&((k=a.app)===null||k===void 0?void 0:k.attrs_are_visible)===1})]}),(0,e.jsxs)("div",{className:"mb-[30px]  font-medium",children:[(0,e.jsx)("div",{className:"mb-[15px] text-[#555555] text-xs",children:d.formatMessage({id:"agent.APIswitch"})}),(0,e.jsx)(He.Z,{size:"small",onChange:qe,checked:a&&((M=a.app)===null||M===void 0?void 0:M.enable_api)===1,disabled:(a==null||(j=a.app)===null||j===void 0?void 0:j.publish_status)!==1})]})]})}),(0,e.jsx)(_.Z.Item,{className:"mb-[30px]",children:(0,e.jsxs)("div",{children:[(0,e.jsxs)("div",{className:"mb-[15px] text-[#555555] text-xs font-medium",children:[(0,e.jsx)("span",{className:"text-[#E80000]",children:"* "}),d.formatMessage({id:"agent.LLMmodel"})]}),(0,e.jsx)(ct.Z,{placeholder:d.formatMessage({id:"agent.pleaseselect"}),value:ke==0?d.formatMessage({id:"agent.pleaseselect"}):ke,variant:"filled",onChange:Dt,options:et,optionRender:function(n){var N;return(0,e.jsxs)("div",{children:[n.label," ",(n==null||(N=n.data)===null||N===void 0?void 0:N.support_image)==1&&(0,e.jsx)(Zt.Z,{color:"blue",className:"text-xs",children:d.formatMessage({id:"workflow.tag.imageUnderstanding",defaultMessage:"Image Understanding"})})]})},labelRender:function(n){var N;return(0,e.jsxs)("div",{children:[n==null?void 0:n.label," ",((N=(0,Yt.ti)(n==null?void 0:n.value,{options:et}))===null||N===void 0?void 0:N.support_image)==1&&(0,e.jsx)(Zt.Z,{color:"blue",className:"text-xs",children:d.formatMessage({id:"workflow.tag.imageUnderstanding",defaultMessage:"Image Understanding"})})]})}})]})}),(0,e.jsx)(_.Z.Item,{className:"mb-[30px]",name:"obligations",children:(0,e.jsxs)("div",{className:"w-full",children:[(0,e.jsx)("div",{className:"mb-[15px] text-[#555555] text-xs",children:(0,e.jsx)(fe.Z,{className:"font-medium",required:!0,name:d.formatMessage({id:"agent.functiondescription"}),title:d.formatMessage({id:"agent.explain.function"})})}),(0,e.jsx)(sa,{onChange:Et,value:a&&a.agent&&a.agent.obligations,placeholder:"Agent".concat(d.formatMessage({id:"agent.functiondescription"})),autoSize:{minRows:8,maxRows:10}})]})}),!xe&&(0,e.jsx)("div",{className:"mb-[30px]",children:(0,e.jsx)(Jt.Z,{title:(0,e.jsx)("div",{className:"text-[#555555] text-xs",children:(0,e.jsx)(fe.Z,{className:"font-medium",required:!0,name:d.formatMessage({id:"agent.inputvariable"}),title:d.formatMessage({id:"agent.explain.inputvariable"})})}),variables:Object.values((a==null||(h=a.agent)===null||h===void 0||(h=h.input_variables)===null||h===void 0?void 0:h.properties)||{}),onChange:xt})}),(0,e.jsx)(_.Z.List,{name:"users",children:function(n,N){var O=N.add,G=N.remove;return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(_.Z.Item,{className:"mb-[30px]",children:[(0,e.jsx)("div",{className:"text-[#555555] text-xs mb-[15px]",children:(0,e.jsx)(fe.Z,{className:"font-medium",name:d.formatMessage({id:"agent.associatedknowledgebase"}),title:d.formatMessage({id:"agent.explain.associatedknowledgebase"})})}),(0,e.jsx)(ct.Z,{size:"large",mode:"multiple",showSearch:!0,style:{width:"100%",fontSize:"12px"},placeholder:d.formatMessage({id:"agent.pleaseselect"}),filterOption:function($e,Oe){var Ve;return((Ve=Oe==null?void 0:Oe.label)!==null&&Ve!==void 0?Ve:"").toLowerCase().includes($e.toLowerCase())},value:ie,onChange:ye,options:F})]}),(0,e.jsx)(_.Z.Item,{className:"mb-[30px]",children:(0,e.jsxs)("div",{className:"",children:[(0,e.jsxs)("div",{className:"text-[#555555] text-xs mb-[15px]",children:[" ",d.formatMessage({id:"agent.defaultoutputformat"})]}),(0,e.jsxs)(H.ZP.Group,{value:a&&a.agent.default_output_format,onChange:function($e){Te($e)},children:[(0,e.jsx)(H.ZP,{value:1,children:(0,e.jsx)("div",{className:"text-[#555555] text-xs font-normal",children:"text"})}),(0,e.jsx)(H.ZP,{value:2,children:(0,e.jsx)("div",{className:"text-[#555555] text-xs font-normal",children:"json"})}),(0,e.jsx)(H.ZP,{value:3,children:(0,e.jsx)("div",{className:"text-[#555555] text-xs font-normal",children:"code"})})]})]})})]})}}),(0,e.jsxs)(_.Z.Item,{className:"mb-[30px]",children:[(0,e.jsx)("div",{className:"text-[#555555] text-base mb-[15px]",children:d.formatMessage({id:"agent.mcp.resources"})}),(0,e.jsxs)("div",{className:"pl-4 ",children:[(0,e.jsxs)("div",{className:"mb-[30px]",children:[(0,e.jsxs)("div",{className:"flex items-center justify-between mb-[15px]",children:[(0,e.jsx)("div",{className:"text-[#555555] text-xs",children:(0,e.jsx)(fe.Z,{className:"font-medium",name:d.formatMessage({id:"agent.selectSkills"}),title:d.formatMessage({id:"agent.explain.selectSkills"})})}),(0,e.jsx)(me.ZP,{type:"link",icon:(0,e.jsx)(Le.Z,{}),onClick:function(){return z(!0)},className:"text-xs",children:d.formatMessage({id:"agent.addSkill"})})]}),be.length>0?(0,e.jsx)("div",{className:"flex flex-col gap-4 mb-4",children:be.map(function(r){return(0,e.jsxs)("div",{className:"group relative flex items-center cursor-pointer w-full p-2 bg-white rounded-lg shadow-sm transition-shadow",children:[(0,e.jsx)(Pt.Z,{rounded:"6px",data:r,bg:r.icon_background}),(0,e.jsxs)("div",{className:"flex flex-col ml-2 truncate",children:[(0,e.jsx)("span",{className:"text-sm font-medium text-[#333333]",children:r.name}),(0,e.jsx)("span",{className:"text-xs text-[#666666] truncate",children:r.description})]}),(0,e.jsx)("div",{className:"absolute right-2 top-1/2 -translate-y-1/2 opacity-0 group-hover:opacity-100 transition-opacity cursor-pointer hover:text-red-500",onClick:function(N){N.stopPropagation(),wt(r)},children:(0,e.jsx)(mt.Z,{})})]},r.app_id)})}):(0,e.jsx)("div",{onClick:function(){return z(!0)},className:"w-full h-[120px] flex items-center justify-center border border-dashed border-[#e8e8e8] rounded-lg bg-[#fafafa] cursor-pointer hover:border-[#1b64f3] transition-colors",children:(0,e.jsxs)("div",{className:"flex flex-col items-center gap-2",children:[(0,e.jsx)(Le.Z,{className:"text-[#999999] text-lg"}),(0,e.jsx)("span",{className:"text-[#999999] text-sm",children:d.formatMessage({id:"agent.addSkill"})})]})}),(0,e.jsx)(kt.Z,{show:E,popupClose:yt,popupSave:jt,checkList:be,radio:!1,nodetype:"skill",zIndex:30})]}),(0,e.jsxs)("div",{className:"mb-[30px]",children:[(0,e.jsxs)("div",{className:"flex items-center justify-between mb-[15px]",children:[(0,e.jsx)("div",{className:"text-[#555555] text-xs",children:(0,e.jsx)(fe.Z,{className:"font-medium",name:d.formatMessage({id:"agent.selectWorkflows"}),title:d.formatMessage({id:"agent.explain.selectWorkflows"})})}),(0,e.jsx)(me.ZP,{type:"link",icon:(0,e.jsx)(Le.Z,{}),onClick:function(){return Pe(!0)},className:"text-xs",children:d.formatMessage({id:"agent.addWorkflow"})})]}),S.length>0?(0,e.jsx)("div",{className:"flex flex-col gap-4 mb-4",children:S.map(function(r){return(0,e.jsxs)("div",{className:"group relative flex items-center cursor-pointer w-full p-2 bg-white rounded-lg shadow-sm transition-shadow",children:[(0,e.jsx)(Pt.Z,{rounded:"6px",data:r,bg:r.icon_background}),(0,e.jsxs)("div",{className:"flex flex-col ml-2 truncate",children:[(0,e.jsx)("span",{className:"text-sm font-medium text-[#333333]",children:r.name}),(0,e.jsx)("span",{className:"text-xs text-[#666666] truncate",children:r.description})]}),(0,e.jsx)("div",{className:"absolute right-2 top-1/2 -translate-y-1/2 opacity-0 group-hover:opacity-100 transition-opacity cursor-pointer hover:text-red-500",onClick:function(N){N.stopPropagation(),at(r)},children:(0,e.jsx)(mt.Z,{})})]},r.app_id)})}):(0,e.jsx)("div",{onClick:function(){return Pe(!0)},className:"w-full h-[120px] flex items-center justify-center border border-dashed border-[#e8e8e8] rounded-lg bg-[#fafafa] cursor-pointer hover:border-[#1b64f3] transition-colors",children:(0,e.jsxs)("div",{className:"flex flex-col items-center gap-2",children:[(0,e.jsx)(Le.Z,{className:"text-[#999999] text-lg"}),(0,e.jsx)("span",{className:"text-[#999999] text-sm",children:d.formatMessage({id:"agent.addWorkflow"})})]})}),(0,e.jsx)(kt.Z,{show:ft,popupClose:St,popupSave:tt,checkList:S,radio:!1,nodetype:"workflow",zIndex:30})]})]})]}),(0,e.jsxs)("div",{children:[(0,e.jsx)(me.ZP,{type:"primary",className:"mr-[20px]",onClick:function(){se()},children:d.formatMessage({id:"agent.btn.nextstep"})}),(0,e.jsx)(me.ZP,{onClick:function(){history.back()},children:d.formatMessage({id:"agent.btn.back"})})]}),(0,e.jsx)("div",{className:"h-[30px] w-1"})]})})]})},ia=na,la=s(13769),Ct=s.n(la),ra=s(49677),oa=s.n(ra),da=s(92485),ua=s(85877),At=s(39944),ca=s(71471),ma=["key","name"],Ea=ca.Z.Title,Ia=Me.Z.TextArea,Ta=Me.Z.Search,fa=function(i){var L=i.handleBack,k=i.Detaillist,M=i.setDetaillist,j=i.Fourthly_select_list,h=i.setFourthly_config_id,Ze=i.Fourthly_config_id,X=i.Fourthlyref,a=i.Fourthly_abilities_list,C=i.Operationbentate,ie=i.callwordlist,y=i.newagentid,x=(0,c.useIntl)(),Y=(0,g.useState)(0),le=p()(Y,2),ke=le[0],pe=le[1],he=(0,g.useState)(""),we=p()(he,2),ve=we[0],b=we[1],re=(0,g.useState)(""),Ne=p()(re,2),d=Ne[0],De=Ne[1],J=(0,g.useState)(!1),F=p()(J,2),Q=F[0],V=F[1],R=function(S){var w={user:{value:oe(S)}};b(new At.z(w))},xe=function(S){var w={user:{value:S.target.value}};b(new At.z(w))},Ee=function(S){pe(S)},ae=function(S){var w=S.users.filter(function(E,z){return E.type=="number"&&!Number(E.value)&&!!E.value});if(!ve.user)I.ZP.warning(x.formatMessage({id:"agent.message.warning.callword"}));else if(w.length>0)I.ZP.warning(x.formatMessage({id:"agent.message.warning.datatype"}));else{V(!0);var $=new Ae.Kr("input","","");S.users.forEach(function(E){var z=new Ae._w(E.name,E.type?E.type:"string",E.type=="string"?E.value:Number(E.value),E.content,E.status);$.addProperty(E.name,z)});var B={agent_id:y||k.agent.agent_id,ability_id:ke,input_dict:$,prompt:ve};be(B)}},oe=function T(S){return S.map(function(w){return w.type==="mention"?w.id:w.children?T(w.children):w.text}).join("")},be=function(S){(0,K.LH)(S).then(function(w){I.ZP.success(x.formatMessage({id:"agent.message.success.runpublish"})),De(w.data.outputs.text),V(!1)}).catch(function(w){V(!1)})},je=function(){var T=te()(Z()().mark(function S(){var w;return Z()().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:return B.next=2,(0,K.Dh)(y||k.agent.agent_id);case 2:w=B.sent,w.code==0?I.ZP.success(x.formatMessage({id:"agent.message.success.publish"})):I.ZP.error(x.formatMessage({id:"agent.message.fail.publish"}));case 4:case"end":return B.stop()}},S)}));return function(){return T.apply(this,arguments)}}(),Xe=function(){var T=te()(Z()().mark(function S(){return Z()().wrap(function($){for(;;)switch($.prev=$.next){case 0:c.history.push("/Agents?app_id=".concat(k.app.app_id,"&type=false")),location.reload();case 2:case"end":return $.stop()}},S)}));return function(){return T.apply(this,arguments)}}();return(0,g.useEffect)(function(){},[]),(0,e.jsxs)("div",{style:{height:"100%"},children:[(0,e.jsx)("div",{className:"text-base font-medium text-[#333333] my-[30px]",children:x.formatMessage({id:"agent.operationrun"})}),(0,e.jsxs)("div",{className:"mb-[30px]",children:[(0,e.jsx)("div",{className:"mb-[15px] text-[#555555] text-xs font-medium",children:x.formatMessage({id:"agent.selectivepower"})}),(0,e.jsx)(ct.Z,{placeholder:x.formatMessage({id:"agent.pleaseselect"}),defaultValue:x.formatMessage({id:"agent.allability"}),style:{width:390,fontSize:"12px",color:"#BBBBBB",fontWeight:"400"},onChange:Ee,options:a})]}),(0,e.jsx)("div",{children:(0,e.jsxs)(_.Z,{name:"dynamic_form_nest_item",onFinish:ae,style:{width:"100%"},autoComplete:"off",form:X,children:[(0,e.jsx)("div",{className:"mb-[15px] text-[#555555] text-xs font-medium",children:x.formatMessage({id:"agent.inputvariable"})}),(0,e.jsx)(_.Z.List,{name:"users",children:function(S,w){return oa()(w),(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)("div",{className:"w-full flex justify-start items-center text-xs font-medium px-[10px] text-[#213044] h-12 bg-[#F7F7F7]  rounded-t-lg",children:[(0,e.jsx)("div",{className:"mr-5 ml-2.5",children:x.formatMessage({id:"agent.variable.name"})}),(0,e.jsx)("div",{className:"",children:x.formatMessage({id:"agent.variable.value"})})]}),(0,e.jsx)("div",{className:"mb-[30px]",children:S.map(function($){var B=$.key,E=$.name,z=Ct()($,ma);return(0,e.jsxs)("div",{className:"w-full h-20 flex justify-start  px-2.5 border-b border-x pt-7 last:rounded-b-lg",children:[(0,e.jsx)(_.Z.Item,t()(t()({},z),{},{name:[E,"content"],children:(0,e.jsx)(Me.Z,{className:"mr-5",style:{color:"#213044",fontWeight:"400",fontSize:"12px"},variant:"borderless",disabled:!0})})),(0,e.jsx)(_.Z.Item,t()(t()({},z),{},{name:[E,"value"],rules:[{required:!!(X.getFieldsValue()&&X.getFieldsValue().users[B].status==!0),message:x.formatMessage({id:"agent.rules.veriablevalue"})}],children:(0,e.jsx)(Me.Z,{placeholder:X.getFieldsValue()&&X.getFieldsValue().users[B].status==!0?x.formatMessage({id:"agent.variable.required.value"}):x.formatMessage({id:"agent.variable.value"})})}))]})})})]})}}),(0,e.jsxs)(_.Z.Item,{rules:[{required:!0,message:x.formatMessage({id:"agent.rules.callwordvalue"})}],children:[(0,e.jsx)("div",{className:"mb-[15px] text-[#555555] text-xs font-medium",children:x.formatMessage({id:"agent.runpreview"})}),(0,e.jsx)(Mt.Z,{spinning:Q,children:(0,e.jsxs)("div",{className:"bg-[#F7F7F7] p-3.5 rounded-lg",children:[(0,e.jsx)("div",{className:"h-[345px] mb-[30px]",children:d?(0,e.jsx)(da.Z,{language:"python3",value:d&&JSON.stringify(d)}):null}),(0,e.jsxs)("div",{className:"agents-input p-2 bg-white border rounded-md my-2 flex items-center justify-between",style:{border:"1px solid #EEE"},children:[(0,e.jsx)("div",{className:"w-full",children:(0,e.jsx)(ua.Z,{onChange:function(S){R(S)},options:ie})}),(0,e.jsx)("div",{className:"w-8 h-8 bg-[#e8effc] rounded-md",children:(0,e.jsx)(me.ZP,{className:"bg-[#e8effc]",icon:(0,e.jsx)("img",{src:"/icons/fs.svg"}),type:"link",htmlType:"submit",block:!0})})]})]})})]})]})}),(0,e.jsx)("div",{className:"w-28",children:(k==null?void 0:k.agent.publish_status)===1&&(k==null?void 0:k.is_creator)===1?(0,e.jsx)("div",{children:(0,e.jsx)(me.ZP,{type:"primary",htmlType:"submit",className:"w-full",onClick:Xe,children:x.formatMessage({id:"agent.amend"})})}):(0,e.jsx)("div",{children:(0,e.jsx)(me.ZP,{type:"primary",htmlType:"submit",className:"w-full",disabled:C!="false",onClick:je,children:x.formatMessage({id:"agent.publish"})})})}),(0,e.jsx)("div",{className:"h-[30px] w-1"})]})},ga=fa,pa=["key","name"],ha=Me.Z.TextArea,va=function(i){var L=i.SecondValue,k=i.handleBack,M=i.Detaillist,j=i.setDetaillist,h=i.Sformref,Ze=i.Operationbentate,X=i.pageKeyfun,a=i.secondjudgingcondition,C=i.SkillMenuClick,ie=i.agentupdata,y=(0,c.useIntl)(),x=I.ZP.useMessage(),Y=p()(x,2),le=Y[0],ke=Y[1],pe=(0,g.useRef)(null),he=(0,g.useState)({auto_match_ability:0,agent_abilities:[{agent_ability_id:0,name:"string",content:"string",status:0}]}),we=p()(he,2),ve=we[0],b=we[1];(0,g.useEffect)(function(){});var re=function(F){if(F.users.length==1&&(!F.users[0].content&&F.users[0].name||F.users[0].content&&!F.users[0].name))return I.ZP.warning(y.formatMessage({id:"agent.message.warning.selectknowledgebase"}));var Q=F.users.map(function(R){return t()(t()({},R),{},{status:R.status?1:2,agent_ability_id:R.agent_ability_id?R.agent_ability_id:0})}),V={agent_id:M.agent.agent_id,data:{auto_match_ability:M.agent.auto_match_ability,agent_abilities:F.users.length==1&&!F.users[0].content&&!F.users[0].name?[]:Q}};Ze=="false"&&Ne(),L(t()({},ve))},Ne=function(){var J=te()(Z()().mark(function F(){return Z()().wrap(function(V){for(;;)switch(V.prev=V.next){case 0:a()||ie();case 1:case"end":return V.stop()}},F)}));return function(){return J.apply(this,arguments)}}(),d=function(F){j(t()(t()({},M),{},{agent:t()(t()({},M.agent),{},{auto_match_ability:F?1:0})}))},De=function(){setTimeout(function(){pe.current&&pe.current.scrollTo({top:pe.current.scrollHeight,behavior:"smooth"})},100)};return(0,e.jsxs)("div",{style:{height:"100%"},className:"w-full flex-1 sticky top-0",children:[(0,e.jsx)("div",{className:"text-base font-medium text-[#333333] my-[30px]",children:y.formatMessage({id:"agent.Applicationcapabilitysetting"})}),(0,e.jsxs)("div",{className:"mb-[30px]",children:[(0,e.jsx)("div",{className:"mb-[15px] text-[#555555] text-xs font-medium",children:(0,e.jsx)(fe.Z,{name:y.formatMessage({id:"agent.automatch"}),title:y.formatMessage({id:"agent.explain.automatch"})})}),(0,e.jsx)(He.Z,{size:"small",checked:!!(M&&M.agent.auto_match_ability==1),onChange:d})]}),(0,e.jsx)("div",{className:"w-full",children:(0,e.jsxs)(_.Z,{name:"dynamic_form_nest_item",onFinish:re,style:{width:"100%"},autoComplete:"off",form:h,children:[(0,e.jsx)(_.Z.List,{name:"users",children:function(F,Q){var V=Q.add,R=Q.remove;return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)("div",{className:"w-full flex items-center justify-between mb-[11px]",children:[(0,e.jsx)("div",{className:" text-[#555555] text-xs font-medium",children:y.formatMessage({id:"agent.capability"})}),(0,e.jsx)("div",{children:(0,e.jsx)(me.ZP,{type:"link",onClick:function(){V(),De()},block:!0,icon:(0,e.jsx)(Le.Z,{}),children:y.formatMessage({id:"agent.add"})})})]}),(0,e.jsx)("div",{style:{height:"calc(100vh - 206px)",overflowY:"auto"},className:"overflow-y-auto",ref:pe,children:F.map(function(xe){var Ee=xe.key,ae=xe.name,oe=Ct()(xe,pa);return(0,e.jsxs)("div",{className:"bg-[#F7F7F7] p-[15px] rounded-lg mb-[20px]",children:[(0,e.jsx)(_.Z.Item,{className:"mb-0",children:(0,e.jsxs)("div",{className:"w-full flex justify-between items-center mb-[15px]",children:[(0,e.jsx)("div",{className:"text-[#555555] text-xs font-medium",children:y.formatMessage({id:"agent.capabilityname"})}),(0,e.jsxs)("div",{children:[" ",(0,e.jsx)(mt.Z,{onClick:function(){return R(ae)}})]})]})}),(0,e.jsx)(_.Z.Item,t()(t()({className:"mb-[20px]"},oe),{},{name:[ae,"name"],rules:[{required:F.length!==1,message:y.formatMessage({id:"agent.capabilityname"})}],children:(0,e.jsx)(Me.Z,{placeholder:y.formatMessage({id:"agent.capabilityname"}),maxLength:50,className:"w-full"})})),(0,e.jsx)("div",{className:"mb-[15px]",children:(0,e.jsx)(fe.Z,{className:"text-[#555555] text-xs font-medium",name:y.formatMessage({id:"agent.capabilitydescription"}),title:y.formatMessage({id:"agent.explain.capabilitydescription"})})}),(0,e.jsx)(_.Z.Item,t()(t()({className:"w-full mb-[20px]"},oe),{},{name:[ae,"content"],rules:[{required:F.length!==1,message:y.formatMessage({id:"agent.capabilitydescription"})}],children:(0,e.jsx)(ha,{placeholder:y.formatMessage({id:"agent.capabilitydescription"}),autoSize:{minRows:3,maxRows:10},className:"w-full"})})),(0,e.jsx)("div",{className:"text-[#555555] text-xs font-medium mb-[15px]",children:y.formatMessage({id:"agent.capabilitystatus"})}),(0,e.jsx)(_.Z.Item,t()(t()({className:"mb-[20px]"},oe),{},{name:[ae,"status"],children:(0,e.jsxs)(H.ZP.Group,{optionType:"button",buttonStyle:"solid",defaultValue:!0,children:[(0,e.jsx)(H.ZP,{value:!0,children:y.formatMessage({id:"agent.capabilitystatus.enable"})}),(0,e.jsx)(H.ZP,{value:!1,children:y.formatMessage({id:"agent.capabilitystatus.disable"})})]})})),(0,e.jsx)("div",{className:"text-[#555555] text-xs font-medium mb-[11px]",children:y.formatMessage({id:"agent.enableall"})}),(0,e.jsx)(_.Z.Item,{className:"mb-0",name:[ae,"output_format"],children:(0,e.jsxs)(H.ZP.Group,{defaultValue:0,children:[(0,e.jsx)(H.ZP,{value:0,children:(0,e.jsx)("div",{className:"text-[#555555] text-xs font-normal",children:y.formatMessage({id:"agent.menu"})})}),(0,e.jsx)(H.ZP,{value:1,children:(0,e.jsx)("div",{className:"text-[#555555] text-xs font-normal",children:"text string"})}),(0,e.jsx)(H.ZP,{value:2,children:(0,e.jsx)("div",{className:"text-[#555555] text-xs font-normal",children:"format json"})}),(0,e.jsx)(H.ZP,{value:3,children:(0,e.jsx)("div",{className:"text-[#555555] text-xs font-normal",children:"code"})})]})})]})})})]})}}),(0,e.jsx)("div",{className:"h-[30px] w-1"})]})})]})},xa=va,ba=s(13085),ja=s(27842),ya=s(96486),Sa=s.n(ya),wa=function(){var i,L,k,M,j=(0,c.useIntl)(),h=(0,g.useRef)(null),Ze=_.Z.useForm(),X=p()(Ze,1),a=X[0],C=_.Z.useForm(),ie=p()(C,1),y=ie[0],x=_.Z.useForm(),Y=p()(x,1),le=Y[0],ke=_.Z.useForm(),pe=p()(ke,1),he=pe[0],we=(0,g.useState)(null),ve=p()(we,2),b=ve[0],re=ve[1],Ne=(0,g.useState)(0),d=p()(Ne,2),De=d[0],J=d[1],F=(0,g.useState)(null),Q=p()(F,2),V=Q[0],R=Q[1],xe=(0,g.useState)(null),Ee=p()(xe,2),ae=Ee[0],oe=Ee[1],be=(0,g.useState)(null),je=p()(be,2),Xe=je[0],T=je[1],S=(0,g.useState)(null),w=p()(S,2),$=w[0],B=w[1],E=(0,g.useState)(null),z=p()(E,2),Ye=z[0],Je=z[1],ft=(0,g.useState)(null),Pe=p()(ft,2),Ie=Pe[0],Ce=Pe[1],q=(0,g.useState)(null),_e=p()(q,2),Dt=_e[0],Et=_e[1],It=(0,g.useState)(null),Qe=p()(It,2),qe=Qe[0],gt=Qe[1],Tt=(0,g.useState)(null),pt=p()(Tt,2),ye=pt[0],ht=pt[1],Ot=(0,g.useState)("1"),vt=p()(Ot,2),se=vt[0],Te=vt[1],xt=(0,g.useState)(null),Re=p()(xt,2),et=Re[0],bt=Re[1],jt=(0,g.useState)(null),tt=p()(jt,2),yt=tt[0],St=tt[1],wt=(0,g.useState)(null),at=p()(wt,2),r=at[0],n=at[1],N=(0,g.useState)(null),O=p()(N,2),G=O[0],ne=O[1],$e=(0,g.useState)(!0),Oe=p()($e,2),Ve=Oe[0],We=Oe[1],_a=(0,g.useState)({first:!1,second:!1,fourthly:!1}),Vt=p()(_a,2),Ue=Vt[0],st=Vt[1],Fa=[{key:"1",icon:(0,e.jsx)(ce.Z,{}),label:j.formatMessage({id:"agent.menu.basicsetup"}),disabled:Ue.first,style:{padding:"15px",width:"100%",margin:"0px",marginBottom:"10px",fontSize:"16px",fontWeight:"500",lineHeight:"22px",color:se=="1"?"#1B64F3":"#213044"}},{key:"2",disabled:Ue.second,icon:(0,e.jsx)(W.Z,{}),label:j.formatMessage({id:"agent.menu.Capacityoutput"}),style:{padding:"15px",width:"100%",margin:"0px",marginBottom:"10px",fontSize:"16px",lineHeight:"22px",fontWeight:"500",color:se=="2"?"#1B64F3":"#213044"}},{key:"5",disabled:Ue.fourthly,icon:(0,e.jsx)(A.Z,{}),label:j.formatMessage({id:"app.dashboard.run_log_agent"}),style:{padding:"15px",width:"100%",margin:"0px",marginBottom:"10px",fontSize:"16px",lineHeight:"22px",fontWeight:"500",color:se=="5"?"#1B64F3":"#213044"}}];(0,g.useEffect)(function(){var D=new URLSearchParams(window.location.search);D.get("app_id")||(st(t()(t()({},Ue),{},{first:!1,second:!0,fourthly:!0})),We(!1)),Nt()},[]);var Nt=function(){var D=te()(Z()().mark(function m(u){var l,v,o,f,de,Ft,Gt,Kt;return Z()().wrap(function(Se){for(;;)switch(Se.prev=Se.next){case 0:if(v=new URLSearchParams(window.location.search),v.get("from")&&St(v.get("from")),o=null,!(v.get("app_id")||u)){Se.next=10;break}return Se.next=6,(0,K.ek)(u||v.get("app_id"),v.get("type"));case 6:o=Se.sent,ne(o.data.app.app_id),Se.next=13;break;case 10:return Se.next=12,(0,Fe.cI)();case 12:o=Se.sent;case 13:f=o.data,de=(l=o.data)===null||l===void 0||(l=l.agent_dataset_relation_list)===null||l===void 0?void 0:l.map(function(P){return P.dataset_id}),R(de),o.data.callable_items&&(o.data.agent.selected_skills=[],o.data.agent.selected_workflows=[],o.data.callable_items.forEach(function(P){P.item_type==1?o.data.agent.selected_skills.push(t()(t()({},P),{},{mode:4})):o.data.agent.selected_workflows.push(t()(t()({},P),{},{mode:2}))})),re(o.data),ht(o.data.agent.publish_status===0&&o.data.is_creator===1?"false":"true"),o.data.agent.publish_status===1&&I.ZP.warning(j.formatMessage({id:"agent.message.listwarning"}),5),a.setFieldsValue(Bt(f.agent.input_variables)),Ft=o.data.agent_abilities_list.map(function(P){return P.status==1?t()(t()({},P),{},{status:!0}):t()(t()({},P),{},{status:!1})}),le.setFieldsValue({users:Ft[0]?Ft:[{agent_ability_id:0,name:"",content:"",status:!0,output_format:0}]}),T(_t(f.agent_abilities_list)),B(_t(f.agent_abilities_list)),Gt=f.agent_abilities_list.filter(function(P){return P.output_format!==0}),y.setFieldsValue({users:Gt.map(function(P){return{agent_ability_id:P.agent_ability_id,output_format:P.output_format}})}),he.setFieldsValue(Bt(f.agent.input_variables)),Je(f.m_configurations_list.map(function(P){return{value:P.m_config_id?P.m_config_id:P.model_config_id,label:P.m_name?P.m_name:P.model_name}})),f.agent.m_config_id||f.agent.model_config_id?Ce(f.agent.m_config_id?f.agent.m_config_id:f.agent.model_config_id):Ce(f.m_configurations_list[0].model_config_id),Kt=f.agent_abilities_list.filter(function(P,Va){return P.status===1}),gt(_t(Kt).concat([{value:0,label:j.formatMessage({id:"agent.allability"})}])),We(!1);case 33:case"end":return Se.stop()}},m)}));return function(u){return D.apply(this,arguments)}}(),Bt=function(m){var u={users:m&&m.properties?Object.values(m.properties).map(function(l){return t()({name:l.name,type:l.type,content:l.display_name,status:l.required},l)}):[{name:"",content:"",type:"string",agent_ability_id:0,output_format:0,status:0}]};return u},_t=function(m){return m.map(function(u){return{value:u.agent_ability_id,label:u.name}})},Ma=function(m){zt(m,1),he.setFieldsValue(a.getFieldsValue())},Za=function(){Nt()},Lt=function(m){J(m)},ka=function(){c.history.back()},Rt=function(){if(!b.agent.input_variables)return I.ZP.warning(j.formatMessage({id:"agent.message.warning.variable"})),!0;if(Sa().isEmpty(b.agent.input_variables.properties))return I.ZP.warning(j.formatMessage({id:"agent.message.warning.variable"})),!0;if(Ie)if(b.agent.obligations){if(Aa(a.getFieldsValue().users,"name"))return I.ZP.warning(j.formatMessage({id:"agent.message.warning.repetition"})),!0}else return I.ZP.warning(j.formatMessage({id:"agent.message.warning.functiondescribe"})),!0;else return I.ZP.warning(j.formatMessage({id:"agent.message.warning.LLM"})),!0;return!1},$t=function(){var m=le.getFieldsValue().users.filter(function(l){return!!l}),u=m.filter(function(l){return!l.name||!l.content});return u.length!==0&&!(u.length==1&&u[0].name==""&&u[0].content=="")?(I.ZP.warning(j.formatMessage({id:"agent.message.warning.integritycapacity"})),!0):!1},Wt=function(m){if((m==null?void 0:m.key)=="4"){var u=a.getFieldsValue().users.map(function(l){return{value:"<<".concat(Ge.qX,".inputs.").concat(l.name,">>"),label:l.name}});bt(u)}Te(m.key)},Ut=function(){We(!0);var m=0;return new Promise(function(u){var l=function(o){return(0,K.ek)(o,!1).then(function(f){return m=f.data.agent.agent_id,Pa(m),G||c.history.replace("/Agents?app_id=".concat(o,"&type=false")),setTimeout(function(){Ca(m),I.ZP.success(j.formatMessage({id:"skill.conserve.success"}))},500),setTimeout(function(){if(Nt(o),!G){var de=t()(t()({},(0,Fe.Go)("GET")),{},{app_id:o});(0,Fe.Go)("SET",de)}},1e3),n(m),f}).catch(function(){return""})};G?l(G).then(function(v){return u(v)}).catch(function(v){console.error("Error during agent update:",v),u("")}):(0,ot.uy)((0,Fe.Go)("GET")).then(function(v){ne(v.data.app_id),l(v.data.app_id).then(function(o){return u(o)}).catch(function(o){console.error("Error during agent creation:",o),u("")})}).catch(function(v){console.error("Error creating app:",v),We(!1),u("")})})},Pa=function(m,u){a.validateFields().then(function(l){var v=[].concat(ee()(b.agent.selected_skills||[]),ee()(b.agent.selected_workflows||[])).map(function(de){return{app_id:de.app_id,item_type:de.mode==4?1:2}}),o={agent_id:m,data:{is_public:b.app.is_public,enable_api:b.app.enable_api,attrs_are_visible:b.app.attrs_are_visible,obligations:b.agent.obligations,input_variables:b.agent.input_variables?b.agent.input_variables:Da(a.getFieldsValue()),dataset_ids:V,m_config_id:Ie,allow_upload_file:b.agent.allow_upload_file,default_output_format:b.agent.default_output_format,callable_list:v}};ye=="false"&&zt(o,1),he.setFieldsValue(a.getFieldsValue());var f=a.getFieldsValue().users.map(function(de){return{value:"<<".concat(Ge.qX,".inputs.").concat(de.name,">>"),label:de.name}});bt(f),u&&Te(u.key)}).catch(function(l){})},Ca=function(m){var u=le.getFieldsValue().users.filter(function(o){return!!o}),l=u.map(function(o){return t()(t()({},o),{},{status:o.status==!1?2:1,agent_ability_id:o.agent_ability_id?o.agent_ability_id:0,output_format:o.output_format?o.output_format:0})}),v={agent_id:m,data:{auto_match_ability:b.agent.auto_match_ability,agent_abilities:l}};ye=="false"&&(l.length==1&&l[0].name==""&&l[0].content==""?st({first:!1,second:!1,fourthly:!1}):(0,K.Iw)(v).then(function(o){o.code==0&&st({first:!1,second:!1,fourthly:!1})}).catch(function(o){}))},zt=function(){var D=te()(Z()().mark(function m(u,l){var v;return Z()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(ye!=="false"){f.next=19;break}if(l!==1){f.next=7;break}return f.next=4,(0,K.XB)(u);case 4:f.t0=f.sent,f.next=17;break;case 7:if(l!==2){f.next=13;break}return f.next=10,(0,K.Iw)(u);case 10:f.t1=f.sent,f.next=16;break;case 13:return f.next=15,(0,K.Ce)(u);case 15:f.t1=f.sent;case 16:f.t0=f.t1;case 17:v=f.t0,v&&v.code===0&&We(!1);case 19:case"end":return f.stop()}},m)}));return function(u,l){return D.apply(this,arguments)}}(),Aa=function(m,u){var l=new Set;return m.some(function(v){var o=v[u];return l.has(o)?l.add(o):l.add(o)&&!1})},Da=function(m){var u=new Ae.Kr("input","","");return m.users.forEach(function(l){var v=new Ae._w(l.name,l.type?l.type:"string",l.value?l.value:"",l.content,l.status);u.addProperty(l.name,v)}),u};return(0,e.jsxs)("div",{className:" flex bg-white",style:{height:"calc(100vh - 56px)"},children:[(0,e.jsxs)("div",{className:"flex flex-col w-[300px]",style:{height:"calc(100vh - 56px)"},children:[(0,e.jsx)("div",{className:"flex w-full items-center bg-white px-[30px] pt-[30px] border-[#e5e7eb] border-solid border-r",children:(0,e.jsxs)(me.ZP,{type:"link",shape:"circle",size:"middle",className:"",onClick:ka,children:[(0,e.jsx)(U.Z,{}),(0,e.jsx)("span",{className:"text-sm font-medium text-[#213044]",children:yt=="chat_room"?j.formatMessage({id:"agent.back_meeting"}):j.formatMessage({id:"agent.back"})})]})}),(0,e.jsxs)("div",{className:"w-full flex-1 px-[30px] py-[30px] bg-white border-[#e5e7eb] border-solid border-r",children:[(0,e.jsx)(Xt.Z,{selectedKeys:[se],onClick:Wt,style:{width:"100%",borderInlineEnd:"1px solid rgba(0,0,0,0)"},defaultSelectedKeys:[se],mode:"inline",items:Fa}),b&&((i=b.app)===null||i===void 0?void 0:i.enable_api)===1&&((L=b.app)===null||L===void 0?void 0:L.publish_status)===1?(0,e.jsx)("div",{className:"w-full h-[40px] rounded-lg text-[#000] hover:bg-[#f0f0f0] p-[12px] pl-[16px] cursor-pointer",onClick:te()(Z()().mark(function D(){var m,u;return Z()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(m=new URLSearchParams(window.location.search),u=null,!m.get("app_id")){v.next=6;break}return v.next=5,(0,K.ek)(m.get("app_id"),m.get("type"));case 5:u=v.sent;case 6:u!=null&&u.data.app.enable_api===1&&u.data.app.publish_status===1?window.open(dt._n+b.app.api_url):I.ZP.warning(j.formatMessage({id:"agent.save.and.click"}),5);case 7:case"end":return v.stop()}},D)})),children:(0,e.jsxs)("div",{className:"mr-[20px] text-base font-medium text-[#213044] -mt-1",children:[(0,e.jsx)(Be.Z,{className:"mr-3"}),j.formatMessage({id:"agent.visit"})," API"]})}):null]})]}),(0,e.jsx)("div",{className:"flex-1 relative w-[calc(100%-300px)]",children:(0,e.jsxs)(ut.Z,{style:{height:"100%",boxShadow:"0 0 10px rgba(0, 0, 0, 0.1)"},children:[(0,e.jsx)(ut.Z.Panel,{defaultSize:"50%",min:"40%",max:"70%",children:(0,e.jsx)(Mt.Z,{spinning:Ve,size:"large",className:"mt-[112px] mr-4",children:(0,e.jsx)("div",{className:"flex flex-col",style:{height:"calc(100vh - 56px)",overflowY:"scroll",scrollbarWidth:"none"},children:(0,e.jsxs)("div",{className:"px-[30px] ",style:{overflowX:"auto",height:"100%"},children:[(0,e.jsx)("div",{className:"w-full flex justify-center  mt-[30px]",children:(0,e.jsxs)("div",{className:"flex items-center w-full ",children:[(0,e.jsx)("div",{className:"mr-[10px] w-[16px] h-[16px]",children:(0,e.jsx)("img",{src:"/icons/flag.svg",alt:"",className:"w-[16px] h-[16px]"})}),(0,e.jsxs)("div",{className:"flex items-center",children:[(0,e.jsxs)("div",{className:"mr-[6px] text-lg text-[#213044] font-medium",children:[(k=(0,Fe.Go)("GET"))!==null&&k!==void 0&&k.app_id?j.formatMessage({id:"agent.compile"}):j.formatMessage({id:"agent.created"})," ",j.formatMessage({id:"agent"})]}),(b==null||(M=b.app)===null||M===void 0?void 0:M.publish_status)===1?(0,e.jsx)("div",{className:"bg-[#1B64F3] px-[7px] text-[#fff] rounded font-normal text-xs flex items-center justify-center h-[18px]",children:j.formatMessage({id:"agent.havepublished"})}):(0,e.jsx)("div",{className:" bg-[#EEE] px-[7px]  text-[#999] rounded font-normal text-xs flex items-center justify-center h-[18px]",children:j.formatMessage({id:"agent.unpublish"})})]})]})}),(0,e.jsx)("div",{style:{display:se==="1"?"flex":"none",height:"calc(100vh - 146px)",justifyContent:"center"},children:!Ve&&(0,e.jsx)(ia,{FirstValue:Ma,Ffromref:a,Detaillist:b,setDetaillist:re,repository:V,setRepository:R,Newproperties:ae,setNewproperties:oe,Operationbentate:ye,Fourthly_config_id:Ie,setFourthly_config_id:Ce,Fourthly_select_list:Ye,pageKeyfun:Te,firstjudgingcondition:Rt,agentmenudisabled:Ue,setAgentmunudisabled:st})}),(0,e.jsx)("div",{style:{display:se==="2"?"flex":"none",height:"calc(100vh - 146px)",justifyContent:"center",position:"sticky",top:"-150px"},children:(0,e.jsx)(xa,{SecondValue:Za,Detaillist:b,setDetaillist:re,Sformref:le,Operationbentate:ye,handleBack:Lt,pageKeyfun:Te,SkillMenuClick:Wt,secondjudgingcondition:$t,agentupdata:Ut})}),(0,e.jsx)("div",{style:{display:se==="4"?"flex":"none",height:"calc(100vh - 146px)",justifyContent:"center"},children:(0,e.jsx)(ga,{handleBack:Lt,Detaillist:b,setDetaillist:re,Fourthly_select_list:Ye,Fourthly_config_id:Ie,setFourthly_config_id:Ce,Fourthlyref:he,Fourthly_abilities_list:qe,Operationbentate:ye,callwordlist:et,newagentid:r})})]})})})}),(0,e.jsx)(ut.Z.Panel,{children:(0,e.jsx)("div",{children:(0,e.jsx)(ba.Z,{saveInfo:{firstjudgingcondition:Rt,secondjudgingcondition:$t,agentupdata:Ut},operationbentate:ye,data:{abilitiesList:qe,detailList:b}})})}),se=="5"&&(0,e.jsx)("div",{className:"absolute bottom-0 left-0 right-0 bg-slate-50 w-full h-full z-10",children:(0,e.jsx)(ja.ZP,{agent_id:b.agent.agent_id})})]})})]})},Na=wa}}]);
