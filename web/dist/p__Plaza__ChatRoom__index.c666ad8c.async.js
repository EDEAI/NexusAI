"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[57],{86:function(ot,Te,o){var Be=o(5574),I=o.n(Be),Ve=o(32332),ae=o(38703),Ue=o(67294),u=o(85893),pe=function(a){var Y=a.subtitle,We=a.handleClick,ce=a.lineClamp,tt=ce===void 0?2:ce,H=a.textDetails,ve=a.title,Ge=a.icon,$e=a.iconType,Le=$e===void 0?"":$e,Ze=a.operation,Oe=Ze===void 0?"":Ze,Ce=a.progress,he=a.status,He=a.backlogTips,ze=(0,Ue.useState)(0),je=I()(ze,2),Ee=je[0],Pe=je[1],Ke=function(){Pe(Ce)},Je=function(){Pe(0)},Qe=function(e){return"rounded-[4px] border-l-[4px] ".concat(e==1?"border-[#1B64F3]":e==2?"border-[#52C41C]":"border-[#F04444]"," ")};return(0,u.jsxs)("div",{className:"flex  p-[10px] cursor-pointer overflow-hidden relative bg-[#fff] ".concat(he!==void 0?Qe(he):"graphicbox"),onClick:We,onMouseEnter:function(){Ce!=null&&Ke()},onMouseLeave:function(){Ce!=null&&Je()},children:[he!==void 0&&(0,u.jsx)("div",{style:{width:"".concat(Ee,"%"),transition:"width 0.5s "},className:"absolute bottom-0 left-0 top-0 bottom-0 h-full ".concat(he==1?"bg-[#1B64F3]/[.03]":he==2?"bg-[#52c41c]/[.05]":"bg-[#FAFAFA]"," ")}),(0,u.jsxs)("div",{className:"flex gap-x-[20px] w-full relative z-20",children:[(0,u.jsx)("div",{className:"shrink-0 flex gap-x-[7px] items-center",style:{fontSize:0},children:(0,u.jsxs)("div",{className:"w-[40px] h-[40px] rounded-[6px] flex items-center justify-center bg-[#F4F8F1] relative",children:[(0,u.jsx)("img",{src:(0,Ve.s9)("single",Ge),className:"w-[22px] h-[22px]"}),Le&&(0,u.jsx)("div",{className:"w-[16px] h-[16px] absolute top-[28px] left-[28px] flex items-center justify-center bg-[#fff] rounded-[3px]",style:{boxShadow:"0px 0px 4px 0px rgba(0,0,0,0.1)"},children:(0,u.jsx)("img",{src:"/icons/".concat(Le,".svg"),alt:"",className:"w-[12px] h-[12px]"})})]})}),(0,u.jsx)("div",{className:"flex flex-1 min-w-0",children:(0,u.jsxs)("div",{className:"flex justify-center flex-col gap-y-[5px] flex-1 min-w-0",children:[(0,u.jsxs)("span",{className:"text-[12px] flex items-center",style:{color:"#213044"},children:[(0,u.jsx)("span",{className:"truncate",children:ve}),(0,u.jsx)("span",{className:"flex items-center flex-1",children:Y})]}),(0,u.jsx)("span",{className:"text-[12px] max-w-full truncate",style:{color:"#999999"},children:H})]})}),He||(0,u.jsx)(u.Fragment,{}),Oe&&(0,u.jsx)("div",{className:"flex items-center w-[24px]",children:(0,u.jsx)("span",{className:"operation",children:Oe})}),Ce!=null&&(0,u.jsx)("div",{className:"graphic_progress flex items-center pl-[30px]",children:(0,u.jsx)(ae.Z,{type:"circle",percent:Ce,size:29})})]})]})};Te.Z=pe},78129:function(ot,Te,o){o.r(Te),o.d(Te,{default:function(){return Fa}});var Be=o(15009),I=o.n(Be),Ve=o(99289),ae=o.n(Ve),Ue=o(5574),u=o.n(Ue),pe=o(43722),_e=o(32983),a=o(67294),Y=o(35312),We=o(19632),ce=o.n(We),tt=o(97857),H=o.n(tt),ve=o(32332),Ge=o(82114),$e=o(82826),Le=o(63783),Ze=o(3471),Oe=o(45360),Ce=o(85576),he=o(28036),He=o(83062),ze=o(72269),je=o(74330),Ee=o(96486),Pe=o(44010),Ke=o(73445),Je=o(782),Qe=(0,Ke.Ue)((0,Je.mW)(function(i,n){return{clearMemory:null,truncatable:!1,disableInput:!1,summaryParams:null,runsSummaryShow:!1,summaryClick:!0,setClearMemory:function(l){i({clearMemory:l})},setTruncatable:function(l){i({truncatable:l})},setDisableInput:function(l){i({disableInput:l})},setSummaryParams:function(l){i({summaryParams:l})},setRunsSummaryShow:function(l){i({runsSummaryShow:l})},setSummaryClick:function(l){console.log(l),i({summaryClick:l})}}})),G=Qe,e=o(85893),ut=function(n){var r=(0,Y.useIntl)(),l=n.roomDetail,w=n.setAgent,S=Oe.ZP.useMessage(),p=u()(S,2),y=p[0],t=p[1],g=(0,Y.useParams)(),d=g.id,c=G(function(M){return M.disableInput}),v=G(function(M){return M.truncatable}),x=G(function(M){return M.setClearMemory}),j=(0,a.useState)([]),b=u()(j,2),s=b[0],L=b[1],K=(0,a.useState)(H()({},l)),z=u()(K,2),R=z[0],Z=z[1],q=(0,a.useState)([]),ne=u()(q,2),V=ne[0],$=ne[1],O=(0,a.useRef)(!1),E=(0,a.useRef)(!1),D=(0,a.useState)(!1),m=u()(D,2),f=m[0],k=m[1],_=function(){var F=Ce.Z.confirm;F({title:r.formatMessage({id:"app.chatroom.clear.title"}),icon:(0,e.jsx)(Ge.Z,{}),content:r.formatMessage({id:"app.chatroom.clear.tips"}),okText:r.formatMessage({id:"app.chatroom.clear.confirm"}),okType:"danger",cancelText:r.formatMessage({id:"app.chatroom.clear.cancel"}),onOk:function(){x(["TRUNCATE","0"])}})},N=function(){var M=ae()(I()().mark(function F(){var C;return I()().wrap(function(T){for(;;)switch(T.prev=T.next){case 0:if(!d){T.next=5;break}return T.next=3,(0,pe.cH)({id:d});case 3:if(C=T.sent,C.code==0)try{Z(function(){return H()(H()({},C.data.chat_info),{},{max_round:C.data.max_round,smart_selection:C.data.smart_selection})}),L(C.data.agent_list),O.current=!0}catch(le){}case 5:case"end":return T.stop()}},F)}));return function(){return M.apply(this,arguments)}}(),te=function(){var M=ae()(I()().mark(function F(){var C;return I()().wrap(function(T){for(;;)switch(T.prev=T.next){case 0:return T.next=2,(0,pe.j2)({id:d});case 2:C=T.sent,C.code==0&&($(C.data.list),E.current=!0);case 4:case"end":return T.stop()}},F)}));return function(){return M.apply(this,arguments)}}(),J=function(){var M=ae()(I()().mark(function F(C){var ie,T,le;return I()().wrap(function(ee){for(;;)switch(ee.prev=ee.next){case 0:if(!d){ee.next=11;break}if(ie=C.active==1?0:1,ie!=0){ee.next=7;break}if(T=s.filter(function(xe){return xe.active==1}),T.length-1!=0){ee.next=7;break}return y.open({type:"error",content:r.formatMessage({id:"app.chatroom.sidebar.agent_tips"}),duration:2}),ee.abrupt("return",!1);case 7:return ee.next=9,(0,pe.sT)({active:ie},d,C.agent_id);case 9:le=ee.sent,le.code==0&&L(function(xe){return xe.map(function(de){return H()(H()({},de),{},{active:de.agent_id==C.agent_id?ie:de.active})})});case 11:case"end":return ee.stop()}},F)}));return function(C){return M.apply(this,arguments)}}(),re=function(F){return F.length>6?F.length=6:F.lenth,F},fe=function(F){F.type=="my_agent"?Y.history.push("/Agents?app_id=".concat(F.app_id,"&type=false&from=chat_room")):Y.history.push("/ReadOnlyAgent?app_id=".concat(F.app_id,"&type=true&from=chat_room"))},se=function(F){Y.history.replace("/chat_room/".concat(F.chatroom_id)),window.location.reload()},Ne=function(){k(!0)},ue=function(){k(!1)},Me=function(){var M=ae()(I()().mark(function F(C){var ie,T,le;return I()().wrap(function(ee){for(;;)switch(ee.prev=ee.next){case 0:if(!(C.checkItem&&C.checkItem.length==0)){ee.next=3;break}return y.open({type:"error",content:r.formatMessage({id:"app.chatroom.content.addAgentTips_fail"}),duration:2}),ee.abrupt("return");case 3:return ie=ce()(C.checkItem).map(function(xe){var de=xe.agent_id,ge=xe.active,et=ge===void 0?1:ge;return{agent_id:de,active:et}}),T={description:R.description,name:R.name,max_round:R.max_round},ee.next=7,(0,pe.sI)(H()(H()({},T),{},{agent:ie}),d);case 7:le=ee.sent,le.code==0?(C.checkItem.map(function(xe){xe.active=xe.active==null?1:xe.active}),L(ce()(C.checkItem)),w.current=ce()(C.checkItem),y.open({type:"success",content:r.formatMessage({id:"app.chatroom.content.addAgentTips"}),duration:2})):y.open({type:"error",content:r.formatMessage({id:"app.chatroom.content.addAgentTips_fail"}),duration:2});case 9:case"end":return ee.stop()}},F)}));return function(C){return M.apply(this,arguments)}}(),we=function(){var M=ae()(I()().mark(function F(){var C;return I()().wrap(function(T){for(;;)switch(T.prev=T.next){case 0:return C=R.smart_selection==1?0:1,T.next=3,(0,pe.r5)({smart_selection:C},d);case 3:Z(function(le){return H()(H()({},le),{},{smart_selection:C})});case 4:case"end":return T.stop()}},F)}));return function(){return M.apply(this,arguments)}}();return(0,a.useEffect)(function(){N(),te()},[]),(0,e.jsxs)(e.Fragment,{children:[t,(0,e.jsxs)("div",{className:"h-full w-[320px] bg-[#fff] shrink-0",style:{boxShadow:"0px 2px 4px 0px rgba(0,0,0,0.1)"},id:"sider",children:[(0,e.jsxs)("div",{className:"flex flex-col  h-full",children:[(0,e.jsx)("div",{className:"w-full flex  justify-start px-[30px]",children:(0,e.jsxs)("div",{className:"py-[20px] text-[14px] text-[#213044] font-[500] flex gap-x-[10px] items-center w-full",children:[(0,e.jsxs)("div",{className:"cursor-pointer flex items-center shrink-0",onClick:function(){Y.history.go(-1)},children:[(0,e.jsx)(he.ZP,{type:"link",danger:!0,className:"p-0",children:(0,e.jsx)($e.Z,{className:"text-[#1B64F3] w-[16px] h-[16px]"})}),(0,e.jsx)("span",{className:"ml-[5px] text-[#213044] text-sm",children:r.formatMessage({id:"app.chatroom.sidebar.return"})})]}),(0,e.jsx)("div",{className:"h-full flex items-center shrink-0",children:(0,e.jsx)("div",{className:"w-[1px] h-[13px] bg-[#ebebeb]"})}),(0,e.jsx)("div",{className:"flex-1 min-w-0 truncate",children:R.name})]})}),(0,e.jsx)("div",{className:"h-[360px]",children:(0,e.jsxs)("div",{className:"pb-[20px] border-b-[1px] px-[10px]",children:[(0,e.jsxs)("div",{className:"flex items-center cursor-pointer px-[20px]",children:[(0,e.jsx)("div",{className:"flex gap-x-[5px] flex-1",children:(0,e.jsx)("span",{className:"text-[#666] text-[14px]",children:r.formatMessage({id:"app.chatroom.sidebar.agent_title"})})}),(0,e.jsxs)("div",{className:"shrink-0 flex items-center",children:[(0,e.jsx)(He.Z,{className:"pr-[2px]",overlayStyle:{fontSize:"12px"},title:r.formatMessage({id:"app.chatroom.sidebar.chatroom_switch_tips"}),children:(0,e.jsx)(Le.Z,{className:"cursor-pointer text-[#666] text-[12px]"})}),(0,e.jsx)("span",{className:"text-[12px] text-[#666] pr-[5px]",children:r.formatHTMLMessage({id:"app.chatroom_list.switch"})}),(0,e.jsx)(ze.Z,{size:"small",defaultChecked:!0,className:"w-[28px]",checked:R.smart_selection==1,onChange:we,disabled:c})]})]}),(0,e.jsx)("div",{className:"py-[20px] pt-[10px]",children:(0,e.jsx)("div",{className:"h-[220px] overflow-y-auto px-[10px]",children:O.current?(0,e.jsx)("div",{className:"flex flex-col",children:s&&s.length>0?s.map(function(M){return(0,e.jsxs)("div",{className:"flex items-center gap-x-[5px] hover:bg-[#FAFAFA] transition p-[10px] slider_agent_box",children:[(0,e.jsxs)("div",{className:"flex gap-x-[15px] flex-1 min-w-[0]",children:[(0,e.jsx)("div",{className:"w-[40px] h-[40px] bg-[#F4F8F1] rounded-[6px] flex items-center justify-center shrink-0",children:(0,e.jsx)("img",{src:(0,ve.s9)("single",M.icon),alt:"",className:"w-[18px]  h-[18px]"})}),(0,e.jsxs)("div",{className:"flex flex-col gap-y-[5px] justify-center flex-1 min-w-[0]",children:[(0,e.jsx)("span",{className:"text-[#213044] text-[12px] font-[500] truncate w-full",children:M.name}),(0,e.jsx)("span",{className:"text-[#999999] text-[12px] truncate",children:M.description})]})]}),(0,e.jsxs)("div",{className:"shrink-0 flex gap-x-[15px] items-center",children:[(0,e.jsx)("div",{className:"edit cursor-pointer w-[20px] h-[20px] flex justify-center items-center opacity-0 transition",onClick:function(){fe(M)},children:(0,e.jsx)("img",{className:"w-[16px] h-[16px]",src:"/icons/edit_icon_1.svg"})}),(0,e.jsx)(ze.Z,{size:"small",disabled:c,defaultChecked:!0,className:"w-[28px]",checked:M.active==1,onChange:function(){J(M)}})]})]},M.agent_id)}):(0,e.jsx)("div",{className:"w-full min-h-[220px] flex items-center justify-center",children:(0,e.jsx)(_e.Z,{image:_e.Z.PRESENTED_IMAGE_SIMPLE})})}):(0,e.jsx)("div",{className:"flex justify-center w-full h-full items-center",children:(0,e.jsx)(je.Z,{})})})}),(0,e.jsx)("div",{className:"px-[20px] ",children:(0,e.jsx)("div",{style:{border:"1px solid #1B64F3"},onClick:Ne,className:"w-full h-[30px] transition text-[#1B64F3] flex items-center justify-center cursor-pointer rounded-[6px] hover:text-[#fff] hover:bg-[#1B64F3]",children:(0,e.jsx)("span",{className:"text-[12px]",children:r.formatMessage({id:"app.chatroom.add.agent"})})})}),(0,e.jsx)("div",{className:"px-[20px] pt-[15px]",children:(0,e.jsx)("div",{style:v&&!c?{border:"1px solid #1B64F3"}:{background:"#d9d9d9",color:"rgba(0,0,0,0.25)",cursor:"not-allowed"},onClick:(0,Ee.throttle)(function(){v&&!c&&_()}),className:"w-full h-[30px] transition text-[#1B64F3] flex items-center justify-center cursor-pointer rounded-[6px] hover:text-[#fff] hover:bg-[#1B64F3]",children:(0,e.jsx)("span",{className:"text-[12px]",children:r.formatMessage({id:"app.chatroom.sidebar.agent_button"})})})})]})}),(0,e.jsxs)("div",{className:"flex-1 min-h-[0] flex flex-col",children:[(0,e.jsx)("div",{className:"pt-[30px] px-[30px] text-[#666] text-[14px] shrink-0",children:r.formatMessage({id:"app.chatroom.sidebar.othe_title"})}),(0,e.jsx)("div",{className:"px-[10px] flex-1 min-h-[0] py-[10px]",children:(0,e.jsx)("div",{style:{height:"calc(100% - 20px)"},className:"px-[10px]  overflow-y-auto",children:E.current?(0,e.jsx)("div",{className:"h-full flex flex-col",children:V&&V.length>0?V.map(function(M){return(0,e.jsxs)("div",{className:"w-full transition hover:bg-[#FAFAFA] p-[10px] cursor-pointer",onClick:function(){se(M)},children:[(0,e.jsxs)("div",{className:"flex pb-[10px]",children:[(0,e.jsx)("div",{className:"flex-1 min-w-[0] truncate text-[#333] text-[14px]",children:M.name}),M.active==0?(0,e.jsxs)("div",{className:"flex items-center gap-x-[6px]",children:[(0,e.jsx)("img",{className:"w-[12px] h-[12px]",src:"/icons/plaza_m2_c2.svg",alt:""}),(0,e.jsx)("span",{className:"text-[12px] text-[#aaa]",children:r.formatMessage({id:"app.chatroom.sidebar.othe_status"})})]}):(0,e.jsxs)("div",{className:"flex items-center gap-x-[6px]",children:[(0,e.jsx)("img",{className:"w-[12px] h-[12px]",src:"/icons/plaza_m2_c1.svg",alt:""}),(0,e.jsx)("span",{className:"text-[12px] text-[#aaa]",children:r.formatMessage({id:"app.chatroom.sidebar.othe_status_succeed"})})]})]}),(0,e.jsx)("div",{className:"flex gap-x-[10px]",children:M.agent_list&&M.agent_list.length>0?(0,e.jsxs)(e.Fragment,{children:[re(M.agent_list).map(function(F,C){return(0,e.jsx)("div",{className:"flex",children:(0,e.jsx)("div",{className:"w-[30px] h-[30px] bg-[#F4F8F1] rounded-[6px] flex items-center justify-center",children:(0,e.jsx)("img",{src:(0,ve.s9)("single",F.icon),alt:"",className:"w-[18px]  h-[18px]"})})},C)}),M.agent_list.length>=6?(0,e.jsx)(Ze.Z,{}):(0,e.jsx)(e.Fragment,{})]}):(0,e.jsx)(e.Fragment,{})})]},M.chatroom_id)}):(0,e.jsx)("div",{className:"w-full h-full",children:(0,e.jsx)(_e.Z,{image:_e.Z.PRESENTED_IMAGE_SIMPLE})})}):(0,e.jsx)("div",{className:"flex justify-center w-full h-full items-center",children:(0,e.jsx)(je.Z,{})})})})]})]}),(0,e.jsx)(Pe.Z,{show:f,popupClose:ue,popupSave:Me,checkList:s,zIndex:99})]})]})},dt=(0,a.memo)(ut),pt=o(13769),xt=o.n(pt),ft=o(47635),oe=o(1413),mt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M862 465.3h-81c-4.6 0-9 2-12.1 5.5L550 723.1V160c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v563.1L255.1 470.8c-3-3.5-7.4-5.5-12.1-5.5h-81c-6.8 0-10.5 8.1-6 13.2L487.9 861a31.96 31.96 0 0048.3 0L868 478.5c4.5-5.2.8-13.2-6-13.2z"}}]},name:"arrow-down",theme:"outlined"},vt=mt,Re=o(91146),ht=function(n,r){return a.createElement(Re.Z,(0,oe.Z)((0,oe.Z)({},n),{},{ref:r,icon:vt}))},gt=a.forwardRef(ht),jt=gt,yt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372zm-88-532h-48c-4.4 0-8 3.6-8 8v304c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V360c0-4.4-3.6-8-8-8zm224 0h-48c-4.4 0-8 3.6-8 8v304c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V360c0-4.4-3.6-8-8-8z"}}]},name:"pause-circle",theme:"outlined"},St=yt,Nt=function(n,r){return a.createElement(Re.Z,(0,oe.Z)((0,oe.Z)({},n),{},{ref:r,icon:St}))},wt=a.forwardRef(Nt),bt=wt,_t=o(2068),Ct={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M312.1 591.5c3.1 3.1 8.2 3.1 11.3 0l101.8-101.8 86.1 86.2c3.1 3.1 8.2 3.1 11.3 0l226.3-226.5c3.1-3.1 3.1-8.2 0-11.3l-36.8-36.8a8.03 8.03 0 00-11.3 0L517 485.3l-86.1-86.2a8.03 8.03 0 00-11.3 0L275.3 543.4a8.03 8.03 0 000 11.3l36.8 36.8z"}},{tag:"path",attrs:{d:"M904 160H548V96c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v64H120c-17.7 0-32 14.3-32 32v520c0 17.7 14.3 32 32 32h356.4v32L311.6 884.1a7.92 7.92 0 00-2.3 11l30.3 47.2v.1c2.4 3.7 7.4 4.7 11.1 2.3L512 838.9l161.3 105.8c3.7 2.4 8.7 1.4 11.1-2.3v-.1l30.3-47.2a8 8 0 00-2.3-11L548 776.3V744h356c17.7 0 32-14.3 32-32V192c0-17.7-14.3-32-32-32zm-40 512H160V232h704v440z"}}]},name:"fund-projection-screen",theme:"outlined"},Rt=Ct,Mt=function(n,r){return a.createElement(Re.Z,(0,oe.Z)((0,oe.Z)({},n),{},{ref:r,icon:Rt}))},kt=a.forwardRef(Mt),Ft=kt,at=o(26915),Dt=o(20640),nt=o.n(Dt),ye=o(22683),Se=o(97807),It=["node","className","children"],At=at.Z.TextArea,Ot=(0,a.memo)(function(i){var n=i.setInstruction,r=i.messageApi,l=i.isStop,w=i.scrollDomRef,S=i.upButtonDom,p=(0,Y.useIntl)(),y=G(function(b){return b.disableInput}),t=G(function(b){return b.setDisableInput}),g=(0,a.useState)(""),d=u()(g,2),c=d[0],v=d[1],x=function(s){!s.shiftKey&&s.target.value==""&&(r.open({type:"warning",content:p.formatMessage({id:"app.chatroom.content.input"}),duration:10}),v(""),s.preventDefault()),!s.shiftKey&&s.keyCode==13&&s.target.value!=""&&(t(!0),v(""),n(["INPUT",s.target.value]),s.preventDefault())},j=(0,Ee.throttle)(function(){n(["STOP",null])},300);return(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)("div",{className:"max-w-[920px] w-full min-h-[60px] mt-[20px] mb-[20px] mx-auto relative",children:[(0,e.jsx)("div",{ref:S,className:"w-[40px] h-[40px] rounded-[6px]  bg-[#fff] border border-[#ddd] cursor-pointer absolute top-[-67px] left-2/4 flex items-center justify-center hidden",onClick:function(s){w.current.scrollTo({top:w.current.scrollHeight,behavior:"smooth"})},children:(0,e.jsx)(jt,{className:"text-[16px]"})}),(0,e.jsxs)("div",{className:"flex items-center p-[12px] gap-[10px] box-border border border-[#ccc] bg-[#fff] rounded-[8px]",children:[(0,e.jsx)(At,{id:"userValue",className:"placeholder-text-[#aaa] placeholder-text-[14px]",autoSize:{minRows:1,maxRows:6},value:c,disabled:y,onChange:function(s){v(s.target.value)},onPressEnter:x,style:{height:"34px",border:"none",resize:"none",backgroundColor:"transparent"},placeholder:"".concat(p.formatMessage({id:"app.chatroom.content.input"}),"\u2026")}),l?(0,e.jsx)("div",{className:"min-w-[34px] h-[34px] bg-[#000] flex items-center justify-center cursor-pointer rounded-[4px]",onClick:j,children:(0,e.jsx)(bt,{style:{color:"#fff",fontSize:"20px"}})}):(0,e.jsx)("div",{className:"".concat(y||!c?"bg-[#ddd]":"bg-[#1B64F3]"," min-w-[30px] h-[30px]  flex items-center justify-center cursor-pointer rounded-[6px]"),onClick:(0,Ee.throttle)(function(){if(y||!c)return!1;c||r.open({type:"warning",content:p.formatMessage({id:"app.chatroom.content.input"}),duration:10}),t(!0),n(["INPUT",c]),v("")},300),children:(0,e.jsx)("img",{src:"/icons/send_icon_w.svg",alt:"",className:"w-[18px] h-[18px]"})})]})]})})}),Et=function i(n){return typeof n=="string"?n:Array.isArray(n)?n.map(i).join(""):a.isValidElement(n)?i(n.props.children):""},Pt=function(n){return Et(n)},Xe=function(n,r){return{code:function(w){var S=w.node,p=w.className,y=w.children,t=xt()(w,It),g=/language-(\w+)/.exec(p||"");if(g!=null&&g.length){var d=Math.random().toString(36).substr(2,9);return(0,e.jsxs)("div",{className:" rounded-md border overflow-hidden",children:[(0,e.jsxs)("div",{className:"flex h-12 items-center justify-between bg-zinc-100 px-4 bg-zinc-900",children:[(0,e.jsx)("div",{className:"flex items-center gap-2",children:(0,e.jsx)("p",{className:"text-sm  text-[#fff] mb-[0]",children:g[1]})}),(0,e.jsxs)("div",{className:"text-[12px] text-[#fff] mb-[0] cursor-pointer flex gap-x-[5px]",onClick:function(){var c=ae()(I()().mark(function v(x){var j;return I()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.prev=0,j=x.currentTarget,s.next=4,nt()(Pt(y));case 4:j&&(j.children[1].innerText=r.formatMessage({id:"app.chatroom.content.copySucceed"})),setTimeout(function(){j&&(j.children[1].innerText=r.formatMessage({id:"app.chatroom.content.copycode"}))},200),s.next=11;break;case 8:s.prev=8,s.t0=s.catch(0),console.error("Failed to copy text: ",s.t0);case 11:case"end":return s.stop()}},v,null,[[0,8]])}));return function(v){return c.apply(this,arguments)}}(),children:[(0,e.jsx)("img",{src:"/icons/chat_copy_w.svg"}),(0,e.jsx)("span",{children:r.formatMessage({id:"app.chatroom.content.copycode"})})]})]}),(0,e.jsx)("div",{className:"overflow-x-auto bg-[#282c34] text-[#abb2bf]",children:(0,e.jsx)("div",{id:"".concat(d).concat(n),className:"p-4",children:y})})]})}else return(0,e.jsx)("code",H()(H()({},t),{},{children:y}))}}},rt=(0,a.memo)(function(i){var n=i.messageApi,r=i.index,l=i.idName,w=i.cidName,S=(0,Y.useIntl)(),p=(0,a.useState)(!1),y=u()(p,2),t=y[0],g=y[1];return(0,e.jsx)("div",{className:"flex gap-x-[4px]",children:(0,e.jsxs)("div",{onMouseEnter:function(){g(!0)},onMouseLeave:function(){g(!1)},className:" p-[2px] cursor-pointer rounded-md flex gap-x-[5px] items-center pt-[10px]",onClick:function(){var d=ae()(I()().mark(function c(v){var x,j;return I()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return x=v.target.closest("#".concat(l).concat(r)),j=x.querySelector("#".concat(w).concat(r)),s.prev=2,s.next=5,nt()(j.innerText);case 5:n.open({type:"success",content:S.formatMessage({id:"app.chatroom.content.copySucceed"}),duration:2}),s.next=11;break;case 8:s.prev=8,s.t0=s.catch(2),console.error("Failed to copy text: ",s.t0);case 11:case"end":return s.stop()}},c,null,[[2,8]])}));return function(c){return d.apply(this,arguments)}}(),children:[(0,e.jsx)("img",{src:"".concat(t?"/icons/chat_copy_check.svg":"/icons/chat_copy.svg"),className:"w-[16px] h-[16px]"}),(0,e.jsx)("span",{className:"text-[12px] ".concat(t?" text-[#1B64F3]":"text-[#666]"),children:S.formatMessage({id:"app.chatroom.content.copy"})})]})})}),st=function(n){var r=n.id,l=n.index,w=n.idName,S=n.cidName,p=(0,Y.useIntl)(),y=G(function(j){return j.setSummaryClick}),t=(0,a.useState)(!0),g=u()(t,2),d=g[0],c=g[1],v=G(function(j){return j.summaryClick});(0,a.useEffect)(function(){c(v)},[v]);var x=G(function(j){return j.setSummaryParams});return(0,e.jsx)("div",{className:"flex gap-x-[4px] text-[#666] ".concat(d?"cursor-pointer hover:text-[#1B64F3]":"cursor-no-drop"),children:(0,e.jsxs)("div",{className:" p-[2px]  rounded-md flex gap-x-[5px] items-center pt-[10px]",onClick:function(b){if(d){var s=b.target.closest("#".concat(w).concat(l)),L=s.querySelector("#".concat(S).concat(l));x({id:r,message:L.innerText}),y(!1)}},children:[(0,e.jsx)(_t.Z,{className:"text-[16px]"}),(0,e.jsx)("span",{className:"text-[12px]",children:p.formatMessage({id:"app.chatroom.content.summary"})})]})})},Tt=function(n){var r=n.roomid,l=(0,Y.useIntl)(),w=G(function(c){return c.setSummaryClick}),S=(0,a.useState)(!0),p=u()(S,2),y=p[0],t=p[1],g=G(function(c){return c.summaryClick});(0,a.useEffect)(function(){t(g)},[g]);var d=G(function(c){return c.setSummaryParams});return(0,e.jsx)("div",{className:"bg-[#fff] text-[#999999]   items-center justify-center rounded-[8px] ".concat(y?"cursor-pointer hover:text-[#1B64F3]":"cursor-no-drop"),style:{boxShadow:"0px 0px 4px 0px rgba(0,0,0,0.1)"},children:(0,e.jsxs)("div",{className:" gap-x-[4px] flex items-center justify-center h-[40px] px-[20px]",onClick:function(){y&&(d({id:r}),w(!1))},children:[(0,e.jsx)(Ft,{className:"text-[16px]"}),(0,e.jsx)("span",{className:"text-[14px]",children:l.formatMessage({id:"app.chatroom.content.meetingSummary"})})]})})},$t=(0,a.memo)(function(i){var n=i.messageApi,r=i.setCurrentMessageContent,l=i.sendValue,w=i.agentList,S=i.scrollDomRef,p=i.upButtonDom,y=i.setIsStop,t=i.setisEnd,g=i.setSendValue,d=(0,Y.useIntl)(),c=(0,Y.useParams)(),v=c.id,x=G(function(O){return O.setDisableInput}),j=(0,a.useState)({}),b=u()(j,2),s=b[0],L=b[1],K=(0,a.useRef)(!1),z=(0,a.useRef)(""),R=G(function(O){return O.setTruncatable}),Z=function(E){var D=E.data;if(D.indexOf("--NEXUSAI-INSTRUCTION-")!==-1){var m=JSON.parse(D.slice(22,-2));switch(m[0]){case"ERROR":x(!1),y(!1),g(""),n.open({type:"error",content:"webSocket-".concat(m[1]),duration:10});break;case"CHAT":var f={content:"".concat(m[1]),is_agent:0};r(function(N){return[].concat(ce()(N),[f])}),setTimeout(function(){S.current.scrollTop=S.current.scrollHeight,p.current.style.display="none"});break;case"STOPPABLE":y(m[1]);break;case"TRUNCATABLE":R(m[1]),m[1]||n.open({type:"success",content:"".concat(d.formatMessage({id:"app.chatroom.sidebar.cleartips"})),duration:3});break;case"TRUNCATEOK":n.open({type:"success",content:"".concat(d.formatMessage({id:"app.chatroom.sidebar.cleartips"})),duration:3});break}}if(D.indexOf("REPLY")!==-1&&D.indexOf("--NEXUSAI-INSTRUCTION-")!==-1){var k=JSON.parse(D.slice(22,-2))[1];z.current="",K.current=!0;var _=w.current.filter(function(N){return N.agent_id==k})[0];Object.keys(s).length&&r(function(N){return[].concat(ce()(N),[s])}),L(function(N){return H()(H()({},N),{},{is_agent:1,icon:_==null?void 0:_.icon,name:_==null?void 0:_.name})}),y(!0),R(!1)}D.indexOf("--NEXUSAI-INSTRUCTION-")===-1&&K.current&&(S.current.scrollTop=S.current.scrollHeight,p.current.style.display="none",z.current+=D,L(function(N){return H()(H()({},N),{},{content:z.current})})),D.indexOf("ENDCHAT")!==-1&&(K.current=!1,z.current="",x(!1),y(!1),R(!0),Object.keys(s).length&&r(function(N){return[].concat(ce()(N),[s])}),L({}),t(!0),g(""))},q=(0,ft.Z)("chat",Z),ne=q.runSocket,V=q.sendMessage,$=q.readyState;return(0,a.useEffect)(function(){$==1&&v&&V(JSON.stringify(["ENTER",parseInt(v)]))},[$]),(0,a.useEffect)(function(){l&&$==1&&V(l)},[l]),(0,a.useEffect)(function(){ne()},[]),(0,e.jsx)(e.Fragment,{children:s.name?(0,e.jsxs)("div",{className:"w-full flex gap-[15px] pt-[15px] pb-[15px] ".concat(s.is_agent!=1?"flex-row-reverse":""),children:[(0,e.jsx)("div",{className:"w-[40px] h-[40px] bg-[#F4F8F1] rounded-[6px] flex items-center justify-center shrink-0",children:s.is_agent==1?(0,e.jsx)("img",{src:(0,ve.s9)("single",s.icon),alt:"",className:"w-[18px]  h-[18px]"}):(0,e.jsx)("img",{src:"/icons/user_header.svg",className:"w-[18px]  h-[18px]"})}),(0,e.jsxs)("div",{className:"flex1 max-w-[560px] text-right",id:"addcontent",children:[(0,e.jsx)("div",{className:"".concat(s.is_agent==1?"text-left":"text-right"," font-[500] text-[14px] text-[#213044] pb-[8px]"),children:s.name?s.name:(0,ve.Qy)("GET").nickname}),(0,e.jsx)("div",{className:"text-left inline-block markdown-container text-[14px] font-[400] text-[#213044] bg-[#F7F7F7] p-[15px] pb-[1px] leading-[22px]",style:s.is_agent==1?{borderRadius:" 0px 8px 8px 8px"}:{borderRadius:"8px 0px 8px 8px",background:"rgba(27,100,243,0.1)",whiteSpace:"pre-wrap"},id:"addchilContent",children:(0,e.jsx)(ye.U,{rehypePlugins:[Se.Z],components:Xe("add",d),children:s.content})})]})]}):(0,e.jsx)(e.Fragment,{})})}),Lt=(0,a.memo)(function(i){var n=i.messageApi,r=i.setUserMessage,l=i.sendValue,w=i.agentList,S=i.scrollDomRef,p=i.upButtonDom,y=i.setIsStop,t=i.setSendValue,g=(0,Y.useIntl)(),d=(0,a.useState)([]),c=u()(d,2),v=c[0],x=c[1],j=(0,a.useState)(!1),b=u()(j,2),s=b[0],L=b[1],K=(0,Y.useParams)(),z=K.id;return(0,a.useEffect)(function(){s&&(r(function(R){return[].concat(ce()(R),ce()(v))}),x([]),setTimeout(function(){L(!1),S.current.scrollTop=S.current.scrollHeight},200))},[s]),(0,e.jsxs)(e.Fragment,{children:[v.length?v.map(function(R,Z){return(0,e.jsxs)("div",{className:"w-full flex gap-[15px] pt-[15px] pb-[15px] ".concat(R.is_agent!=1?"flex-row-reverse":""),children:[(0,e.jsx)("div",{className:"w-[40px] h-[40px] bg-[#F4F8F1] rounded-[6px] flex items-center justify-center shrink-0",children:R.is_agent==1?(0,e.jsx)("img",{src:(0,ve.s9)("single",R.icon),alt:"",className:"w-[18px]  h-[18px]"}):(0,e.jsx)("img",{src:"/icons/user_header.svg",className:"w-[18px]  h-[18px]"})}),(0,e.jsxs)("div",{className:"flex1 max-w-[560px] text-right",id:"currentContent".concat(Z),children:[(0,e.jsx)("div",{className:"".concat(R.is_agent==1?"text-left":"text-right"," font-[500] text-[14px] text-[#213044] pb-[8px]"),children:R.name?R.name:(0,ve.Qy)("GET").nickname}),(0,e.jsx)("div",{className:"text-left inline-block markdown-container text-[14px] font-[400] text-[#213044] bg-[#F7F7F7] p-[15px] pb-[1px] leading-[22px]",style:R.is_agent==1?{borderRadius:" 0px 8px 8px 8px"}:{borderRadius:"8px 0px 8px 8px",background:"rgba(27,100,243,0.1)",whiteSpace:"pre-wrap"},id:"currentChilContent".concat(Z),children:(0,e.jsx)(ye.U,{rehypePlugins:[Se.Z],components:Xe(Z,g),children:R.content})}),R.is_agent==1?(0,e.jsxs)("div",{className:"flex gap-x-[20px]",children:[(0,e.jsx)(rt,{messageApi:n,index:Z,idName:"currentContent",cidName:"currentChilContent"}),(0,e.jsx)(st,{id:z,index:Z,idName:"currentContent",cidName:"currentChilContent"})]}):(0,e.jsx)(e.Fragment,{})]})]},Z)}):(0,e.jsx)(e.Fragment,{}),(0,e.jsx)($t,{messageApi:n,setCurrentMessageContent:x,sendValue:l,agentList:w,scrollDomRef:S,upButtonDom:p,setIsStop:y,setisEnd:L,setSendValue:t})]})}),Zt=(0,a.memo)(function(i){var n=i.messageApi,r=i.scrollDomRef,l=i.instruction,w=i.setIsStop,S=i.upButtonDom,p=i.setInstruction,y=i.agentList,t=(0,Y.useIntl)(),g=(0,Y.useParams)(),d=g.id,c=(0,a.useState)([]),v=u()(c,2),x=v[0],j=v[1],b=(0,a.useRef)(!1),s=(0,a.useState)(""),L=u()(s,2),K=L[0],z=L[1],R=(0,a.useRef)(null),Z=(0,a.useRef)(null),q=(0,a.useRef)(!0),ne=(0,a.useRef)(2),V=(0,a.useRef)(1),$=(0,a.useRef)(0),O=function(){var k=ae()(I()().mark(function _(N){var te,J,re=arguments;return I()().wrap(function(se){for(;;)switch(se.prev=se.next){case 0:if(te=re.length>1&&re[1]!==void 0?re[1]:function(){},!d){se.next=6;break}return se.next=4,(0,pe.KH)(d,{page:V.current,page_size:20});case 4:J=se.sent,J.code==0&&(ne.current=J.data.total_pages,j(function(Ne){return N?ce()(J.data.list):[].concat(ce()(J.data.list),ce()(Ne))}),N?setTimeout(function(){r.current.scrollTop=r.current.scrollHeight,S.current.style.display="none"}):$.current=J.data.list.length);case 6:case"end":return se.stop()}},_)}));return function(N){return k.apply(this,arguments)}}(),E=function(_){var N=_.target.scrollHeight-_.target.scrollTop-_.target.clientHeight;if(b.current!==Math.ceil(N)>50&&(b.current=Math.ceil(N)>50,S.current.style.display=b.current?"flex":"none"),_.target.scrollTop==0&&q.current){q.current=!1;var te=R.current.firstChild;V.current=V.current+1,Z.current.style.display="flex",ne.current,ne.current>=V.current?O(!1):Z.current.style.display="none"}},D=function(_,N){N==="0"&&(N=Number(N));var te=["".concat(_),N===0||N?N:null];z(JSON.stringify(te))},m=G(function(k){return k.disableInput}),f=G(function(k){return k.clearMemory});return(0,a.useEffect)(function(){f&&f.length&&D(f[0],f[1])},[f]),(0,a.useEffect)(function(){l&&l.length&&(D(l[0],l[1]?l[1]:""),p([]))},[l]),(0,a.useEffect)(function(){$.current&&R.current.children[$.current]&&(r.current.scrollTop=R.current.children[$.current].offsetTop,q.current=!0)},[x]),(0,a.useEffect)(function(){V.current=1,O(!0)},[]),(0,e.jsxs)("div",{className:"flex-1 box-border relative overflow-y-auto chatroom overflow-x-hidden",ref:r,onScroll:E,children:[(0,e.jsx)("div",{className:"text-center justify-center items-center flex",style:{display:"none"},ref:Z,children:(0,e.jsx)(je.Z,{})}),(0,e.jsxs)("div",{className:"max-w-[920px] mx-auto",style:{minHeight:"calc(100% - 50px)"},ref:R,children:[x.map(function(k,_){return(0,e.jsxs)("div",{id:"c".concat(k.id),className:"w-full flex gap-[15px] pt-[15px] pb-[15px] ".concat(k.is_agent!=1?"flex-row-reverse":""),children:[(0,e.jsx)("div",{className:"w-[40px] h-[40px] bg-[#F4F8F1] rounded-[6px] flex items-center justify-center shrink-0",children:k.is_agent==1?(0,e.jsx)("img",{src:(0,ve.s9)("single",k.icon),alt:"",className:"w-[18px]  h-[18px]"}):(0,e.jsx)("img",{src:"/icons/user_header.svg",className:"w-[18px]  h-[18px]"})}),(0,e.jsxs)("div",{className:"flex1 max-w-[560px] text-right",id:"content".concat(_),children:[(0,e.jsx)("div",{className:"".concat(k.is_agent==1?"text-left":"text-right"," font-[500] text-[14px] text-[#213044] pb-[8px]"),children:k.name?k.name:(0,ve.Qy)("GET").nickname}),(0,e.jsx)("div",{className:"text-left markdown-container inline-block text-[14px] font-[400] text-[#213044] bg-[#F7F7F7] p-[15px] pb-[1px] leading-[22px]",style:k.is_agent==1?{borderRadius:" 0px 8px 8px 8px"}:{borderRadius:"8px 0px 8px 8px",background:"rgba(27,100,243,0.1)",whiteSpace:"pre-wrap"},id:"chilContent".concat(_),children:(0,e.jsx)(ye.U,{rehypePlugins:[Se.Z],components:Xe(_,t),children:k.content})}),k.is_agent==1?(0,e.jsxs)("div",{className:"flex gap-x-[20px]",children:[(0,e.jsx)(rt,{messageApi:n,idName:"content",cidName:"chilContent",index:_}),(0,e.jsx)(st,{id:d,index:_,idName:"content",cidName:"chilContent"})]}):(0,e.jsx)(e.Fragment,{})]})]},_)}),(0,e.jsx)(Lt,{messageApi:n,setUserMessage:j,sendValue:K,agentList:y,scrollDomRef:r,upButtonDom:S,setIsStop:w,setSendValue:z})]}),(0,e.jsx)("div",{className:"w-full flex justify-center pb-[10px]",children:!m&&x.length?(0,e.jsx)(Tt,{roomid:d}):(0,e.jsx)(e.Fragment,{})})]})}),Ht=(0,a.memo)(function(i){var n=i.agentList,r=(0,a.useRef)(null),l=(0,a.useRef)(null),w=(0,a.useState)(!1),S=u()(w,2),p=S[0],y=S[1],t=(0,a.useState)([]),g=u()(t,2),d=g[0],c=g[1],v=Oe.ZP.useMessage(),x=u()(v,2),j=x[0],b=x[1];return(0,e.jsxs)(e.Fragment,{children:[b,(0,e.jsx)("div",{className:"mx-[44px] flex justify-center relative box-border pt-[12px]   overflow-auto",style:{height:"calc(100% )"},children:(0,e.jsxs)("div",{className:"flex flex-col w-full",children:[(0,e.jsx)(Zt,{instruction:d,setInstruction:c,messageApi:j,scrollDomRef:r,setIsStop:y,upButtonDom:l,agentList:n}),(0,e.jsx)(Ot,{setInstruction:c,messageApi:j,isStop:p,upButtonDom:l,scrollDomRef:r})]})})]})}),zt=o(42881),Bt=function(n){var r=n.children,l=n.className,w=l===void 0?"":l,S=n.dragDirection,p=S===void 0?"left":S,y=n.minWidth,t=y===void 0?415:y,g=n.maxWidth,d=g===void 0?820:g,c=n.minHeight,v=c===void 0?200:c,x=n.maxHeight,j=x===void 0?800:x,b=n.defaultWidth,s=b===void 0?415:b,L=n.defaultHeight,K=L===void 0?300:L,z=(0,a.useState)(s),R=u()(z,2),Z=R[0],q=R[1],ne=(0,a.useState)(K),V=u()(ne,2),$=V[0],O=V[1],E=(0,a.useCallback)(function(k,_){q(k),_&&O(_)},[q,O]),D=(0,zt.W)({direction:["left","right"].includes(p)?"horizontal":"vertical",triggerDirection:p,minWidth:t,maxWidth:d,minHeight:v,maxHeight:j,onResize:E}),m=D.triggerRef,f=D.containerRef;return(0,e.jsxs)("div",{ref:f,style:{width:["left","right"].includes(p)?"".concat(Z,"px"):void 0,height:["top","bottom"].includes(p)?"".concat($,"px"):void 0},className:"flex flex-col p-4 shadow-lg rounded-md border border-blue-300 bg-white z-10 wrapPanel ".concat(w),children:[p==="left"&&(0,e.jsx)("div",{ref:m,className:"absolute top-1/2 -translate-y-1/2 -left-2 w-3 h-6 cursor-col-resize resize-x",children:(0,e.jsx)("div",{className:"w-1 h-6 bg-gray-300 rounded-sm"})}),p==="right"&&(0,e.jsx)("div",{ref:m,className:"absolute top-1/2 -translate-y-1/2 -right-2 flex justify-end w-3 h-6 cursor-col-resize resize-x",children:(0,e.jsx)("div",{className:"w-1 h-6 bg-gray-300 rounded-sm"})}),p==="top"&&(0,e.jsx)("div",{ref:m,className:"absolute left-1/2 -translate-x-1/2 -top-2 h-3 w-6 cursor-row-resize resize-y",children:(0,e.jsx)("div",{className:"h-1 w-6 bg-gray-300 rounded-sm"})}),p==="bottom"&&(0,e.jsx)("div",{ref:m,className:"absolute left-1/2 -translate-x-1/2 -bottom-2 h-3 w-6 cursor-row-resize resize-y",children:(0,e.jsx)("div",{className:"h-1 w-6 bg-gray-300 rounded-sm"})}),r]})},Vt=(0,a.memo)(Bt),Ut={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M762 164h-64c-4.4 0-8 3.6-8 8v688c0 4.4 3.6 8 8 8h64c4.4 0 8-3.6 8-8V172c0-4.4-3.6-8-8-8zm-508 0v72.4c0 9.5 4.2 18.4 11.4 24.5L564.6 512 265.4 763.1c-7.2 6.1-11.4 15-11.4 24.5V860c0 6.8 7.9 10.5 13.1 6.1L689 512 267.1 157.9A7.95 7.95 0 00254 164z"}}]},name:"vertical-left",theme:"outlined"},Wt=Ut,Gt=function(n,r){return a.createElement(Re.Z,(0,oe.Z)((0,oe.Z)({},n),{},{ref:r,icon:Wt}))},Kt=a.forwardRef(Gt),Jt=Kt,Qt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M326 164h-64c-4.4 0-8 3.6-8 8v688c0 4.4 3.6 8 8 8h64c4.4 0 8-3.6 8-8V172c0-4.4-3.6-8-8-8zm444 72.4V164c0-6.8-7.9-10.5-13.1-6.1L335 512l421.9 354.1c5.2 4.4 13.1.7 13.1-6.1v-72.4c0-9.4-4.2-18.4-11.4-24.5L459.4 512l299.2-251.1c7.2-6.1 11.4-15.1 11.4-24.5z"}}]},name:"vertical-right",theme:"outlined"},Xt=Qt,Yt=function(n,r){return a.createElement(Re.Z,(0,oe.Z)((0,oe.Z)({},n),{},{ref:r,icon:Xt}))},qt=a.forwardRef(Yt),ea=qt,ta=o(83159),it=o(42237),aa={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M464 144H160c-8.8 0-16 7.2-16 16v304c0 8.8 7.2 16 16 16h304c8.8 0 16-7.2 16-16V160c0-8.8-7.2-16-16-16zm-52 268H212V212h200v200zm452-268H560c-8.8 0-16 7.2-16 16v304c0 8.8 7.2 16 16 16h304c8.8 0 16-7.2 16-16V160c0-8.8-7.2-16-16-16zm-52 268H612V212h200v200zm52 132H560c-8.8 0-16 7.2-16 16v304c0 8.8 7.2 16 16 16h304c8.8 0 16-7.2 16-16V560c0-8.8-7.2-16-16-16zm-52 268H612V612h200v200zM424 712H296V584c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v128H104c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h128v128c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V776h128c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8z"}}]},name:"appstore-add",theme:"outlined"},na=aa,ra=function(n,r){return a.createElement(Re.Z,(0,oe.Z)((0,oe.Z)({},n),{},{ref:r,icon:na}))},sa=a.forwardRef(ra),ia=sa,la=o(93696),ca=function(n,r){return a.createElement(Re.Z,(0,oe.Z)((0,oe.Z)({},n),{},{ref:r,icon:la.Z}))},oa=a.forwardRef(ca),ua=oa,Ye=o(86),da=o(34994),pa=o(4981),xa=o(2216),fa=o(85877),ma=o(29432),va=o(39944),ha=o(11551),qe=o(29608),lt=o(55927),ga=(0,a.memo)(function(i){var n=i.progressObj;console.log(n);var r=function(){return parseFloat(n.elapsed_time).toFixed(6)},l=function(S){var p=new Date(S),y=p.getFullYear(),t=(p.getMonth()+1).toString().padStart(2,"0"),g=p.getDate().toString().padStart(2,"0"),d=p.getHours().toString().padStart(2,"0"),c=p.getMinutes().toString().padStart(2,"0"),v=p.getSeconds().toString().padStart(2,"0");return(0,e.jsx)(e.Fragment,{children:"".concat(y,".").concat(t,".").concat(g," ").concat(d,":").concat(c,":").concat(v)})};return(0,e.jsx)("div",{className:"inline-flex gap-x-4 justify-end max-w-[100%]",children:(0,e.jsxs)("div",{className:"inline-flex gap-x-[20px] max-w-[100%]",children:[(0,e.jsx)("div",{className:"truncate min-w-[70px]",children:n.created_time&&l(n.created_time)}),(0,e.jsx)("div",{className:"truncate",children:n.apps_name||n.app_name}),(0,e.jsxs)("div",{className:"flex items-center gap-x-[7px] truncate min-w-[50px]",children:[(0,e.jsx)("div",{className:"shrink-0 rounded-full ".concat(n.status==1?"bg-blue-600":n.status==2?"bg-green-500":"bg-red-500"),style:{width:"3px",height:"3px"}}),(0,e.jsxs)("div",{className:"truncate",children:[r(),"S"]})]})]})})}),ja=function(n){var r,l,w,S,p,y,t=(0,Y.useIntl)(),g=n.runboxShow,d=n.runid,c=n.id,v=n.setBoxLoading,x=n.scrollDom,j=n.setinputShow,b=(0,a.useState)(null),s=u()(b,2),L=s[0],K=s[1],z=(0,a.useState)(null),R=u()(z,2),Z=R[0],q=R[1],ne=(0,a.useState)("agent"),V=u()(ne,2),$=V[0],O=V[1],E=(0,a.useState)({type:"agent",checkItem:[],show:!1}),D=u()(E,2),m=D[0],f=D[1],k=(0,a.useState)([]),_=u()(k,2),N=_[0],te=_[1],J=(0,a.useState)(""),re=u()(J,2),fe=re[0],se=re[1],Ne=(0,a.useState)(!1),ue=u()(Ne,2),Me=ue[0],we=ue[1],M=(0,a.useState)(null),F=u()(M,2),C=F[0],ie=F[1],T=(0,a.useState)(null),le=u()(T,2),me=le[0],ee=le[1],xe=(0,a.useState)(""),de=u()(xe,2),ge=de[0],et=de[1],ct=(0,a.useRef)(""),ke=(0,a.useRef)(null),Fe=(0,a.useRef)(""),Da=(0,qe.Z)(function(P){return P.setDealtWithData}),Ia=(0,qe.Z)(function(P){return P.setRunPanelLogRecord}),Aa=[{key:"1",label:(0,e.jsx)("div",{className:"hover:text-[#1B64F3]",onClick:function(){f(function(h){return H()(H()({},h),{},{type:"agent",show:!0})})},children:t.formatMessage({id:"app.summary.SelectAgent"})})},{key:"2",label:(0,e.jsx)("div",{className:"hover:text-[#1B64F3]",onClick:function(){f(function(h){return H()(H()({},h),{},{type:"workflow",show:!0})})},children:t.formatMessage({id:"app.summary.SelectWorkflow"})})}],Oa=function(){var P=ae()(I()().mark(function h(A,Q){var B,X;return I()().wrap(function(U){for(;;)switch(U.prev=U.next){case 0:return U.next=2,(0,pe.xT)(A,Q);case 2:B=U.sent,(B==null?void 0:B.code)==0&&(Fe.current=B==null||(X=B.data)===null||X===void 0?void 0:X.app_run_id);case 4:case"end":return U.stop()}},h)}));return function(A,Q){return P.apply(this,arguments)}}(),Ea=function(){var P=ae()(I()().mark(function h(A,Q){var B,X;return I()().wrap(function(U){for(;;)switch(U.prev=U.next){case 0:if(Q=="agent"){U.next=5;break}return U.next=3,(0,it.zO)(A);case 3:B=U.sent,B.code==0&&q(B==null||(X=B.data)===null||X===void 0?void 0:X.need_confirm_nodes);case 5:Oa(c,{app_id:A,app_run_id:d,status:1,corrected_parameter:""});case 6:case"end":return U.stop()}},h)}));return function(A,Q){return P.apply(this,arguments)}}(),Pa=function(){f(function(h){return H()(H()({},h),{},{show:!1})})},Ta=function(h){v(!0),K(null),f(function(A){return H()(H()({},A),{},{checkItem:h.checkItem})}),O(m.type),Ea(h.checkItem[0].app_id,m.type),ct.current=h.checkItem[0].app_id,setTimeout(function(){x.current.scrollTo({top:x.current.scrollHeight})},300)},$a=function(h){return h.completed_progress?parseInt(h.completed_progress.slice(0,-1)):!1},La=function(h){var A={user:{value:Za(h)}};se(new va.z(A))},Za=function P(h){return h.map(function(A){return A.type==="mention"?A.id:A.children?P(A.children):A.text}).join("")},Ha=function(){var P=ae()(I()().mark(function h(){var A,Q;return I()().wrap(function(X){for(;;)switch(X.prev=X.next){case 0:A=be==null?void 0:be.filter(function(W){return W.type=="workflow_run_progress"&&W.data.app_run_id==Fe.current}).map(function(W){var U=W.data;return U}),A&&A.length&&(Q=A[A.length-1],ie(Q),v(!1));case 2:case"end":return X.stop()}},h)}));return function(){return P.apply(this,arguments)}}(),za=function(){var P=ae()(I()().mark(function h(){var A,Q,B,X;return I()().wrap(function(U){for(;;)switch(U.prev=U.next){case 0:Q=be==null||(A=be.filter(function(De){return De.type=="workflow_need_human_confirm"&&De.data.app_run_id==Fe.current}).map(function(De){var Ie=De.data;return Ie}))===null||A===void 0?void 0:A.filter(function(De){return De.type!==1}),Q&&Q.length&&(X=Q[Q.length-1],X.exec_id=X==null||(B=X.node_exec_data)===null||B===void 0?void 0:B.node_exec_id,ee(X),v(!1));case 2:case"end":return U.stop()}},h)}));return function(){return P.apply(this,arguments)}}(),Ba=function(){var P=ae()(I()().mark(function h(A){var Q,B,X,W,U;return I()().wrap(function(Ie){for(;;)switch(Ie.prev=Ie.next){case 0:return v(!0),Q=Object.keys(A),B={},Q.forEach(function(Ae){ke.current.properties[Ae]&&(ke.current.properties[Ae].value=A[Ae]),Z&&Z.forEach(function(Ua){Ua.node_id==Ae&&(B[Ae]=A[Ae])})}),X={inputs:ke.current,node_confirm_users:B,run_name:"chatroom-".concat(c,"-run-").concat(Fe.current,"-driven"),run_type:1,data_source_run_id:Fe.current},Ie.next=7,(0,it.UE)(ct.current,X);case 7:W=Ie.sent,W.code==0&&(Fe.current=W==null||(U=W.data)===null||U===void 0?void 0:U.app_run_id,we(!0));case 9:case"end":return Ie.stop()}},h)}));return function(A){return P.apply(this,arguments)}}(),Va=function(){var P=ae()(I()().mark(function h(A){var Q,B;return I()().wrap(function(W){for(;;)switch(W.prev=W.next){case 0:return v(!0),Q=Object.keys(A),Q.forEach(function(U){ke.current.properties[U]&&(ke.current.properties[U].value=A[U])}),W.next=5,(0,ha.LH)({agent_id:m.checkItem[0].agent_id,ability_id:0,input_dict:ke.current,prompt:fe,data_source_run_id:Fe.current});case 5:B=W.sent,B.code==0&&(et(B.data.outputs_md),v(!1));case 7:case"end":return W.stop()}},h)}));return function(A){return P.apply(this,arguments)}}();(0,a.useEffect)(function(){g&&f({type:"agent",checkItem:[],show:!1})},[g]);var be=(0,lt.Z)(function(P){return P.flowMessage});return(0,a.useEffect)(function(){Ha(),za();var P=be.filter(function(W){return W.data.app_run_id==d&&W.type.indexOf("generate_meeting_action_items")!==-1});if(P.length!=0){var h,A=(h=P[P.length-1])===null||h===void 0||(h=h.data)===null||h===void 0||(h=h.exec_data)===null||h===void 0||(h=h.outputs)===null||h===void 0?void 0:h.value;if(A){var Q=JSON.parse(A);ke.current=Q;var B=Object.keys(Q.properties);if(B.length&&(K(Q.properties),$=="agent")){var X=B.map(function(W){return{value:"<<".concat(ma.qX,".inputs.").concat(W,">>"),label:W}});te(X)}j(!1),v(!1)}}},[be]),(0,e.jsxs)(e.Fragment,{children:[g?(0,e.jsxs)("div",{className:"pt-[24px]  border-[#ddd]",style:{minHeight:m!=null&&(r=m.checkItem)!==null&&r!==void 0&&r.length?x==null||(l=x.current)===null||l===void 0?void 0:l.offsetHeight:"100%"},children:[(0,e.jsxs)("div",{className:"text-[14px] font-[500] flex item-center",children:[(0,e.jsx)("div",{className:"flex-1",children:t.formatMessage({id:"app.summary.Runapp"})}),(0,e.jsx)("div",{className:"px-[10px]",children:!Me&&!ge?(0,e.jsx)(ta.Z,{menu:{items:Aa},children:(0,e.jsx)(ia,{className:"transition cursor-pointer text-[#999] text-[18px] hover:text-[#1B64F3]"})}):(0,e.jsx)(e.Fragment,{})})]}),(0,e.jsx)("div",{children:m!=null&&(w=m.checkItem)!==null&&w!==void 0&&w.length?(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("div",{className:"py-[6px]",children:(0,e.jsx)(Ye.Z,{icon:m==null||(S=m.checkItem[0])===null||S===void 0?void 0:S.icon,title:m==null||(p=m.checkItem[0])===null||p===void 0?void 0:p.name,textDetails:m==null||(y=m.checkItem[0])===null||y===void 0?void 0:y.description,iconType:$=="agent"?"robot_icon":"workflow_icon",handleClick:function(){}})}),ge?(0,e.jsx)("div",{className:"max-h-[400px] overflow-y-auto",children:(0,e.jsx)("div",{className:"p-[12px]  bg-[#F7F7F7] leading-[22px]",children:(0,e.jsx)(ye.U,{rehypePlugins:[Se.Z],children:ge})})}):(0,e.jsx)(e.Fragment,{}),!Me&&L!=null?(0,e.jsxs)(da.A,{submitter:{resetButtonProps:!1,submitButtonProps:{className:"w-full"},searchConfig:{submitText:t.formatMessage({id:"workflow.button.run"})}},onFinish:function(h){$=="workflow"?Ba(h):Va(h)},children:[(0,e.jsx)("div",{className:"py-[6px]",children:(0,e.jsx)(xa._,{data:L})}),$=="workflow"?(0,e.jsx)(pa.e,{data:Z}):(0,e.jsx)("div",{className:"h-[150px] overflow-y-auto border border-color-[#eee] py-[4px] px-[11px] mb-[8px]",children:(0,e.jsx)(fa.Z,{onChange:function(h){La(h)},options:N})})]}):(0,e.jsx)(e.Fragment,{}),me&&C&&C.need_human_confirm!=0?(0,e.jsx)("div",{className:"pt-[12px]",children:(0,e.jsxs)("div",{className:"flex gap-x-[6px] items-center h-[20px] cursor-pointer",onClick:function(){Da(me)},children:[(0,e.jsx)("div",{children:(0,e.jsx)(ua,{className:"text-[#1B64F3] text-[16px]"})}),(0,e.jsx)("span",{children:t.formatMessage({id:"app.summary.backlogTips"})})]})}):(0,e.jsx)(e.Fragment,{}),C?(0,e.jsx)("div",{className:"pt-[10px]",children:(0,e.jsx)(Ye.Z,{status:C.status,icon:C.icon,title:C.run_name,textDetails:(0,e.jsx)(ga,{progressObj:C}),handleClick:function(){Ia(C)},progress:$a(C)})}):(0,e.jsx)(e.Fragment,{})]}):(0,e.jsxs)("div",{className:"flex gap-x-[20px] min-h-[70px] items-center px-[20px]",children:[(0,e.jsxs)(he.ZP,{className:"flex-1 text-[14px]",onClick:function(){f(function(h){return H()(H()({},h),{},{type:"agent",show:!0})})},children:[(0,e.jsx)("img",{src:"/icons/robot_icon.svg",alt:"",className:"w-[14px] h-[14px]"}),t.formatMessage({id:"app.summary.SelectAgent"})]}),(0,e.jsxs)(he.ZP,{className:"flex-1 text-[14px]",onClick:function(){f(function(h){return H()(H()({},h),{},{type:"workflow",show:!0})})},children:[(0,e.jsx)("img",{src:"/icons/workflow_icon.svg",alt:"",className:"w-[14px] h-[14px]"}),t.formatMessage({id:"app.summary.SelectWorkflow"})]})]})})]}):(0,e.jsx)(e.Fragment,{}),(0,e.jsx)(Pe.Z,{show:m.show,nodetype:m.type,popupClose:Pa,popupSave:Ta,checkList:$==m.type?m.checkItem:[],zIndex:99,radio:!0})]})},ya=(0,a.memo)(ja),Sa=function(n){var r=n.setShow,l=n.inputShow,w=n.setBoxLoading,S=n.setAppRunId,p=(0,Y.useIntl)(),y=(0,a.useState)(!1),t=u()(y,2),g=t[0],d=t[1],c=(0,a.useState)(""),v=u()(c,2),x=v[0],j=v[1],b=(0,a.useState)(""),s=u()(b,2),L=s[0],K=s[1],z=(0,a.useRef)(""),R=(0,a.useRef)(""),Z=G(function(O){return O.setSummaryClick}),q=function(){var O=ae()(I()().mark(function E(D){var m,f,k,_,N=arguments;return I()().wrap(function(J){for(;;)switch(J.prev=J.next){case 0:return m=N.length>1&&N[1]!==void 0?N[1]:{app_run_id:"",corrected_parameter:""},J.next=3,(0,pe.Rp)(D,m);case 3:f=J.sent,(f==null?void 0:f.code)==0&&(S(f==null||(k=f.data)===null||k===void 0?void 0:k.app_run_id),R.current=f==null||(_=f.data)===null||_===void 0?void 0:_.app_run_id);case 5:case"end":return J.stop()}},E)}));return function(D){return O.apply(this,arguments)}}(),ne=function(){var O=ae()(I()().mark(function E(D,m){var f,k,_,N,te;return I()().wrap(function(re){for(;;)switch(re.prev=re.next){case 0:return re.next=2,(0,pe.xM)(D,{message:m});case 2:f=re.sent,(f==null?void 0:f.code)==0&&(R.current=f==null||(k=f.data)===null||k===void 0?void 0:k.app_run_id,S(f==null||(_=f.data)===null||_===void 0?void 0:_.app_run_id),f!=null&&(N=f.data)!==null&&N!==void 0&&(N=N.outputs)!==null&&N!==void 0&&N.value&&(j(f==null||(te=f.data)===null||te===void 0||(te=te.outputs)===null||te===void 0?void 0:te.value),r(!0),w(!1),Z(!0)));case 4:case"end":return re.stop()}},E)}));return function(D,m){return O.apply(this,arguments)}}(),V=(0,lt.Z)(function(O){return O.flowMessage});(0,a.useEffect)(function(){var O=V.filter(function(m){return m.data.app_run_id==R.current&&m.type.indexOf("generate_meeting_summary")!==-1});if(O.length!=0){var E,D=(E=O[O.length-1])===null||E===void 0||(E=E.data)===null||E===void 0||(E=E.exec_data)===null||E===void 0||(E=E.outputs)===null||E===void 0?void 0:E.value;D&&(j(D),r(!0),Z(!0),w(!1))}},[V]);var $=G(function(O){return O.summaryParams});return(0,a.useEffect)(function(){$&&$.id&&(z.current=$.id,x&&j(""),d(!0),$.message?(w(!0),ne($.id,$.message)):q($.id))},[$]),(0,e.jsx)(e.Fragment,{children:g?(0,e.jsxs)("div",{className:"pb-[16px]",children:[(0,e.jsx)("div",{className:"text-[16px] font-[600] pt-[12px]",children:p.formatMessage({id:"app.summary.title"})}),(0,e.jsx)("div",{className:"text-[14px] pt-[12px] leading-[23px] px-[8px]",children:x?(0,e.jsx)("div",{className:" ".concat("max-h-[400px]"," p-[12px]  bg-[#F7F7F7]  relative overflow-y-auto"),children:(0,e.jsx)(ye.U,{rehypePlugins:[Se.Z],children:x})}):(0,e.jsx)("div",{className:"min-h-[120px] flex items-center justify-center",children:(0,e.jsx)(je.Z,{size:"large"})})}),l?(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("div",{className:"pt-[12px]",children:(0,e.jsx)(at.Z.TextArea,{onChange:function(E){K(E.target.value)},value:L,disabled:!x,rows:4,placeholder:p.formatMessage({id:"app.summary.placeholder"})})}),(0,e.jsx)("div",{className:"flex pt-[12px] gap-x-[4px]",children:(0,e.jsx)(he.ZP,{type:"primary",disabled:!x||!L,className:"bg-[#1B64F3] rounded-[4px] w-[88px] h-[40px] flex-1",onClick:function(){q(z.current,{app_run_id:String(R.current),corrected_parameter:L}),w(!0),K(""),r("")},children:p.formatMessage({id:"app.summary.submitText"})})})]}):(0,e.jsx)(e.Fragment,{})]}):(0,e.jsx)(e.Fragment,{})})},Na=(0,a.memo)(Sa),wa=(0,a.memo)(function(i){var n=i.progressObj;console.log(n);var r=function(){return parseFloat(n.elapsed_time).toFixed(6)},l=function(S){var p=new Date(S),y=p.getFullYear(),t=(p.getMonth()+1).toString().padStart(2,"0"),g=p.getDate().toString().padStart(2,"0"),d=p.getHours().toString().padStart(2,"0"),c=p.getMinutes().toString().padStart(2,"0"),v=p.getSeconds().toString().padStart(2,"0");return(0,e.jsx)(e.Fragment,{children:"".concat(y,".").concat(t,".").concat(g," ").concat(d,":").concat(c,":").concat(v)})};return(0,e.jsx)("div",{className:"inline-flex gap-x-4 justify-end max-w-[100%]",children:(0,e.jsxs)("div",{className:"inline-flex gap-x-[20px] max-w-[100%]",children:[(0,e.jsx)("div",{className:"truncate min-w-[70px]",children:n.created_time&&l(n.created_time)}),(0,e.jsx)("div",{className:"truncate",children:n.apps_name||n.app_name}),(0,e.jsxs)("div",{className:"flex items-center gap-x-[7px] truncate min-w-[50px]",children:[(0,e.jsx)("div",{className:"shrink-0 rounded-full ".concat(n.status==1?"bg-blue-600":n.status==2?"bg-green-500":"bg-red-500"),style:{width:"3px",height:"3px"}}),(0,e.jsxs)("div",{className:"truncate",children:[r(),"S"]})]})]})})}),ba=function(n){var r=n.list,l=(0,Y.useIntl)(),w=r.reverse(),S=(0,qe.Z)(function(t){return t.setRunPanelLogRecord}),p=function(g){var d=new Date(g),c=d.getMonth()+1,v=d.getDate(),x=d.getHours(),j=d.getMinutes(),b=d.getSeconds();return d.getFullYear()+"-"+(c<10?"0"+c:c)+"-"+(v<10?"0"+v:v)+" "+(x<10?"0"+x:x)+":"+(j<10?"0"+j:j)+":"+(b<10?"0"+b:b)},y=function(g){var d=Object.keys(g),c=[];return d.forEach(function(v){c.push(g[v])}),c};return(0,e.jsx)(e.Fragment,{children:(0,e.jsx)("div",{className:"px-4",children:w&&w.length?w.map(function(t){var g,d,c,v,x,j,b,s,L,K,z,R,Z,q,ne,V,$,O,E;return t!=null&&t.source_run&&t!==null&&t!==void 0&&t.source_run.summary?(0,e.jsx)("div",{className:"pt-[16px] border-b-[1px] border-color-[#eee] ",children:(0,e.jsxs)("div",{className:"pb-[60px]",children:[(0,e.jsx)("div",{className:"text-[16px] font-[600] pb-[8px] flex items-center",children:(0,e.jsx)("span",{className:"flex-1",children:(t==null||(g=t.source_run)===null||g===void 0?void 0:g.name)||l.formatMessage({id:"app.summary.title"})})}),(0,e.jsx)("p",{className:"text-[12px] color-[#eee] mb-[8px]",children:p(t==null||(d=t.source_run)===null||d===void 0?void 0:d.created_time)}),(0,e.jsx)("div",{className:"p-[12px]  bg-[#F7F7F7] leading-[22px]",children:(0,e.jsx)(ye.U,{rehypePlugins:[Se.Z],children:t==null||(c=t.source_run)===null||c===void 0?void 0:c.summary})}),t!=null&&t.source_corrections&&(t==null?void 0:t.source_corrections.length)>0?(0,e.jsxs)("div",{children:[(0,e.jsxs)("div",{className:"text-[16px] font-[600] py-[8px]",children:[l.formatMessage({id:"app.summaryhistory.orientation"}),":"]}),t==null?void 0:t.source_corrections.map(function(D){return(0,e.jsx)("div",{children:(0,e.jsxs)("div",{className:"p-[12px]  bg-[#F7F7F7] leading-[22px]",children:[(0,e.jsxs)("div",{className:"tetx-[14px] font-[600] pb-[12px]",children:[l.formatMessage({id:"app.summaryhistory.time"}),": ",p(D.created_time)]}),(0,e.jsx)(ye.U,{rehypePlugins:[Se.Z],children:D==null?void 0:D.corrected_summary})]})},D.created_time)})]}):(0,e.jsx)(e.Fragment,{}),t!=null&&t.target_run?(0,e.jsxs)("div",{className:"py-[12px]",children:[(0,e.jsxs)("div",{className:"text-[16px] font-[600] py-[8px]",children:[l.formatMessage({id:"app.summaryhistory.runapp"}),":"]}),(0,e.jsx)("div",{children:(0,e.jsxs)("div",{className:"text-[14px] py-[6px]",children:[(0,e.jsx)("span",{className:"font-[500] ",children:t!=null&&(v=t.target_run)!==null&&v!==void 0&&v.agent_id?"agent":"workflow"}),(0,e.jsx)("span",{className:"px-[6px]",children:":"}),(0,e.jsx)("span",{children:t==null||(x=t.target_run)===null||x===void 0||(x=x.app)===null||x===void 0?void 0:x.name})]})}),(0,e.jsx)("div",{children:t!=null&&(j=t.target_run)!==null&&j!==void 0&&(j=j.inputs)!==null&&j!==void 0&&j.properties?y(t==null||(b=t.target_run)===null||b===void 0||(b=b.inputs)===null||b===void 0?void 0:b.properties).map(function(D){return(0,e.jsxs)("div",{children:[(0,e.jsxs)("div",{className:"text-[16px] color-[#000] font-[600] py-[12px]",children:[l.formatMessage({id:"app.summaryhistory.input"}),":"]}),(0,e.jsx)("div",{className:"pb-[8px] font-[600]",children:D.name}),(0,e.jsx)("div",{className:"py-[4px] px-[11px] text-[14px] leading-[1.5] h-[]",children:D.value})]})}):(0,e.jsx)(e.Fragment,{})}),(0,e.jsx)("div",{children:t!=null&&(s=t.target_run)!==null&&s!==void 0&&s.raw_user_prompt?(0,e.jsxs)("div",{children:[(0,e.jsxs)("div",{className:"text-[16px] color-[#000] font-[600] py-[12px] pb-[6px]",children:[l.formatMessage({id:"app.summaryhistory.prompt"}),":"]}),(0,e.jsx)("div",{className:"py-[4px] px-[11px] text-[14px] leading-[1.5] ",children:t==null||(L=t.target_run)===null||L===void 0?void 0:L.raw_user_prompt})]}):(0,e.jsx)(e.Fragment,{})}),(0,e.jsxs)("div",{children:[(0,e.jsxs)("div",{className:"text-[16px] font-[600] py-[8px]",children:[l.formatMessage({id:"app.summaryhistory.results"}),":"]}),(0,e.jsx)("div",{className:"p-[12px]  bg-[#F7F7F7]",children:(t==null||(K=t.target_run)===null||K===void 0?void 0:K.agent_id)!=0?(0,e.jsx)("div",{className:"p-[12px]  bg-[#F7F7F7] leading-[22px]",children:(0,e.jsx)(ye.U,{rehypePlugins:[Se.Z],children:t==null||(z=t.target_run)===null||z===void 0||(z=z.outputs)===null||z===void 0?void 0:z.value})}):(0,e.jsx)(Ye.Z,{status:t==null||(R=t.target_run)===null||R===void 0?void 0:R.status,icon:t==null||(Z=t.target_run)===null||Z===void 0?void 0:Z.icon,title:t==null||(q=t.target_run)===null||q===void 0?void 0:q.name,textDetails:(0,e.jsx)(wa,{progressObj:{created_time:t==null||(ne=t.target_run)===null||ne===void 0?void 0:ne.created_time,elapsed_time:t==null||(V=t.target_run)===null||V===void 0?void 0:V.elapsed_time,app_name:t==null||($=t.target_run)===null||$===void 0?void 0:$.app.name,status:t==null||(O=t.target_run)===null||O===void 0?void 0:O.status}}),handleClick:function(){var m,f,k,_,N,te,J,re,fe,se;S({app_id:t==null||(m=t.target_run)===null||m===void 0||(m=m.app)===null||m===void 0?void 0:m.id,app_name:t==null||(f=t.target_run)===null||f===void 0||(f=f.app)===null||f===void 0?void 0:f.name,icon:t==null||(k=t.target_run)===null||k===void 0?void 0:k.icon,workflow_id:t==null||(_=t.target_run)===null||_===void 0?void 0:_.workflow_id,type:2,app_run_id:t==null||(N=t.target_run)===null||N===void 0?void 0:N.id,run_name:t==null||(te=t.target_run)===null||te===void 0?void 0:te.name,status:t==null||(J=t.target_run)===null||J===void 0?void 0:J.status,created_time:t==null||(re=t.target_run)===null||re===void 0?void 0:re.created_time,elapsed_time:t==null||(fe=t.target_run)===null||fe===void 0?void 0:fe.elapsed_time,completed_progress:"".concat(t==null||(se=t.target_run)===null||se===void 0?void 0:se.percentage,"%")})},progress:t==null||(E=t.target_run)===null||E===void 0?void 0:E.percentage})})]})]}):(0,e.jsx)(e.Fragment,{})]})},t.source_run.id):(0,e.jsx)(e.Fragment,{})}):(0,e.jsx)(e.Fragment,{})})})},_a=(0,a.memo)(ba),Ca=function(n){var r,l=n.id,w=(0,a.useState)(""),S=u()(w,2),p=S[0],y=S[1],t=(0,a.useState)(!1),g=u()(t,2),d=g[0],c=g[1],v=(0,a.useState)([]),x=u()(v,2),j=x[0],b=x[1],s=(0,a.useState)(!1),L=u()(s,2),K=L[0],z=L[1],R=(0,a.useState)(!1),Z=u()(R,2),q=Z[0],ne=Z[1],V=(0,a.useState)(""),$=u()(V,2),O=$[0],E=$[1],D=(0,a.useState)(!1),m=u()(D,2),f=m[0],k=m[1],_=(0,a.useState)(!1),N=u()(_,2),te=N[0],J=N[1],re=(0,a.useState)(!0),fe=u()(re,2),se=fe[0],Ne=fe[1],ue=(0,a.useRef)(null),Me=function(){var F=ae()(I()().mark(function C(){var ie,T,le,me,ee=arguments;return I()().wrap(function(de){for(;;)switch(de.prev=de.next){case 0:return ie=ee.length>0&&ee[0]!==void 0?ee[0]:!0,de.next=3,(0,pe.sh)({chatroom_id:l,page:1,page_size:9999});case 3:T=de.sent,T.code==0&&(T!=null&&(le=T.data)!==null&&le!==void 0&&le.list&&T!==null&&T!==void 0&&(me=T.data)!==null&&me!==void 0&&(me=me.list)!==null&&me!==void 0&&me.length&&(b(T.data.list),c(!0)),ie||(setTimeout(function(){var ge;ue==null||(ge=ue.current)===null||ge===void 0||ge.scrollTo({top:ue.current.scrollHeight})},200),y(we.id),M({})));case 5:case"end":return de.stop()}},C)}));return function(){return F.apply(this,arguments)}}();(0,a.useEffect)(function(){Me()},[l]);var we=G(function(F){return F.summaryParams}),M=G(function(F){return F.setSummaryParams});return(0,a.useEffect)(function(){we&&we.id&&(c(!0),se||Ne(!0),K&&z(!1),f&&k(!1),ne(!0),Me(!1))},[we]),(0,e.jsx)(e.Fragment,{children:d?(0,e.jsxs)(Vt,{minWidth:400,className:"relative h-full right-0 border-0 returned-0 px-[0] ".concat(f?"translate-x-full flex-[0]":""),children:[te?(0,e.jsx)("div",{className:"h-full w-full absolute top-0 left-0 flex justify-center items-center z-20 bg-[rgba(255,255,255,0.5)]",children:(0,e.jsx)(je.Z,{size:"large"})}):(0,e.jsx)(e.Fragment,{}),(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("div",{onClick:function(){k(function(C){return!C})},className:`
                                        `.concat(f?"right-[100%] top-[4px]":"right-[6px] top-[60px]",`
                                        fixed w-[40px] h-[40px]  flex justify-center items-center cursor-pointer z-[99]
                                    `),children:f?(0,e.jsx)(ea,{className:"text-[20px]"}):(0,e.jsx)(Jt,{className:"text-[20px]"})}),(0,e.jsx)("div",{className:"h-full overflow-y-auto flex flex-col-reverse scroll-smooth",ref:ue,children:(0,e.jsxs)("div",{children:[j.length?(0,e.jsx)(_a,{list:j}):(0,e.jsx)(e.Fragment,{}),(0,e.jsxs)("div",{className:"w-full px-4 h-full",style:{minHeight:q?ue==null||(r=ue.current)===null||r===void 0?void 0:r.offsetHeight:"100%"},children:[(0,e.jsx)(Na,{setShow:z,inputShow:se,setBoxLoading:J,setAppRunId:E}),(0,e.jsx)(ya,{id:p,runid:O,runboxShow:K,setBoxLoading:J,scrollDom:ue,setinputShow:Ne})]})]})})]})]}):(0,e.jsx)(e.Fragment,{})})},Ra=(0,a.memo)(Ca),Ma=function(n){return(0,e.jsx)("div",{className:"flex items-center h-full justify-center",children:(0,e.jsx)(_e.Z,{image:_e.Z.PRESENTED_IMAGE_SIMPLE})})},ka=(0,a.memo)(function(){var i=(0,Y.useParams)(),n=i.id,r=(0,a.useRef)([]),l=(0,a.useRef)(null),w=(0,a.useState)(!1),S=u()(w,2),p=S[0],y=S[1],t=function(){var g=ae()(I()().mark(function d(){var c;return I()().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:if(!n){x.next=5;break}return x.next=3,(0,pe.cH)({id:n});case 3:c=x.sent,c.code==0?(y(!0),l.current=c.data,r.current=c.data.agent_list):Y.history.replace("/meeting");case 5:case"end":return x.stop()}},d)}));return function(){return g.apply(this,arguments)}}();return(0,a.useEffect)(function(){t()},[]),(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)("div",{className:"w-full flex bg-[#fff] overflow-hidden",style:{height:"calc(100vh - 56px)"},children:[(0,e.jsx)(dt,{roomDetail:l.current,setAgent:r}),(0,e.jsx)("div",{className:"flex-1",children:p?(0,e.jsx)(Ht,{agentList:r}):(0,e.jsx)(Ma,{})}),(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(Ra,{id:n})})]})})}),Fa=ka}}]);
