"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[1446],{83510:function(oe,W,a){a.d(W,{LK:function(){return C},bs:function(){return A},go:function(){return w},uy:function(){return b}});var N=a(15009),u=a.n(N),K=a(99289),m=a.n(K),p=a(47520),S="/v1/apps/apps_list",G="/v1/agent/agent_delete/",E="/v1/workflow/workflow_app_delete/",y="/v1/vector/delete_dataset/",v="/v1/skill/delete_skill_by_app_id/",Z="/v1/apps/apps_create",x="/v1/apps/app_update/",w=function(){var f=m()(u()().mark(function d(r){var e;return u()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,(0,p.ZP)("".concat(S),{method:"GET",data:r});case 2:return e=s.sent,s.abrupt("return",e);case 4:case"end":return s.stop()}},d)}));return function(r){return f.apply(this,arguments)}}(),C=function(){var f=m()(u()().mark(function d(r){var e;return u()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return console.log(r),s.next=3,r.mode;case 3:if(s.t0=s.sent,s.t0!=1){s.next=8;break}s.t1=(0,p.ZP)("".concat(G).concat(r.app_id),{method:"DELETE"}),s.next=9;break;case 8:s.t1=r.mode==2?(0,p.ZP)("".concat(E).concat(r.app_id),{method:"DELETE"}):r.mode==3?(0,p.ZP)("".concat(y).concat(r.app_id),{method:"DELETE"}):(0,p.ZP)("".concat(v).concat(r.app_id),{method:"DELETE",data:{is_soft:1}});case 9:return e=s.t1,s.abrupt("return",e);case 11:case"end":return s.stop()}},d)}));return function(r){return f.apply(this,arguments)}}(),b=function(){var f=m()(u()().mark(function d(r){var e;return u()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,(0,p.ZP)("".concat(Z),{method:"POST",data:r});case 2:return e=s.sent,s.abrupt("return",e);case 4:case"end":return s.stop()}},d)}));return function(r){return f.apply(this,arguments)}}(),A=function(){var f=m()(u()().mark(function d(r){var e;return u()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,(0,p.ZP)("".concat(x).concat(r.app_id),{method:"PUT",data:r});case 2:return e=s.sent,s.abrupt("return",e);case 4:case"end":return s.stop()}},d)}));return function(r){return f.apply(this,arguments)}}()},21446:function(oe,W,a){var N=a(15009),u=a.n(N),K=a(97857),m=a.n(K),p=a(99289),S=a.n(p),G=a(5574),E=a.n(G),y=a(83510),v=a(29608),Z=a(32332),x=a(35312),w=a(26915),C=a(28036),b=a(85576),A=a(67294),f=a(94840),d=a(54464),r=a(62880),e=a(85893),U=w.Z.TextArea,s=function(c){var O=c.setIsModalOpen,D=c.isModalOpen,H=c.transformData,i=c.CreationType,ae=c.setcreationType,k=c.ModalType,t=(0,x.useIntl)(),J=(0,A.useState)(""),Q=E()(J,2),F=Q[0],se=Q[1],X=(0,A.useState)(""),g=E()(X,2),re=g[0],n=g[1],te=(0,A.useState)({id:1,icon:"/icons/headportrait/Android.svg"}),Y=E()(te,2),$=Y[0],ne=Y[1],M=(0,v.Z)(),_=M.setAgentCreateOpen,P=M.setSkillCreateOpen,T=(0,d.TE)(),h=T.hasPermission,j=h(r.Dg.CREATE_AGENT),q=h(r.Dg.CREATE_WORKFLOW),z=h(r.Dg.CREATE_SKILL),B=h(r.Dg.CREATE_KNOWLEDGE_BASE),I=function(o){se(o.target.value)},V=function(o){n(o.target.value)},ie=function(){var l=S()(u()().mark(function o(){var R,_e;return u()().wrap(function(L){for(;;)switch(L.prev=L.next){case 0:if(R={name:F,mode:i.apps_mode,description:re,icon:JSON.stringify($.id),avatar:$.avatar||null,icon_background:""},i.apps_mode!=2){L.next=8;break}return L.next=4,(0,y.uy)(R);case 4:_e=L.sent,_e.code===0&&(O(!1),le(_e.data.app_id)),L.next=10;break;case 8:(0,Z.Go)("SET",m()(m()({},R),{},{type:!1})),le();case 10:case"end":return L.stop()}},o)}));return function(){return l.apply(this,arguments)}}(),de=function(o){H.map(function(R){R.name==o.name&&ae(R)})},le=function(o){o?x.history.push("/".concat(i.path,"?app_id=").concat(o,"&&type=false")):x.history.push("/".concat(i.path,"?type=false"))},ue=function(){return(0,e.jsxs)("div",{className:"flex justify-between",children:[(0,e.jsxs)("div",{className:"flex items-center",children:[i.apps_mode==1&&(0,e.jsx)(C.ZP,{disabled:!j,className:j?"":"cursor-not-allowed opacity-50",onClick:function(){j&&(_(!0),O(!1))},children:t.formatMessage({id:"agent.creation.button.ai"})}),i.apps_mode==4&&(0,e.jsx)(C.ZP,{disabled:!z,className:z?"":"cursor-not-allowed opacity-50",onClick:function(){z&&(P(!0),O(!1))},children:t.formatMessage({id:"agent.creation.button.skill.ai"})})]}),(0,e.jsxs)("div",{className:"flex gap-2",children:[(0,e.jsx)(C.ZP,{onClick:function(){return O(!1)},children:t.formatMessage({id:"agent.modal.button.cancel"})}),(0,e.jsx)(C.ZP,{disabled:F==="",onClick:ie,type:"primary",children:t.formatMessage({id:"creation"})})]})]})};return(0,e.jsx)(b.Z,{title:t.formatMessage({id:"creation.addnewapp"}),open:D,okText:t.formatMessage({id:"creation"}),onOk:ie,onCancel:function(){return O(!1)},okButtonProps:{disabled:F===""},width:820,footer:(0,e.jsx)(ue,{}),children:(0,e.jsxs)("div",{className:"pb-1",children:[k?(0,e.jsxs)("div",{children:[(0,e.jsx)("div",{className:"font-medium text-xs mb-4 mt-8",children:t.formatMessage({id:"creation.appntype"})}),(0,e.jsx)("div",{className:"flex items-center justify-around gap-y-[24px]",children:H&&H.map(function(l){var o=l.apps_mode===1&&!j||l.apps_mode===2&&!q||l.apps_mode===3&&!B||l.apps_mode===4&&!z;return(0,e.jsxs)("div",{className:"w-44 h-24 rounded-lg text-center bg-[url('/images/bg.png')] bg-[length:176px_96px] ".concat(o?"cursor-not-allowed opacity-50":"cursor-pointer"),style:{border:l.apps_mode===i.apps_mode?"1px solid #1B64F3":"1px solid #eeeeee"},onClick:function(){o||de(l)},children:[(0,e.jsx)("div",{className:"flex items-center justify-center mt-5 mb-2.5",children:(0,e.jsx)("img",{className:"w-6 h-6 ".concat(o?"grayscale":""),src:l.signicon,alt:""})}),(0,e.jsx)("div",{className:"text-base font-normal ".concat(o?"text-gray-400":"text-p[#213044]"),children:l.name})]})})})]}):null,(0,e.jsxs)("div",{className:" mt-5",children:[(0,e.jsxs)("div",{className:"mb-5",children:[(0,e.jsxs)("p",{className:"text-xs",children:[i.apps_mode==1?t.formatMessage({id:"creation.agent"}):i.apps_mode==2?t.formatMessage({id:"creation.workflow"}):i.apps_mode==3?t.formatMessage({id:"creation.repository"}):t.formatMessage({id:"creation.skill"}),t.formatMessage({id:"creation.appiconname"})]}),(0,e.jsxs)("div",{className:"flex items-center justify-around",children:[(0,e.jsx)(f.Z,{CardData:$,setCardData:ne}),(0,e.jsx)(w.Z,{showCount:!0,maxLength:50,placeholder:t.formatMessage({id:"creation.placeholder.appname"}),onChange:I})]})]}),(0,e.jsxs)("div",{className:"mb-5 text-xs",children:[(0,e.jsxs)("p",{children:[i.apps_mode==1?t.formatMessage({id:"creation.agent"}):i.apps_mode==2?t.formatMessage({id:"creation.workflow"}):i.apps_mode==3?t.formatMessage({id:"creation.repository"}):t.formatMessage({id:"creation.skill"}),t.formatMessage({id:"creation.appdescribe"})]}),(0,e.jsx)(U,{showCount:!0,maxLength:1e3,rows:4,placeholder:t.formatMessage({id:"creation.placeholder.appdescribe"}),onChange:V})]})]})]})})};W.Z=s},94840:function(oe,W,a){var N=a(15009),u=a.n(N),K=a(97857),m=a.n(K),p=a(99289),S=a.n(p),G=a(5574),E=a.n(G),y=a(32332),v=a(45360),Z=a(78367),x=a(55241),w=a(85576),C=a(88484),b=a(67294),A=a(83065),f=a(35312),d=a(42016),r=a(99579),e=a(85893),U=function(ee){var c=ee.CardData,O=ee.setCardData,D=(0,f.useIntl)(),H=(0,b.useState)(!1),i=E()(H,2),ae=i[0],k=i[1],t=(0,b.useState)(""),J=E()(t,2),Q=J[0],F=J[1],se=(0,b.useState)(null),X=E()(se,2),g=X[0],re=X[1],n=200;(0,b.useEffect)(function(){},[]);var te=function(_){var P=_.type.startsWith("image/"),T=_.size/1024/1024<2;if(!P)return v.ZP.error(D.formatMessage({id:"workflow.uploadFileErrorType"})),!1;if(!T)return v.ZP.error(D.formatMessage({id:"workflow.uploadFileErrorText"})),!1;var h=new FileReader;return h.readAsDataURL(_),h.onload=function(){F(h.result),k(!0)},!1},Y=function(){if(g){var _=g.getCroppedCanvas({width:n,height:n,minWidth:n,minHeight:n,maxWidth:n,maxHeight:n,imageSmoothingEnabled:!0,imageSmoothingQuality:"high"});_.toBlob(function(){var P=S()(u()().mark(function T(h){var j,q;return u()().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:return j=new FormData,j.append("file",h,"avatar.png"),B.next=4,(0,A.M$)();case 4:q=B.sent,fetch(q,{method:"POST",headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))},body:j}).then(function(I){return I.json()}).then(function(I){var V;I.code===0&&(V=I.data)!==null&&V!==void 0&&V.path?(O(m()(m()({},c),{},{avatar:I.data.path,avatar_show:I.data.path_show})),v.ZP.success(D.formatMessage({id:"workflow.uploadSuccess"}))):v.ZP.error(D.formatMessage({id:"workflow.uploadError"}))}).catch(function(){v.ZP.error(D.formatMessage({id:"workflow.uploadError"}))});case 6:case"end":return B.stop()}},T)}));return function(T){return P.apply(this,arguments)}}(),"image/png",1),k(!1)}},$=function(){return(0,e.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,e.jsx)("div",{className:"flex justify-start items-center flex-wrap w-40",children:(0,y.s9)("all").map(function(_){return(0,e.jsx)("div",{className:"w-8 h-8 bg-[#F4F8F1] rounded-lg mr-1.5 flex items-center justify-center m-0.5 cursor-pointer",onClick:function(){ne(_)},children:(0,e.jsx)("img",{src:_.image,alt:""})},_.id)})}),(0,e.jsx)(Z.Z,{name:"file",accept:".jpg,.png,.jpeg",showUploadList:!1,beforeUpload:te,children:(0,e.jsxs)("div",{className:"w-full flex items-center justify-center p-2 cursor-pointer hover:bg-gray-100 rounded",children:[(0,e.jsx)(C.Z,{className:"mr-2"}),D.formatMessage({id:"workflow.uploadAvatar"})]})})]})},ne=function(_){O(m()(m()({},c),{},{icon:_.image,id:_.id,avatar:null,avatar_show:null}))};return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(x.Z,{content:$,trigger:"click",placement:"bottomLeft",children:(0,e.jsx)("div",{className:"w-8 h-8 bg-[#F4F8F1] rounded-lg mr-1.5 flex items-center justify-center m-0.5 cursor-pointer",children:(0,e.jsx)("img",{src:c.avatar_show||c.avatar||(0,y.s9)("single",c.id?c.id:c.icon),alt:"",className:"rounded"})})}),(0,e.jsx)(w.Z,{title:D.formatMessage({id:"workflow.cropAvatar"}),open:ae,onOk:Y,onCancel:function(){return k(!1)},width:800,children:(0,e.jsx)("div",{className:"w-full h-[400px]",children:(0,e.jsx)(d.Z,{src:Q,style:{height:"100%",width:"100%"},aspectRatio:1,guides:!0,cropBoxResizable:!0,cropBoxMovable:!0,viewMode:2,dragMode:"move",autoCropArea:1,background:!1,responsive:!0,restore:!1,checkCrossOrigin:!1,checkOrientation:!1,modal:!0,highlight:!0,center:!0,zoomOnWheel:!0,wheelZoomRatio:.1,minContainerWidth:n,minContainerHeight:n,minCanvasWidth:n,minCanvasHeight:n,minCropBoxWidth:n,minCropBoxHeight:n,onInitialized:function(_){re(_),_.setCropBoxData({width:n,height:n})},ready:function(){if(g){var _=g.getImageData(),P=Math.min(_.width,_.height);if(P<n){var T=n/P*1.1;g.scale(T)}g.setData({width:n,height:n})}}})})})]})};W.Z=U}}]);
