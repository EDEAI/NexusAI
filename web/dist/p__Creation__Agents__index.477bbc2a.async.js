"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[5178],{83510:function(Et,Oe,i){i.d(Oe,{LK:function(){return v},bs:function(){return W},go:function(){return t},uy:function(){return P}});var ve=i(15009),U=i.n(ve),He=i(99289),_=i.n(He),re=i(47520),O="/v1/apps/apps_list",Ie="/v1/agent/agent_delete/",a="/v1/workflow/workflow_app_delete/",Ke="/v1/vector/delete_dataset/",l="/v1/skill/delete_skill_by_app_id/",x="/v1/apps/apps_create",o="/v1/apps/app_update/",t=function(){var te=_()(U()().mark(function Y(D){var z;return U()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,(0,re.ZP)("".concat(O),{method:"GET",data:D});case 2:return z=p.sent,p.abrupt("return",z);case 4:case"end":return p.stop()}},Y)}));return function(D){return te.apply(this,arguments)}}(),v=function(){var te=_()(U()().mark(function Y(D){var z;return U()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return console.log(D),p.next=3,D.mode;case 3:if(p.t0=p.sent,p.t0!=1){p.next=8;break}p.t1=(0,re.ZP)("".concat(Ie).concat(D.app_id),{method:"DELETE"}),p.next=9;break;case 8:p.t1=D.mode==2?(0,re.ZP)("".concat(a).concat(D.app_id),{method:"DELETE"}):D.mode==3?(0,re.ZP)("".concat(Ke).concat(D.app_id),{method:"DELETE"}):(0,re.ZP)("".concat(l).concat(D.app_id),{method:"DELETE",data:{is_soft:1}});case 9:return z=p.t1,p.abrupt("return",z);case 11:case"end":return p.stop()}},Y)}));return function(D){return te.apply(this,arguments)}}(),P=function(){var te=_()(U()().mark(function Y(D){var z;return U()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,(0,re.ZP)("".concat(x),{method:"POST",data:D});case 2:return z=p.sent,p.abrupt("return",z);case 4:case"end":return p.stop()}},Y)}));return function(D){return te.apply(this,arguments)}}(),W=function(){var te=_()(U()().mark(function Y(D){var z;return U()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,(0,re.ZP)("".concat(o).concat(D.app_id),{method:"PUT",data:D});case 2:return z=p.sent,p.abrupt("return",z);case 4:case"end":return p.stop()}},Y)}));return function(D){return te.apply(this,arguments)}}()},6180:function(Et,Oe,i){i.r(Oe),i.d(Oe,{default:function(){return ja}});var ve=i(19632),U=i.n(ve),He=i(15009),_=i.n(He),re=i(99289),O=i.n(re),Ie=i(97857),a=i.n(Ie),Ke=i(5574),l=i.n(Ke),x=i(11551),o=i(83510),t=i(47520),v=i(29432),P=i(10759),W=i(32332),te=i(2068),Y=i(89035),D=i(15360),z=i(82826),Ze=i(69243),p=i(76772),S=i(40741),B=i(45360),xe=i(28036),Jt=i(33456),mt=i(25409),Ct=i(74330),Qt=i(96486),qt=i.n(Qt),b=i(67294),be=i(92939),Dt=i(80459),Tt=i(85750),ea=i(5608),ta=i(58299),Xe=i(51042),gt=i(82061),De=i(26915),st=i(72269),ht=i(34041),nt=i(66309),ae=i(78045),At=i(44010),e=i(85893),aa=De.Z.TextArea,sa=function(f){var pe,V,G,M,fe,Je=f.loading,ye=f.FirstValue,s=f.Detaillist,I=f.setDetaillist,Te=f.repository,k=f.setRepository,E=f.Operationbentate,Pe=f.Ffromref,me=f.setFourthly_config_id,Ae=f.Fourthly_config_id,je=f.Fourthly_select_list,we=f.Newproperties,ke=f.setNewproperties,_e=f.pageKeyfun,j=f.firstjudgingcondition,ge=f.setAgentmunudisabled,Ee=f.agentmenudisabled,d=(0,p.useIntl)(),Be=(0,b.useState)([]),se=l()(Be,2),C=se[0],ne=se[1],H=(0,b.useState)(!1),X=l()(H,2),Se=X[0],Ve=X[1],oe=(0,b.useState)([]),he=l()(oe,2),Ne=he[0],Fe=he[1],it=(0,b.useState)([]),$=l()(it,2),N=$[0],Z=$[1],J=(0,b.useState)(!1),K=l()(J,2),L=K[0],Q=K[1],lt=(0,b.useState)(!1),rt=l()(lt,2),xt=rt[0],Le=rt[1],$e=(0,b.useState)({agent_id:0,data:{is_public:1,enable_api:0,obligations:null,input_variables:{},dataset_ids:[],attrs_are_visible:1}}),Re=l()($e,2),ie=Re[0],Ce=Re[1];(0,b.useEffect)(function(){var r,n;if(jt(),s!=null&&(r=s.agent)!==null&&r!==void 0&&r.selected_skills&&Fe(s.agent.selected_skills),s!=null&&(n=s.agent)!==null&&n!==void 0&&n.selected_workflows){var w;Z(s==null||(w=s.agent)===null||w===void 0?void 0:w.selected_workflows)}},[s,s==null?void 0:s.agent]);var Ot=function(n){me(n)},It=function(n){Ce(a()(a()({},ie),{},{data:a()(a()({},ie.data),{},{obligations:n.target.value})})),I(a()(a()({},s),{},{agent:a()(a()({},s.agent),{},{obligations:n.target.value})}))},Bt=function(n,w){var T=new Set;return n.some(function(q){var de=q[w];return T.has(de)?T.add(de):T.add(de)&&!1})},ot=function(n){I(a()(a()({},s),{},{app:a()(a()({},s.app),{},{is_public:n?1:0})})),Ce(a()(a()({},ie),{},{data:a()(a()({},ie.data),{},{is_public:n?1:0})}))},ut=function(n){I(a()(a()({},s),{},{app:a()(a()({},s.app),{},{enable_api:n?1:0})})),Ce(a()(a()({},ie),{},{data:a()(a()({},ie.data),{},{enable_api:n?1:0})}))},bt=function(n){I(a()(a()({},s),{},{app:a()(a()({},s.app),{},{attrs_are_visible:n?1:0})})),Ce(a()(a()({},ie),{},{data:a()(a()({},ie.data),{},{attrs_are_visible:n?1:0})}))},Vt=function(n){I(a()(a()({},s),{},{agent:a()(a()({},s.agent),{},{allow_upload_file:n?1:0})}))},yt=function(n){I(a()(a()({},s),{},{agent:a()(a()({},s.agent),{},{mcp:n?1:0})}))},Me=function(n){Ce(a()(a()({},ie),{},{data:a()(a()({},ie.data),{},{dataset_ids:n})})),k(n)},jt=function(){var r=O()(_()().mark(function n(){var w;return _()().wrap(function(q){for(;;)switch(q.prev=q.next){case 0:return q.next=2,(0,x.zl)();case 2:w=q.sent,ne(w.data.data.map(function(de){return{value:de.dataset_id,label:de.name}}));case 4:case"end":return q.stop()}},n)}));return function(){return r.apply(this,arguments)}}(),$t=function(n){Fe(n),I(a()(a()({},s),{},{agent:a()(a()({},s.agent),{},{selected_skills:n})}))},wt=function(n){Z(n),I(a()(a()({},s),{},{agent:a()(a()({},s.agent),{},{selected_workflows:n})}))},ue=function(){var r=O()(_()().mark(function n(){return _()().wrap(function(T){for(;;)switch(T.prev=T.next){case 0:j()||(_e("2"),ge(a()(a()({},Ee),{},{first:!1,second:!1})));case 1:case"end":return T.stop()}},n)}));return function(){return r.apply(this,arguments)}}(),We=function(n){I(a()(a()({},s),{},{agent:a()(a()({},s.agent),{},{default_output_format:n.target.value})}))},_t=function(n){I(a()(a()({},s),{},{agent:a()(a()({},s==null?void 0:s.agent),{},{input_variables:n.free})}))},Qe=(0,ta.m)(),qe=Qe.options,St=Qe.defaultValue,Nt=function(n){Fe(n.checkItem),I(a()(a()({},s),{},{agent:a()(a()({},s.agent),{},{selected_skills:n.checkItem})})),Q(!1)},dt=function(n){Z(n.checkItem),I(a()(a()({},s),{},{agent:a()(a()({},s.agent),{},{selected_workflows:n.checkItem})})),Le(!1)},Ft=function(){Q(!1)},Mt=function(){Le(!1)},Zt=function(n){var w=Ne.filter(function(T){return T.app_id!==n.app_id});Fe(w),I(a()(a()({},s),{},{agent:a()(a()({},s.agent),{},{selected_skills:w})}))},ct=function(n){var w=N.filter(function(T){return T.app_id!==n.app_id});Z(w),I(a()(a()({},s),{},{agent:a()(a()({},s.agent),{},{selected_workflows:w})}))};return(0,e.jsxs)("div",{style:{height:"100%",width:"100%",marginBottom:"30px"},children:[(0,e.jsx)("div",{className:"flex align-center justify-between mt-[30px]",children:(0,e.jsx)("div",{className:"text-base font-medium mb-[30px] text-[#333333]",children:d.formatMessage({id:"agent.menu.basicsetup"})})}),(0,e.jsx)("div",{className:"w-full",children:(0,e.jsxs)(S.Z,{name:"dynamic_form_nest_item",style:{width:"100%"},autoComplete:"off",form:Pe,children:[(0,e.jsx)(S.Z.Item,{className:"mb-[30px]",children:(0,e.jsxs)("div",{className:"text-[#555555] text-xs",children:[(0,e.jsx)("div",{className:"font-medium  mb-[15px]",children:d.formatMessage({id:"agent.appname"})}),(0,e.jsxs)("div",{className:"w-full p-[15px] flex font-normal items-center bg-[#F7F7F7] rounded-lg",children:[(0,e.jsxs)("div",{children:[s&&s.app&&s.app.name,"\xA0"]}),(0,e.jsx)("div",{className:"",children:E==="true"?d.formatMessage({id:"agent.cannotmodify"}):""})]})]})}),(0,e.jsx)(S.Z.Item,{className:"mb-[30px]",children:(0,e.jsxs)("div",{className:"text-[#555555] text-xs",children:[(0,e.jsx)("div",{className:"font-medium  mb-[15px]",children:d.formatMessage({id:"agent.appdescription"})}),(0,e.jsx)("div",{className:"w-full p-[15px] flex font-normal items-center bg-[#F7F7F7] rounded-lg",children:s&&s.app&&s.app.description})]})}),(0,e.jsx)(S.Z.Item,{className:"mb-[30px]",children:(0,e.jsxs)("div",{children:[(0,e.jsxs)("div",{className:"mb-[30px]",children:[(0,e.jsx)("div",{className:"mb-[15px] text-[#555555] text-xs",children:(0,e.jsx)(be.Z,{className:"font-medium",name:d.formatMessage({id:"agent.teamvisibility"}),title:d.formatMessage({id:"agent.explain.teamvisibility"})})}),(0,e.jsx)(st.Z,{size:"small",onChange:ot,checked:!!(s&&((pe=s.app)===null||pe===void 0?void 0:pe.is_public)===1)})]}),(0,e.jsxs)("div",{className:"mb-[30px]  font-medium",children:[(0,e.jsx)("div",{className:"mb-[15px] text-[#555555] text-xs",children:(0,e.jsx)(be.Z,{className:"font-medium",name:d.formatMessage({id:"agent.attrVisible"}),title:d.formatMessage({id:"agent.explain.attrVisible"})})}),(0,e.jsx)(st.Z,{size:"small",onChange:bt,checked:s&&((V=s.app)===null||V===void 0?void 0:V.attrs_are_visible)===1})]}),(0,e.jsxs)("div",{className:"mb-[30px]  font-medium",children:[(0,e.jsx)("div",{className:"mb-[15px] text-[#555555] text-xs",children:d.formatMessage({id:"agent.APIswitch"})}),(0,e.jsx)(st.Z,{size:"small",onChange:ut,checked:s&&((G=s.app)===null||G===void 0?void 0:G.enable_api)===1,disabled:(s==null||(M=s.app)===null||M===void 0?void 0:M.publish_status)!==1})]})]})}),(0,e.jsx)(S.Z.Item,{className:"mb-[30px]",children:(0,e.jsxs)("div",{children:[(0,e.jsxs)("div",{className:"mb-[15px] text-[#555555] text-xs font-medium",children:[(0,e.jsx)("span",{className:"text-[#E80000]",children:"* "}),d.formatMessage({id:"agent.LLMmodel"})]}),(0,e.jsx)(ht.Z,{placeholder:d.formatMessage({id:"agent.pleaseselect"}),value:Ae==0?d.formatMessage({id:"agent.pleaseselect"}):Ae,variant:"filled",onChange:Ot,options:qe,optionRender:function(n){var w,T;return(0,e.jsxs)("div",{children:[n.label," ",(n==null||(w=n.data)===null||w===void 0?void 0:w.support_image)==1&&(0,e.jsx)(nt.Z,{color:"blue",className:"text-xs",children:d.formatMessage({id:"workflow.tag.imageUnderstanding",defaultMessage:"Image Understanding"})}),(n==null||(T=n.data)===null||T===void 0?void 0:T.model_mode)==2&&(0,e.jsx)(nt.Z,{color:"default",className:"text-xs",children:d.formatMessage({id:"workflow.tag.localModel",defaultMessage:"Local Model"})})]})},labelRender:function(n){var w,T;return(0,e.jsxs)("div",{children:[n==null?void 0:n.label," ",((w=(0,Tt.ti)(n==null?void 0:n.value,{options:qe}))===null||w===void 0?void 0:w.support_image)==1&&(0,e.jsx)(nt.Z,{color:"blue",className:"text-xs",children:d.formatMessage({id:"workflow.tag.imageUnderstanding",defaultMessage:"Image Understanding"})}),((T=(0,Tt.ti)(n==null?void 0:n.value,{options:qe}))===null||T===void 0?void 0:T.model_mode)==2&&(0,e.jsx)(nt.Z,{color:"default",className:"text-xs",children:d.formatMessage({id:"workflow.tag.localModel",defaultMessage:"Local Model"})})]})}})]})}),(0,e.jsx)(S.Z.Item,{className:"mb-[30px]",name:"obligations",children:(0,e.jsxs)("div",{className:"w-full",children:[(0,e.jsx)("div",{className:"mb-[15px] text-[#555555] text-xs",children:(0,e.jsx)(be.Z,{className:"font-medium",required:!0,name:d.formatMessage({id:"agent.functiondescription"}),title:d.formatMessage({id:"agent.explain.function"})})}),(0,e.jsx)(aa,{onChange:It,value:s&&s.agent&&s.agent.obligations,placeholder:"Agent".concat(d.formatMessage({id:"agent.functiondescription"})),autoSize:{minRows:8,maxRows:10}})]})}),!Se&&(0,e.jsx)("div",{className:"mb-[30px]",children:(0,e.jsx)(ea.Z,{title:(0,e.jsx)("div",{className:"text-[#555555] text-xs",children:(0,e.jsx)(be.Z,{className:"font-medium",required:!0,name:d.formatMessage({id:"agent.inputvariable"}),title:d.formatMessage({id:"agent.explain.inputvariable"})})}),variables:Object.values((s==null||(fe=s.agent)===null||fe===void 0||(fe=fe.input_variables)===null||fe===void 0?void 0:fe.properties)||{}),onChange:_t})}),(0,e.jsx)(S.Z.List,{name:"users",children:function(n,w){var T=w.add,q=w.remove;return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(S.Z.Item,{className:"mb-[30px]",children:[(0,e.jsx)("div",{className:"text-[#555555] text-xs mb-[15px]",children:(0,e.jsx)(be.Z,{className:"font-medium",name:d.formatMessage({id:"agent.associatedknowledgebase"}),title:d.formatMessage({id:"agent.explain.associatedknowledgebase"})})}),(0,e.jsx)(ht.Z,{size:"large",mode:"multiple",showSearch:!0,style:{width:"100%",fontSize:"12px"},placeholder:d.formatMessage({id:"agent.pleaseselect"}),filterOption:function(et,Ue){var Ye;return((Ye=Ue==null?void 0:Ue.label)!==null&&Ye!==void 0?Ye:"").toLowerCase().includes(et.toLowerCase())},value:Te,onChange:Me,options:C})]}),(0,e.jsx)(S.Z.Item,{className:"mb-[30px]",children:(0,e.jsxs)("div",{className:"",children:[(0,e.jsxs)("div",{className:"text-[#555555] text-xs mb-[15px]",children:[" ",d.formatMessage({id:"agent.defaultoutputformat"})]}),(0,e.jsxs)(ae.ZP.Group,{value:s&&s.agent.default_output_format,onChange:function(et){We(et)},children:[(0,e.jsx)(ae.ZP,{value:1,children:(0,e.jsx)("div",{className:"text-[#555555] text-xs font-normal",children:"text"})}),(0,e.jsx)(ae.ZP,{value:2,children:(0,e.jsx)("div",{className:"text-[#555555] text-xs font-normal",children:"json"})}),(0,e.jsx)(ae.ZP,{value:3,children:(0,e.jsx)("div",{className:"text-[#555555] text-xs font-normal",children:"code"})})]})]})})]})}}),(0,e.jsxs)(S.Z.Item,{className:"mb-[30px]",children:[(0,e.jsx)("div",{className:"text-[#555555] text-base mb-[15px]",children:d.formatMessage({id:"agent.mcp.resources"})}),(0,e.jsxs)("div",{className:"pl-4 ",children:[(0,e.jsxs)("div",{className:"mb-[30px]",children:[(0,e.jsxs)("div",{className:"flex items-center justify-between mb-[15px]",children:[(0,e.jsx)("div",{className:"text-[#555555] text-xs",children:(0,e.jsx)(be.Z,{className:"font-medium",name:d.formatMessage({id:"agent.selectSkills"}),title:d.formatMessage({id:"agent.explain.selectSkills"})})}),(0,e.jsx)(xe.ZP,{type:"link",icon:(0,e.jsx)(Xe.Z,{}),onClick:function(){return Q(!0)},className:"text-xs",children:d.formatMessage({id:"agent.addSkill"})})]}),Ne.length>0?(0,e.jsx)("div",{className:"flex flex-col gap-4 mb-4",children:Ne.map(function(r){return(0,e.jsxs)("div",{className:"group relative flex items-center cursor-pointer w-full p-2 bg-white rounded-lg shadow-sm transition-shadow",children:[(0,e.jsx)(Dt.Z,{rounded:"6px",data:r,bg:r.icon_background}),(0,e.jsxs)("div",{className:"flex flex-col ml-2 truncate",children:[(0,e.jsx)("span",{className:"text-sm font-medium text-[#333333]",children:r.name}),(0,e.jsx)("span",{className:"text-xs text-[#666666] truncate",children:r.description})]}),(0,e.jsx)("div",{className:"absolute right-2 top-1/2 -translate-y-1/2 opacity-0 group-hover:opacity-100 transition-opacity cursor-pointer hover:text-red-500",onClick:function(w){w.stopPropagation(),Zt(r)},children:(0,e.jsx)(gt.Z,{})})]},r.app_id)})}):(0,e.jsx)("div",{onClick:function(){return Q(!0)},className:"w-full h-[120px] flex items-center justify-center border border-dashed border-[#e8e8e8] rounded-lg bg-[#fafafa] cursor-pointer hover:border-[#1b64f3] transition-colors",children:(0,e.jsxs)("div",{className:"flex flex-col items-center gap-2",children:[(0,e.jsx)(Xe.Z,{className:"text-[#999999] text-lg"}),(0,e.jsx)("span",{className:"text-[#999999] text-sm",children:d.formatMessage({id:"agent.addSkill"})})]})}),(0,e.jsx)(At.Z,{show:L,popupClose:Ft,popupSave:Nt,checkList:Ne,radio:!1,nodetype:"skill",zIndex:30})]}),(0,e.jsxs)("div",{className:"mb-[30px]",children:[(0,e.jsxs)("div",{className:"flex items-center justify-between mb-[15px]",children:[(0,e.jsx)("div",{className:"text-[#555555] text-xs",children:(0,e.jsx)(be.Z,{className:"font-medium",name:d.formatMessage({id:"agent.selectWorkflows"}),title:d.formatMessage({id:"agent.explain.selectWorkflows"})})}),(0,e.jsx)(xe.ZP,{type:"link",icon:(0,e.jsx)(Xe.Z,{}),onClick:function(){return Le(!0)},className:"text-xs",children:d.formatMessage({id:"agent.addWorkflow"})})]}),N.length>0?(0,e.jsx)("div",{className:"flex flex-col gap-4 mb-4",children:N.map(function(r){return(0,e.jsxs)("div",{className:"group relative flex items-center cursor-pointer w-full p-2 bg-white rounded-lg shadow-sm transition-shadow",children:[(0,e.jsx)(Dt.Z,{rounded:"6px",data:r,bg:r.icon_background}),(0,e.jsxs)("div",{className:"flex flex-col ml-2 truncate",children:[(0,e.jsx)("span",{className:"text-sm font-medium text-[#333333]",children:r.name}),(0,e.jsx)("span",{className:"text-xs text-[#666666] truncate",children:r.description})]}),(0,e.jsx)("div",{className:"absolute right-2 top-1/2 -translate-y-1/2 opacity-0 group-hover:opacity-100 transition-opacity cursor-pointer hover:text-red-500",onClick:function(w){w.stopPropagation(),ct(r)},children:(0,e.jsx)(gt.Z,{})})]},r.app_id)})}):(0,e.jsx)("div",{onClick:function(){return Le(!0)},className:"w-full h-[120px] flex items-center justify-center border border-dashed border-[#e8e8e8] rounded-lg bg-[#fafafa] cursor-pointer hover:border-[#1b64f3] transition-colors",children:(0,e.jsxs)("div",{className:"flex flex-col items-center gap-2",children:[(0,e.jsx)(Xe.Z,{className:"text-[#999999] text-lg"}),(0,e.jsx)("span",{className:"text-[#999999] text-sm",children:d.formatMessage({id:"agent.addWorkflow"})})]})}),(0,e.jsx)(At.Z,{show:xt,popupClose:Mt,popupSave:dt,checkList:N,radio:!1,nodetype:"workflow",zIndex:30})]})]})]}),(0,e.jsxs)("div",{children:[(0,e.jsx)(xe.ZP,{type:"primary",className:"mr-[20px]",onClick:function(){ue()},children:d.formatMessage({id:"agent.btn.nextstep"})}),(0,e.jsx)(xe.ZP,{onClick:function(){history.back()},children:d.formatMessage({id:"agent.btn.back"})})]}),(0,e.jsx)("div",{className:"h-[30px] w-1"})]})})]})},na=sa,ia=i(13769),Lt=i.n(ia),la=i(49677),ra=i.n(la),oa=i(620),ua=i(85877),Rt=i(39944),da=i(71471),ca=["key","name"],Ea=da.Z.Title,Ca=De.Z.TextArea,Da=De.Z.Search,pa=function(f){var pe=f.handleBack,V=f.Detaillist,G=f.setDetaillist,M=f.Fourthly_select_list,fe=f.setFourthly_config_id,Je=f.Fourthly_config_id,ye=f.Fourthlyref,s=f.Fourthly_abilities_list,I=f.Operationbentate,Te=f.callwordlist,k=f.newagentid,E=(0,p.useIntl)(),Pe=(0,b.useState)(0),me=l()(Pe,2),Ae=me[0],je=me[1],we=(0,b.useState)(""),ke=l()(we,2),_e=ke[0],j=ke[1],ge=(0,b.useState)(""),Ee=l()(ge,2),d=Ee[0],Be=Ee[1],se=(0,b.useState)(!1),C=l()(se,2),ne=C[0],H=C[1],X=function(N){var Z={user:{value:he(N)}};j(new Rt.z(Z))},Se=function(N){var Z={user:{value:N.target.value}};j(new Rt.z(Z))},Ve=function(N){je(N)},oe=function(N){var Z=N.users.filter(function(L,Q){return L.type=="number"&&!Number(L.value)&&!!L.value});if(!_e.user)B.ZP.warning(E.formatMessage({id:"agent.message.warning.callword"}));else if(Z.length>0)B.ZP.warning(E.formatMessage({id:"agent.message.warning.datatype"}));else{H(!0);var J=new P.Kr("input","","");N.users.forEach(function(L){var Q=new P._w(L.name,L.type?L.type:"string",L.type=="string"?L.value:Number(L.value),L.content,L.status);J.addProperty(L.name,Q)});var K={agent_id:k||V.agent.agent_id,ability_id:Ae,input_dict:J,prompt:_e};Ne(K)}},he=function $(N){return N.map(function(Z){return Z.type==="mention"?Z.id:Z.children?$(Z.children):Z.text}).join("")},Ne=function(N){(0,x.LH)(N).then(function(Z){B.ZP.success(E.formatMessage({id:"agent.message.success.runpublish"})),Be(Z.data.outputs.text),H(!1)}).catch(function(Z){H(!1)})},Fe=function(){var $=O()(_()().mark(function N(){var Z;return _()().wrap(function(K){for(;;)switch(K.prev=K.next){case 0:return K.next=2,(0,x.Dh)(k||V.agent.agent_id);case 2:Z=K.sent,Z.code==0?B.ZP.success(E.formatMessage({id:"agent.message.success.publish"})):B.ZP.error(E.formatMessage({id:"agent.message.fail.publish"}));case 4:case"end":return K.stop()}},N)}));return function(){return $.apply(this,arguments)}}(),it=function(){var $=O()(_()().mark(function N(){return _()().wrap(function(J){for(;;)switch(J.prev=J.next){case 0:p.history.push("/Agents?app_id=".concat(V.app.app_id,"&type=false")),location.reload();case 2:case"end":return J.stop()}},N)}));return function(){return $.apply(this,arguments)}}();return(0,b.useEffect)(function(){},[]),(0,e.jsxs)("div",{style:{height:"100%"},children:[(0,e.jsx)("div",{className:"text-base font-medium text-[#333333] my-[30px]",children:E.formatMessage({id:"agent.operationrun"})}),(0,e.jsxs)("div",{className:"mb-[30px]",children:[(0,e.jsx)("div",{className:"mb-[15px] text-[#555555] text-xs font-medium",children:E.formatMessage({id:"agent.selectivepower"})}),(0,e.jsx)(ht.Z,{placeholder:E.formatMessage({id:"agent.pleaseselect"}),defaultValue:E.formatMessage({id:"agent.allability"}),style:{width:390,fontSize:"12px",color:"#BBBBBB",fontWeight:"400"},onChange:Ve,options:s})]}),(0,e.jsx)("div",{children:(0,e.jsxs)(S.Z,{name:"dynamic_form_nest_item",onFinish:oe,style:{width:"100%"},autoComplete:"off",form:ye,children:[(0,e.jsx)("div",{className:"mb-[15px] text-[#555555] text-xs font-medium",children:E.formatMessage({id:"agent.inputvariable"})}),(0,e.jsx)(S.Z.List,{name:"users",children:function(N,Z){return ra()(Z),(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)("div",{className:"w-full flex justify-start items-center text-xs font-medium px-[10px] text-[#213044] h-12 bg-[#F7F7F7]  rounded-t-lg",children:[(0,e.jsx)("div",{className:"mr-5 ml-2.5",children:E.formatMessage({id:"agent.variable.name"})}),(0,e.jsx)("div",{className:"",children:E.formatMessage({id:"agent.variable.value"})})]}),(0,e.jsx)("div",{className:"mb-[30px]",children:N.map(function(J){var K=J.key,L=J.name,Q=Lt()(J,ca);return(0,e.jsxs)("div",{className:"w-full h-20 flex justify-start  px-2.5 border-b border-x pt-7 last:rounded-b-lg",children:[(0,e.jsx)(S.Z.Item,a()(a()({},Q),{},{name:[L,"content"],children:(0,e.jsx)(De.Z,{className:"mr-5",style:{color:"#213044",fontWeight:"400",fontSize:"12px"},variant:"borderless",disabled:!0})})),(0,e.jsx)(S.Z.Item,a()(a()({},Q),{},{name:[L,"value"],rules:[{required:!!(ye.getFieldsValue()&&ye.getFieldsValue().users[K].status==!0),message:E.formatMessage({id:"agent.rules.veriablevalue"})}],children:(0,e.jsx)(De.Z,{placeholder:ye.getFieldsValue()&&ye.getFieldsValue().users[K].status==!0?E.formatMessage({id:"agent.variable.required.value"}):E.formatMessage({id:"agent.variable.value"})})}))]})})})]})}}),(0,e.jsxs)(S.Z.Item,{rules:[{required:!0,message:E.formatMessage({id:"agent.rules.callwordvalue"})}],children:[(0,e.jsx)("div",{className:"mb-[15px] text-[#555555] text-xs font-medium",children:E.formatMessage({id:"agent.runpreview"})}),(0,e.jsx)(Ct.Z,{spinning:ne,children:(0,e.jsxs)("div",{className:"bg-[#F7F7F7] p-3.5 rounded-lg",children:[(0,e.jsx)("div",{className:"h-[345px] mb-[30px]",children:d?(0,e.jsx)(oa.Z,{language:"python3",value:d&&JSON.stringify(d)}):null}),(0,e.jsxs)("div",{className:"agents-input p-2 bg-white border rounded-md my-2 flex items-center justify-between",style:{border:"1px solid #EEE"},children:[(0,e.jsx)("div",{className:"w-full",children:(0,e.jsx)(ua.Z,{onChange:function(N){X(N)},options:Te})}),(0,e.jsx)("div",{className:"w-8 h-8 bg-[#e8effc] rounded-md",children:(0,e.jsx)(xe.ZP,{className:"bg-[#e8effc]",icon:(0,e.jsx)("img",{src:"/icons/fs.svg"}),type:"link",htmlType:"submit",block:!0})})]})]})})]})]})}),(0,e.jsx)("div",{className:"w-28",children:(V==null?void 0:V.agent.publish_status)===1&&(V==null?void 0:V.is_creator)===1?(0,e.jsx)("div",{children:(0,e.jsx)(xe.ZP,{type:"primary",htmlType:"submit",className:"w-full",onClick:it,children:E.formatMessage({id:"agent.amend"})})}):(0,e.jsx)("div",{children:(0,e.jsx)(xe.ZP,{type:"primary",htmlType:"submit",className:"w-full",disabled:I!="false",onClick:Fe,children:E.formatMessage({id:"agent.publish"})})})}),(0,e.jsx)("div",{className:"h-[30px] w-1"})]})},fa=pa,ma=["key","name"],ga=De.Z.TextArea,ha=function(f){var pe=f.SecondValue,V=f.handleBack,G=f.Detaillist,M=f.setDetaillist,fe=f.Sformref,Je=f.Operationbentate,ye=f.pageKeyfun,s=f.secondjudgingcondition,I=f.SkillMenuClick,Te=f.agentupdata,k=(0,p.useIntl)(),E=B.ZP.useMessage(),Pe=l()(E,2),me=Pe[0],Ae=Pe[1],je=(0,b.useRef)(null),we=(0,b.useState)({auto_match_ability:0,agent_abilities:[{agent_ability_id:0,name:"string",content:"string",status:0}]}),ke=l()(we,2),_e=ke[0],j=ke[1];(0,b.useEffect)(function(){});var ge=function(C){if(C.users.length==1&&(!C.users[0].content&&C.users[0].name||C.users[0].content&&!C.users[0].name))return B.ZP.warning(k.formatMessage({id:"agent.message.warning.selectknowledgebase"}));var ne=C.users.map(function(X){return a()(a()({},X),{},{status:X.status?1:2,agent_ability_id:X.agent_ability_id?X.agent_ability_id:0})}),H={agent_id:G.agent.agent_id,data:{auto_match_ability:G.agent.auto_match_ability,agent_abilities:C.users.length==1&&!C.users[0].content&&!C.users[0].name?[]:ne}};Je=="false"&&Ee(),pe(a()({},_e))},Ee=function(){var se=O()(_()().mark(function C(){return _()().wrap(function(H){for(;;)switch(H.prev=H.next){case 0:s()||Te();case 1:case"end":return H.stop()}},C)}));return function(){return se.apply(this,arguments)}}(),d=function(C){M(a()(a()({},G),{},{agent:a()(a()({},G.agent),{},{auto_match_ability:C?1:0})}))},Be=function(){setTimeout(function(){je.current&&je.current.scrollTo({top:je.current.scrollHeight,behavior:"smooth"})},100)};return(0,e.jsxs)("div",{style:{height:"100%"},className:"w-full flex-1 sticky top-0",children:[(0,e.jsx)("div",{className:"text-base font-medium text-[#333333] my-[30px]",children:k.formatMessage({id:"agent.Applicationcapabilitysetting"})}),(0,e.jsxs)("div",{className:"mb-[30px]",children:[(0,e.jsx)("div",{className:"mb-[15px] text-[#555555] text-xs font-medium",children:(0,e.jsx)(be.Z,{name:k.formatMessage({id:"agent.automatch"}),title:k.formatMessage({id:"agent.explain.automatch"})})}),(0,e.jsx)(st.Z,{size:"small",checked:!!(G&&G.agent.auto_match_ability==1),onChange:d})]}),(0,e.jsx)("div",{className:"w-full",children:(0,e.jsxs)(S.Z,{name:"dynamic_form_nest_item",onFinish:ge,style:{width:"100%"},autoComplete:"off",form:fe,children:[(0,e.jsx)(S.Z.List,{name:"users",children:function(C,ne){var H=ne.add,X=ne.remove;return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)("div",{className:"w-full flex items-center justify-between mb-[11px]",children:[(0,e.jsx)("div",{className:" text-[#555555] text-xs font-medium",children:k.formatMessage({id:"agent.capability"})}),(0,e.jsx)("div",{children:(0,e.jsx)(xe.ZP,{type:"link",onClick:function(){H(),Be()},block:!0,icon:(0,e.jsx)(Xe.Z,{}),children:k.formatMessage({id:"agent.add"})})})]}),(0,e.jsx)("div",{style:{height:"calc(100vh - 206px)",overflowY:"auto"},className:"overflow-y-auto",ref:je,children:C.map(function(Se){var Ve=Se.key,oe=Se.name,he=Lt()(Se,ma);return(0,e.jsxs)("div",{className:"bg-[#F7F7F7] p-[15px] rounded-lg mb-[20px]",children:[(0,e.jsx)(S.Z.Item,{className:"mb-0",children:(0,e.jsxs)("div",{className:"w-full flex justify-between items-center mb-[15px]",children:[(0,e.jsx)("div",{className:"text-[#555555] text-xs font-medium",children:k.formatMessage({id:"agent.capabilityname"})}),(0,e.jsxs)("div",{children:[" ",(0,e.jsx)(gt.Z,{onClick:function(){return X(oe)}})]})]})}),(0,e.jsx)(S.Z.Item,a()(a()({className:"mb-[20px]"},he),{},{name:[oe,"name"],rules:[{required:C.length!==1,message:k.formatMessage({id:"agent.capabilityname"})}],children:(0,e.jsx)(De.Z,{placeholder:k.formatMessage({id:"agent.capabilityname"}),maxLength:50,className:"w-full"})})),(0,e.jsx)("div",{className:"mb-[15px]",children:(0,e.jsx)(be.Z,{className:"text-[#555555] text-xs font-medium",name:k.formatMessage({id:"agent.capabilitydescription"}),title:k.formatMessage({id:"agent.explain.capabilitydescription"})})}),(0,e.jsx)(S.Z.Item,a()(a()({className:"w-full mb-[20px]"},he),{},{name:[oe,"content"],rules:[{required:C.length!==1,message:k.formatMessage({id:"agent.capabilitydescription"})}],children:(0,e.jsx)(ga,{placeholder:k.formatMessage({id:"agent.capabilitydescription"}),autoSize:{minRows:3,maxRows:10},className:"w-full"})})),(0,e.jsx)("div",{className:"text-[#555555] text-xs font-medium mb-[15px]",children:k.formatMessage({id:"agent.capabilitystatus"})}),(0,e.jsx)(S.Z.Item,a()(a()({className:"mb-[20px]"},he),{},{name:[oe,"status"],children:(0,e.jsxs)(ae.ZP.Group,{optionType:"button",buttonStyle:"solid",defaultValue:!0,children:[(0,e.jsx)(ae.ZP,{value:!0,children:k.formatMessage({id:"agent.capabilitystatus.enable"})}),(0,e.jsx)(ae.ZP,{value:!1,children:k.formatMessage({id:"agent.capabilitystatus.disable"})})]})})),(0,e.jsx)("div",{className:"text-[#555555] text-xs font-medium mb-[11px]",children:k.formatMessage({id:"agent.enableall"})}),(0,e.jsx)(S.Z.Item,{className:"mb-0",name:[oe,"output_format"],children:(0,e.jsxs)(ae.ZP.Group,{defaultValue:0,children:[(0,e.jsx)(ae.ZP,{value:0,children:(0,e.jsx)("div",{className:"text-[#555555] text-xs font-normal",children:k.formatMessage({id:"agent.menu"})})}),(0,e.jsx)(ae.ZP,{value:1,children:(0,e.jsx)("div",{className:"text-[#555555] text-xs font-normal",children:"text string"})}),(0,e.jsx)(ae.ZP,{value:2,children:(0,e.jsx)("div",{className:"text-[#555555] text-xs font-normal",children:"format json"})}),(0,e.jsx)(ae.ZP,{value:3,children:(0,e.jsx)("div",{className:"text-[#555555] text-xs font-normal",children:"code"})})]})})]})})})]})}}),(0,e.jsx)("div",{className:"h-[30px] w-1"})]})})]})},va=ha,xa=i(43319),ba=i(27842),ya=function(){var f,pe,V,G,M=(0,p.useIntl)(),fe=(0,b.useRef)(null),Je=S.Z.useForm(),ye=l()(Je,1),s=ye[0],I=S.Z.useForm(),Te=l()(I,1),k=Te[0],E=S.Z.useForm(),Pe=l()(E,1),me=Pe[0],Ae=S.Z.useForm(),je=l()(Ae,1),we=je[0],ke=(0,b.useState)(null),_e=l()(ke,2),j=_e[0],ge=_e[1],Ee=(0,b.useState)(0),d=l()(Ee,2),Be=d[0],se=d[1],C=(0,b.useState)(null),ne=l()(C,2),H=ne[0],X=ne[1],Se=(0,b.useState)(null),Ve=l()(Se,2),oe=Ve[0],he=Ve[1],Ne=(0,b.useState)(null),Fe=l()(Ne,2),it=Fe[0],$=Fe[1],N=(0,b.useState)(null),Z=l()(N,2),J=Z[0],K=Z[1],L=(0,b.useState)(null),Q=l()(L,2),lt=Q[0],rt=Q[1],xt=(0,b.useState)(null),Le=l()(xt,2),$e=Le[0],Re=Le[1],ie=(0,b.useState)(null),Ce=l()(ie,2),Ot=Ce[0],It=Ce[1],Bt=(0,b.useState)(null),ot=l()(Bt,2),ut=ot[0],bt=ot[1],Vt=(0,b.useState)(null),yt=l()(Vt,2),Me=yt[0],jt=yt[1],$t=(0,b.useState)("1"),wt=l()($t,2),ue=wt[0],We=wt[1],_t=(0,b.useState)(null),Qe=l()(_t,2),qe=Qe[0],St=Qe[1],Nt=(0,b.useState)(null),dt=l()(Nt,2),Ft=dt[0],Mt=dt[1],Zt=(0,b.useState)(null),ct=l()(Zt,2),r=ct[0],n=ct[1],w=(0,b.useState)(null),T=l()(w,2),q=T[0],de=T[1],et=(0,b.useState)(!0),Ue=l()(et,2),Ye=Ue[0],tt=Ue[1],wa=(0,b.useState)({first:!1,second:!1,fourthly:!1}),Wt=l()(wa,2),at=Wt[0],pt=Wt[1],_a=[{key:"1",icon:(0,e.jsx)(te.Z,{}),label:M.formatMessage({id:"agent.menu.basicsetup"}),disabled:at.first,style:{padding:"15px",width:"100%",margin:"0px",marginBottom:"10px",fontSize:"16px",fontWeight:"500",lineHeight:"22px",color:ue=="1"?"#1B64F3":"#213044"}},{key:"2",disabled:at.second,icon:(0,e.jsx)(Y.Z,{}),label:M.formatMessage({id:"agent.menu.Capacityoutput"}),style:{padding:"15px",width:"100%",margin:"0px",marginBottom:"10px",fontSize:"16px",lineHeight:"22px",fontWeight:"500",color:ue=="2"?"#1B64F3":"#213044"}},{key:"5",disabled:at.fourthly,icon:(0,e.jsx)(D.Z,{}),label:M.formatMessage({id:"app.dashboard.run_log_agent"}),style:{padding:"15px",width:"100%",margin:"0px",marginBottom:"10px",fontSize:"16px",lineHeight:"22px",fontWeight:"500",color:ue=="5"?"#1B64F3":"#213044"}}];(0,b.useEffect)(function(){var A=new URLSearchParams(window.location.search);A.get("app_id")||(pt(a()(a()({},at),{},{first:!1,second:!0,fourthly:!0})),tt(!1)),Pt()},[]);var Pt=function(){var A=O()(_()().mark(function g(c){var u,y,h,m,R,ee,ze,ce;return _()().wrap(function(le){for(;;)switch(le.prev=le.next){case 0:if(y=new URLSearchParams(window.location.search),y.get("from")&&Mt(y.get("from")),h=null,!(y.get("app_id")||c)){le.next=10;break}return le.next=6,(0,x.ek)(c||y.get("app_id"),y.get("type"));case 6:h=le.sent,de(h.data.app.app_id),le.next=13;break;case 10:return le.next=12,(0,W.cI)();case 12:h=le.sent;case 13:m=h.data,R=(u=h.data)===null||u===void 0||(u=u.agent_dataset_relation_list)===null||u===void 0?void 0:u.map(function(F){return F.dataset_id}),X(R),h.data.callable_items&&(h.data.agent.selected_skills=[],h.data.agent.selected_workflows=[],h.data.callable_items.forEach(function(F){F.item_type==1?h.data.agent.selected_skills.push(a()(a()({},F),{},{mode:4})):h.data.agent.selected_workflows.push(a()(a()({},F),{},{mode:2}))})),ge(h.data),jt(h.data.agent.publish_status===0&&h.data.is_creator===1?"false":"true"),h.data.agent.publish_status===1&&B.ZP.warning(M.formatMessage({id:"agent.message.listwarning"}),5),s.setFieldsValue(Ut(m.agent.input_variables)),ee=h.data.agent_abilities_list.map(function(F){return F.status==1?a()(a()({},F),{},{status:!0}):a()(a()({},F),{},{status:!1})}),me.setFieldsValue({users:ee[0]?ee:[{agent_ability_id:0,name:"",content:"",status:!0,output_format:0}]}),$(kt(m.agent_abilities_list)),K(kt(m.agent_abilities_list)),ze=m.agent_abilities_list.filter(function(F){return F.output_format!==0}),k.setFieldsValue({users:ze.map(function(F){return{agent_ability_id:F.agent_ability_id,output_format:F.output_format}})}),we.setFieldsValue(Ut(m.agent.input_variables)),rt(m.m_configurations_list.map(function(F){return{value:F.m_config_id?F.m_config_id:F.model_config_id,label:F.m_name?F.m_name:F.model_name}})),m.agent.m_config_id||m.agent.model_config_id?Re(m.agent.m_config_id?m.agent.m_config_id:m.agent.model_config_id):Re(m.m_configurations_list[0].model_config_id),ce=m.agent_abilities_list.filter(function(F,Ge){return F.status===1}),bt(kt(ce).concat([{value:0,label:M.formatMessage({id:"agent.allability"})}])),tt(!1);case 33:case"end":return le.stop()}},g)}));return function(c){return A.apply(this,arguments)}}(),Ut=function(g){var c={users:g&&g.properties?Object.values(g.properties).map(function(u){return a()({name:u.name,type:u.type,content:u.display_name,status:u.required},u)}):[{name:"",content:"",type:"string",agent_ability_id:0,output_format:0,status:0}]};return c},kt=function(g){return g.map(function(c){return{value:c.agent_ability_id,label:c.name}})},Sa=function(g){Xt(g,1),we.setFieldsValue(s.getFieldsValue())},Na=function(){Pt()},Yt=function(g){se(g)},Fa=function(){p.history.back()},zt=function(){if(!j.agent.input_variables)return B.ZP.warning(M.formatMessage({id:"agent.message.warning.variable"})),!0;if(qt().isEmpty(j.agent.input_variables.properties))return B.ZP.warning(M.formatMessage({id:"agent.message.warning.variable"})),!0;if($e)if(j.agent.obligations){if(Pa(s.getFieldsValue().users,"name"))return B.ZP.warning(M.formatMessage({id:"agent.message.warning.repetition"})),!0}else return B.ZP.warning(M.formatMessage({id:"agent.message.warning.functiondescribe"})),!0;else return B.ZP.warning(M.formatMessage({id:"agent.message.warning.LLM"})),!0;return!1},Gt=function(){var g=me.getFieldsValue().users.filter(function(u){return!!u}),c=g.filter(function(u){return!u.name||!u.content});return c.length!==0&&!(c.length==1&&c[0].name==""&&c[0].content=="")?(B.ZP.warning(M.formatMessage({id:"agent.message.warning.integritycapacity"})),!0):!1},Ht=function(g){if((g==null?void 0:g.key)=="4"){var c=s.getFieldsValue().users.map(function(u){return{value:"<<".concat(v.qX,".inputs.").concat(u.name,">>"),label:u.name}});St(c)}We(g.key)},Kt=function(){tt(!0);var g=0;return new Promise(function(c){var u=function(h){return(0,x.ek)(h,!1).then(function(){var m=O()(_()().mark(function R(ee){return _()().wrap(function(ce){for(;;)switch(ce.prev=ce.next){case 0:return g=ee.data.agent.agent_id,ce.next=3,Ma(g);case 3:return q||p.history.replace("/Agents?app_id=".concat(h,"&type=false")),Za(g).then(function(ft){B.ZP.success(M.formatMessage({id:"skill.conserve.success"})),setTimeout(function(){if(Pt(h),!q){var le=a()(a()({},(0,W.Go)("GET")),{},{app_id:h});(0,W.Go)("SET",le)}},1e3),n(g)}),ce.abrupt("return",ee);case 6:case"end":return ce.stop()}},R)}));return function(R){return m.apply(this,arguments)}}()).catch(function(){return""})};q?u(q).then(function(y){return c(y)}).catch(function(y){console.error("Error during agent update:",y),c("")}):(0,o.uy)((0,W.Go)("GET")).then(function(y){de(y.data.app_id),u(y.data.app_id).then(function(h){return c(h)}).catch(function(h){console.error("Error during agent creation:",h),c("")})}).catch(function(y){console.error("Error creating app:",y),tt(!1),c("")})})},Ma=function(g,c){return new Promise(function(u,y){s.validateFields().then(function(){var h=O()(_()().mark(function m(R){var ee,ze,ce,ft;return _()().wrap(function(F){for(;;)switch(F.prev=F.next){case 0:if(ze=[].concat(U()(j.agent.selected_skills||[]),U()(j.agent.selected_workflows||[])).map(function(Ge){return{app_id:Ge.app_id,item_type:Ge.mode==4?1:2}}),ce={agent_id:g,data:{is_public:j.app.is_public,enable_api:j.app.enable_api,attrs_are_visible:j.app.attrs_are_visible,obligations:j.agent.obligations,input_variables:j.agent.input_variables?j.agent.input_variables:ka(s.getFieldsValue()),dataset_ids:H,m_config_id:$e,allow_upload_file:j.agent.allow_upload_file,default_output_format:j.agent.default_output_format,callable_list:ze}},Me!="false"){F.next=5;break}return F.next=5,Xt(ce,1);case 5:we.setFieldsValue(s.getFieldsValue()),ft=((ee=s.getFieldsValue())===null||ee===void 0||(ee=ee.users)===null||ee===void 0?void 0:ee.map(function(Ge){return{value:"<<".concat(v.qX,".inputs.").concat(Ge.name,">>"),label:Ge.name}}))||[],St(ft),c&&We(c.key),u();case 10:case"end":return F.stop()}},m)}));return function(m){return h.apply(this,arguments)}}()).catch(function(h){y(h)})})},Za=function(g){return new Promise(function(c,u){var y=me.getFieldsValue().users.filter(function(R){return!!R}),h=y.map(function(R){return a()(a()({},R),{},{status:R.status==!1?2:1,agent_ability_id:R.agent_ability_id?R.agent_ability_id:0,output_format:R.output_format?R.output_format:0})}),m={agent_id:g,data:{auto_match_ability:j.agent.auto_match_ability,agent_abilities:h}};Me=="false"?h.length==1&&h[0].name==""&&h[0].content==""?(pt({first:!1,second:!1,fourthly:!1}),c()):(0,x.Iw)(m).then(function(R){R.code==0?(pt({first:!1,second:!1,fourthly:!1}),c()):u(new Error("API call failed with code: ".concat(R.code)))}).catch(function(R){u(R)}):c()})},Xt=function(){var A=O()(_()().mark(function g(c,u){var y;return _()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:if(Me!=="false"){m.next=19;break}if(u!==1){m.next=7;break}return m.next=4,(0,x.XB)(c);case 4:m.t0=m.sent,m.next=17;break;case 7:if(u!==2){m.next=13;break}return m.next=10,(0,x.Iw)(c);case 10:m.t1=m.sent,m.next=16;break;case 13:return m.next=15,(0,x.Ce)(c);case 15:m.t1=m.sent;case 16:m.t0=m.t1;case 17:y=m.t0,y&&y.code===0&&tt(!1);case 19:return m.abrupt("return",!0);case 20:case"end":return m.stop()}},g)}));return function(c,u){return A.apply(this,arguments)}}(),Pa=function(g,c){var u=new Set;return g.some(function(y){var h=y[c];return u.has(h)?u.add(h):u.add(h)&&!1})},ka=function(g){var c=new P.Kr("input","","");return g.users.forEach(function(u){var y=new P._w(u.name,u.type?u.type:"string",u.value?u.value:"",u.content,u.status);c.addProperty(u.name,y)}),c};return(0,e.jsxs)("div",{className:" flex bg-white",style:{height:"calc(100vh - 56px)"},children:[(0,e.jsxs)("div",{className:"flex flex-col w-[300px]",style:{height:"calc(100vh - 56px)"},children:[(0,e.jsx)("div",{className:"flex w-full items-center bg-white px-[30px] pt-[30px] border-[#e5e7eb] border-solid border-r",children:(0,e.jsxs)(xe.ZP,{type:"link",shape:"circle",size:"middle",className:"",onClick:Fa,children:[(0,e.jsx)(z.Z,{}),(0,e.jsx)("span",{className:"text-sm font-medium text-[#213044]",children:Ft=="chat_room"?M.formatMessage({id:"agent.back_meeting"}):M.formatMessage({id:"agent.back"})})]})}),(0,e.jsxs)("div",{className:"w-full flex-1 px-[30px] py-[30px] bg-white border-[#e5e7eb] border-solid border-r",children:[(0,e.jsx)(Jt.Z,{selectedKeys:[ue],onClick:Ht,style:{width:"100%",borderInlineEnd:"1px solid rgba(0,0,0,0)"},defaultSelectedKeys:[ue],mode:"inline",items:_a}),j&&((f=j.app)===null||f===void 0?void 0:f.enable_api)===1&&((pe=j.app)===null||pe===void 0?void 0:pe.publish_status)===1?(0,e.jsx)("div",{className:"w-full h-[40px] rounded-lg text-[#000] hover:bg-[#f0f0f0] p-[12px] pl-[16px] cursor-pointer",onClick:O()(_()().mark(function A(){var g,c;return _()().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:if(g=new URLSearchParams(window.location.search),c=null,!g.get("app_id")){y.next=6;break}return y.next=5,(0,x.ek)(g.get("app_id"),g.get("type"));case 5:c=y.sent;case 6:c!=null&&c.data.app.enable_api===1&&c.data.app.publish_status===1?window.open(t._n+j.app.api_url):B.ZP.warning(M.formatMessage({id:"agent.save.and.click"}),5);case 7:case"end":return y.stop()}},A)})),children:(0,e.jsxs)("div",{className:"mr-[20px] text-base font-medium text-[#213044] -mt-1",children:[(0,e.jsx)(Ze.Z,{className:"mr-3"}),M.formatMessage({id:"agent.visit"})," API"]})}):null]})]}),(0,e.jsx)("div",{className:"flex-1 relative w-[calc(100%-300px)]",children:(0,e.jsxs)(mt.Z,{style:{height:"100%",boxShadow:"0 0 10px rgba(0, 0, 0, 0.1)"},children:[(0,e.jsx)(mt.Z.Panel,{defaultSize:"50%",min:"40%",max:"70%",children:(0,e.jsx)(Ct.Z,{spinning:Ye,size:"large",className:"mt-[112px] mr-4",children:(0,e.jsx)("div",{className:"flex flex-col",style:{height:"calc(100vh - 56px)",overflowY:"scroll",scrollbarWidth:"none"},children:(0,e.jsxs)("div",{className:"px-[30px] ",style:{overflowX:"auto",height:"100%"},children:[(0,e.jsx)("div",{className:"w-full flex justify-center  mt-[30px]",children:(0,e.jsxs)("div",{className:"flex items-center w-full ",children:[(0,e.jsx)("div",{className:"mr-[10px] w-[16px] h-[16px]",children:(0,e.jsx)("img",{src:"/icons/flag.svg",alt:"",className:"w-[16px] h-[16px]"})}),(0,e.jsxs)("div",{className:"flex items-center",children:[(0,e.jsxs)("div",{className:"mr-[6px] text-lg text-[#213044] font-medium",children:[(V=(0,W.Go)("GET"))!==null&&V!==void 0&&V.app_id?M.formatMessage({id:"agent.compile"}):M.formatMessage({id:"agent.created"})," ",M.formatMessage({id:"agent"})]}),(j==null||(G=j.app)===null||G===void 0?void 0:G.publish_status)===1?(0,e.jsx)("div",{className:"bg-[#1B64F3] px-[7px] text-[#fff] rounded font-normal text-xs flex items-center justify-center h-[18px]",children:M.formatMessage({id:"agent.havepublished"})}):(0,e.jsx)("div",{className:" bg-[#EEE] px-[7px]  text-[#999] rounded font-normal text-xs flex items-center justify-center h-[18px]",children:M.formatMessage({id:"agent.unpublish"})})]})]})}),(0,e.jsx)("div",{style:{display:ue==="1"?"flex":"none",height:"calc(100vh - 146px)",justifyContent:"center"},children:!Ye&&(0,e.jsx)(na,{FirstValue:Sa,Ffromref:s,Detaillist:j,setDetaillist:ge,repository:H,setRepository:X,Newproperties:oe,setNewproperties:he,Operationbentate:Me,Fourthly_config_id:$e,setFourthly_config_id:Re,Fourthly_select_list:lt,pageKeyfun:We,firstjudgingcondition:zt,agentmenudisabled:at,setAgentmunudisabled:pt})}),(0,e.jsx)("div",{style:{display:ue==="2"?"flex":"none",height:"calc(100vh - 146px)",justifyContent:"center",position:"sticky",top:"-150px"},children:(0,e.jsx)(va,{SecondValue:Na,Detaillist:j,setDetaillist:ge,Sformref:me,Operationbentate:Me,handleBack:Yt,pageKeyfun:We,SkillMenuClick:Ht,secondjudgingcondition:Gt,agentupdata:Kt})}),(0,e.jsx)("div",{style:{display:ue==="4"?"flex":"none",height:"calc(100vh - 146px)",justifyContent:"center"},children:(0,e.jsx)(fa,{handleBack:Yt,Detaillist:j,setDetaillist:ge,Fourthly_select_list:lt,Fourthly_config_id:$e,setFourthly_config_id:Re,Fourthlyref:we,Fourthly_abilities_list:ut,Operationbentate:Me,callwordlist:qe,newagentid:r})})]})})})}),(0,e.jsx)(mt.Z.Panel,{children:(0,e.jsx)("div",{children:(0,e.jsx)(xa.Z,{saveInfo:{firstjudgingcondition:zt,secondjudgingcondition:Gt,agentupdata:Kt},operationbentate:Me,data:{abilitiesList:ut,detailList:j}})})}),ue=="5"&&(0,e.jsx)("div",{className:"absolute bottom-0 left-0 right-0 bg-slate-50 w-full h-full z-10",children:(0,e.jsx)(ba.ZP,{agent_id:j.agent.agent_id})})]})})]})},ja=ya},58533:function(Et,Oe,i){var ve=i(67294);var U=function(l,x){return U=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var v in t)t.hasOwnProperty(v)&&(o[v]=t[v])},U(l,x)};function He(l,x){U(l,x);function o(){this.constructor=l}l.prototype=x===null?Object.create(x):(o.prototype=x.prototype,new o)}var _=function(){return _=Object.assign||function(x){for(var o,t=1,v=arguments.length;t<v;t++){o=arguments[t];for(var P in o)Object.prototype.hasOwnProperty.call(o,P)&&(x[P]=o[P])}return x},_.apply(this,arguments)};function re(l,x,o,t){var v,P=!1,W=0;function te(){v&&clearTimeout(v)}function Y(){te(),P=!0}typeof x!="boolean"&&(t=o,o=x,x=void 0);function D(){var z=this,Ze=Date.now()-W,p=arguments;if(P)return;function S(){W=Date.now(),o.apply(z,p)}function B(){v=void 0}t&&!v&&S(),te(),t===void 0&&Ze>l?S():x!==!0&&(v=setTimeout(t?B:S,t===void 0?l-Ze:l))}return D.cancel=Y,D}var O={Pixel:"Pixel",Percent:"Percent"},Ie={unit:O.Percent,value:.8};function a(l){return typeof l=="number"?{unit:O.Percent,value:l*100}:typeof l=="string"?l.match(/^(\d*(\.\d+)?)px$/)?{unit:O.Pixel,value:parseFloat(l)}:l.match(/^(\d*(\.\d+)?)%$/)?{unit:O.Percent,value:parseFloat(l)}:(console.warn('scrollThreshold format is invalid. Valid formats: "120px", "50%"...'),Ie):(console.warn("scrollThreshold should be string or number"),Ie)}var Ke=function(l){He(x,l);function x(o){var t=l.call(this,o)||this;return t.lastScrollTop=0,t.actionTriggered=!1,t.startY=0,t.currentY=0,t.dragging=!1,t.maxPullDownDistance=0,t.getScrollableTarget=function(){return t.props.scrollableTarget instanceof HTMLElement?t.props.scrollableTarget:typeof t.props.scrollableTarget=="string"?document.getElementById(t.props.scrollableTarget):(t.props.scrollableTarget===null&&console.warn(`You are trying to pass scrollableTarget but it is null. This might
        happen because the element may not have been added to DOM yet.
        See https://github.com/ankeetmaini/react-infinite-scroll-component/issues/59 for more info.
      `),null)},t.onStart=function(v){t.lastScrollTop||(t.dragging=!0,v instanceof MouseEvent?t.startY=v.pageY:v instanceof TouchEvent&&(t.startY=v.touches[0].pageY),t.currentY=t.startY,t._infScroll&&(t._infScroll.style.willChange="transform",t._infScroll.style.transition="transform 0.2s cubic-bezier(0,0,0.31,1)"))},t.onMove=function(v){t.dragging&&(v instanceof MouseEvent?t.currentY=v.pageY:v instanceof TouchEvent&&(t.currentY=v.touches[0].pageY),!(t.currentY<t.startY)&&(t.currentY-t.startY>=Number(t.props.pullDownToRefreshThreshold)&&t.setState({pullToRefreshThresholdBreached:!0}),!(t.currentY-t.startY>t.maxPullDownDistance*1.5)&&t._infScroll&&(t._infScroll.style.overflow="visible",t._infScroll.style.transform="translate3d(0px, "+(t.currentY-t.startY)+"px, 0px)")))},t.onEnd=function(){t.startY=0,t.currentY=0,t.dragging=!1,t.state.pullToRefreshThresholdBreached&&(t.props.refreshFunction&&t.props.refreshFunction(),t.setState({pullToRefreshThresholdBreached:!1})),requestAnimationFrame(function(){t._infScroll&&(t._infScroll.style.overflow="auto",t._infScroll.style.transform="none",t._infScroll.style.willChange="unset")})},t.onScrollListener=function(v){typeof t.props.onScroll=="function"&&setTimeout(function(){return t.props.onScroll&&t.props.onScroll(v)},0);var P=t.props.height||t._scrollableNode?v.target:document.documentElement.scrollTop?document.documentElement:document.body;if(!t.actionTriggered){var W=t.props.inverse?t.isElementAtTop(P,t.props.scrollThreshold):t.isElementAtBottom(P,t.props.scrollThreshold);W&&t.props.hasMore&&(t.actionTriggered=!0,t.setState({showLoader:!0}),t.props.next&&t.props.next()),t.lastScrollTop=P.scrollTop}},t.state={showLoader:!1,pullToRefreshThresholdBreached:!1,prevDataLength:o.dataLength},t.throttledOnScrollListener=re(150,t.onScrollListener).bind(t),t.onStart=t.onStart.bind(t),t.onMove=t.onMove.bind(t),t.onEnd=t.onEnd.bind(t),t}return x.prototype.componentDidMount=function(){if(typeof this.props.dataLength=="undefined")throw new Error('mandatory prop "dataLength" is missing. The prop is needed when loading more content. Check README.md for usage');if(this._scrollableNode=this.getScrollableTarget(),this.el=this.props.height?this._infScroll:this._scrollableNode||window,this.el&&this.el.addEventListener("scroll",this.throttledOnScrollListener),typeof this.props.initialScrollY=="number"&&this.el&&this.el instanceof HTMLElement&&this.el.scrollHeight>this.props.initialScrollY&&this.el.scrollTo(0,this.props.initialScrollY),this.props.pullDownToRefresh&&this.el&&(this.el.addEventListener("touchstart",this.onStart),this.el.addEventListener("touchmove",this.onMove),this.el.addEventListener("touchend",this.onEnd),this.el.addEventListener("mousedown",this.onStart),this.el.addEventListener("mousemove",this.onMove),this.el.addEventListener("mouseup",this.onEnd),this.maxPullDownDistance=this._pullDown&&this._pullDown.firstChild&&this._pullDown.firstChild.getBoundingClientRect().height||0,this.forceUpdate(),typeof this.props.refreshFunction!="function"))throw new Error(`Mandatory prop "refreshFunction" missing.
          Pull Down To Refresh functionality will not work
          as expected. Check README.md for usage'`)},x.prototype.componentWillUnmount=function(){this.el&&(this.el.removeEventListener("scroll",this.throttledOnScrollListener),this.props.pullDownToRefresh&&(this.el.removeEventListener("touchstart",this.onStart),this.el.removeEventListener("touchmove",this.onMove),this.el.removeEventListener("touchend",this.onEnd),this.el.removeEventListener("mousedown",this.onStart),this.el.removeEventListener("mousemove",this.onMove),this.el.removeEventListener("mouseup",this.onEnd)))},x.prototype.componentDidUpdate=function(o){this.props.dataLength!==o.dataLength&&(this.actionTriggered=!1,this.setState({showLoader:!1}))},x.getDerivedStateFromProps=function(o,t){var v=o.dataLength!==t.prevDataLength;return v?_(_({},t),{prevDataLength:o.dataLength}):null},x.prototype.isElementAtTop=function(o,t){t===void 0&&(t=.8);var v=o===document.body||o===document.documentElement?window.screen.availHeight:o.clientHeight,P=a(t);return P.unit===O.Pixel?o.scrollTop<=P.value+v-o.scrollHeight+1:o.scrollTop<=P.value/100+v-o.scrollHeight+1},x.prototype.isElementAtBottom=function(o,t){t===void 0&&(t=.8);var v=o===document.body||o===document.documentElement?window.screen.availHeight:o.clientHeight,P=a(t);return P.unit===O.Pixel?o.scrollTop+v>=o.scrollHeight-P.value:o.scrollTop+v>=P.value/100*o.scrollHeight},x.prototype.render=function(){var o=this,t=_({height:this.props.height||"auto",overflow:"auto",WebkitOverflowScrolling:"touch"},this.props.style),v=this.props.hasChildren||!!(this.props.children&&this.props.children instanceof Array&&this.props.children.length),P=this.props.pullDownToRefresh&&this.props.height?{overflow:"auto"}:{};return ve.createElement("div",{style:P,className:"infinite-scroll-component__outerdiv"},ve.createElement("div",{className:"infinite-scroll-component "+(this.props.className||""),ref:function(W){return o._infScroll=W},style:t},this.props.pullDownToRefresh&&ve.createElement("div",{style:{position:"relative"},ref:function(W){return o._pullDown=W}},ve.createElement("div",{style:{position:"absolute",left:0,right:0,top:-1*this.maxPullDownDistance}},this.state.pullToRefreshThresholdBreached?this.props.releaseToRefreshContent:this.props.pullDownToRefreshContent)),this.props.children,!this.state.showLoader&&!v&&this.props.hasMore&&this.props.loader,this.state.showLoader&&this.props.hasMore&&this.props.loader,!this.props.hasMore&&this.props.endMessage))},x}(ve.Component);Oe.Z=Ke}}]);
