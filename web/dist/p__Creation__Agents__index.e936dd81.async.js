"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[5178],{83510:function(It,Ve,i){i.d(Ve,{LK:function(){return v},bs:function(){return $},go:function(){return t},uy:function(){return M}});var we=i(15009),Y=i.n(we),Qe=i(99289),_=i.n(Qe),re=i(47520),R="/v1/apps/apps_list",$e="/v1/agent/agent_delete/",a="/v1/workflow/workflow_app_delete/",qe="/v1/vector/delete_dataset/",r="/v1/skill/delete_skill_by_app_id/",x="/v1/apps/apps_create",u="/v1/apps/app_update/",t=function(){var ae=_()(Y()().mark(function z(T){var K;return Y()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,(0,re.ZP)("".concat(R),{method:"GET",data:T});case 2:return K=p.sent,p.abrupt("return",K);case 4:case"end":return p.stop()}},z)}));return function(T){return ae.apply(this,arguments)}}(),v=function(){var ae=_()(Y()().mark(function z(T){var K;return Y()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return console.log(T),p.next=3,T.mode;case 3:if(p.t0=p.sent,p.t0!=1){p.next=8;break}p.t1=(0,re.ZP)("".concat($e).concat(T.app_id),{method:"DELETE"}),p.next=9;break;case 8:p.t1=T.mode==2?(0,re.ZP)("".concat(a).concat(T.app_id),{method:"DELETE"}):T.mode==3?(0,re.ZP)("".concat(qe).concat(T.app_id),{method:"DELETE"}):(0,re.ZP)("".concat(r).concat(T.app_id),{method:"DELETE",data:{is_soft:1}});case 9:return K=p.t1,p.abrupt("return",K);case 11:case"end":return p.stop()}},z)}));return function(T){return ae.apply(this,arguments)}}(),M=function(){var ae=_()(Y()().mark(function z(T){var K;return Y()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,(0,re.ZP)("".concat(x),{method:"POST",data:T});case 2:return K=p.sent,p.abrupt("return",K);case 4:case"end":return p.stop()}},z)}));return function(T){return ae.apply(this,arguments)}}(),$=function(){var ae=_()(Y()().mark(function z(T){var K;return Y()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,(0,re.ZP)("".concat(u).concat(T.app_id),{method:"PUT",data:T});case 2:return K=p.sent,p.abrupt("return",K);case 4:case"end":return p.stop()}},z)}));return function(T){return ae.apply(this,arguments)}}()},6180:function(It,Ve,i){i.r(Ve),i.d(Ve,{default:function(){return Za}});var we=i(19632),Y=i.n(we),Qe=i(15009),_=i.n(Qe),re=i(99289),R=i.n(re),$e=i(97857),a=i.n($e),qe=i(5574),r=i.n(qe),x=i(11551),u=i(83510),t=i(47520),v=i(29432),M=i(10759),$=i(32332),ae=i(2068),z=i(89035),T=i(15360),K=i(82826),Pe=i(69243),p=i(76772),N=i(40741),B=i(45360),oe=i(28036),na=i(33456),jt=i(25409),Rt=i(74330),ia=i(96486),Bt=i.n(ia),h=i(67294),Se=i(92939),Vt=i(80459),$t=i(85750),la=i(75486),ra=i(58299),oa=i(5785),et=i(51042),wt=i(82061),ua=i(28508),Te=i(26915),it=i(72269),St=i(34041),lt=i(66309),Wt=i(83062),se=i(78045),Ut=i(44010),e=i(85893),Yt=Te.Z.TextArea,da=function(m){var me,V,G,F,Ae,ue,_e=m.loading,J=m.FirstValue,n=m.Detaillist,I=m.setDetaillist,C=m.repository,D=m.setRepository,Ce=m.Operationbentate,ge=m.Ffromref,We=m.setFourthly_config_id,de=m.Fourthly_config_id,Ne=m.Fourthly_select_list,ke=m.Newproperties,Ee=m.setNewproperties,S=m.pageKeyfun,he=m.firstjudgingcondition,De=m.setAgentmunudisabled,ve=m.agentmenudisabled,c=(0,p.useIntl)(),ce=(0,h.useState)([]),E=r()(ce,2),ne=E[0],H=E[1],q=(0,h.useState)(!1),xe=r()(q,2),Le=xe[0],be=xe[1],Fe=(0,h.useState)([]),Oe=r()(Fe,2),Me=Oe[0],Ie=Oe[1],U=(0,h.useState)([]),k=r()(U,2),P=k[0],W=k[1],Q=(0,h.useState)(!1),O=r()(Q,2),ye=O[0],Re=O[1],Nt=(0,h.useState)(!1),rt=r()(Nt,2),ot=rt[0],Ze=rt[1],Ue=(0,h.useState)(!1),ut=r()(Ue,2),Ye=ut[0],Ft=ut[1],Gt=(0,h.useState)(""),dt=r()(Gt,2),tt=dt[0],at=dt[1],Mt=(0,h.useState)({agent_id:0,data:{is_public:1,enable_api:0,obligations:null,input_variables:{},dataset_ids:[],attrs_are_visible:1}}),ct=r()(Mt,2),fe=ct[0],ee=ct[1];(0,h.useEffect)(function(){var l,s;if(Et(),n!=null&&(l=n.agent)!==null&&l!==void 0&&l.selected_skills&&Ie(n.agent.selected_skills),n!=null&&(s=n.agent)!==null&&s!==void 0&&s.selected_workflows){var b;W(n==null||(b=n.agent)===null||b===void 0?void 0:b.selected_workflows)}},[n,n==null?void 0:n.agent]);var Zt=function(s){We(s)};(0,h.useEffect)(function(){var l,s;at((l=n==null||(s=n.agent)===null||s===void 0?void 0:s.obligations)!==null&&l!==void 0?l:"")},[n==null||(me=n.agent)===null||me===void 0?void 0:me.obligations]),(0,h.useEffect)(function(){if(Ye){var l=document.body.style.overflow;return document.body.style.overflow="hidden",function(){document.body.style.overflow=l}}},[Ye]);var ft=function(s){var b=s.target.value;at(b),ee(function(y){return a()(a()({},y),{},{data:a()(a()({},y.data),{},{obligations:b})})}),I(function(y){return a()(a()({},y),{},{agent:a()(a()({},(y==null?void 0:y.agent)||{}),{},{obligations:b})})})},Pt=function(s,b){var y=new Set;return s.some(function(te){var je=te[b];return y.has(je)?y.add(je):y.add(je)&&!1})},pe=function(s){I(a()(a()({},n),{},{app:a()(a()({},n.app),{},{is_public:s?1:0})})),ee(a()(a()({},fe),{},{data:a()(a()({},fe.data),{},{is_public:s?1:0})}))},ze=function(s){I(a()(a()({},n),{},{app:a()(a()({},n.app),{},{enable_api:s?1:0})})),ee(a()(a()({},fe),{},{data:a()(a()({},fe.data),{},{enable_api:s?1:0})}))},Ct=function(s){I(a()(a()({},n),{},{app:a()(a()({},n.app),{},{attrs_are_visible:s?1:0})})),ee(a()(a()({},fe),{},{data:a()(a()({},fe.data),{},{attrs_are_visible:s?1:0})}))},kt=function(s){I(a()(a()({},n),{},{agent:a()(a()({},n.agent),{},{allow_upload_file:s?1:0})}))},Ht=function(s){I(a()(a()({},n),{},{agent:a()(a()({},n.agent),{},{mcp:s?1:0})}))},pt=function(s){ee(a()(a()({},fe),{},{data:a()(a()({},fe.data),{},{dataset_ids:s})})),D(s)},Et=function(){var l=R()(_()().mark(function s(){var b;return _()().wrap(function(te){for(;;)switch(te.prev=te.next){case 0:return te.next=2,(0,x.zl)();case 2:b=te.sent,H(b.data.data.map(function(je){return{value:je.dataset_id,label:je.name}}));case 4:case"end":return te.stop()}},s)}));return function(){return l.apply(this,arguments)}}(),Dt=function(s){Ie(s),I(a()(a()({},n),{},{agent:a()(a()({},n.agent),{},{selected_skills:s})}))},Xt=function(s){W(s),I(a()(a()({},n),{},{agent:a()(a()({},n.agent),{},{selected_workflows:s})}))},Tt=function(){var l=R()(_()().mark(function s(){return _()().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:he()||(S("2"),De(a()(a()({},ve),{},{first:!1,second:!1})));case 1:case"end":return y.stop()}},s)}));return function(){return l.apply(this,arguments)}}(),At=function(s){I(a()(a()({},n),{},{agent:a()(a()({},n.agent),{},{default_output_format:s.target.value})}))},mt=function(s){I(a()(a()({},n),{},{agent:a()(a()({},n==null?void 0:n.agent),{},{input_variables:s.free})}))},gt=(0,ra.m)(),st=gt.options,Jt=gt.defaultValue,ht=function(s){Ie(s.checkItem),I(a()(a()({},n),{},{agent:a()(a()({},n.agent),{},{selected_skills:s.checkItem})})),Re(!1)},Ke=function(s){W(s.checkItem),I(a()(a()({},n),{},{agent:a()(a()({},n.agent),{},{selected_workflows:s.checkItem})})),Ze(!1)},vt=function(){Re(!1)},Lt=function(){Ze(!1)},xt=function(s){var b=Me.filter(function(y){return y.app_id!==s.app_id});Ie(b),I(a()(a()({},n),{},{agent:a()(a()({},n.agent),{},{selected_skills:b})}))},bt=function(s){var b=P.filter(function(y){return y.app_id!==s.app_id});W(b),I(a()(a()({},n),{},{agent:a()(a()({},n.agent),{},{selected_workflows:b})}))};return(0,e.jsxs)("div",{style:{height:"100%",width:"100%",marginBottom:"30px"},children:[(0,e.jsx)("div",{className:"flex align-center justify-between mt-[30px]",children:(0,e.jsx)("div",{className:"text-base font-medium mb-[30px] text-[#333333]",children:c.formatMessage({id:"agent.menu.basicsetup"})})}),(0,e.jsxs)("div",{className:"w-full",children:[(0,e.jsxs)(N.Z,{name:"dynamic_form_nest_item",style:{width:"100%"},autoComplete:"off",form:ge,children:[(0,e.jsx)(N.Z.Item,{className:"mb-[30px]",children:(0,e.jsxs)("div",{className:"text-[#555555] text-xs",children:[(0,e.jsx)("div",{className:"font-medium  mb-[15px]",children:c.formatMessage({id:"agent.appname"})}),(0,e.jsxs)("div",{className:"w-full p-[15px] flex font-normal items-center bg-[#F7F7F7] rounded-lg",children:[(0,e.jsxs)("div",{children:[n&&n.app&&n.app.name,"\xA0"]}),(0,e.jsx)("div",{className:"",children:Ce==="true"?c.formatMessage({id:"agent.cannotmodify"}):""})]})]})}),(0,e.jsx)(N.Z.Item,{className:"mb-[30px]",children:(0,e.jsxs)("div",{className:"text-[#555555] text-xs",children:[(0,e.jsx)("div",{className:"font-medium  mb-[15px]",children:c.formatMessage({id:"agent.appdescription"})}),(0,e.jsx)("div",{className:"w-full p-[15px] flex font-normal items-center bg-[#F7F7F7] rounded-lg",children:n&&n.app&&n.app.description})]})}),(0,e.jsx)(N.Z.Item,{className:"mb-[30px]",children:(0,e.jsxs)("div",{children:[(0,e.jsxs)("div",{className:"mb-[30px]",children:[(0,e.jsx)("div",{className:"mb-[15px] text-[#555555] text-xs",children:(0,e.jsx)(Se.Z,{className:"font-medium",name:c.formatMessage({id:"agent.teamvisibility"}),title:c.formatMessage({id:"agent.explain.teamvisibility"})})}),(0,e.jsx)(it.Z,{size:"small",onChange:pe,checked:!!(n&&((V=n.app)===null||V===void 0?void 0:V.is_public)===1)})]}),(0,e.jsxs)("div",{className:"mb-[30px]  font-medium",children:[(0,e.jsx)("div",{className:"mb-[15px] text-[#555555] text-xs",children:(0,e.jsx)(Se.Z,{className:"font-medium",name:c.formatMessage({id:"agent.attrVisible"}),title:c.formatMessage({id:"agent.explain.attrVisible"})})}),(0,e.jsx)(it.Z,{size:"small",onChange:Ct,checked:n&&((G=n.app)===null||G===void 0?void 0:G.attrs_are_visible)===1})]}),(0,e.jsxs)("div",{className:"mb-[30px]  font-medium",children:[(0,e.jsx)("div",{className:"mb-[15px] text-[#555555] text-xs",children:c.formatMessage({id:"agent.APIswitch"})}),(0,e.jsx)(it.Z,{size:"small",onChange:ze,checked:n&&((F=n.app)===null||F===void 0?void 0:F.enable_api)===1,disabled:(n==null||(Ae=n.app)===null||Ae===void 0?void 0:Ae.publish_status)!==1})]})]})}),(0,e.jsx)(N.Z.Item,{className:"mb-[30px]",children:(0,e.jsxs)("div",{children:[(0,e.jsxs)("div",{className:"mb-[15px] text-[#555555] text-xs font-medium",children:[(0,e.jsx)("span",{className:"text-[#E80000]",children:"* "}),c.formatMessage({id:"agent.LLMmodel"})]}),(0,e.jsx)(St.Z,{placeholder:c.formatMessage({id:"agent.pleaseselect"}),value:de==0?c.formatMessage({id:"agent.pleaseselect"}):de,variant:"filled",onChange:Zt,options:st,optionRender:function(s){var b,y;return(0,e.jsxs)("div",{children:[s.label," ",(s==null||(b=s.data)===null||b===void 0?void 0:b.support_image)==1&&(0,e.jsx)(lt.Z,{color:"blue",className:"text-xs",children:c.formatMessage({id:"workflow.tag.imageUnderstanding",defaultMessage:"Image Understanding"})}),(s==null||(y=s.data)===null||y===void 0?void 0:y.model_mode)==2&&(0,e.jsx)(lt.Z,{color:"default",className:"text-xs",children:c.formatMessage({id:"workflow.tag.localModel",defaultMessage:"Local Model"})})]})},labelRender:function(s){var b,y;return(0,e.jsxs)("div",{children:[s==null?void 0:s.label," ",((b=(0,$t.ti)(s==null?void 0:s.value,{options:st}))===null||b===void 0?void 0:b.support_image)==1&&(0,e.jsx)(lt.Z,{color:"blue",className:"text-xs",children:c.formatMessage({id:"workflow.tag.imageUnderstanding",defaultMessage:"Image Understanding"})}),((y=(0,$t.ti)(s==null?void 0:s.value,{options:st}))===null||y===void 0?void 0:y.model_mode)==2&&(0,e.jsx)(lt.Z,{color:"default",className:"text-xs",children:c.formatMessage({id:"workflow.tag.localModel",defaultMessage:"Local Model"})})]})}})]})}),(0,e.jsx)(N.Z.Item,{className:"mb-[30px]",name:"obligations",children:(0,e.jsxs)("div",{className:"relative w-full",children:[(0,e.jsx)("div",{className:"mb-[15px] text-[#555555] text-xs",children:(0,e.jsx)(Se.Z,{className:"font-medium",required:!0,name:c.formatMessage({id:"agent.functiondescription"}),title:c.formatMessage({id:"agent.explain.function"})})}),(0,e.jsx)(Yt,{onChange:ft,value:tt,placeholder:"Agent".concat(c.formatMessage({id:"agent.functiondescription"})),autoSize:{minRows:8,maxRows:10},className:"pr-[40px]"}),(0,e.jsx)(Wt.Z,{title:c.formatMessage({id:"agent.functiondescription.fullscreen"}),children:(0,e.jsx)(oe.ZP,{type:"text",className:"absolute bottom-[10px] right-[10px] h-auto w-auto p-0 text-base text-[#8C8C8C]",icon:(0,e.jsx)(oa.Z,{}),onClick:function(){return Ft(!0)}})})]})}),!Le&&(0,e.jsx)("div",{className:"mb-[30px]",children:(0,e.jsx)(la.Z,{title:(0,e.jsx)("div",{className:"text-[#555555] text-xs",children:(0,e.jsx)(Se.Z,{className:"font-medium",required:!0,name:c.formatMessage({id:"agent.inputvariable"}),title:c.formatMessage({id:"agent.explain.inputvariable"})})}),variables:Object.values((n==null||(ue=n.agent)===null||ue===void 0||(ue=ue.input_variables)===null||ue===void 0?void 0:ue.properties)||{}),onChange:mt})}),(0,e.jsx)(N.Z.List,{name:"users",children:function(s,b){var y=b.add,te=b.remove;return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(N.Z.Item,{className:"mb-[30px]",children:[(0,e.jsx)("div",{className:"text-[#555555] text-xs mb-[15px]",children:(0,e.jsx)(Se.Z,{className:"font-medium",name:c.formatMessage({id:"agent.associatedknowledgebase"}),title:c.formatMessage({id:"agent.explain.associatedknowledgebase"})})}),(0,e.jsx)(St.Z,{size:"large",mode:"multiple",showSearch:!0,style:{width:"100%",fontSize:"12px"},placeholder:c.formatMessage({id:"agent.pleaseselect"}),filterOption:function(yt,Be){var Ge;return((Ge=Be==null?void 0:Be.label)!==null&&Ge!==void 0?Ge:"").toLowerCase().includes(yt.toLowerCase())},value:C,onChange:pt,options:ne})]}),(0,e.jsx)(N.Z.Item,{className:"mb-[30px]",children:(0,e.jsxs)("div",{className:"",children:[(0,e.jsxs)("div",{className:"text-[#555555] text-xs mb-[15px]",children:[" ",c.formatMessage({id:"agent.defaultoutputformat"})]}),(0,e.jsxs)(se.ZP.Group,{value:n&&n.agent.default_output_format,onChange:function(yt){At(yt)},children:[(0,e.jsx)(se.ZP,{value:1,children:(0,e.jsx)("div",{className:"text-[#555555] text-xs font-normal",children:"text"})}),(0,e.jsx)(se.ZP,{value:2,children:(0,e.jsx)("div",{className:"text-[#555555] text-xs font-normal",children:"json"})}),(0,e.jsx)(se.ZP,{value:3,children:(0,e.jsx)("div",{className:"text-[#555555] text-xs font-normal",children:"code"})})]})]})})]})}}),(0,e.jsxs)(N.Z.Item,{className:"mb-[30px]",children:[(0,e.jsx)("div",{className:"text-[#555555] text-base mb-[15px]",children:c.formatMessage({id:"agent.mcp.resources"})}),(0,e.jsxs)("div",{className:"pl-4 ",children:[(0,e.jsxs)("div",{className:"mb-[30px]",children:[(0,e.jsxs)("div",{className:"flex items-center justify-between mb-[15px]",children:[(0,e.jsx)("div",{className:"text-[#555555] text-xs",children:(0,e.jsx)(Se.Z,{className:"font-medium",name:c.formatMessage({id:"agent.selectSkills"}),title:c.formatMessage({id:"agent.explain.selectSkills"})})}),(0,e.jsx)(oe.ZP,{type:"link",icon:(0,e.jsx)(et.Z,{}),onClick:function(){return Re(!0)},className:"text-xs",children:c.formatMessage({id:"agent.addSkill"})})]}),Me.length>0?(0,e.jsx)("div",{className:"flex flex-col gap-4 mb-4",children:Me.map(function(l){return(0,e.jsxs)("div",{className:"group relative flex items-center cursor-pointer w-full p-2 bg-white rounded-lg shadow-sm transition-shadow",children:[(0,e.jsx)(Vt.Z,{rounded:"6px",data:l,bg:l.icon_background}),(0,e.jsxs)("div",{className:"flex flex-col ml-2 truncate",children:[(0,e.jsx)("span",{className:"text-sm font-medium text-[#333333]",children:l.name}),(0,e.jsx)("span",{className:"text-xs text-[#666666] truncate",children:l.description})]}),(0,e.jsx)("div",{className:"absolute right-2 top-1/2 -translate-y-1/2 opacity-0 group-hover:opacity-100 transition-opacity cursor-pointer hover:text-red-500",onClick:function(b){b.stopPropagation(),xt(l)},children:(0,e.jsx)(wt.Z,{})})]},l.app_id)})}):(0,e.jsx)("div",{onClick:function(){return Re(!0)},className:"w-full h-[120px] flex items-center justify-center border border-dashed border-[#e8e8e8] rounded-lg bg-[#fafafa] cursor-pointer hover:border-[#1b64f3] transition-colors",children:(0,e.jsxs)("div",{className:"flex flex-col items-center gap-2",children:[(0,e.jsx)(et.Z,{className:"text-[#999999] text-lg"}),(0,e.jsx)("span",{className:"text-[#999999] text-sm",children:c.formatMessage({id:"agent.addSkill"})})]})}),(0,e.jsx)(Ut.Z,{show:ye,popupClose:vt,popupSave:ht,checkList:Me,radio:!1,nodetype:"skill",zIndex:30})]}),(0,e.jsxs)("div",{className:"mb-[30px]",children:[(0,e.jsxs)("div",{className:"flex items-center justify-between mb-[15px]",children:[(0,e.jsx)("div",{className:"text-[#555555] text-xs",children:(0,e.jsx)(Se.Z,{className:"font-medium",name:c.formatMessage({id:"agent.selectWorkflows"}),title:c.formatMessage({id:"agent.explain.selectWorkflows"})})}),(0,e.jsx)(oe.ZP,{type:"link",icon:(0,e.jsx)(et.Z,{}),onClick:function(){return Ze(!0)},className:"text-xs",children:c.formatMessage({id:"agent.addWorkflow"})})]}),P.length>0?(0,e.jsx)("div",{className:"flex flex-col gap-4 mb-4",children:P.map(function(l){return(0,e.jsxs)("div",{className:"group relative flex items-center cursor-pointer w-full p-2 bg-white rounded-lg shadow-sm transition-shadow",children:[(0,e.jsx)(Vt.Z,{rounded:"6px",data:l,bg:l.icon_background}),(0,e.jsxs)("div",{className:"flex flex-col ml-2 truncate",children:[(0,e.jsx)("span",{className:"text-sm font-medium text-[#333333]",children:l.name}),(0,e.jsx)("span",{className:"text-xs text-[#666666] truncate",children:l.description})]}),(0,e.jsx)("div",{className:"absolute right-2 top-1/2 -translate-y-1/2 opacity-0 group-hover:opacity-100 transition-opacity cursor-pointer hover:text-red-500",onClick:function(b){b.stopPropagation(),bt(l)},children:(0,e.jsx)(wt.Z,{})})]},l.app_id)})}):(0,e.jsx)("div",{onClick:function(){return Ze(!0)},className:"w-full h-[120px] flex items-center justify-center border border-dashed border-[#e8e8e8] rounded-lg bg-[#fafafa] cursor-pointer hover:border-[#1b64f3] transition-colors",children:(0,e.jsxs)("div",{className:"flex flex-col items-center gap-2",children:[(0,e.jsx)(et.Z,{className:"text-[#999999] text-lg"}),(0,e.jsx)("span",{className:"text-[#999999] text-sm",children:c.formatMessage({id:"agent.addWorkflow"})})]})}),(0,e.jsx)(Ut.Z,{show:ot,popupClose:Lt,popupSave:Ke,checkList:P,radio:!1,nodetype:"workflow",zIndex:30})]})]})]}),(0,e.jsxs)("div",{children:[(0,e.jsx)(oe.ZP,{type:"primary",className:"mr-[20px]",onClick:function(){Tt()},children:c.formatMessage({id:"agent.btn.nextstep"})}),(0,e.jsx)(oe.ZP,{onClick:function(){history.back()},children:c.formatMessage({id:"agent.btn.back"})})]}),(0,e.jsx)("div",{className:"h-[30px] w-1"})]}),Ye&&(0,e.jsx)("div",{className:"fixed inset-0 z-[2000] bg-white",children:(0,e.jsxs)("div",{className:"flex h-full flex-col",children:[(0,e.jsxs)("div",{className:"flex items-center justify-between border-b border-[#F0F0F0] px-6 py-4",children:[(0,e.jsx)("div",{className:"text-base font-medium text-[#1F2329]",children:c.formatMessage({id:"agent.functiondescription"})}),(0,e.jsx)(Wt.Z,{title:c.formatMessage({id:"agent.functiondescription.exitfullscreen"}),children:(0,e.jsx)(oe.ZP,{type:"text",icon:(0,e.jsx)(ua.Z,{}),className:"text-lg text-[#8C8C8C]",onClick:function(){return Ft(!1)}})})]}),(0,e.jsx)("div",{className:"flex-1 px-6 pb-6 pt-4",children:(0,e.jsx)(Yt,{autoFocus:!0,value:tt,onChange:ft,placeholder:"Agent".concat(c.formatMessage({id:"agent.functiondescription"})),style:{height:"100%",resize:"none"}})})]})})]})]})},ca=da,fa=i(13769),zt=i.n(fa),pa=i(49677),ma=i.n(pa),ga=i(620),ha=i(85877),Kt=i(39944),va=i(71471),xa=["key","name"],La=va.Z.Title,Oa=Te.Z.TextArea,Ia=Te.Z.Search,ba=function(m){var me=m.handleBack,V=m.Detaillist,G=m.setDetaillist,F=m.Fourthly_select_list,Ae=m.setFourthly_config_id,ue=m.Fourthly_config_id,_e=m.Fourthlyref,J=m.Fourthly_abilities_list,n=m.Operationbentate,I=m.callwordlist,C=m.newagentid,D=(0,p.useIntl)(),Ce=(0,h.useState)(0),ge=r()(Ce,2),We=ge[0],de=ge[1],Ne=(0,h.useState)(""),ke=r()(Ne,2),Ee=ke[0],S=ke[1],he=(0,h.useState)(""),De=r()(he,2),ve=De[0],c=De[1],ce=(0,h.useState)(!1),E=r()(ce,2),ne=E[0],H=E[1],q=function(k){var P={user:{value:Fe(k)}};S(new Kt.z(P))},xe=function(k){var P={user:{value:k.target.value}};S(new Kt.z(P))},Le=function(k){de(k)},be=function(k){var P=k.users.filter(function(O,ye){return O.type=="number"&&!Number(O.value)&&!!O.value});if(!Ee.user)B.ZP.warning(D.formatMessage({id:"agent.message.warning.callword"}));else if(P.length>0)B.ZP.warning(D.formatMessage({id:"agent.message.warning.datatype"}));else{H(!0);var W=new M.Kr("input","","");k.users.forEach(function(O){var ye=new M._w(O.name,O.type?O.type:"string",O.type=="string"?O.value:Number(O.value),O.content,O.status);W.addProperty(O.name,ye)});var Q={agent_id:C||V.agent.agent_id,ability_id:We,input_dict:W,prompt:Ee};Oe(Q)}},Fe=function U(k){return k.map(function(P){return P.type==="mention"?P.id:P.children?U(P.children):P.text}).join("")},Oe=function(k){(0,x.LH)(k).then(function(P){B.ZP.success(D.formatMessage({id:"agent.message.success.runpublish"})),c(P.data.outputs.text),H(!1)}).catch(function(P){H(!1)})},Me=function(){var U=R()(_()().mark(function k(){var P;return _()().wrap(function(Q){for(;;)switch(Q.prev=Q.next){case 0:return Q.next=2,(0,x.Dh)(C||V.agent.agent_id);case 2:P=Q.sent,P.code==0?B.ZP.success(D.formatMessage({id:"agent.message.success.publish"})):B.ZP.error(D.formatMessage({id:"agent.message.fail.publish"}));case 4:case"end":return Q.stop()}},k)}));return function(){return U.apply(this,arguments)}}(),Ie=function(){var U=R()(_()().mark(function k(){return _()().wrap(function(W){for(;;)switch(W.prev=W.next){case 0:p.history.push("/Agents?app_id=".concat(V.app.app_id,"&type=false")),location.reload();case 2:case"end":return W.stop()}},k)}));return function(){return U.apply(this,arguments)}}();return(0,h.useEffect)(function(){},[]),(0,e.jsxs)("div",{style:{height:"100%"},children:[(0,e.jsx)("div",{className:"text-base font-medium text-[#333333] my-[30px]",children:D.formatMessage({id:"agent.operationrun"})}),(0,e.jsxs)("div",{className:"mb-[30px]",children:[(0,e.jsx)("div",{className:"mb-[15px] text-[#555555] text-xs font-medium",children:D.formatMessage({id:"agent.selectivepower"})}),(0,e.jsx)(St.Z,{placeholder:D.formatMessage({id:"agent.pleaseselect"}),defaultValue:D.formatMessage({id:"agent.allability"}),style:{width:390,fontSize:"12px",color:"#BBBBBB",fontWeight:"400"},onChange:Le,options:J})]}),(0,e.jsx)("div",{children:(0,e.jsxs)(N.Z,{name:"dynamic_form_nest_item",onFinish:be,style:{width:"100%"},autoComplete:"off",form:_e,children:[(0,e.jsx)("div",{className:"mb-[15px] text-[#555555] text-xs font-medium",children:D.formatMessage({id:"agent.inputvariable"})}),(0,e.jsx)(N.Z.List,{name:"users",children:function(k,P){return ma()(P),(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)("div",{className:"w-full flex justify-start items-center text-xs font-medium px-[10px] text-[#213044] h-12 bg-[#F7F7F7]  rounded-t-lg",children:[(0,e.jsx)("div",{className:"mr-5 ml-2.5",children:D.formatMessage({id:"agent.variable.name"})}),(0,e.jsx)("div",{className:"",children:D.formatMessage({id:"agent.variable.value"})})]}),(0,e.jsx)("div",{className:"mb-[30px]",children:k.map(function(W){var Q=W.key,O=W.name,ye=zt()(W,xa);return(0,e.jsxs)("div",{className:"w-full h-20 flex justify-start  px-2.5 border-b border-x pt-7 last:rounded-b-lg",children:[(0,e.jsx)(N.Z.Item,a()(a()({},ye),{},{name:[O,"content"],children:(0,e.jsx)(Te.Z,{className:"mr-5",style:{color:"#213044",fontWeight:"400",fontSize:"12px"},variant:"borderless",disabled:!0})})),(0,e.jsx)(N.Z.Item,a()(a()({},ye),{},{name:[O,"value"],rules:[{required:!!(_e.getFieldsValue()&&_e.getFieldsValue().users[Q].status==!0),message:D.formatMessage({id:"agent.rules.veriablevalue"})}],children:(0,e.jsx)(Te.Z,{placeholder:_e.getFieldsValue()&&_e.getFieldsValue().users[Q].status==!0?D.formatMessage({id:"agent.variable.required.value"}):D.formatMessage({id:"agent.variable.value"})})}))]})})})]})}}),(0,e.jsxs)(N.Z.Item,{rules:[{required:!0,message:D.formatMessage({id:"agent.rules.callwordvalue"})}],children:[(0,e.jsx)("div",{className:"mb-[15px] text-[#555555] text-xs font-medium",children:D.formatMessage({id:"agent.runpreview"})}),(0,e.jsx)(Rt.Z,{spinning:ne,children:(0,e.jsxs)("div",{className:"bg-[#F7F7F7] p-3.5 rounded-lg",children:[(0,e.jsx)("div",{className:"h-[345px] mb-[30px]",children:ve?(0,e.jsx)(ga.Z,{language:"python3",value:ve&&JSON.stringify(ve)}):null}),(0,e.jsxs)("div",{className:"agents-input p-2 bg-white border rounded-md my-2 flex items-center justify-between",style:{border:"1px solid #EEE"},children:[(0,e.jsx)("div",{className:"w-full",children:(0,e.jsx)(ha.Z,{onChange:function(k){q(k)},options:I})}),(0,e.jsx)("div",{className:"w-8 h-8 bg-[#e8effc] rounded-md",children:(0,e.jsx)(oe.ZP,{className:"bg-[#e8effc]",icon:(0,e.jsx)("img",{src:"/icons/fs.svg"}),type:"link",htmlType:"submit",block:!0})})]})]})})]})]})}),(0,e.jsx)("div",{className:"w-28",children:(V==null?void 0:V.agent.publish_status)===1&&(V==null?void 0:V.is_creator)===1?(0,e.jsx)("div",{children:(0,e.jsx)(oe.ZP,{type:"primary",htmlType:"submit",className:"w-full",onClick:Ie,children:D.formatMessage({id:"agent.amend"})})}):(0,e.jsx)("div",{children:(0,e.jsx)(oe.ZP,{type:"primary",htmlType:"submit",className:"w-full",disabled:n!="false",onClick:Me,children:D.formatMessage({id:"agent.publish"})})})}),(0,e.jsx)("div",{className:"h-[30px] w-1"})]})},ya=ba,ja=["key","name"],wa=Te.Z.TextArea,Sa=function(m){var me=m.SecondValue,V=m.handleBack,G=m.Detaillist,F=m.setDetaillist,Ae=m.Sformref,ue=m.Operationbentate,_e=m.pageKeyfun,J=m.secondjudgingcondition,n=m.SkillMenuClick,I=m.agentupdata,C=(0,p.useIntl)(),D=B.ZP.useMessage(),Ce=r()(D,2),ge=Ce[0],We=Ce[1],de=(0,h.useRef)(null),Ne=(0,h.useState)({auto_match_ability:0,agent_abilities:[{agent_ability_id:0,name:"string",content:"string",status:0}]}),ke=r()(Ne,2),Ee=ke[0],S=ke[1];(0,h.useEffect)(function(){});var he=function(E){if(E.users.length==1&&(!E.users[0].content&&E.users[0].name||E.users[0].content&&!E.users[0].name))return B.ZP.warning(C.formatMessage({id:"agent.message.warning.selectknowledgebase"}));var ne=E.users.map(function(q){return a()(a()({},q),{},{status:q.status?1:2,agent_ability_id:q.agent_ability_id?q.agent_ability_id:0})}),H={agent_id:G.agent.agent_id,data:{auto_match_ability:G.agent.auto_match_ability,agent_abilities:E.users.length==1&&!E.users[0].content&&!E.users[0].name?[]:ne}};ue=="false"&&De(),me(a()({},Ee))},De=function(){var ce=R()(_()().mark(function E(){return _()().wrap(function(H){for(;;)switch(H.prev=H.next){case 0:J()||I();case 1:case"end":return H.stop()}},E)}));return function(){return ce.apply(this,arguments)}}(),ve=function(E){F(a()(a()({},G),{},{agent:a()(a()({},G.agent),{},{auto_match_ability:E?1:0})}))},c=function(){setTimeout(function(){de.current&&de.current.scrollTo({top:de.current.scrollHeight,behavior:"smooth"})},100)};return(0,e.jsxs)("div",{style:{height:"100%"},className:"w-full flex-1 sticky top-0",children:[(0,e.jsx)("div",{className:"text-base font-medium text-[#333333] my-[30px]",children:C.formatMessage({id:"agent.Applicationcapabilitysetting"})}),(0,e.jsxs)("div",{className:"mb-[30px]",children:[(0,e.jsx)("div",{className:"mb-[15px] text-[#555555] text-xs font-medium",children:(0,e.jsx)(Se.Z,{name:C.formatMessage({id:"agent.automatch"}),title:C.formatMessage({id:"agent.explain.automatch"})})}),(0,e.jsx)(it.Z,{size:"small",checked:!!(G&&G.agent.auto_match_ability==1),onChange:ve})]}),(0,e.jsx)("div",{className:"w-full",children:(0,e.jsxs)(N.Z,{name:"dynamic_form_nest_item",onFinish:he,style:{width:"100%"},autoComplete:"off",form:Ae,children:[(0,e.jsx)(N.Z.List,{name:"users",children:function(E,ne){var H=ne.add,q=ne.remove;return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)("div",{className:"w-full flex items-center justify-between mb-[11px]",children:[(0,e.jsx)("div",{className:" text-[#555555] text-xs font-medium",children:C.formatMessage({id:"agent.capability"})}),(0,e.jsx)("div",{children:(0,e.jsx)(oe.ZP,{type:"link",onClick:function(){H(),c()},block:!0,icon:(0,e.jsx)(et.Z,{}),children:C.formatMessage({id:"agent.add"})})})]}),(0,e.jsx)("div",{style:{height:"calc(100vh - 206px)",overflowY:"auto"},className:"overflow-y-auto",ref:de,children:E.map(function(xe){var Le=xe.key,be=xe.name,Fe=zt()(xe,ja);return(0,e.jsxs)("div",{className:"bg-[#F7F7F7] p-[15px] rounded-lg mb-[20px]",children:[(0,e.jsx)(N.Z.Item,{className:"mb-0",children:(0,e.jsxs)("div",{className:"w-full flex justify-between items-center mb-[15px]",children:[(0,e.jsx)("div",{className:"text-[#555555] text-xs font-medium",children:C.formatMessage({id:"agent.capabilityname"})}),(0,e.jsxs)("div",{children:[" ",(0,e.jsx)(wt.Z,{onClick:function(){return q(be)}})]})]})}),(0,e.jsx)(N.Z.Item,a()(a()({className:"mb-[20px]"},Fe),{},{name:[be,"name"],rules:[{required:E.length!==1,message:C.formatMessage({id:"agent.capabilityname"})}],children:(0,e.jsx)(Te.Z,{placeholder:C.formatMessage({id:"agent.capabilityname"}),maxLength:50,className:"w-full"})})),(0,e.jsx)("div",{className:"mb-[15px]",children:(0,e.jsx)(Se.Z,{className:"text-[#555555] text-xs font-medium",name:C.formatMessage({id:"agent.capabilitydescription"}),title:C.formatMessage({id:"agent.explain.capabilitydescription"})})}),(0,e.jsx)(N.Z.Item,a()(a()({className:"w-full mb-[20px]"},Fe),{},{name:[be,"content"],rules:[{required:E.length!==1,message:C.formatMessage({id:"agent.capabilitydescription"})}],children:(0,e.jsx)(wa,{placeholder:C.formatMessage({id:"agent.capabilitydescription"}),autoSize:{minRows:3,maxRows:10},className:"w-full"})})),(0,e.jsx)("div",{className:"text-[#555555] text-xs font-medium mb-[15px]",children:C.formatMessage({id:"agent.capabilitystatus"})}),(0,e.jsx)(N.Z.Item,a()(a()({className:"mb-[20px]"},Fe),{},{name:[be,"status"],children:(0,e.jsxs)(se.ZP.Group,{optionType:"button",buttonStyle:"solid",defaultValue:!0,children:[(0,e.jsx)(se.ZP,{value:!0,children:C.formatMessage({id:"agent.capabilitystatus.enable"})}),(0,e.jsx)(se.ZP,{value:!1,children:C.formatMessage({id:"agent.capabilitystatus.disable"})})]})})),(0,e.jsx)("div",{className:"text-[#555555] text-xs font-medium mb-[11px]",children:C.formatMessage({id:"agent.enableall"})}),(0,e.jsx)(N.Z.Item,{className:"mb-0",name:[be,"output_format"],children:(0,e.jsxs)(se.ZP.Group,{defaultValue:0,children:[(0,e.jsx)(se.ZP,{value:0,children:(0,e.jsx)("div",{className:"text-[#555555] text-xs font-normal",children:C.formatMessage({id:"agent.menu"})})}),(0,e.jsx)(se.ZP,{value:1,children:(0,e.jsx)("div",{className:"text-[#555555] text-xs font-normal",children:"text string"})}),(0,e.jsx)(se.ZP,{value:2,children:(0,e.jsx)("div",{className:"text-[#555555] text-xs font-normal",children:"format json"})}),(0,e.jsx)(se.ZP,{value:3,children:(0,e.jsx)("div",{className:"text-[#555555] text-xs font-normal",children:"code"})})]})})]})})})]})}}),(0,e.jsx)("div",{className:"h-[30px] w-1"})]})})]})},_a=Sa,Na=i(10696),Fa=i(27842),Ma=function(){var m,me,V,G,F=(0,p.useIntl)(),Ae=(0,h.useRef)(null),ue=N.Z.useForm(),_e=r()(ue,1),J=_e[0],n=N.Z.useForm(),I=r()(n,1),C=I[0],D=N.Z.useForm(),Ce=r()(D,1),ge=Ce[0],We=N.Z.useForm(),de=r()(We,1),Ne=de[0],ke=(0,h.useState)(null),Ee=r()(ke,2),S=Ee[0],he=Ee[1],De=(0,h.useState)(0),ve=r()(De,2),c=ve[0],ce=ve[1],E=(0,h.useState)(null),ne=r()(E,2),H=ne[0],q=ne[1],xe=(0,h.useState)(null),Le=r()(xe,2),be=Le[0],Fe=Le[1],Oe=(0,h.useState)(null),Me=r()(Oe,2),Ie=Me[0],U=Me[1],k=(0,h.useState)(null),P=r()(k,2),W=P[0],Q=P[1],O=(0,h.useState)(null),ye=r()(O,2),Re=ye[0],Nt=ye[1],rt=(0,h.useState)(null),ot=r()(rt,2),Ze=ot[0],Ue=ot[1],ut=(0,h.useState)(null),Ye=r()(ut,2),Ft=Ye[0],Gt=Ye[1],dt=(0,h.useState)(null),tt=r()(dt,2),at=tt[0],Mt=tt[1],ct=(0,h.useState)(null),fe=r()(ct,2),ee=fe[0],Zt=fe[1],ft=(0,h.useState)("1"),Pt=r()(ft,2),pe=Pt[0],ze=Pt[1],Ct=(0,h.useState)(null),kt=r()(Ct,2),Ht=kt[0],pt=kt[1],Et=(0,h.useState)(null),Dt=r()(Et,2),Xt=Dt[0],Tt=Dt[1],At=(0,h.useState)(null),mt=r()(At,2),gt=mt[0],st=mt[1],Jt=(0,h.useState)(null),ht=r()(Jt,2),Ke=ht[0],vt=ht[1],Lt=(0,h.useState)(!0),xt=r()(Lt,2),bt=xt[0],l=xt[1],s=(0,h.useState)({first:!1,second:!1,fourthly:!1}),b=r()(s,2),y=b[0],te=b[1],je=[{key:"1",icon:(0,e.jsx)(ae.Z,{}),label:F.formatMessage({id:"agent.menu.basicsetup"}),disabled:y.first,style:{padding:"15px",width:"100%",margin:"0px",marginBottom:"10px",fontSize:"16px",fontWeight:"500",lineHeight:"22px",color:pe=="1"?"#1B64F3":"#213044"}},{key:"2",disabled:y.second,icon:(0,e.jsx)(z.Z,{}),label:F.formatMessage({id:"agent.menu.Capacityoutput"}),style:{padding:"15px",width:"100%",margin:"0px",marginBottom:"10px",fontSize:"16px",lineHeight:"22px",fontWeight:"500",color:pe=="2"?"#1B64F3":"#213044"}},{key:"5",disabled:y.fourthly,icon:(0,e.jsx)(T.Z,{}),label:F.formatMessage({id:"app.dashboard.run_log_agent"}),style:{padding:"15px",width:"100%",margin:"0px",marginBottom:"10px",fontSize:"16px",lineHeight:"22px",fontWeight:"500",color:pe=="5"?"#1B64F3":"#213044"}}],yt=function(){var g=F.formatMessage({id:"agent.inputvariable.default.display"}),o=new M.Kr("input","",""),f=new M._w("default_var","string","",g,!0,48);return o.addProperty("default_var",f),o.toObject()};(0,h.useEffect)(function(){var L=new URLSearchParams(window.location.search);L.get("app_id")||(te(a()(a()({},y),{},{first:!1,second:!0,fourthly:!0})),l(!1)),Be()},[]);var Be=function(){var L=R()(_()().mark(function g(o){var f,j,Z,d,w,ie,He,le,Xe,nt;return _()().wrap(function(X){for(;;)switch(X.prev=X.next){case 0:if(Z=new URLSearchParams(window.location.search),Z.get("from")&&Tt(Z.get("from")),d=null,!(Z.get("app_id")||o)){X.next=10;break}return X.next=6,(0,x.ek)(o||Z.get("app_id"),Z.get("type"));case 6:d=X.sent,vt(d.data.app.app_id),X.next=13;break;case 10:return X.next=12,(0,$.cI)();case 12:d=X.sent;case 13:w=d.data,(!w.agent.input_variables||Bt().isEmpty((f=w.agent.input_variables)===null||f===void 0?void 0:f.properties))&&(ie=F.formatMessage({id:"agent.inputvariable.default.display"}),w.agent.input_variables=(0,$.B8)(ie)),He=(j=d.data)===null||j===void 0||(j=j.agent_dataset_relation_list)===null||j===void 0?void 0:j.map(function(A){return A.dataset_id}),q(He),d.data.callable_items&&(d.data.agent.selected_skills=[],d.data.agent.selected_workflows=[],d.data.callable_items.forEach(function(A){A.item_type==1?d.data.agent.selected_skills.push(a()(a()({},A),{},{mode:4})):d.data.agent.selected_workflows.push(a()(a()({},A),{},{mode:2}))})),he(d.data),Zt(d.data.agent.publish_status===0&&d.data.is_creator===1?"false":"true"),d.data.agent.publish_status===1&&B.ZP.warning(F.formatMessage({id:"agent.message.listwarning"}),5),J.setFieldsValue(Ge(w.agent.input_variables)),le=d.data.agent_abilities_list.map(function(A){return A.status==1?a()(a()({},A),{},{status:!0}):a()(a()({},A),{},{status:!1})}),ge.setFieldsValue({users:le[0]?le:[{agent_ability_id:0,name:"",content:"",status:!0,output_format:0}]}),U(Ot(w.agent_abilities_list)),Q(Ot(w.agent_abilities_list)),Xe=w.agent_abilities_list.filter(function(A){return A.output_format!==0}),C.setFieldsValue({users:Xe.map(function(A){return{agent_ability_id:A.agent_ability_id,output_format:A.output_format}})}),Ne.setFieldsValue(Ge(w.agent.input_variables)),Nt(w.m_configurations_list.map(function(A){return{value:A.m_config_id?A.m_config_id:A.model_config_id,label:A.m_name?A.m_name:A.model_name}})),w.agent.m_config_id||w.agent.model_config_id?Ue(w.agent.m_config_id?w.agent.m_config_id:w.agent.model_config_id):Ue(w.m_configurations_list[0].model_config_id),nt=w.agent_abilities_list.filter(function(A,Ra){return A.status===1}),Mt(Ot(nt).concat([{value:0,label:F.formatMessage({id:"agent.allability"})}])),l(!1);case 34:case"end":return X.stop()}},g)}));return function(o){return L.apply(this,arguments)}}(),Ge=function(g){var o={users:g&&g.properties?Object.values(g.properties).map(function(f){return a()({name:f.name,type:f.type,content:f.display_name,status:f.required},f)}):[{name:"",content:"",type:"string",agent_ability_id:0,output_format:0,status:0}]};return o},Ot=function(g){return g.map(function(o){return{value:o.agent_ability_id,label:o.name}})},Pa=function(g){sa(g,1),Ne.setFieldsValue(J.getFieldsValue())},Ca=function(){Be()},Qt=function(g){ce(g)},ka=function(){p.history.back()},qt=function(){if(!S.agent.input_variables)return B.ZP.warning(F.formatMessage({id:"agent.message.warning.variable"})),!0;if(Bt().isEmpty(S.agent.input_variables.properties))return B.ZP.warning(F.formatMessage({id:"agent.message.warning.variable"})),!0;if(Ze)if(S.agent.obligations){if(Ta(J.getFieldsValue().users,"name"))return B.ZP.warning(F.formatMessage({id:"agent.message.warning.repetition"})),!0}else return B.ZP.warning(F.formatMessage({id:"agent.message.warning.functiondescribe"})),!0;else return B.ZP.warning(F.formatMessage({id:"agent.message.warning.LLM"})),!0;return!1},ea=function(){var g=ge.getFieldsValue().users.filter(function(f){return!!f}),o=g.filter(function(f){return!f.name||!f.content});return o.length!==0&&!(o.length==1&&o[0].name==""&&o[0].content=="")?(B.ZP.warning(F.formatMessage({id:"agent.message.warning.integritycapacity"})),!0):!1},ta=function(g){if((g==null?void 0:g.key)=="4"){var o=J.getFieldsValue().users.map(function(f){return{value:"<<".concat(v.qX,".inputs.").concat(f.name,">>"),label:f.name}});pt(o)}ze(g.key)},aa=function(){l(!0);var g=0;return new Promise(function(o){var f=function(Z){return(0,x.ek)(Z,!1).then(function(){var d=R()(_()().mark(function w(ie){return _()().wrap(function(le){for(;;)switch(le.prev=le.next){case 0:return g=ie.data.agent.agent_id,le.next=3,Ea(g);case 3:return Ke||p.history.replace("/Agents?app_id=".concat(Z,"&type=false")),Da(g).then(function(Xe){B.ZP.success(F.formatMessage({id:"skill.conserve.success"})),setTimeout(function(){if(Be(Z),!Ke){var nt=a()(a()({},(0,$.Go)("GET")),{},{app_id:Z});(0,$.Go)("SET",nt)}},1e3),st(g)}),le.abrupt("return",ie);case 6:case"end":return le.stop()}},w)}));return function(w){return d.apply(this,arguments)}}()).catch(function(){return""})};Ke?f(Ke).then(function(j){return o(j)}).catch(function(j){console.error("Error during agent update:",j),o("")}):(0,u.uy)((0,$.Go)("GET")).then(function(j){vt(j.data.app_id),f(j.data.app_id).then(function(Z){return o(Z)}).catch(function(Z){console.error("Error during agent creation:",Z),o("")})}).catch(function(j){console.error("Error creating app:",j),l(!1),o("")})})},Ea=function(g,o){return new Promise(function(f,j){J.validateFields().then(function(){var Z=R()(_()().mark(function d(w){var ie,He,le,Xe;return _()().wrap(function(Je){for(;;)switch(Je.prev=Je.next){case 0:if(He=[].concat(Y()(S.agent.selected_skills||[]),Y()(S.agent.selected_workflows||[])).map(function(X){return{app_id:X.app_id,item_type:X.mode==4?1:2}}),le={agent_id:g,data:{is_public:S.app.is_public,enable_api:S.app.enable_api,attrs_are_visible:S.app.attrs_are_visible,obligations:S.agent.obligations,input_variables:S.agent.input_variables?S.agent.input_variables:Aa(J.getFieldsValue()),dataset_ids:H,m_config_id:Ze,allow_upload_file:S.agent.allow_upload_file,default_output_format:S.agent.default_output_format,callable_list:He}},ee!="false"){Je.next=5;break}return Je.next=5,sa(le,1);case 5:Ne.setFieldsValue(J.getFieldsValue()),Xe=((ie=J.getFieldsValue())===null||ie===void 0||(ie=ie.users)===null||ie===void 0?void 0:ie.map(function(X){return{value:"<<".concat(v.qX,".inputs.").concat(X.name,">>"),label:X.name}}))||[],pt(Xe),o&&ze(o.key),f();case 10:case"end":return Je.stop()}},d)}));return function(d){return Z.apply(this,arguments)}}()).catch(function(Z){j(Z)})})},Da=function(g){return new Promise(function(o,f){var j=ge.getFieldsValue().users.filter(function(w){return!!w}),Z=j.map(function(w){return a()(a()({},w),{},{status:w.status==!1?2:1,agent_ability_id:w.agent_ability_id?w.agent_ability_id:0,output_format:w.output_format?w.output_format:0})}),d={agent_id:g,data:{auto_match_ability:S.agent.auto_match_ability,agent_abilities:Z}};ee=="false"?Z.length==1&&Z[0].name==""&&Z[0].content==""?(te({first:!1,second:!1,fourthly:!1}),o()):(0,x.Iw)(d).then(function(w){w.code==0?(te({first:!1,second:!1,fourthly:!1}),o()):f(new Error("API call failed with code: ".concat(w.code)))}).catch(function(w){f(w)}):o()})},sa=function(){var L=R()(_()().mark(function g(o,f){var j;return _()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:if(ee!=="false"){d.next=19;break}if(f!==1){d.next=7;break}return d.next=4,(0,x.XB)(o);case 4:d.t0=d.sent,d.next=17;break;case 7:if(f!==2){d.next=13;break}return d.next=10,(0,x.Iw)(o);case 10:d.t1=d.sent,d.next=16;break;case 13:return d.next=15,(0,x.Ce)(o);case 15:d.t1=d.sent;case 16:d.t0=d.t1;case 17:j=d.t0,j&&j.code===0&&l(!1);case 19:return d.abrupt("return",!0);case 20:case"end":return d.stop()}},g)}));return function(o,f){return L.apply(this,arguments)}}(),Ta=function(g,o){var f=new Set;return g.some(function(j){var Z=j[o];return f.has(Z)?f.add(Z):f.add(Z)&&!1})},Aa=function(g){var o=new M.Kr("input","","");return g.users.forEach(function(f){var j=new M._w(f.name,f.type?f.type:"string",f.value?f.value:"",f.content,f.status);o.addProperty(f.name,j)}),o};return(0,e.jsxs)("div",{className:" flex bg-white",style:{height:"calc(100vh - 56px)"},children:[(0,e.jsxs)("div",{className:"flex flex-col w-[300px]",style:{height:"calc(100vh - 56px)"},children:[(0,e.jsx)("div",{className:"flex w-full items-center bg-white px-[30px] pt-[30px] border-[#e5e7eb] border-solid border-r",children:(0,e.jsxs)(oe.ZP,{type:"link",shape:"circle",size:"middle",className:"",onClick:ka,children:[(0,e.jsx)(K.Z,{}),(0,e.jsx)("span",{className:"text-sm font-medium text-[#213044]",children:Xt=="chat_room"?F.formatMessage({id:"agent.back_meeting"}):F.formatMessage({id:"agent.back"})})]})}),(0,e.jsxs)("div",{className:"w-full flex-1 px-[30px] py-[30px] bg-white border-[#e5e7eb] border-solid border-r",children:[(0,e.jsx)(na.Z,{selectedKeys:[pe],onClick:ta,style:{width:"100%",borderInlineEnd:"1px solid rgba(0,0,0,0)"},defaultSelectedKeys:[pe],mode:"inline",items:je}),S&&((m=S.app)===null||m===void 0?void 0:m.enable_api)===1&&((me=S.app)===null||me===void 0?void 0:me.publish_status)===1?(0,e.jsx)("div",{className:"w-full h-[40px] rounded-lg text-[#000] hover:bg-[#f0f0f0] p-[12px] pl-[16px] cursor-pointer",onClick:R()(_()().mark(function L(){var g,o;return _()().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:if(g=new URLSearchParams(window.location.search),o=null,!g.get("app_id")){j.next=6;break}return j.next=5,(0,x.ek)(g.get("app_id"),g.get("type"));case 5:o=j.sent;case 6:o!=null&&o.data.app.enable_api===1&&o.data.app.publish_status===1?window.open(t._n+S.app.api_url):B.ZP.warning(F.formatMessage({id:"agent.save.and.click"}),5);case 7:case"end":return j.stop()}},L)})),children:(0,e.jsxs)("div",{className:"mr-[20px] text-base font-medium text-[#213044] -mt-1",children:[(0,e.jsx)(Pe.Z,{className:"mr-3"}),F.formatMessage({id:"agent.visit"})," API"]})}):null]})]}),(0,e.jsx)("div",{className:"flex-1 relative w-[calc(100%-300px)]",children:(0,e.jsxs)(jt.Z,{style:{height:"100%",boxShadow:"0 0 10px rgba(0, 0, 0, 0.1)"},children:[(0,e.jsx)(jt.Z.Panel,{defaultSize:"50%",min:"40%",max:"70%",children:(0,e.jsx)(Rt.Z,{spinning:bt,size:"large",className:"mt-[112px] mr-4",children:(0,e.jsx)("div",{className:"flex flex-col",style:{height:"calc(100vh - 56px)",overflowY:"scroll",scrollbarWidth:"none"},children:(0,e.jsxs)("div",{className:"px-[30px] ",style:{overflowX:"auto",height:"100%"},children:[(0,e.jsx)("div",{className:"w-full flex justify-center  mt-[30px]",children:(0,e.jsxs)("div",{className:"flex items-center w-full ",children:[(0,e.jsx)("div",{className:"mr-[10px] w-[16px] h-[16px]",children:(0,e.jsx)("img",{src:"/icons/flag.svg",alt:"",className:"w-[16px] h-[16px]"})}),(0,e.jsxs)("div",{className:"flex items-center",children:[(0,e.jsxs)("div",{className:"mr-[6px] text-lg text-[#213044] font-medium",children:[(V=(0,$.Go)("GET"))!==null&&V!==void 0&&V.app_id?F.formatMessage({id:"agent.compile"}):F.formatMessage({id:"agent.created"})," ",F.formatMessage({id:"agent"})]}),(S==null||(G=S.app)===null||G===void 0?void 0:G.publish_status)===1?(0,e.jsx)("div",{className:"bg-[#1B64F3] px-[7px] text-[#fff] rounded font-normal text-xs flex items-center justify-center h-[18px]",children:F.formatMessage({id:"agent.havepublished"})}):(0,e.jsx)("div",{className:" bg-[#EEE] px-[7px]  text-[#999] rounded font-normal text-xs flex items-center justify-center h-[18px]",children:F.formatMessage({id:"agent.unpublish"})})]})]})}),(0,e.jsx)("div",{style:{display:pe==="1"?"flex":"none",height:"calc(100vh - 146px)",justifyContent:"center"},children:!bt&&(0,e.jsx)(ca,{FirstValue:Pa,Ffromref:J,Detaillist:S,setDetaillist:he,repository:H,setRepository:q,Newproperties:be,setNewproperties:Fe,Operationbentate:ee,Fourthly_config_id:Ze,setFourthly_config_id:Ue,Fourthly_select_list:Re,pageKeyfun:ze,firstjudgingcondition:qt,agentmenudisabled:y,setAgentmunudisabled:te})}),(0,e.jsx)("div",{style:{display:pe==="2"?"flex":"none",height:"calc(100vh - 146px)",justifyContent:"center",position:"sticky",top:"-150px"},children:(0,e.jsx)(_a,{SecondValue:Ca,Detaillist:S,setDetaillist:he,Sformref:ge,Operationbentate:ee,handleBack:Qt,pageKeyfun:ze,SkillMenuClick:ta,secondjudgingcondition:ea,agentupdata:aa})}),(0,e.jsx)("div",{style:{display:pe==="4"?"flex":"none",height:"calc(100vh - 146px)",justifyContent:"center"},children:(0,e.jsx)(ya,{handleBack:Qt,Detaillist:S,setDetaillist:he,Fourthly_select_list:Re,Fourthly_config_id:Ze,setFourthly_config_id:Ue,Fourthlyref:Ne,Fourthly_abilities_list:at,Operationbentate:ee,callwordlist:Ht,newagentid:gt})})]})})})}),(0,e.jsx)(jt.Z.Panel,{children:(0,e.jsx)("div",{children:(0,e.jsx)(Na.Z,{saveInfo:{firstjudgingcondition:qt,secondjudgingcondition:ea,agentupdata:aa},operationbentate:ee,data:{abilitiesList:at,detailList:S}})})}),pe=="5"&&(0,e.jsx)("div",{className:"absolute bottom-0 left-0 right-0 bg-slate-50 w-full h-full z-10",children:(0,e.jsx)(Fa.ZP,{agent_id:S.agent.agent_id})})]})})]})},Za=Ma},58533:function(It,Ve,i){var we=i(67294);var Y=function(r,x){return Y=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,t){u.__proto__=t}||function(u,t){for(var v in t)t.hasOwnProperty(v)&&(u[v]=t[v])},Y(r,x)};function Qe(r,x){Y(r,x);function u(){this.constructor=r}r.prototype=x===null?Object.create(x):(u.prototype=x.prototype,new u)}var _=function(){return _=Object.assign||function(x){for(var u,t=1,v=arguments.length;t<v;t++){u=arguments[t];for(var M in u)Object.prototype.hasOwnProperty.call(u,M)&&(x[M]=u[M])}return x},_.apply(this,arguments)};function re(r,x,u,t){var v,M=!1,$=0;function ae(){v&&clearTimeout(v)}function z(){ae(),M=!0}typeof x!="boolean"&&(t=u,u=x,x=void 0);function T(){var K=this,Pe=Date.now()-$,p=arguments;if(M)return;function N(){$=Date.now(),u.apply(K,p)}function B(){v=void 0}t&&!v&&N(),ae(),t===void 0&&Pe>r?N():x!==!0&&(v=setTimeout(t?B:N,t===void 0?r-Pe:r))}return T.cancel=z,T}var R={Pixel:"Pixel",Percent:"Percent"},$e={unit:R.Percent,value:.8};function a(r){return typeof r=="number"?{unit:R.Percent,value:r*100}:typeof r=="string"?r.match(/^(\d*(\.\d+)?)px$/)?{unit:R.Pixel,value:parseFloat(r)}:r.match(/^(\d*(\.\d+)?)%$/)?{unit:R.Percent,value:parseFloat(r)}:(console.warn('scrollThreshold format is invalid. Valid formats: "120px", "50%"...'),$e):(console.warn("scrollThreshold should be string or number"),$e)}var qe=function(r){Qe(x,r);function x(u){var t=r.call(this,u)||this;return t.lastScrollTop=0,t.actionTriggered=!1,t.startY=0,t.currentY=0,t.dragging=!1,t.maxPullDownDistance=0,t.getScrollableTarget=function(){return t.props.scrollableTarget instanceof HTMLElement?t.props.scrollableTarget:typeof t.props.scrollableTarget=="string"?document.getElementById(t.props.scrollableTarget):(t.props.scrollableTarget===null&&console.warn(`You are trying to pass scrollableTarget but it is null. This might
        happen because the element may not have been added to DOM yet.
        See https://github.com/ankeetmaini/react-infinite-scroll-component/issues/59 for more info.
      `),null)},t.onStart=function(v){t.lastScrollTop||(t.dragging=!0,v instanceof MouseEvent?t.startY=v.pageY:v instanceof TouchEvent&&(t.startY=v.touches[0].pageY),t.currentY=t.startY,t._infScroll&&(t._infScroll.style.willChange="transform",t._infScroll.style.transition="transform 0.2s cubic-bezier(0,0,0.31,1)"))},t.onMove=function(v){t.dragging&&(v instanceof MouseEvent?t.currentY=v.pageY:v instanceof TouchEvent&&(t.currentY=v.touches[0].pageY),!(t.currentY<t.startY)&&(t.currentY-t.startY>=Number(t.props.pullDownToRefreshThreshold)&&t.setState({pullToRefreshThresholdBreached:!0}),!(t.currentY-t.startY>t.maxPullDownDistance*1.5)&&t._infScroll&&(t._infScroll.style.overflow="visible",t._infScroll.style.transform="translate3d(0px, "+(t.currentY-t.startY)+"px, 0px)")))},t.onEnd=function(){t.startY=0,t.currentY=0,t.dragging=!1,t.state.pullToRefreshThresholdBreached&&(t.props.refreshFunction&&t.props.refreshFunction(),t.setState({pullToRefreshThresholdBreached:!1})),requestAnimationFrame(function(){t._infScroll&&(t._infScroll.style.overflow="auto",t._infScroll.style.transform="none",t._infScroll.style.willChange="unset")})},t.onScrollListener=function(v){typeof t.props.onScroll=="function"&&setTimeout(function(){return t.props.onScroll&&t.props.onScroll(v)},0);var M=t.props.height||t._scrollableNode?v.target:document.documentElement.scrollTop?document.documentElement:document.body;if(!t.actionTriggered){var $=t.props.inverse?t.isElementAtTop(M,t.props.scrollThreshold):t.isElementAtBottom(M,t.props.scrollThreshold);$&&t.props.hasMore&&(t.actionTriggered=!0,t.setState({showLoader:!0}),t.props.next&&t.props.next()),t.lastScrollTop=M.scrollTop}},t.state={showLoader:!1,pullToRefreshThresholdBreached:!1,prevDataLength:u.dataLength},t.throttledOnScrollListener=re(150,t.onScrollListener).bind(t),t.onStart=t.onStart.bind(t),t.onMove=t.onMove.bind(t),t.onEnd=t.onEnd.bind(t),t}return x.prototype.componentDidMount=function(){if(typeof this.props.dataLength=="undefined")throw new Error('mandatory prop "dataLength" is missing. The prop is needed when loading more content. Check README.md for usage');if(this._scrollableNode=this.getScrollableTarget(),this.el=this.props.height?this._infScroll:this._scrollableNode||window,this.el&&this.el.addEventListener("scroll",this.throttledOnScrollListener),typeof this.props.initialScrollY=="number"&&this.el&&this.el instanceof HTMLElement&&this.el.scrollHeight>this.props.initialScrollY&&this.el.scrollTo(0,this.props.initialScrollY),this.props.pullDownToRefresh&&this.el&&(this.el.addEventListener("touchstart",this.onStart),this.el.addEventListener("touchmove",this.onMove),this.el.addEventListener("touchend",this.onEnd),this.el.addEventListener("mousedown",this.onStart),this.el.addEventListener("mousemove",this.onMove),this.el.addEventListener("mouseup",this.onEnd),this.maxPullDownDistance=this._pullDown&&this._pullDown.firstChild&&this._pullDown.firstChild.getBoundingClientRect().height||0,this.forceUpdate(),typeof this.props.refreshFunction!="function"))throw new Error(`Mandatory prop "refreshFunction" missing.
          Pull Down To Refresh functionality will not work
          as expected. Check README.md for usage'`)},x.prototype.componentWillUnmount=function(){this.el&&(this.el.removeEventListener("scroll",this.throttledOnScrollListener),this.props.pullDownToRefresh&&(this.el.removeEventListener("touchstart",this.onStart),this.el.removeEventListener("touchmove",this.onMove),this.el.removeEventListener("touchend",this.onEnd),this.el.removeEventListener("mousedown",this.onStart),this.el.removeEventListener("mousemove",this.onMove),this.el.removeEventListener("mouseup",this.onEnd)))},x.prototype.componentDidUpdate=function(u){this.props.dataLength!==u.dataLength&&(this.actionTriggered=!1,this.setState({showLoader:!1}))},x.getDerivedStateFromProps=function(u,t){var v=u.dataLength!==t.prevDataLength;return v?_(_({},t),{prevDataLength:u.dataLength}):null},x.prototype.isElementAtTop=function(u,t){t===void 0&&(t=.8);var v=u===document.body||u===document.documentElement?window.screen.availHeight:u.clientHeight,M=a(t);return M.unit===R.Pixel?u.scrollTop<=M.value+v-u.scrollHeight+1:u.scrollTop<=M.value/100+v-u.scrollHeight+1},x.prototype.isElementAtBottom=function(u,t){t===void 0&&(t=.8);var v=u===document.body||u===document.documentElement?window.screen.availHeight:u.clientHeight,M=a(t);return M.unit===R.Pixel?u.scrollTop+v>=u.scrollHeight-M.value:u.scrollTop+v>=M.value/100*u.scrollHeight},x.prototype.render=function(){var u=this,t=_({height:this.props.height||"auto",overflow:"auto",WebkitOverflowScrolling:"touch"},this.props.style),v=this.props.hasChildren||!!(this.props.children&&this.props.children instanceof Array&&this.props.children.length),M=this.props.pullDownToRefresh&&this.props.height?{overflow:"auto"}:{};return we.createElement("div",{style:M,className:"infinite-scroll-component__outerdiv"},we.createElement("div",{className:"infinite-scroll-component "+(this.props.className||""),ref:function($){return u._infScroll=$},style:t},this.props.pullDownToRefresh&&we.createElement("div",{style:{position:"relative"},ref:function($){return u._pullDown=$}},we.createElement("div",{style:{position:"absolute",left:0,right:0,top:-1*this.maxPullDownDistance}},this.state.pullToRefreshThresholdBreached?this.props.releaseToRefreshContent:this.props.pullDownToRefreshContent)),this.props.children,!this.state.showLoader&&!v&&this.props.hasMore&&this.props.loader,this.state.showLoader&&this.props.hasMore&&this.props.loader,!this.props.hasMore&&this.props.endMessage))},x}(we.Component);Ve.Z=qe}}]);
