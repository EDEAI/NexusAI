"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[316],{11475:function(ne,I,a){a.d(I,{Z:function(){return b}});var D=a(1413),M=a(67294),h={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}},{tag:"path",attrs:{d:"M464 688a48 48 0 1096 0 48 48 0 10-96 0zm24-112h48c4.4 0 8-3.6 8-8V296c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v272c0 4.4 3.6 8 8 8z"}}]},name:"exclamation-circle",theme:"outlined"},A=h,Z=a(91146),L=function(V,F){return M.createElement(Z.Z,(0,D.Z)((0,D.Z)({},V),{},{ref:F,icon:A}))},O=M.forwardRef(L),b=O},35790:function(ne,I,a){var D=a(1413),M=a(67294),h=a(19369),A=a(91146),Z=function(b,B){return M.createElement(A.Z,(0,D.Z)((0,D.Z)({},b),{},{ref:B,icon:h.Z}))},L=M.forwardRef(Z);I.Z=L},44261:function(ne,I,a){a.r(I),a.d(I,{default:function(){return Te}});var D=a(56264),M=a(64456),h=a(67294),A=a(15009),Z=a.n(A),L=a(99289),O=a.n(L),b=a(97857),B=a.n(b),V=a(5574),F=a.n(V),J=a(42237),E=a(29608),ue=a(35790),ve=a(11475),fe=a(8751),ge=a(97578),re=a(77598),P=a(97582),Q=a(22638),pe=a(3917),me=function(v,r){var s;r===void 0&&(r={});var j=r.defaultPageSize,g=j===void 0?10:j,l=r.defaultCurrent,d=l===void 0?1:l,p=(0,P._T)(r,["defaultPageSize","defaultCurrent"]),i=(0,pe.Z)(v,(0,P.pi)({defaultParams:[{current:d,pageSize:g}],refreshDepsAction:function(){N(1)}},p)),m=i.params[0]||{},f=m.current,S=f===void 0?1:f,o=m.pageSize,c=o===void 0?g:o,t=((s=i.data)===null||s===void 0?void 0:s.total)||0,w=(0,h.useMemo)(function(){return Math.ceil(t/c)},[c,t]),x=function(u,W){var T=u<=0?1:u,H=W<=0?1:W,U=Math.ceil(t/H);T>U&&(T=Math.max(1,U));var $=(0,P.CR)(i.params||[]),y=$[0],K=y===void 0?{}:y,ae=$.slice(1);i.run.apply(i,(0,P.ev)([(0,P.pi)((0,P.pi)({},K),{current:T,pageSize:H})],(0,P.CR)(ae),!1))},N=function(u){x(u,c)},z=function(u){x(S,u)};return(0,P.pi)((0,P.pi)({},i),{pagination:{current:S,pageSize:c,total:t,totalPage:w,onChange:(0,Q.Z)(x),changeCurrent:(0,Q.Z)(N),changePageSize:(0,Q.Z)(z)}})},X=me,Y=a(78697),q=a(32332),R=a(35312),se=a(74330),ie=a(83062),_=a(32983),xe=a(29432),he=a(72252),le=a(71471),e=a(85893),ee=function(r){var s=r.iconSrc,j=r.titleText,g=r.pagination,l=(0,R.useIntl)();return(0,e.jsxs)("div",{className:"flex items-center gap-4",children:[(0,e.jsx)("img",{src:s,alt:""}),(0,e.jsx)("div",{children:j}),(0,e.jsx)("div",{children:(0,e.jsx)(he.Z,{size:"small",simple:!0,showTotal:function(p,i){return"".concat(l.formatMessage({id:"app.workflow.title.1"})).concat(i[0],"-").concat(i[1]).concat(l.formatMessage({id:"app.workflow.title.2"})," / ").concat(l.formatMessage({id:"app.workflow.title.3"})).concat(p," ").concat(l.formatMessage({id:"app.workflow.title.2"}))},current:g.current,pageSize:g.pageSize,onShowSizeChange:null,total:g.total,onChange:g.onChange})})]})},je=function(r){var s=r.item;console.log(s);var j=(0,R.useIntl)(),g="/icons/creation/",l="",d="";switch(s.type){case 1:d=j.formatMessage({id:"app.itemHeader.agent"}),l="Agent";break;case 2:d=j.formatMessage({id:"app.itemHeader.chatRoom"}),l="ChatRoom";break;case 3:d=j.formatMessage({id:"app.itemHeader.workFlow"}),l="WorkFlow";break;default:break}return g+=xe.Le[l],(0,e.jsxs)("div",{className:"flex gap-5 shrink-0",children:[(0,e.jsx)("div",{className:"shrink-0",children:(0,e.jsx)(Y.Z,{Image:s.type==2?"/icons/chat_room.svg":(0,q.s9)("single",s.icon),icon:"".concat(g,".svg")})}),(0,e.jsxs)("div",{className:"flex flex-col justify-center",children:[(0,e.jsx)("div",{className:"text-sm text-[#213044]",children:(0,e.jsx)(le.Z.Paragraph,{ellipsis:{rows:2,tooltip:s.name},className:"!mb-0",children:s.name})}),(0,e.jsx)("div",{className:"text-xs text-[#999999]",children:d})]})]})},Se=function(){var v,r,s=(0,E.Z)(function(n){return n.setDealtWithData}),j=(0,E.Z)(function(n){return n.prevConfirmDealtWith}),g=(0,E.Z)(function(n){return n.dealtWithData}),l=(0,E.Z)(function(n){return n.setRunPanelLogRecord}),d=(0,E.Z)(function(n){return n.submitPromptId}),p=(0,R.useIntl)(),i=(0,h.useRef)(null),m=(0,h.useState)(null),f=F()(m,2),S=f[0],o=f[1],c=(0,ge.Z)("pageNumber"),t=F()(c,2),w=t[0],x=t[1],N=function(C){console.log(C),s(C)};(0,re.Z)(function(){var n=y.list.map(function(C){return C.exec_id==j.exec_id&&(C.need_human_confirm=0),C});K(B()(B()({},y),{},{list:n}))},[j]);var z=function(){var n=O()(Z()().mark(function C(G){var ce,de,te;return Z()().wrap(function(k){for(;;)switch(k.prev=k.next){case 0:return ce=G.current,de=G.pageSize,k.next=3,(0,J.VE)({current:ce,pageSize:de});case 3:return te=k.sent,k.abrupt("return",{list:te.data.list,success:!0,total:te.data.total_count});case 5:case"end":return k.stop()}},C)}));return function(G){return n.apply(this,arguments)}}(),u=X(z,{defaultPageSize:10}),W=u.data,T=u.loading,H=u.pagination,U=(0,h.useState)(W),$=F()(U,2),y=$[0],K=$[1];(0,h.useEffect)(function(){K(W)},[W]),(0,re.Z)(function(){i.current&&i.current.reload()},[d]);var ae=(0,h.useCallback)(function(n){var C=n.item;return(0,e.jsxs)("div",{className:"flex flex-col gap-1 truncate flex-1",children:[(0,e.jsxs)("div",{children:[(0,e.jsx)("span",{children:C.app_name})," ",(0,e.jsx)(ue.Z,{}),(0,e.jsx)("span",{className:C.need_human_confirm==1?"text-[#1B64F3]":"text-[#808183]",children:C.node_name})]}),(0,e.jsx)("div",{className:"text-[#999999] text-xs truncate",children:C.app_run_name})]})},[y]);return(0,e.jsx)(se.Z,{spinning:T,children:(0,e.jsxs)("div",{className:"min-h-[300px]",style:{height:"calc(100vh - 596px)"},children:[(0,e.jsx)(ee,{iconSrc:"/icons/back_log.svg",titleText:p.formatMessage({id:"app.workflow.backlogs.title"}),pagination:H}),(0,e.jsxs)("div",{className:"bg-white rounded-lg p-2.5 mt-4 overflow-y-auto h-full",style:{boxShadow:" 0px 2px 4px 0px rgba(0,0,0,0.05)"},children:[y==null||(v=y.list)===null||v===void 0?void 0:v.map(function(n,C){return n.type=3,(0,e.jsxs)("div",{onClick:function(){console.log(n),n.need_human_confirm&&(s(n),o(n),l(!1))},className:"flex items-center gap-5 cursor-pointer duration-200 rounded-lg  p-2.5 hover:bg-[#fafafa]",children:[(0,e.jsx)(Y.Z,{Image:(0,q.s9)("single",n.icon)}),(0,e.jsx)(ae,{item:n}),(0,e.jsx)("div",{children:n.need_human_confirm?(0,e.jsx)(ie.Z,{title:p.formatMessage({id:"workflow.needHumanConfirm"}),children:(0,e.jsx)(ve.Z,{className:"text-[#1B64F3]"})}):(0,e.jsx)(ie.Z,{title:p.formatMessage({id:"workflow.noHumanConfirm"}),children:(0,e.jsx)(fe.Z,{className:"text-[#52C41C]"})})})]},n.exec_id)}),!T&&(y==null||(r=y.list)===null||r===void 0?void 0:r.length)===0&&(0,e.jsx)("div",{className:"h-full flex items-center justify-center",children:(0,e.jsx)(_.Z,{image:"/images/empty.svg",description:p.formatMessage({id:"app.workflow.backlogs.empty"})})})]})]})})},Ce=a(29933),ye=a(4393),ke=ye.Z.Meta,Ze=function(){var v,r,s=(0,R.useIntl)(),j=function(f){console.log(f);var S=f.app_id||f.apps_id;switch(f.type){case 1:R.history.push("/Agents?app_id=".concat(S));break;case 2:R.history.push("/chat_room/".concat(f.chatroom_id));break;case 3:R.history.push("/workspace/workflow?app_id=".concat(S));break;default:break}},g=function(){var m=O()(Z()().mark(function f(S){var o,c,t;return Z()().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return o=S.current,c=S.pageSize,x.next=3,(0,J.vu)({current:o,pageSize:c});case 3:return t=x.sent,x.abrupt("return",{list:t.data.list,success:!0,total:t.data.total_count});case 5:case"end":return x.stop()}},f)}));return function(S){return m.apply(this,arguments)}}(),l=X(g,{defaultPageSize:8}),d=l.data,p=l.loading,i=l.pagination;return console.log(p),(0,e.jsxs)("div",{className:"flex-grow-0",children:[(0,e.jsx)(ee,{iconSrc:"/icons/recently_active.svg",titleText:s.formatMessage({id:"app.workflow.ra.title"}),pagination:i}),(0,e.jsx)("div",{className:"grid grid-cols-4  gap-4 mt-4",children:d==null||(v=d.list)===null||v===void 0?void 0:v.map(function(m,f){var S=m.type==3?m.process_name:m.last_agent_name;return(0,e.jsx)(Ce.Z,{className:"h-[160px] cursor-pointer transition shadow-lg shadow-gray-100 hover:shadow-gray-200",title:(0,e.jsx)(je,{item:m}),onClick:function(){return j(m)},bodyStyle:{padding:"15px 20px"},children:(0,e.jsx)(le.Z.Paragraph,{ellipsis:{rows:2,tooltip:S},children:S})},m.app_id)})}),!(d!=null&&(r=d.list)!==null&&r!==void 0&&r.length)&&(0,e.jsxs)("div",{className:"h-[400px] w-full flex items-center justify-center",children:[!p&&(0,e.jsx)(_.Z,{imageStyle:{display:"flex",justifyContent:"center"},image:"/images/empty.svg",description:s.formatMessage({id:"app.workflow.ra.empty"})}),(0,e.jsx)(se.Z,{spinning:p})]})]})},oe=a(1413),Ne=a(99011),Pe=a(91146),we=function(r,s){return h.createElement(Pe.Z,(0,oe.Z)((0,oe.Z)({},r),{},{ref:s,icon:Ne.Z}))},Re=h.forwardRef(we),ze=Re,De=a(88284),Me=a(28058),Ee=a(44720),Ie=a(38703),Oe=(0,h.memo)(function(){var v,r,s=(0,E.Z)(function(o){return o.setDealtWithData}),j=(0,E.Z)(function(o){return o.setRunPanelLogRecord}),g=(0,R.useIntl)(),l=function(c){var t=c.text;switch(t){case 1:return(0,e.jsx)(ze,{className:"text-blue-500"});case 2:return(0,e.jsx)(De.Z,{className:"text-green-500"});case 3:return(0,e.jsx)(Me.Z,{className:"text-red-500"})}return(0,e.jsx)("span",{children:t})},d=function(){var o=O()(Z()().mark(function c(t){var w,x,N;return Z()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return w=t.current,x=t.pageSize,u.next=3,(0,J.PE)({current:w,pageSize:x});case 3:return N=u.sent,u.abrupt("return",{list:N.data.list,success:!0,total:N.data.total_count});case 5:case"end":return u.stop()}},c)}));return function(t){return o.apply(this,arguments)}}(),p=X(d,{defaultPageSize:10}),i=p.data,m=p.loading,f=p.pagination,S=(0,h.memo)(function(o){var c,t=o.item,w=t.status==1?"#1B64F3":t.status==2?"#22C55F":"#F04444",x=t.status==1?"#f9fafe":t.status==2?"#f6fcf3":"#fafafa",N=(0,h.useRef)(null),z=(0,Ee.Z)(N);return(0,e.jsxs)("div",{onClick:function(){j(t),s(null)},ref:N,className:"flex relative rounded truncate gap-5  items-center shrink-0 cursor-pointer duration-200  box-border py-2.5 pr-5 ",children:[(0,e.jsx)("div",{style:{backgroundColor:z?x:"",width:z?"".concat(t.completed_steps/t.total_steps*100,"%"):"0%",transition:"0.5s"},className:"w-full h-full absolute left-0 duration-500"}),(0,e.jsx)("div",{style:{backgroundColor:w},className:"w-[4px] h-full z-10 mr-[10px] absolute"}),(0,e.jsx)("div",{className:"ml-5",children:(0,e.jsx)(Y.Z,{Image:(0,q.s9)("single",t.icon)})}),(0,e.jsxs)("div",{className:"flex flex-col gap-1 truncate flex-1  z-10",children:[(0,e.jsx)("div",{children:(0,e.jsx)("span",{children:t.app_runs_name})}),(0,e.jsx)("div",{className:"text-[#999999] text-xs truncate  max-w-7/8",children:(0,e.jsxs)("div",{className:"flex items-center truncate",children:[(0,e.jsxs)("span",{children:[" ",t.created_time," "]}),(0,e.jsx)("span",{style:{maxWidth:"calc(100% - 200px)"},className:"truncate ml-2 ",children:t.apps_name}),(0,e.jsxs)("span",{className:"inline-flex items-center ml-2 gap-2",children:[(0,e.jsx)("span",{style:{backgroundColor:w},className:"inline-block w-1 h-1 rounded-sm"}),(c=t.elapsed_time)===null||c===void 0?void 0:c.toFixed(6),"S"]})]})})]}),(0,e.jsx)("div",{className:"flex items-center justify-center",children:(0,e.jsx)(Ie.Z,{type:"circle",size:30,percent:parseInt(t.completed_steps/t.total_steps*100)})})]},t.app_run_id)});return(0,e.jsxs)("div",{className:"min-h-[300px]",style:{height:"calc(100vh - 596px)"},children:[(0,e.jsx)(ee,{iconSrc:"/icons/workflows.svg",titleText:g.formatMessage({id:"app.workflow.log.title"}),pagination:f}),(0,e.jsxs)("div",{className:"bg-white rounded-lg p-4 h-full mt-4 overflow-y-auto box-border relative flex flex-col gap-5",style:{boxShadow:" 0px 2px 4px 0px rgba(0,0,0,0.05)"},children:[i==null||(v=i.list)===null||v===void 0?void 0:v.map(function(o,c){return(0,e.jsx)(S,{item:o})}),!m&&(i==null||(r=i.list)===null||r===void 0?void 0:r.length)===0&&(0,e.jsx)("div",{className:"h-full flex items-center justify-center",children:(0,e.jsx)(_.Z,{image:"/images/empty.svg",description:g.formatMessage({id:"app.workflow.log.empty"})})})]})]})}),We=function(){return(0,e.jsxs)("div",{style:{height:"calc(100vh - 56px)"},className:"w-full p-[30px] flex flex-col gap-6 overflow-x-auto box-border",children:[(0,e.jsx)(Ze,{}),(0,e.jsxs)("div",{className:"grid grid-cols-2 gap-6 flex-1",children:[(0,e.jsx)(Se,{}),(0,e.jsx)(Oe,{})]}),(0,e.jsx)(D.$_,{}),(0,e.jsx)(M.Z,{})]})},Te=We}}]);
