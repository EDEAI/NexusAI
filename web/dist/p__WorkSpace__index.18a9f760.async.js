"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[316],{11475:function(re,W,a){a.d(W,{Z:function(){return B}});var D=a(1413),M=a(67294),f={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}},{tag:"path",attrs:{d:"M464 688a48 48 0 1096 0 48 48 0 10-96 0zm24-112h48c4.4 0 8-3.6 8-8V296c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v272c0 4.4 3.6 8 8 8z"}}]},name:"exclamation-circle",theme:"outlined"},L=f,Z=a(91146),A=function(J,F){return M.createElement(Z.Z,(0,D.Z)((0,D.Z)({},J),{},{ref:F,icon:L}))},E=M.forwardRef(A),B=E},35790:function(re,W,a){var D=a(1413),M=a(67294),f=a(19369),L=a(91146),Z=function(B,b){return M.createElement(L.Z,(0,D.Z)((0,D.Z)({},B),{},{ref:b,icon:f.Z}))},A=M.forwardRef(Z);W.Z=A},46569:function(re,W,a){a.r(W),a.d(W,{default:function(){return $e}});var D=a(56264),M=a(91962),f=a(67294),L=a(15009),Z=a.n(L),A=a(99289),E=a.n(A),B=a(97857),b=a.n(B),J=a(5574),F=a.n(J),Q=a(42237),O=a(29608),ve=a(35790),fe=a(11475),ge=a(8751),me=a(9577),pe=a(52982),xe=(0,me.f)(function(){return pe.Z?sessionStorage:void 0}),he=xe,se=a(77598),N=a(97582),X=a(22638),je=a(3917),Se=function(d,n){var s;n===void 0&&(n={});var j=n.defaultPageSize,m=j===void 0?10:j,l=n.defaultCurrent,u=l===void 0?1:l,p=(0,N._T)(n,["defaultPageSize","defaultCurrent"]),i=(0,je.Z)(d,(0,N.pi)({defaultParams:[{current:u,pageSize:m}],refreshDepsAction:function(){w(1)}},p)),x=i.params[0]||{},g=x.current,S=g===void 0?1:g,o=x.pageSize,c=o===void 0?m:o,t=((s=i.data)===null||s===void 0?void 0:s.total)||0,P=(0,f.useMemo)(function(){return Math.ceil(t/c)},[c,t]),h=function(v,I){var T=v<=0?1:v,U=I<=0?1:I,K=Math.ceil(t/U);T>K&&(T=Math.max(1,K));var $=(0,N.CR)(i.params||[]),y=$[0],V=y===void 0?{}:y,te=$.slice(1);i.run.apply(i,(0,N.ev)([(0,N.pi)((0,N.pi)({},V),{current:T,pageSize:U})],(0,N.CR)(te),!1))},w=function(v){h(v,c)},R=function(v){h(S,v)};return(0,N.pi)((0,N.pi)({},i),{pagination:{current:S,pageSize:c,total:t,totalPage:P,onChange:(0,X.Z)(h),changeCurrent:(0,X.Z)(w),changePageSize:(0,X.Z)(R)}})},Y=Se,q=a(78697),_=a(32332),z=a(35312),ie=a(74330),le=a(83062),ee=a(32983),Ce=a(29432),ye=a(72252),oe=a(71471),e=a(85893),ae=function(n){var s=n.iconSrc,j=n.titleText,m=n.pagination,l=(0,z.useIntl)();return(0,e.jsxs)("div",{className:"flex items-center gap-4",children:[(0,e.jsx)("img",{src:s,alt:""}),(0,e.jsx)("div",{children:j}),(0,e.jsx)("div",{children:(0,e.jsx)(ye.Z,{size:"small",simple:!0,showTotal:function(p,i){return"".concat(l.formatMessage({id:"app.workflow.title.1"})).concat(i[0],"-").concat(i[1]).concat(l.formatMessage({id:"app.workflow.title.2"})," / ").concat(l.formatMessage({id:"app.workflow.title.3"})).concat(p," ").concat(l.formatMessage({id:"app.workflow.title.2"}))},current:m.current,pageSize:m.pageSize,onShowSizeChange:null,total:m.total,onChange:m.onChange})})]})},Ze=function(n){var s=n.item;console.log(s);var j=(0,z.useIntl)(),m="/icons/creation/",l="",u="";switch(s.type){case 1:u=j.formatMessage({id:"app.itemHeader.agent"}),l="Agent";break;case 2:u=j.formatMessage({id:"app.itemHeader.chatRoom"}),l="ChatRoom";break;case 3:u=j.formatMessage({id:"app.itemHeader.workFlow"}),l="WorkFlow";break;default:break}return m+=Ce.Le[l],(0,e.jsxs)("div",{className:"flex gap-5 shrink-0",children:[(0,e.jsx)("div",{className:"shrink-0",children:(0,e.jsx)(q.Z,{Image:s.type==2?"/icons/chat_room.svg":(0,_.s9)("single",s.icon),icon:"".concat(m,".svg")})}),(0,e.jsxs)("div",{className:"flex flex-col justify-center",children:[(0,e.jsx)("div",{className:"text-sm text-[#213044]",children:(0,e.jsx)(oe.Z.Paragraph,{ellipsis:{rows:2,tooltip:s.name},className:"!mb-0",children:s.name})}),(0,e.jsx)("div",{className:"text-xs text-[#999999]",children:u})]})]})},we=function(){var d,n,s=(0,O.Z)(function(r){return r.setDealtWithData}),j=(0,O.Z)(function(r){return r.prevConfirmDealtWith}),m=(0,O.Z)(function(r){return r.dealtWithData}),l=(0,O.Z)(function(r){return r.setRunPanelLogRecord}),u=(0,O.Z)(function(r){return r.submitPromptId}),p=(0,z.useIntl)(),i=(0,f.useRef)(null),x=(0,f.useState)(null),g=F()(x,2),S=g[0],o=g[1],c=he("pageNumber"),t=F()(c,2),P=t[0],h=t[1],w=function(C){console.log(C),s(C)};(0,se.Z)(function(){var r=y.list.map(function(C){return C.exec_id==j.exec_id&&(C.need_human_confirm=0),C});V(b()(b()({},y),{},{list:r}))},[j]);var R=function(){var r=E()(Z()().mark(function C(G){var de,ue,ne;return Z()().wrap(function(k){for(;;)switch(k.prev=k.next){case 0:return de=G.current,ue=G.pageSize,k.next=3,(0,Q.VE)({current:de,pageSize:ue});case 3:return ne=k.sent,k.abrupt("return",{list:ne.data.list,success:!0,total:ne.data.total_count});case 5:case"end":return k.stop()}},C)}));return function(G){return r.apply(this,arguments)}}(),v=Y(R,{defaultPageSize:10}),I=v.data,T=v.loading,U=v.pagination,K=(0,f.useState)(I),$=F()(K,2),y=$[0],V=$[1];(0,f.useEffect)(function(){V(I)},[I]),(0,se.Z)(function(){i.current&&i.current.reload()},[u]);var te=(0,f.useCallback)(function(r){var C=r.item;return(0,e.jsxs)("div",{className:"flex flex-col gap-1 truncate flex-1",children:[(0,e.jsxs)("div",{children:[(0,e.jsx)("span",{children:C.app_name})," ",(0,e.jsx)(ve.Z,{}),(0,e.jsx)("span",{className:C.need_human_confirm==1?"text-[#1B64F3]":"text-[#808183]",children:C.node_name})]}),(0,e.jsx)("div",{className:"text-[#999999] text-xs truncate",children:C.app_run_name})]})},[y]);return(0,e.jsx)(ie.Z,{spinning:T,children:(0,e.jsxs)("div",{style:{height:"calc(100vh - 596px)"},children:[(0,e.jsx)(ae,{iconSrc:"/icons/back_log.svg",titleText:p.formatMessage({id:"app.workflow.backlogs.title"}),pagination:U}),(0,e.jsxs)("div",{className:"bg-white rounded-lg p-2.5 mt-4 overflow-y-auto h-full",style:{boxShadow:" 0px 2px 4px 0px rgba(0,0,0,0.05)"},children:[y==null||(d=y.list)===null||d===void 0?void 0:d.map(function(r,C){return r.type=3,(0,e.jsxs)("div",{onClick:function(){console.log(r),r.need_human_confirm&&(s(r),o(r),l(!1))},className:"flex items-center gap-5 cursor-pointer duration-200 rounded-lg  p-2.5 hover:bg-[#fafafa]",children:[(0,e.jsx)(q.Z,{Image:(0,_.s9)("single",r.icon)}),(0,e.jsx)(te,{item:r}),(0,e.jsx)("div",{children:r.need_human_confirm?(0,e.jsx)(le.Z,{title:p.formatMessage({id:"workflow.needHumanConfirm"}),children:(0,e.jsx)(fe.Z,{className:"text-[#1B64F3]"})}):(0,e.jsx)(le.Z,{title:p.formatMessage({id:"workflow.noHumanConfirm"}),children:(0,e.jsx)(ge.Z,{className:"text-[#808183]"})})})]},r.exec_id)}),!T&&(y==null||(n=y.list)===null||n===void 0?void 0:n.length)===0&&(0,e.jsx)("div",{className:"h-full flex items-center justify-center",children:(0,e.jsx)(ee.Z,{image:"/images/empty.svg",description:p.formatMessage({id:"app.workflow.backlogs.empty"})})})]})]})})},Ne=a(29933),Pe=a(4393),He=Pe.Z.Meta,ze=function(){var d,n,s=(0,z.useIntl)(),j=function(g){console.log(g);var S=g.app_id||g.apps_id;switch(g.type){case 1:z.history.push("/Agents?app_id=".concat(S));break;case 2:z.history.push("/chat_room/".concat(g.chatroom_id));break;case 3:z.history.push("/workspace/workflow?app_id=".concat(S));break;default:break}},m=function(){var x=E()(Z()().mark(function g(S){var o,c,t;return Z()().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return o=S.current,c=S.pageSize,h.next=3,(0,Q.vu)({current:o,pageSize:c});case 3:return t=h.sent,h.abrupt("return",{list:t.data.list,success:!0,total:t.data.total_count});case 5:case"end":return h.stop()}},g)}));return function(S){return x.apply(this,arguments)}}(),l=Y(m,{defaultPageSize:8}),u=l.data,p=l.loading,i=l.pagination;return console.log(p),(0,e.jsxs)("div",{className:"flex-grow-0",children:[(0,e.jsx)(ae,{iconSrc:"/icons/recently_active.svg",titleText:s.formatMessage({id:"app.workflow.ra.title"}),pagination:i}),(0,e.jsx)("div",{className:"grid grid-cols-4  gap-4 mt-4",children:u==null||(d=u.list)===null||d===void 0?void 0:d.map(function(x,g){var S=x.type==3?x.process_name:x.last_agent_name;return(0,e.jsx)(Ne.Z,{className:"h-[160px] cursor-pointer transition shadow-lg shadow-gray-100 hover:shadow-gray-200",title:(0,e.jsx)(Ze,{item:x}),onClick:function(){return j(x)},bodyStyle:{padding:"15px 20px"},children:(0,e.jsx)(oe.Z.Paragraph,{ellipsis:{rows:2,tooltip:S},children:S})},x.app_id)})}),!(u!=null&&(n=u.list)!==null&&n!==void 0&&n.length)&&(0,e.jsxs)("div",{className:"h-[400px] w-full flex items-center justify-center",children:[!p&&(0,e.jsx)(ee.Z,{imageStyle:{display:"flex",justifyContent:"center"},image:"/images/empty.svg",description:s.formatMessage({id:"app.workflow.ra.empty"})}),(0,e.jsx)(ie.Z,{spinning:p})]})]})},H=a(1413),Re=a(99011),ce=a(91146),De=function(n,s){return f.createElement(ce.Z,(0,H.Z)((0,H.Z)({},n),{},{ref:s,icon:Re.Z}))},Me=f.forwardRef(De),Oe=Me,We=a(88284),Ee={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M464 720a48 48 0 1096 0 48 48 0 10-96 0zm16-304v184c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V416c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8zm475.7 440l-416-720c-6.2-10.7-16.9-16-27.7-16s-21.6 5.3-27.7 16l-416 720C56 877.4 71.4 904 96 904h832c24.6 0 40-26.6 27.7-48zm-783.5-27.9L512 239.9l339.8 588.2H172.2z"}}]},name:"warning",theme:"outlined"},Ie=Ee,Te=function(n,s){return f.createElement(ce.Z,(0,H.Z)((0,H.Z)({},n),{},{ref:s,icon:Ie}))},ke=f.forwardRef(Te),Le=ke,Ae=a(44720),Be=a(38703),be=(0,f.memo)(function(){var d,n,s=(0,O.Z)(function(o){return o.setDealtWithData}),j=(0,O.Z)(function(o){return o.setRunPanelLogRecord}),m=(0,z.useIntl)(),l=function(c){var t=c.text;switch(t){case 1:return(0,e.jsx)(Oe,{className:"text-blue-500"});case 2:return(0,e.jsx)(We.Z,{className:"text-green-500"});case 3:return(0,e.jsx)(Le,{className:"text-red-500"})}return(0,e.jsx)("span",{children:t})},u=function(){var o=E()(Z()().mark(function c(t){var P,h,w;return Z()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return P=t.current,h=t.pageSize,v.next=3,(0,Q.PE)({current:P,pageSize:h});case 3:return w=v.sent,v.abrupt("return",{list:w.data.list,success:!0,total:w.data.total_count});case 5:case"end":return v.stop()}},c)}));return function(t){return o.apply(this,arguments)}}(),p=Y(u,{defaultPageSize:10}),i=p.data,x=p.loading,g=p.pagination,S=(0,f.memo)(function(o){var c,t=o.item,P=t.status==1?"#1B64F3":t.status==2?"#22C55F":"#F04444",h=t.status==1?"#f9fafe":t.status==2?"#f6fcf3":"#fafafa",w=(0,f.useRef)(null),R=(0,Ae.Z)(w);return(0,e.jsxs)("div",{onClick:function(){j(t),s(null)},ref:w,className:"flex relative rounded truncate gap-5  items-center shrink-0 cursor-pointer duration-200  box-border py-2.5 pr-5 ",children:[(0,e.jsx)("div",{style:{backgroundColor:R?h:"",width:R?"".concat(t.completed_steps/t.total_steps*100,"%"):"0%",transition:"0.5s"},className:"w-full h-full absolute left-0 duration-500"}),(0,e.jsx)("div",{style:{backgroundColor:P},className:"w-[4px] h-full z-10 mr-[10px] absolute"}),(0,e.jsx)("div",{className:"ml-5",children:(0,e.jsx)(q.Z,{Image:(0,_.s9)("single",t.icon)})}),(0,e.jsxs)("div",{className:"flex flex-col gap-1 truncate flex-1  z-10",children:[(0,e.jsx)("div",{children:(0,e.jsx)("span",{children:t.app_runs_name})}),(0,e.jsx)("div",{className:"text-[#999999] text-xs truncate  max-w-7/8",children:(0,e.jsxs)("div",{className:"flex items-center truncate",children:[(0,e.jsxs)("span",{children:[" ",t.created_time," "]}),(0,e.jsx)("span",{style:{maxWidth:"calc(100% - 200px)"},className:"truncate ml-2 ",children:t.apps_name}),(0,e.jsxs)("span",{className:"inline-flex items-center ml-2 gap-2",children:[(0,e.jsx)("span",{style:{backgroundColor:P},className:"inline-block w-1 h-1 rounded-sm"}),(c=t.elapsed_time)===null||c===void 0?void 0:c.toFixed(6),"S"]})]})})]}),(0,e.jsx)("div",{className:"flex items-center justify-center",children:(0,e.jsx)(Be.Z,{type:"circle",size:30,percent:parseInt(t.completed_steps/t.total_steps*100)})})]},t.app_run_id)});return(0,e.jsxs)("div",{style:{height:"calc(100vh - 596px)"},children:[(0,e.jsx)(ae,{iconSrc:"/icons/workflows.svg",titleText:m.formatMessage({id:"app.workflow.log.title"}),pagination:g}),(0,e.jsxs)("div",{className:"bg-white rounded-lg p-4 h-full mt-4 overflow-y-auto box-border relative flex flex-col gap-5",style:{boxShadow:" 0px 2px 4px 0px rgba(0,0,0,0.05)"},children:[i==null||(d=i.list)===null||d===void 0?void 0:d.map(function(o,c){return(0,e.jsx)(S,{item:o})}),!x&&(i==null||(n=i.list)===null||n===void 0?void 0:n.length)===0&&(0,e.jsx)("div",{className:"h-full flex items-center justify-center",children:(0,e.jsx)(ee.Z,{image:"/images/empty.svg",description:m.formatMessage({id:"app.workflow.log.empty"})})})]})]})}),Fe=function(){return(0,e.jsxs)("div",{style:{height:"calc(100vh - 56px)"},className:"w-full p-[30px] flex flex-col gap-6 overflow-x-auto box-border",children:[(0,e.jsx)(ze,{}),(0,e.jsxs)("div",{className:"grid grid-cols-2 gap-6 flex-1",children:[(0,e.jsx)(we,{}),(0,e.jsx)(be,{})]}),(0,e.jsx)(D.$_,{}),(0,e.jsx)(M.Z,{})]})},$e=Fe}}]);
