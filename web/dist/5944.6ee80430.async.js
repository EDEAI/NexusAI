(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[5944],{69243:function(j,x,e){"use strict";e.d(x,{Z:function(){return L}});var D=e(1413),M=e(67294),C={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M928 140H96c-17.7 0-32 14.3-32 32v496c0 17.7 14.3 32 32 32h380v112H304c-8.8 0-16 7.2-16 16v48c0 4.4 3.6 8 8 8h432c4.4 0 8-3.6 8-8v-48c0-8.8-7.2-16-16-16H548V700h380c17.7 0 32-14.3 32-32V172c0-17.7-14.3-32-32-32zm-40 488H136V212h752v416z"}}]},name:"desktop",theme:"outlined"},i=C,A=e(91146),p=function(w,b){return M.createElement(A.Z,(0,D.Z)((0,D.Z)({},w),{},{ref:b,icon:i}))},R=M.forwardRef(p),L=R},15360:function(j,x,e){"use strict";e.d(x,{Z:function(){return L}});var D=e(1413),M=e(67294),C={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M854.6 288.6L639.4 73.4c-6-6-14.1-9.4-22.6-9.4H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V311.3c0-8.5-3.4-16.7-9.4-22.7zM790.2 326H602V137.8L790.2 326zm1.8 562H232V136h302v216a42 42 0 0042 42h216v494zM504 618H320c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h184c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8zM312 490v48c0 4.4 3.6 8 8 8h384c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8H320c-4.4 0-8 3.6-8 8z"}}]},name:"file-text",theme:"outlined"},i=C,A=e(91146),p=function(w,b){return M.createElement(A.Z,(0,D.Z)((0,D.Z)({},w),{},{ref:b,icon:i}))},R=M.forwardRef(p),L=R},85877:function(j,x,e){"use strict";var D=e(19632),M=e.n(D),C=e(97857),i=e.n(C),A=e(5574),p=e.n(A),R=e(52677),L=e.n(R),V=e(76772),w=e(78234),b=e(77598),Y=e(96486),U=e.n(Y),f=e(67294),ae=e(73935),r=e(43413),W=e(92858),l=e(16845),S=e(15425),s=e(85893),Z=function(n){var a=n.children;return(typeof document=="undefined"?"undefined":L()(document))==="object"?ae.createPortal(a,document.body):null},k=typeof navigator!="undefined"&&/Mac OS X/.test(navigator.userAgent),G=function(n){var a=n.value,d=n.onChange,h=n.id,c=n.placeholder,_=n.options,g=(0,V.useIntl)(),B=(0,f.useRef)(),Q=(0,f.useState)(),q=p()(Q,2),E=q[0],y=q[1],I=(0,f.useState)(0),re=p()(I,2),T=re[0],ee=re[1],de=(0,f.useState)(""),se=p()(de,2),ce=se[0],me=se[1],fe=(0,f.useCallback)(function(t){return(0,s.jsx)($,i()({},t))},[]),he=(0,f.useCallback)(function(t){return(0,s.jsx)(X,i()({},t))},[]),u=(0,f.useMemo)(function(){return z((0,l.BU)((0,W.VC)((0,r.Jh)())))},[]),ge=(0,f.useState)(null),oe=p()(ge,2),ve=oe[0],pe=oe[1],Oe=(0,S.Z)(function(t){return t.selectedNode}),Pe=(0,S.Z)(function(t){return t.getOutputVariables}),je=(0,S.Z)(function(t){return t.getInputVariables}),Ee=(0,f.useState)([]),ie=p()(Ee,2),P=ie[0],le=ie[1];(0,w.Z)(function(){a&&a.length>0&&te(a),_!=null&&_.length&&le(_.map(function(t){return i()(i()({},t),{},{name:t.label,id:t.value})}))}),(0,b.Z)(function(){var t=U().isEqual(ve,a);t||(a&&a.length>0?te(a):a&&U().isArray(a)&&a.length==0&&te([{type:"paragraph",children:[]}]))},[a,h]),(0,b.Z)(function(){_.length&&le(_.map(function(t){return i()(i()({},t),{},{name:t.label,id:t.value})})),console.log(_)},[_]);var te=function(o){pe(o),_e(u,{nodes:[{type:"paragraph",children:[]}]}),_e(u,{nodes:o})},Me=(0,f.useCallback)(function(t){if(E&&P.length>0)switch(t.key){case"ArrowDown":t.preventDefault();var o=T>=P.length-1?0:T+1;ee(o);return;case"ArrowUp":t.preventDefault();var m=T<=0?P.length-1:T-1;ee(m);return;case"Tab":case"Enter":t.preventDefault(),r.YR.select(u,E),v(u,P[T]),y(null);return;case"Escape":t.preventDefault(),y(null);return}else if(t.key==="@"){setTimeout(function(){return be()},10);return}y(null)},[P,u,T,E]),_e=function(o){var m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},ne=M()(o.children);if(ne.forEach(function(K){return o.apply({type:"remove_node",path:[0],node:K})}),m.nodes){var N=r.NB.isNode(m.nodes)?[m.nodes]:m.nodes;N.forEach(function(K,ue){return o.apply({type:"insert_node",path:[ue],node:K})})}var F=m.at&&r.E9.isPoint(m.at)?m.at:r.ML.end(o,[]);F&&r.YR.select(o,F)};(0,f.useEffect)(function(){if(E&&P.length>0){var t=B.current,o=l.F3.toDOMRange(u,E),m=o.getBoundingClientRect();t.style.top="".concat(m.top+window.pageYOffset+24,"px"),t.style.left="".concat(m.left+window.pageXOffset,"px")}},[P.length,u,T,ce,E]);var be=function(){var o=u.selection;if(o&&r.e6.isCollapsed(o)){var m=r.e6.edges(o),ne=p()(m,1),N=ne[0],F=r.ML.before(u,N),K=F&&r.ML.range(u,F,N),ue=K&&r.ML.string(u,K),xe=r.ML.after(u,N),De=r.ML.range(u,N,xe),we=r.ML.string(u,De);y(K),me(""),ee(0);return}y(null)};return(0,s.jsxs)(l.mH,{editor:u,initialValue:J,onChange:function(o){d==null||d(o),y(null)},children:[(0,s.jsx)(l.CX,{renderElement:fe,renderLeaf:he,onKeyDown:Me,className:"!outline-none",placeholder:c!=null?c:g.formatMessage({id:"workflow.placeholder.enterContent",defaultMessage:"\uFF0C@"})}),E&&(0,s.jsx)(Z,{children:(0,s.jsx)("div",{ref:B,style:{top:"-9999px",left:"-9999px",position:"absolute",zIndex:10,padding:"3px",background:"white",borderRadius:"4px",boxShadow:"0 1px 5px rgba(0,0,0,.2)"},className:"px-1 pt-1 z-10","data-cy":"mentions-portal",children:P.length?P.map(function(t,o){return(0,s.jsx)("div",{onClick:function(){console.log(t),r.YR.select(u,E),v(u,t),y(null)},className:"hover:bg-blue-100 text-sm mb-1",style:{padding:"1px 3px",borderRadius:"3px",cursor:"pointer",background:o===T?"#B4D5FF":""},children:(0,s.jsx)("span",{children:t.name})},t.name+o)}):(0,s.jsx)(s.Fragment,{children:g.formatMessage({id:"workflow.message.noVariablesFound",defaultMessage:""})})})})]})},z=function(n){var a=n.isInline,d=n.isVoid,h=n.markableVoid;return n.isInline=function(c){return c.type==="mention"?!0:a(c)},n.isVoid=function(c){return c.type==="mention"?!0:d(c)},n.markableVoid=function(c){return c.type==="mention"||h(c)},n},v=function(n,a){var d={type:"mention",id:(a==null?void 0:a.id)||"",character:a.name,base:a,children:[{bold:!0,text:"11111"}]};r.YR.insertNodes(n,d),r.YR.move(n)},X=function(n){var a=n.attributes,d=n.children,h=n.leaf;return(0,s.jsx)("span",i()(i()({},a),{},{children:d}))},$=function(n){var a=n.attributes,d=n.children,h=n.element;switch(h.type){case"mention":return(0,s.jsx)(H,i()({},n));default:return(0,s.jsx)("p",i()(i()({},a),{},{children:d}))}},H=function(n){var a=n.attributes,d=n.children,h=n.element,c=(0,l.vt)(),_=(0,l.UE)(),g={padding:"3px 3px 2px",margin:"0 1px",verticalAlign:"baseline",display:"inline-block",borderRadius:"4px",backgroundColor:"#eee",fontSize:"0.9em",boxShadow:c&&_?"0 0 0 2px #B4D5FF":"none"};return h.children[0].bold&&(g.fontWeight="bold"),h.children[0].italic&&(g.fontStyle="italic"),(0,s.jsx)("span",i()(i()({},a),{},{className:"m-2",contentEditable:!1,"data-cy":"mention-".concat(h.character.replace(" ","-")),style:g,children:k?(0,s.jsxs)(f.Fragment,{children:["1",d,"/",h.character]}):(0,s.jsxs)(f.Fragment,{children:[(0,s.jsx)("span",{children:h.character}),d]})}))},J=[{type:"paragraph",children:[{text:""}]}];x.Z=G},27842:function(j,x,e){"use strict";var D=e(5574),M=e.n(D),C=e(15009),i=e.n(C),A=e(99289),p=e.n(A),R=e(11551),L=e(29608),V=e(46944),w=e(76772),b=e(67294),Y=e(4730),U=e(85893),f=null,ae=null;x.ZP=function(r){var W=r.agent_id,l=(0,w.useIntl)(),S=(0,w.useSearchParams)(),s=M()(S,1),Z=s[0],k=(0,b.useRef)(null),G=(0,b.useState)(null),z=M()(G,2),v=z[0],X=z[1],$=(0,b.useState)(!1),H=M()($,2),J=H[0],O=H[1],n=Z.get("app_id"),a=function(){O(!1)},d=function(g){X({app_id:n,app_run_id:g.id}),O(!0)},h=[{dataIndex:"index",valueType:"indexBorder",width:48},{disable:!0,title:l.formatMessage({id:"workflow.status",defaultMessage:""}),dataIndex:"status",ellipsis:!0,search:!1,valueEnum:{1:{text:l.formatMessage({id:"workflow.running",defaultMessage:""}),status:"Processing"},2:{text:l.formatMessage({id:"workflow.runSc",defaultMessage:""}),status:"Success"},3:{text:l.formatMessage({id:"workflow.runF",defaultMessage:""}),status:"Error"}}},{title:l.formatMessage({id:"workflow.created_time",defaultMessage:""}),dataIndex:"created_time",ellipsis:!0,tooltip:l.formatMessage({id:"workflow.created_time_des",defaultMessage:l.formatMessage({id:"workflow.created_time_des",defaultMessage:""})}),search:!1},{title:"".concat(l.formatMessage({id:"workflow.elapsed_time",defaultMessage:""}),"S"),dataIndex:"elapsed_time",ellipsis:!0,tooltip:l.formatMessage({id:"workflow.run_time"}),search:!1},{title:"Tokens",key:"showTime",dataIndex:"total_tokens",hideInSearch:!0},{title:l.formatMessage({id:"workflow.user"}),dataIndex:"nickname",search:!1,ellipsis:!0,key:"user"}],c=(0,L.Z)(function(_){return _.setRunPanelLogRecord});return(0,U.jsxs)("div",{className:"h-full",children:[(0,U.jsx)(V.Z,{columns:h,formRef:k,form:{submitter:!1},cardBordered:!0,style:{height:"calc(100% - 20px)"},scroll:{y:"calc(100vh - 230px)"},request:function(){var _=p()(i()().mark(function g(B,Q,q){var E;return i()().wrap(function(I){for(;;)switch(I.prev=I.next){case 0:return I.next=2,(0,R.My)(n,{page:B.current,page_size:B.pageSize});case 2:return E=I.sent,I.abrupt("return",{data:E.data.list,success:!0,total:E.data.total_count});case 4:case"end":return I.stop()}},g)}));return function(g,B,Q){return _.apply(this,arguments)}}(),onRow:function(g){return{onClick:function(){d(g)},className:(v==null?void 0:v.app_run_id)===g.id?"bg-blue-50":""}},editable:{type:"multiple"},rowKey:"app_runs_id",search:!1,options:{search:!1,setting:{listsHeight:600}},pagination:{pageSize:20,showSizeChanger:!1},dateFormatter:"string",headerTitle:l.formatMessage({id:"agent.log.list"})}),J&&(v==null?void 0:v.app_id)&&(v==null?void 0:v.app_run_id)&&(0,U.jsx)(Y.Z,{data:v,onClose:a})]})}},49677:function(j){function x(e){if(e==null)throw new TypeError("Cannot destructure "+e)}j.exports=x,j.exports.__esModule=!0,j.exports.default=j.exports}}]);
