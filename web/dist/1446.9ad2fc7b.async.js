"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[1446],{83510:function(oe,W,a){a.d(W,{LK:function(){return P},bs:function(){return I},go:function(){return B},uy:function(){return D}});var N=a(15009),u=a.n(N),K=a(99289),m=a.n(K),p=a(47520),S="/v1/apps/apps_list",Z="/v1/agent/agent_delete/",E="/v1/workflow/workflow_app_delete/",w="/v1/vector/delete_dataset/",v="/v1/skill/delete_skill_by_app_id/",k="/v1/apps/apps_create",T="/v1/apps/app_update/",B=function(){var h=m()(u()().mark(function d(s){var e;return u()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,p.ZP)("".concat(S),{method:"GET",data:s});case 2:return e=t.sent,t.abrupt("return",e);case 4:case"end":return t.stop()}},d)}));return function(s){return h.apply(this,arguments)}}(),P=function(){var h=m()(u()().mark(function d(s){var e;return u()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return console.log(s),t.next=3,s.mode;case 3:if(t.t0=t.sent,t.t0!=1){t.next=8;break}t.t1=(0,p.ZP)("".concat(Z).concat(s.app_id),{method:"DELETE"}),t.next=9;break;case 8:t.t1=s.mode==2?(0,p.ZP)("".concat(E).concat(s.app_id),{method:"DELETE"}):s.mode==3?(0,p.ZP)("".concat(w).concat(s.app_id),{method:"DELETE"}):(0,p.ZP)("".concat(v).concat(s.app_id),{method:"DELETE",data:{is_soft:1}});case 9:return e=t.t1,t.abrupt("return",e);case 11:case"end":return t.stop()}},d)}));return function(s){return h.apply(this,arguments)}}(),D=function(){var h=m()(u()().mark(function d(s){var e;return u()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,p.ZP)("".concat(k),{method:"POST",data:s});case 2:return e=t.sent,t.abrupt("return",e);case 4:case"end":return t.stop()}},d)}));return function(s){return h.apply(this,arguments)}}(),I=function(){var h=m()(u()().mark(function d(s){var e;return u()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,p.ZP)("".concat(T).concat(s.app_id),{method:"PUT",data:s});case 2:return e=t.sent,t.abrupt("return",e);case 4:case"end":return t.stop()}},d)}));return function(s){return h.apply(this,arguments)}}()},21446:function(oe,W,a){var N=a(15009),u=a.n(N),K=a(97857),m=a.n(K),p=a(99289),S=a.n(p),Z=a(5574),E=a.n(Z),w=a(83510),v=a(29608),k=a(32332),T=a(76772),B=a(55102),P=a(83622),D=a(85576),I=a(67294),h=a(94840),d=a(54464),s=a(62880),e=a(85893),R=B.Z.TextArea,t=function(c){var O=c.setIsModalOpen,g=c.isModalOpen,F=c.transformData,i=c.CreationType,ae=c.setcreationType,G=c.ModalType,r=(0,T.useIntl)(),J=(0,I.useState)(""),Q=E()(J,2),$=Q[0],te=Q[1],X=(0,I.useState)(""),C=E()(X,2),se=C[0],n=C[1],re=(0,I.useState)({id:1,icon:"/icons/headportrait/Android.svg"}),Y=E()(re,2),z=Y[0],ne=Y[1],b=(0,v.Z)(),_=b.setAgentCreateOpen,M=b.setSkillCreateOpen,j=(0,d.TE)(),f=j.hasPermission,x=f(s.Dg.CREATE_AGENT),q=f(s.Dg.CREATE_WORKFLOW),H=f(s.Dg.CREATE_SKILL),L=f(s.Dg.CREATE_KNOWLEDGE_BASE),A=function(o){te(o.target.value)},V=function(o){n(o.target.value)},ie=function(){var l=S()(u()().mark(function o(){var y,_e;return u()().wrap(function(U){for(;;)switch(U.prev=U.next){case 0:if(y={name:$,mode:i.apps_mode,description:se,icon:JSON.stringify(z.id),avatar:z.avatar||null,icon_background:""},i.apps_mode!=2){U.next=8;break}return U.next=4,(0,w.uy)(y);case 4:_e=U.sent,_e.code===0&&(O(!1),le(_e.data.app_id)),U.next=10;break;case 8:(0,k.Go)("SET",m()(m()({},y),{},{type:!1})),le();case 10:case"end":return U.stop()}},o)}));return function(){return l.apply(this,arguments)}}(),de=function(o){F.map(function(y){y.name==o.name&&ae(y)})},le=function(o){o?T.history.push("/".concat(i.path,"?app_id=").concat(o,"&&type=false")):T.history.push("/".concat(i.path,"?type=false"))},ue=function(){return(0,e.jsxs)("div",{className:"flex justify-between",children:[(0,e.jsxs)("div",{className:"flex items-center",children:[i.apps_mode==1&&(0,e.jsx)(P.ZP,{disabled:!x,className:x?"":"cursor-not-allowed opacity-50",onClick:function(){x&&(_(!0),O(!1))},children:r.formatMessage({id:"agent.creation.button.ai"})}),i.apps_mode==4&&(0,e.jsx)(P.ZP,{disabled:!H,className:H?"":"cursor-not-allowed opacity-50",onClick:function(){H&&(M(!0),O(!1))},children:r.formatMessage({id:"agent.creation.button.skill.ai"})})]}),(0,e.jsxs)("div",{className:"flex gap-2",children:[(0,e.jsx)(P.ZP,{onClick:function(){return O(!1)},children:r.formatMessage({id:"agent.modal.button.cancel"})}),(0,e.jsx)(P.ZP,{disabled:$==="",onClick:ie,type:"primary",children:r.formatMessage({id:"creation"})})]})]})};return(0,e.jsx)(D.Z,{title:r.formatMessage({id:"creation.addnewapp"}),open:g,okText:r.formatMessage({id:"creation"}),onOk:ie,onCancel:function(){return O(!1)},okButtonProps:{disabled:$===""},width:820,footer:(0,e.jsx)(ue,{}),children:(0,e.jsxs)("div",{className:"pb-1",children:[G?(0,e.jsxs)("div",{children:[(0,e.jsx)("div",{className:"font-medium text-xs mb-4 mt-8",children:r.formatMessage({id:"creation.appntype"})}),(0,e.jsx)("div",{className:"flex items-center justify-around gap-y-[24px]",children:F&&F.map(function(l){var o=l.apps_mode===1&&!x||l.apps_mode===2&&!q||l.apps_mode===3&&!L||l.apps_mode===4&&!H;return(0,e.jsxs)("div",{className:"w-44 h-24 rounded-lg text-center bg-[url('/images/bg.png')] bg-[length:176px_96px] ".concat(o?"cursor-not-allowed opacity-50":"cursor-pointer"),style:{border:l.apps_mode===i.apps_mode?"1px solid #1B64F3":"1px solid #eeeeee"},onClick:function(){o||de(l)},children:[(0,e.jsx)("div",{className:"flex items-center justify-center mt-5 mb-2.5",children:(0,e.jsx)("img",{className:"w-6 h-6 ".concat(o?"grayscale":""),src:l.signicon,alt:""})}),(0,e.jsx)("div",{className:"text-base font-normal ".concat(o?"text-gray-400":"text-p[#213044]"),children:l.name})]})})})]}):null,(0,e.jsxs)("div",{className:" mt-5",children:[(0,e.jsxs)("div",{className:"mb-5",children:[(0,e.jsxs)("p",{className:"text-xs",children:[i.apps_mode==1?r.formatMessage({id:"creation.agent"}):i.apps_mode==2?r.formatMessage({id:"creation.workflow"}):i.apps_mode==3?r.formatMessage({id:"creation.repository"}):r.formatMessage({id:"creation.skill"}),r.formatMessage({id:"creation.appiconname"})]}),(0,e.jsxs)("div",{className:"flex items-center justify-around",children:[(0,e.jsx)(h.Z,{CardData:z,setCardData:ne}),(0,e.jsx)(B.Z,{showCount:!0,maxLength:50,placeholder:r.formatMessage({id:"creation.placeholder.appname"}),onChange:A})]})]}),(0,e.jsxs)("div",{className:"mb-5 text-xs",children:[(0,e.jsxs)("p",{children:[i.apps_mode==1?r.formatMessage({id:"creation.agent"}):i.apps_mode==2?r.formatMessage({id:"creation.workflow"}):i.apps_mode==3?r.formatMessage({id:"creation.repository"}):r.formatMessage({id:"creation.skill"}),r.formatMessage({id:"creation.appdescribe"})]}),(0,e.jsx)(R,{showCount:!0,maxLength:1e3,rows:4,placeholder:r.formatMessage({id:"creation.placeholder.appdescribe"}),onChange:V})]})]})]})})};W.Z=t},94840:function(oe,W,a){var N=a(15009),u=a.n(N),K=a(97857),m=a.n(K),p=a(99289),S=a.n(p),Z=a(5574),E=a.n(Z),w=a(32332),v=a(45360),k=a(78367),T=a(55241),B=a(85576),P=a(88484),D=a(67294),I=a(83065),h=a(76772),d=a(42016),s=a(99579),e=a(85893),R=function(ee){var c=ee.CardData,O=ee.setCardData,g=(0,h.useIntl)(),F=(0,D.useState)(!1),i=E()(F,2),ae=i[0],G=i[1],r=(0,D.useState)(""),J=E()(r,2),Q=J[0],$=J[1],te=(0,D.useState)(null),X=E()(te,2),C=X[0],se=X[1],n=200;(0,D.useEffect)(function(){},[]);var re=function(_){var M=_.type.startsWith("image/"),j=_.size/1024/1024<2;if(!M)return v.ZP.error(g.formatMessage({id:"workflow.uploadFileErrorType"})),!1;if(!j)return v.ZP.error(g.formatMessage({id:"workflow.uploadFileErrorText"})),!1;var f=new FileReader;return f.readAsDataURL(_),f.onload=function(){$(f.result),G(!0)},!1},Y=function(){if(C){var _=C.getCroppedCanvas({width:n,height:n,minWidth:n,minHeight:n,maxWidth:n,maxHeight:n,imageSmoothingEnabled:!0,imageSmoothingQuality:"high"});_.toBlob(function(){var M=S()(u()().mark(function j(f){var x,q;return u()().wrap(function(L){for(;;)switch(L.prev=L.next){case 0:return x=new FormData,x.append("file",f,"avatar.png"),L.next=4,(0,I.M$)();case 4:q=L.sent,fetch(q,{method:"POST",headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))},body:x}).then(function(A){return A.json()}).then(function(A){var V;A.code===0&&(V=A.data)!==null&&V!==void 0&&V.path?(O(m()(m()({},c),{},{avatar:A.data.path,avatar_show:A.data.path_show})),v.ZP.success(g.formatMessage({id:"workflow.uploadSuccess"}))):v.ZP.error(g.formatMessage({id:"workflow.uploadError"}))}).catch(function(){v.ZP.error(g.formatMessage({id:"workflow.uploadError"}))});case 6:case"end":return L.stop()}},j)}));return function(j){return M.apply(this,arguments)}}(),"image/png",1),G(!1)}},z=function(){return(0,e.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,e.jsx)("div",{className:"flex justify-start items-center flex-wrap w-40",children:(0,w.s9)("all").map(function(_){return(0,e.jsx)("div",{className:"w-8 h-8 bg-[#F4F8F1] rounded-lg mr-1.5 flex items-center justify-center m-0.5 cursor-pointer",onClick:function(){ne(_)},children:(0,e.jsx)("img",{src:_.image,alt:""})},_.id)})}),(0,e.jsx)(k.Z,{name:"file",accept:".jpg,.png,.jpeg",showUploadList:!1,beforeUpload:re,children:(0,e.jsxs)("div",{className:"w-full flex items-center justify-center p-2 cursor-pointer hover:bg-gray-100 rounded",children:[(0,e.jsx)(P.Z,{className:"mr-2"}),g.formatMessage({id:"workflow.uploadAvatar"})]})})]})},ne=function(_){O(m()(m()({},c),{},{icon:_.image,id:_.id,avatar:null,avatar_show:null}))};return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(T.Z,{content:z,trigger:"click",placement:"bottomLeft",children:(0,e.jsx)("div",{className:"w-8 h-8 bg-[#F4F8F1] rounded-lg mr-1.5 flex items-center justify-center m-0.5 cursor-pointer",children:(0,e.jsx)("img",{src:c.avatar_show||c.avatar||(0,w.s9)("single",c.id?c.id:c.icon),alt:"",className:"rounded"})})}),(0,e.jsx)(B.Z,{title:g.formatMessage({id:"workflow.cropAvatar"}),open:ae,onOk:Y,onCancel:function(){return G(!1)},width:800,children:(0,e.jsx)("div",{className:"w-full h-[400px]",children:(0,e.jsx)(d.Z,{src:Q,style:{height:"100%",width:"100%"},aspectRatio:1,guides:!0,cropBoxResizable:!0,cropBoxMovable:!0,viewMode:2,dragMode:"move",autoCropArea:1,background:!1,responsive:!0,restore:!1,checkCrossOrigin:!1,checkOrientation:!1,modal:!0,highlight:!0,center:!0,zoomOnWheel:!0,wheelZoomRatio:.1,minContainerWidth:n,minContainerHeight:n,minCanvasWidth:n,minCanvasHeight:n,minCropBoxWidth:n,minCropBoxHeight:n,onInitialized:function(_){se(_),_.setCropBoxData({width:n,height:n})},ready:function(){if(C){var _=C.getImageData(),M=Math.min(_.width,_.height);if(M<n){var j=n/M*1.1;C.scale(j)}C.setData({width:n,height:n})}}})})})]})};W.Z=R}}]);
