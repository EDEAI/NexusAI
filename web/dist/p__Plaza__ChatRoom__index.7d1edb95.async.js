"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[57],{86:function(dt,Te,c){var Ve=c(5574),A=c.n(Ve),Ue=c(32332),re=c(38703),We=c(67294),o=c(85893),pe=function(a){var X=a.subtitle,Ge=a.handleClick,ue=a.lineClamp,at=ue===void 0?2:ue,U=a.textDetails,ve=a.title,Ke=a.icon,$e=a.iconType,Le=$e===void 0?"":$e,Ze=a.operation,Ee=Ze===void 0?"":Ze,Fe=a.progress,he=a.status,He=a.backlogTips,Be=(0,We.useState)(0),Ne=A()(Be,2),Oe=Ne[0],Pe=Ne[1],Je=function(){Pe(Fe)},Qe=function(){Pe(0)},Xe=function(e){return"rounded-[4px] border-l-[4px] ".concat(e==1?"border-[#1B64F3]":e==2?"border-[#52C41C]":"border-[#F04444]"," ")};return(0,o.jsxs)("div",{className:"flex  p-[10px] cursor-pointer overflow-hidden relative bg-[#fff] ".concat(he!==void 0?Xe(he):"graphicbox"),onClick:Ge,onMouseEnter:function(){Fe!=null&&Je()},onMouseLeave:function(){Fe!=null&&Qe()},children:[he!==void 0&&(0,o.jsx)("div",{style:{width:"".concat(Oe,"%"),transition:"width 0.5s "},className:"absolute bottom-0 left-0 top-0 bottom-0 h-full ".concat(he==1?"bg-[#1B64F3]/[.03]":he==2?"bg-[#52c41c]/[.05]":"bg-[#FAFAFA]"," ")}),(0,o.jsxs)("div",{className:"flex gap-x-[20px] w-full relative z-20",children:[(0,o.jsx)("div",{className:"shrink-0 flex gap-x-[7px] items-center",style:{fontSize:0},children:(0,o.jsxs)("div",{className:"w-[40px] h-[40px] rounded-[6px] flex items-center justify-center bg-[#F4F8F1] relative",children:[(0,o.jsx)("img",{src:(0,Ue.s9)("single",Ke),className:"w-[22px] h-[22px]"}),Le&&(0,o.jsx)("div",{className:"w-[16px] h-[16px] absolute top-[28px] left-[28px] flex items-center justify-center bg-[#fff] rounded-[3px]",style:{boxShadow:"0px 0px 4px 0px rgba(0,0,0,0.1)"},children:(0,o.jsx)("img",{src:"/icons/".concat(Le,".svg"),alt:"",className:"w-[12px] h-[12px]"})})]})}),(0,o.jsx)("div",{className:"flex flex-1 min-w-0",children:(0,o.jsxs)("div",{className:"flex justify-center flex-col gap-y-[5px] flex-1 min-w-0",children:[(0,o.jsxs)("span",{className:"text-[12px] flex items-center",style:{color:"#213044"},children:[(0,o.jsx)("span",{className:"truncate",children:ve}),(0,o.jsx)("span",{className:"flex items-center flex-1",children:X})]}),(0,o.jsx)("span",{className:"text-[12px] max-w-full truncate",style:{color:"#999999"},children:U})]})}),He||(0,o.jsx)(o.Fragment,{}),Ee&&(0,o.jsx)("div",{className:"flex items-center w-[24px]",children:(0,o.jsx)("span",{className:"operation",children:Ee})}),Fe!=null&&(0,o.jsx)("div",{className:"graphic_progress flex items-center pl-[30px]",children:(0,o.jsx)(re.Z,{type:"circle",percent:Fe,size:29})})]})]})};Te.Z=pe},78129:function(dt,Te,c){c.r(Te),c.d(Te,{default:function(){return Aa}});var Ve=c(15009),A=c.n(Ve),Ue=c(99289),re=c.n(Ue),We=c(5574),o=c.n(We),pe=c(43722),Me=c(32983),a=c(67294),X=c(35312),Ge=c(19632),ue=c.n(Ge),at=c(97857),U=c.n(at),ve=c(32332),Ke=c(82114),$e=c(82826),Le=c(63783),Ze=c(3471),Ee=c(45360),Fe=c(85576),he=c(28036),He=c(83062),Be=c(72269),Ne=c(74330),Oe=c(96486),Pe=c(44010),Je=c(73445),Qe=c(782),Xe=(0,Je.Ue)((0,Qe.mW)(function(i,n){return{clearMemory:null,truncatable:!1,disableInput:!1,summaryParams:null,runsSummaryShow:!1,summaryClick:!0,setClearMemory:function(l){i({clearMemory:l})},setTruncatable:function(l){i({truncatable:l})},setDisableInput:function(l){i({disableInput:l})},setSummaryParams:function(l){i({summaryParams:l})},setRunsSummaryShow:function(l){i({runsSummaryShow:l})},setSummaryClick:function(l){console.log(l),i({summaryClick:l})}}})),Q=Xe,e=c(85893),pt=function(n){var r=(0,X.useIntl)(),l=n.roomDetail,_=n.setAgent,x=Ee.ZP.useMessage(),u=o()(x,2),g=u[0],N=u[1],w=(0,X.useParams)(),m=w.id,d=Q(function(j){return j.disableInput}),S=Q(function(j){return j.truncatable}),b=Q(function(j){return j.setClearMemory}),t=(0,a.useState)([]),C=o()(t,2),s=C[0],k=C[1],B=(0,a.useState)(U()({},l)),$=o()(B,2),h=$[0],Z=$[1],Y=(0,a.useState)([]),te=o()(Y,2),L=te[0],z=te[1],P=(0,a.useRef)(!1),E=(0,a.useRef)(!1),v=(0,a.useState)(!1),D=o()(v,2),y=D[0],M=D[1],R=function(){var F=Fe.Z.confirm;F({title:r.formatMessage({id:"app.chatroom.clear.title"}),icon:(0,e.jsx)(Ke.Z,{}),content:r.formatMessage({id:"app.chatroom.clear.tips"}),okText:r.formatMessage({id:"app.chatroom.clear.confirm"}),okType:"danger",cancelText:r.formatMessage({id:"app.chatroom.clear.cancel"}),onOk:function(){b(["TRUNCATE","0"])}})},f=function(){var j=re()(A()().mark(function F(){var I;return A()().wrap(function(W){for(;;)switch(W.prev=W.next){case 0:if(!m){W.next=5;break}return W.next=3,(0,pe.cH)({id:m});case 3:if(I=W.sent,I.code==0)try{Z(function(){return U()(U()({},I.data.chat_info),{},{max_round:I.data.max_round,smart_selection:I.data.smart_selection})}),k(I.data.agent_list),P.current=!0}catch(ee){}case 5:case"end":return W.stop()}},F)}));return function(){return j.apply(this,arguments)}}(),K=function(){var j=re()(A()().mark(function F(){var I;return A()().wrap(function(W){for(;;)switch(W.prev=W.next){case 0:return W.next=2,(0,pe.j2)({id:m});case 2:I=W.sent,I.code==0&&(z(I.data.list),E.current=!0);case 4:case"end":return W.stop()}},F)}));return function(){return j.apply(this,arguments)}}(),G=function(){var j=re()(A()().mark(function F(I){var ce,W,ee;return A()().wrap(function(J){for(;;)switch(J.prev=J.next){case 0:if(!m){J.next=11;break}if(ce=I.active==1?0:1,ce!=0){J.next=7;break}if(W=s.filter(function(oe){return oe.active==1}),W.length-1!=0){J.next=7;break}return g.open({type:"error",content:r.formatMessage({id:"app.chatroom.sidebar.agent_tips"}),duration:2}),J.abrupt("return",!1);case 7:return J.next=9,(0,pe.sT)({active:ce},m,I.agent_id);case 9:ee=J.sent,ee.code==0&&k(function(oe){return oe.map(function(ye){return U()(U()({},ye),{},{active:ye.agent_id==I.agent_id?ce:ye.active})})});case 11:case"end":return J.stop()}},F)}));return function(I){return j.apply(this,arguments)}}(),se=function(F){return F.length>6?F.length=6:F.lenth,F},me=function(F){F.type=="my_agent"?X.history.push("/Agents?app_id=".concat(F.app_id,"&type=false&from=chat_room")):X.history.push("/ReadOnlyAgent?app_id=".concat(F.app_id,"&type=true&from=chat_room"))},le=function(F){X.history.replace("/chat_room/".concat(F.chatroom_id)),window.location.reload()},xe=function(){M(!0)},ie=function(){M(!1)},ge=function(){var j=re()(A()().mark(function F(I){var ce,W,ee;return A()().wrap(function(J){for(;;)switch(J.prev=J.next){case 0:if(!(I.checkItem&&I.checkItem.length==0)){J.next=3;break}return g.open({type:"error",content:r.formatMessage({id:"app.chatroom.content.addAgentTips_fail"}),duration:2}),J.abrupt("return");case 3:return ce=ue()(I.checkItem).map(function(oe){var ye=oe.agent_id,Se=oe.active,_e=Se===void 0?1:Se;return{agent_id:ye,active:_e}}),W={description:h.description,name:h.name,max_round:h.max_round},J.next=7,(0,pe.sI)(U()(U()({},W),{},{agent:ce}),m);case 7:ee=J.sent,ee.code==0?(I.checkItem.map(function(oe){oe.active=oe.active==null?1:oe.active}),k(ue()(I.checkItem)),_.current=ue()(I.checkItem),g.open({type:"success",content:r.formatMessage({id:"app.chatroom.content.addAgentTips"}),duration:2})):g.open({type:"error",content:r.formatMessage({id:"app.chatroom.content.addAgentTips_fail"}),duration:2});case 9:case"end":return J.stop()}},F)}));return function(I){return j.apply(this,arguments)}}(),je=function(){var j=re()(A()().mark(function F(){var I;return A()().wrap(function(W){for(;;)switch(W.prev=W.next){case 0:return I=h.smart_selection==1?0:1,W.next=3,(0,pe.r5)({smart_selection:I},m);case 3:Z(function(ee){return U()(U()({},ee),{},{smart_selection:I})});case 4:case"end":return W.stop()}},F)}));return function(){return j.apply(this,arguments)}}();return(0,a.useEffect)(function(){f(),K()},[]),(0,e.jsxs)(e.Fragment,{children:[N,(0,e.jsxs)("div",{className:"h-full w-[320px] bg-[#fff] shrink-0",style:{boxShadow:"0px 2px 4px 0px rgba(0,0,0,0.1)"},id:"sider",children:[(0,e.jsxs)("div",{className:"flex flex-col  h-full",children:[(0,e.jsx)("div",{className:"w-full flex  justify-start px-[30px]",children:(0,e.jsxs)("div",{className:"py-[20px] text-[14px] text-[#213044] font-[500] flex gap-x-[10px] items-center w-full",children:[(0,e.jsxs)("div",{className:"cursor-pointer flex items-center shrink-0",onClick:function(){X.history.go(-1)},children:[(0,e.jsx)(he.ZP,{type:"link",danger:!0,className:"p-0",children:(0,e.jsx)($e.Z,{className:"text-[#1B64F3] w-[16px] h-[16px]"})}),(0,e.jsx)("span",{className:"ml-[5px] text-[#213044] text-sm",children:r.formatMessage({id:"app.chatroom.sidebar.return"})})]}),(0,e.jsx)("div",{className:"h-full flex items-center shrink-0",children:(0,e.jsx)("div",{className:"w-[1px] h-[13px] bg-[#ebebeb]"})}),(0,e.jsx)("div",{className:"flex-1 min-w-0 truncate",children:h.name})]})}),(0,e.jsx)("div",{className:"h-[360px]",children:(0,e.jsxs)("div",{className:"pb-[20px] border-b-[1px] px-[10px]",children:[(0,e.jsxs)("div",{className:"flex items-center cursor-pointer px-[20px]",children:[(0,e.jsx)("div",{className:"flex gap-x-[5px] flex-1",children:(0,e.jsx)("span",{className:"text-[#666] text-[14px]",children:r.formatMessage({id:"app.chatroom.sidebar.agent_title"})})}),(0,e.jsxs)("div",{className:"shrink-0 flex items-center",children:[(0,e.jsx)(He.Z,{className:"pr-[2px]",overlayStyle:{fontSize:"12px"},title:r.formatMessage({id:"app.chatroom.sidebar.chatroom_switch_tips"}),children:(0,e.jsx)(Le.Z,{className:"cursor-pointer text-[#666] text-[12px]"})}),(0,e.jsx)("span",{className:"text-[12px] text-[#666] pr-[5px]",children:r.formatHTMLMessage({id:"app.chatroom_list.switch"})}),(0,e.jsx)(Be.Z,{size:"small",defaultChecked:!0,className:"w-[28px]",checked:h.smart_selection==1,onChange:je,disabled:d})]})]}),(0,e.jsx)("div",{className:"py-[20px] pt-[10px]",children:(0,e.jsx)("div",{className:"h-[220px] overflow-y-auto px-[10px]",children:P.current?(0,e.jsx)("div",{className:"flex flex-col",children:s&&s.length>0?s.map(function(j){return(0,e.jsxs)("div",{className:"flex items-center gap-x-[5px] hover:bg-[#FAFAFA] transition p-[10px] slider_agent_box",children:[(0,e.jsxs)("div",{className:"flex gap-x-[15px] flex-1 min-w-[0]",children:[(0,e.jsx)("div",{className:"w-[40px] h-[40px] bg-[#F4F8F1] rounded-[6px] flex items-center justify-center shrink-0",children:(0,e.jsx)("img",{src:(0,ve.s9)("single",j.icon),alt:"",className:"w-[18px]  h-[18px]"})}),(0,e.jsxs)("div",{className:"flex flex-col gap-y-[5px] justify-center flex-1 min-w-[0]",children:[(0,e.jsx)("span",{className:"text-[#213044] text-[12px] font-[500] truncate w-full",children:j.name}),(0,e.jsx)("span",{className:"text-[#999999] text-[12px] truncate",children:j.description})]})]}),(0,e.jsxs)("div",{className:"shrink-0 flex gap-x-[15px] items-center",children:[(0,e.jsx)("div",{className:"edit cursor-pointer w-[20px] h-[20px] flex justify-center items-center opacity-0 transition",onClick:function(){me(j)},children:(0,e.jsx)("img",{className:"w-[16px] h-[16px]",src:"/icons/edit_icon_1.svg"})}),(0,e.jsx)(Be.Z,{size:"small",disabled:d,defaultChecked:!0,className:"w-[28px]",checked:j.active==1,onChange:function(){G(j)}})]})]},j.agent_id)}):(0,e.jsx)("div",{className:"w-full min-h-[220px] flex items-center justify-center",children:(0,e.jsx)(Me.Z,{image:Me.Z.PRESENTED_IMAGE_SIMPLE})})}):(0,e.jsx)("div",{className:"flex justify-center w-full h-full items-center",children:(0,e.jsx)(Ne.Z,{})})})}),(0,e.jsx)("div",{className:"px-[20px] ",children:(0,e.jsx)("div",{style:{border:"1px solid #1B64F3"},onClick:xe,className:"w-full h-[30px] transition text-[#1B64F3] flex items-center justify-center cursor-pointer rounded-[6px] hover:text-[#fff] hover:bg-[#1B64F3]",children:(0,e.jsx)("span",{className:"text-[12px]",children:r.formatMessage({id:"app.chatroom.add.agent"})})})}),(0,e.jsx)("div",{className:"px-[20px] pt-[15px]",children:(0,e.jsx)("div",{style:S&&!d?{border:"1px solid #1B64F3"}:{background:"#d9d9d9",color:"rgba(0,0,0,0.25)",cursor:"not-allowed"},onClick:(0,Oe.throttle)(function(){S&&!d&&R()}),className:"w-full h-[30px] transition text-[#1B64F3] flex items-center justify-center cursor-pointer rounded-[6px] hover:text-[#fff] hover:bg-[#1B64F3]",children:(0,e.jsx)("span",{className:"text-[12px]",children:r.formatMessage({id:"app.chatroom.sidebar.agent_button"})})})})]})}),(0,e.jsxs)("div",{className:"flex-1 min-h-[0] flex flex-col",children:[(0,e.jsx)("div",{className:"pt-[30px] px-[30px] text-[#666] text-[14px] shrink-0",children:r.formatMessage({id:"app.chatroom.sidebar.othe_title"})}),(0,e.jsx)("div",{className:"px-[10px] flex-1 min-h-[0] py-[10px]",children:(0,e.jsx)("div",{style:{height:"calc(100% - 20px)"},className:"px-[10px]  overflow-y-auto",children:E.current?(0,e.jsx)("div",{className:"h-full flex flex-col",children:L&&L.length>0?L.map(function(j){return(0,e.jsxs)("div",{className:"w-full transition hover:bg-[#FAFAFA] p-[10px] cursor-pointer",onClick:function(){le(j)},children:[(0,e.jsxs)("div",{className:"flex pb-[10px]",children:[(0,e.jsx)("div",{className:"flex-1 min-w-[0] truncate text-[#333] text-[14px]",children:j.name}),j.active==0?(0,e.jsxs)("div",{className:"flex items-center gap-x-[6px]",children:[(0,e.jsx)("img",{className:"w-[12px] h-[12px]",src:"/icons/plaza_m2_c2.svg",alt:""}),(0,e.jsx)("span",{className:"text-[12px] text-[#aaa]",children:r.formatMessage({id:"app.chatroom.sidebar.othe_status"})})]}):(0,e.jsxs)("div",{className:"flex items-center gap-x-[6px]",children:[(0,e.jsx)("img",{className:"w-[12px] h-[12px]",src:"/icons/plaza_m2_c1.svg",alt:""}),(0,e.jsx)("span",{className:"text-[12px] text-[#aaa]",children:r.formatMessage({id:"app.chatroom.sidebar.othe_status_succeed"})})]})]}),(0,e.jsx)("div",{className:"flex gap-x-[10px]",children:j.agent_list&&j.agent_list.length>0?(0,e.jsxs)(e.Fragment,{children:[se(j.agent_list).map(function(F,I){return(0,e.jsx)("div",{className:"flex",children:(0,e.jsx)("div",{className:"w-[30px] h-[30px] bg-[#F4F8F1] rounded-[6px] flex items-center justify-center",children:(0,e.jsx)("img",{src:(0,ve.s9)("single",F.icon),alt:"",className:"w-[18px]  h-[18px]"})})},I)}),j.agent_list.length>=6?(0,e.jsx)(Ze.Z,{}):(0,e.jsx)(e.Fragment,{})]}):(0,e.jsx)(e.Fragment,{})})]},j.chatroom_id)}):(0,e.jsx)("div",{className:"w-full h-full",children:(0,e.jsx)(Me.Z,{image:Me.Z.PRESENTED_IMAGE_SIMPLE})})}):(0,e.jsx)("div",{className:"flex justify-center w-full h-full items-center",children:(0,e.jsx)(Ne.Z,{})})})})]})]}),(0,e.jsx)(Pe.Z,{show:y,popupClose:ie,popupSave:ge,checkList:s,zIndex:99})]})]})},xt=(0,a.memo)(pt),ft=c(13769),mt=c.n(ft),vt=c(47635),de=c(1413),ht={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M862 465.3h-81c-4.6 0-9 2-12.1 5.5L550 723.1V160c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v563.1L255.1 470.8c-3-3.5-7.4-5.5-12.1-5.5h-81c-6.8 0-10.5 8.1-6 13.2L487.9 861a31.96 31.96 0 0048.3 0L868 478.5c4.5-5.2.8-13.2-6-13.2z"}}]},name:"arrow-down",theme:"outlined"},gt=ht,ke=c(91146),jt=function(n,r){return a.createElement(ke.Z,(0,de.Z)((0,de.Z)({},n),{},{ref:r,icon:gt}))},yt=a.forwardRef(jt),St=yt,Nt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372zm-88-532h-48c-4.4 0-8 3.6-8 8v304c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V360c0-4.4-3.6-8-8-8zm224 0h-48c-4.4 0-8 3.6-8 8v304c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V360c0-4.4-3.6-8-8-8z"}}]},name:"pause-circle",theme:"outlined"},wt=Nt,bt=function(n,r){return a.createElement(ke.Z,(0,de.Z)((0,de.Z)({},n),{},{ref:r,icon:wt}))},_t=a.forwardRef(bt),Ct=_t,Rt=c(2068),Mt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M312.1 591.5c3.1 3.1 8.2 3.1 11.3 0l101.8-101.8 86.1 86.2c3.1 3.1 8.2 3.1 11.3 0l226.3-226.5c3.1-3.1 3.1-8.2 0-11.3l-36.8-36.8a8.03 8.03 0 00-11.3 0L517 485.3l-86.1-86.2a8.03 8.03 0 00-11.3 0L275.3 543.4a8.03 8.03 0 000 11.3l36.8 36.8z"}},{tag:"path",attrs:{d:"M904 160H548V96c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v64H120c-17.7 0-32 14.3-32 32v520c0 17.7 14.3 32 32 32h356.4v32L311.6 884.1a7.92 7.92 0 00-2.3 11l30.3 47.2v.1c2.4 3.7 7.4 4.7 11.1 2.3L512 838.9l161.3 105.8c3.7 2.4 8.7 1.4 11.1-2.3v-.1l30.3-47.2a8 8 0 00-2.3-11L548 776.3V744h356c17.7 0 32-14.3 32-32V192c0-17.7-14.3-32-32-32zm-40 512H160V232h704v440z"}}]},name:"fund-projection-screen",theme:"outlined"},Ft=Mt,kt=function(n,r){return a.createElement(ke.Z,(0,de.Z)((0,de.Z)({},n),{},{ref:r,icon:Ft}))},Dt=a.forwardRef(kt),It=Dt,nt=c(26915),At=c(20640),rt=c.n(At),we=c(22683),be=c(97807),Et=["node","className","children"],Ot=nt.Z.TextArea,Pt=(0,a.memo)(function(i){var n=i.setInstruction,r=i.messageApi,l=i.isStop,_=i.scrollDomRef,x=i.upButtonDom,u=(0,X.useIntl)(),g=Q(function(C){return C.disableInput}),N=Q(function(C){return C.setDisableInput}),w=(0,a.useState)(""),m=o()(w,2),d=m[0],S=m[1],b=function(s){!s.shiftKey&&s.target.value==""&&(r.open({type:"warning",content:u.formatMessage({id:"app.chatroom.content.input"}),duration:10}),S(""),s.preventDefault()),!s.shiftKey&&s.keyCode==13&&s.target.value!=""&&(N(!0),S(""),n(["INPUT",s.target.value]),s.preventDefault())},t=(0,Oe.throttle)(function(){n(["STOP",null])},300);return(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)("div",{className:"max-w-[920px] w-full min-h-[60px] mt-[20px] mb-[20px] mx-auto relative",children:[(0,e.jsx)("div",{ref:x,className:"w-[40px] h-[40px] rounded-[6px]  bg-[#fff] border border-[#ddd] cursor-pointer absolute top-[-67px] left-2/4 flex items-center justify-center hidden",onClick:function(s){_.current.scrollTo({top:_.current.scrollHeight,behavior:"smooth"})},children:(0,e.jsx)(St,{className:"text-[16px]"})}),(0,e.jsxs)("div",{className:"flex items-center p-[12px] gap-[10px] box-border border border-[#ccc] bg-[#fff] rounded-[8px]",children:[(0,e.jsx)(Ot,{id:"userValue",className:"placeholder-text-[#aaa] placeholder-text-[14px]",autoSize:{minRows:1,maxRows:6},value:d,disabled:g,onChange:function(s){S(s.target.value)},onPressEnter:b,style:{height:"34px",border:"none",resize:"none",backgroundColor:"transparent"},placeholder:"".concat(u.formatMessage({id:"app.chatroom.content.input"}),"\u2026")}),l?(0,e.jsx)("div",{className:"min-w-[34px] h-[34px] bg-[#000] flex items-center justify-center cursor-pointer rounded-[4px]",onClick:t,children:(0,e.jsx)(Ct,{style:{color:"#fff",fontSize:"20px"}})}):(0,e.jsx)("div",{className:"".concat(g||!d?"bg-[#ddd]":"bg-[#1B64F3]"," min-w-[30px] h-[30px]  flex items-center justify-center cursor-pointer rounded-[6px]"),onClick:(0,Oe.throttle)(function(){if(g||!d)return!1;d||r.open({type:"warning",content:u.formatMessage({id:"app.chatroom.content.input"}),duration:10}),N(!0),n(["INPUT",d]),S("")},300),children:(0,e.jsx)("img",{src:"/icons/send_icon_w.svg",alt:"",className:"w-[18px] h-[18px]"})})]})]})})}),Tt=function i(n){return typeof n=="string"?n:Array.isArray(n)?n.map(i).join(""):a.isValidElement(n)?i(n.props.children):""},$t=function(n){return Tt(n)},Ye=function(n,r){return{code:function(_){var x=_.node,u=_.className,g=_.children,N=mt()(_,Et),w=/language-(\w+)/.exec(u||"");if(w!=null&&w.length){var m=Math.random().toString(36).substr(2,9);return(0,e.jsxs)("div",{className:" rounded-md border overflow-hidden",children:[(0,e.jsxs)("div",{className:"flex h-12 items-center justify-between bg-zinc-100 px-4 bg-zinc-900",children:[(0,e.jsx)("div",{className:"flex items-center gap-2",children:(0,e.jsx)("p",{className:"text-sm  text-[#fff] mb-[0]",children:w[1]})}),(0,e.jsxs)("div",{className:"text-[12px] text-[#fff] mb-[0] cursor-pointer flex gap-x-[5px]",onClick:function(){var d=re()(A()().mark(function S(b){var t;return A()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.prev=0,t=b.currentTarget,s.next=4,rt()($t(g));case 4:t&&(t.children[1].innerText=r.formatMessage({id:"app.chatroom.content.copySucceed"})),setTimeout(function(){t&&(t.children[1].innerText=r.formatMessage({id:"app.chatroom.content.copycode"}))},200),s.next=11;break;case 8:s.prev=8,s.t0=s.catch(0),console.error("Failed to copy text: ",s.t0);case 11:case"end":return s.stop()}},S,null,[[0,8]])}));return function(S){return d.apply(this,arguments)}}(),children:[(0,e.jsx)("img",{src:"/icons/chat_copy_w.svg"}),(0,e.jsx)("span",{children:r.formatMessage({id:"app.chatroom.content.copycode"})})]})]}),(0,e.jsx)("div",{className:"overflow-x-auto bg-[#282c34] text-[#abb2bf]",children:(0,e.jsx)("div",{id:"".concat(m).concat(n),className:"p-4",children:g})})]})}else return(0,e.jsx)("code",U()(U()({},N),{},{children:g}))}}},st=(0,a.memo)(function(i){var n=i.messageApi,r=i.index,l=i.idName,_=i.cidName,x=(0,X.useIntl)(),u=(0,a.useState)(!1),g=o()(u,2),N=g[0],w=g[1];return(0,e.jsx)("div",{className:"flex gap-x-[4px]",children:(0,e.jsxs)("div",{onMouseEnter:function(){w(!0)},onMouseLeave:function(){w(!1)},className:" p-[2px] cursor-pointer rounded-md flex gap-x-[5px] items-center pt-[10px]",onClick:function(){var m=re()(A()().mark(function d(S){var b,t;return A()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return b=S.target.closest("#".concat(l).concat(r)),t=b.querySelector("#".concat(_).concat(r)),s.prev=2,s.next=5,rt()(t.innerText);case 5:n.open({type:"success",content:x.formatMessage({id:"app.chatroom.content.copySucceed"}),duration:2}),s.next=11;break;case 8:s.prev=8,s.t0=s.catch(2),console.error("Failed to copy text: ",s.t0);case 11:case"end":return s.stop()}},d,null,[[2,8]])}));return function(d){return m.apply(this,arguments)}}(),children:[(0,e.jsx)("img",{src:"".concat(N?"/icons/chat_copy_check.svg":"/icons/chat_copy.svg"),className:"w-[16px] h-[16px]"}),(0,e.jsx)("span",{className:"text-[12px] ".concat(N?" text-[#1B64F3]":"text-[#666]"),children:x.formatMessage({id:"app.chatroom.content.copy"})})]})})}),it=function(n){var r=n.id,l=n.index,_=n.idName,x=n.cidName,u=(0,X.useIntl)(),g=Q(function(t){return t.setSummaryClick}),N=(0,a.useState)(!0),w=o()(N,2),m=w[0],d=w[1],S=Q(function(t){return t.summaryClick});(0,a.useEffect)(function(){d(S)},[S]);var b=Q(function(t){return t.setSummaryParams});return(0,e.jsx)("div",{className:"flex gap-x-[4px] text-[#666] ".concat(m?"cursor-pointer hover:text-[#1B64F3]":"cursor-no-drop"),children:(0,e.jsxs)("div",{className:" p-[2px]  rounded-md flex gap-x-[5px] items-center pt-[10px]",onClick:function(C){if(m){var s=C.target.closest("#".concat(_).concat(l)),k=s.querySelector("#".concat(x).concat(l));b({id:r,message:k.innerText}),g(!1)}},children:[(0,e.jsx)(Rt.Z,{className:"text-[16px]"}),(0,e.jsx)("span",{className:"text-[12px]",children:u.formatMessage({id:"app.chatroom.content.summary"})})]})})},Lt=function(n){var r=n.roomid,l=(0,X.useIntl)(),_=Q(function(d){return d.setSummaryClick}),x=(0,a.useState)(!0),u=o()(x,2),g=u[0],N=u[1],w=Q(function(d){return d.summaryClick});(0,a.useEffect)(function(){N(w)},[w]);var m=Q(function(d){return d.setSummaryParams});return(0,e.jsx)("div",{className:"bg-[#fff] text-[#999999]   items-center justify-center rounded-[8px] ".concat(g?"cursor-pointer hover:text-[#1B64F3]":"cursor-no-drop"),style:{boxShadow:"0px 0px 4px 0px rgba(0,0,0,0.1)"},children:(0,e.jsxs)("div",{className:" gap-x-[4px] flex items-center justify-center h-[40px] px-[20px]",onClick:function(){g&&(m({id:r}),_(!1))},children:[(0,e.jsx)(It,{className:"text-[16px]"}),(0,e.jsx)("span",{className:"text-[14px]",children:l.formatMessage({id:"app.chatroom.content.meetingSummary"})})]})})},Zt=(0,a.memo)(function(i){var n=i.messageApi,r=i.setCurrentMessageContent,l=i.sendValue,_=i.agentList,x=i.scrollDomRef,u=i.upButtonDom,g=i.setIsStop,N=i.setisEnd,w=i.setSendValue,m=(0,X.useIntl)(),d=(0,X.useParams)(),S=d.id,b=Q(function(P){return P.setDisableInput}),t=(0,a.useState)({}),C=o()(t,2),s=C[0],k=C[1],B=(0,a.useRef)(!1),$=(0,a.useRef)(""),h=Q(function(P){return P.setTruncatable}),Z=function(E){var v=E.data;if(v.indexOf("--NEXUSAI-INSTRUCTION-")!==-1){var D=JSON.parse(v.slice(22,-2));switch(D[0]){case"ERROR":b(!1),g(!1),w(""),n.open({type:"error",content:"webSocket-".concat(D[1]),duration:10});break;case"CHAT":var y={content:"".concat(D[1]),is_agent:0};r(function(f){return[].concat(ue()(f),[y])}),setTimeout(function(){x.current.scrollTop=x.current.scrollHeight,u.current.style.display="none"});break;case"STOPPABLE":g(D[1]);break;case"TRUNCATABLE":h(D[1]),D[1]||n.open({type:"success",content:"".concat(m.formatMessage({id:"app.chatroom.sidebar.cleartips"})),duration:3});break;case"TRUNCATEOK":n.open({type:"success",content:"".concat(m.formatMessage({id:"app.chatroom.sidebar.cleartips"})),duration:3});break}}if(v.indexOf("REPLY")!==-1&&v.indexOf("--NEXUSAI-INSTRUCTION-")!==-1){var M=JSON.parse(v.slice(22,-2))[1];$.current="",B.current=!0;var R=_.current.filter(function(f){return f.agent_id==M})[0];Object.keys(s).length&&r(function(f){return[].concat(ue()(f),[s])}),k(function(f){return U()(U()({},f),{},{is_agent:1,icon:R==null?void 0:R.icon,name:R==null?void 0:R.name})}),g(!0),h(!1)}v.indexOf("--NEXUSAI-INSTRUCTION-")===-1&&B.current&&(x.current.scrollTop=x.current.scrollHeight,u.current.style.display="none",$.current+=v,k(function(f){return U()(U()({},f),{},{content:$.current})})),v.indexOf("ENDCHAT")!==-1&&(B.current=!1,$.current="",b(!1),g(!1),h(!0),Object.keys(s).length&&r(function(f){return[].concat(ue()(f),[s])}),k({}),N(!0),w(""))},Y=(0,vt.Z)("chat",Z),te=Y.runSocket,L=Y.sendMessage,z=Y.readyState;return(0,a.useEffect)(function(){z==1&&S&&L(JSON.stringify(["ENTER",parseInt(S)]))},[z]),(0,a.useEffect)(function(){l&&z==1&&L(l)},[l]),(0,a.useEffect)(function(){te()},[]),(0,e.jsx)(e.Fragment,{children:s.name?(0,e.jsxs)("div",{className:"w-full flex gap-[15px] pt-[15px] pb-[15px] ".concat(s.is_agent!=1?"flex-row-reverse":""),children:[(0,e.jsx)("div",{className:"w-[40px] h-[40px] bg-[#F4F8F1] rounded-[6px] flex items-center justify-center shrink-0",children:s.is_agent==1?(0,e.jsx)("img",{src:(0,ve.s9)("single",s.icon),alt:"",className:"w-[18px]  h-[18px]"}):(0,e.jsx)("img",{src:"/icons/user_header.svg",className:"w-[18px]  h-[18px]"})}),(0,e.jsxs)("div",{className:"flex1 max-w-[560px] text-right",id:"addcontent",children:[(0,e.jsx)("div",{className:"".concat(s.is_agent==1?"text-left":"text-right"," font-[500] text-[14px] text-[#213044] pb-[8px]"),children:s.name?s.name:(0,ve.Qy)("GET").nickname}),(0,e.jsx)("div",{className:"text-left inline-block markdown-container text-[14px] font-[400] text-[#213044] bg-[#F7F7F7] p-[15px] pb-[1px] leading-[22px]",style:s.is_agent==1?{borderRadius:" 0px 8px 8px 8px"}:{borderRadius:"8px 0px 8px 8px",background:"rgba(27,100,243,0.1)",whiteSpace:"pre-wrap"},id:"addchilContent",children:(0,e.jsx)(we.U,{rehypePlugins:[be.Z],components:Ye("add",m),children:s.content})})]})]}):(0,e.jsx)(e.Fragment,{})})}),Ht=(0,a.memo)(function(i){var n=i.messageApi,r=i.setUserMessage,l=i.sendValue,_=i.agentList,x=i.scrollDomRef,u=i.upButtonDom,g=i.setIsStop,N=i.setSendValue,w=(0,X.useIntl)(),m=(0,a.useState)([]),d=o()(m,2),S=d[0],b=d[1],t=(0,a.useState)(!1),C=o()(t,2),s=C[0],k=C[1],B=(0,X.useParams)(),$=B.id;return(0,a.useEffect)(function(){s&&(r(function(h){return[].concat(ue()(h),ue()(S))}),b([]),setTimeout(function(){k(!1),x.current.scrollTop=x.current.scrollHeight},200))},[s]),(0,e.jsxs)(e.Fragment,{children:[S.length?S.map(function(h,Z){return(0,e.jsxs)("div",{className:"w-full flex gap-[15px] pt-[15px] pb-[15px] ".concat(h.is_agent!=1?"flex-row-reverse":""),children:[(0,e.jsx)("div",{className:"w-[40px] h-[40px] bg-[#F4F8F1] rounded-[6px] flex items-center justify-center shrink-0",children:h.is_agent==1?(0,e.jsx)("img",{src:(0,ve.s9)("single",h.icon),alt:"",className:"w-[18px]  h-[18px]"}):(0,e.jsx)("img",{src:"/icons/user_header.svg",className:"w-[18px]  h-[18px]"})}),(0,e.jsxs)("div",{className:"flex1 max-w-[560px] text-right",id:"currentContent".concat(Z),children:[(0,e.jsx)("div",{className:"".concat(h.is_agent==1?"text-left":"text-right"," font-[500] text-[14px] text-[#213044] pb-[8px]"),children:h.name?h.name:(0,ve.Qy)("GET").nickname}),(0,e.jsx)("div",{className:"text-left inline-block markdown-container text-[14px] font-[400] text-[#213044] bg-[#F7F7F7] p-[15px] pb-[1px] leading-[22px]",style:h.is_agent==1?{borderRadius:" 0px 8px 8px 8px"}:{borderRadius:"8px 0px 8px 8px",background:"rgba(27,100,243,0.1)",whiteSpace:"pre-wrap"},id:"currentChilContent".concat(Z),children:(0,e.jsx)(we.U,{rehypePlugins:[be.Z],components:Ye(Z,w),children:h.content})}),h.is_agent==1?(0,e.jsxs)("div",{className:"flex gap-x-[20px]",children:[(0,e.jsx)(st,{messageApi:n,index:Z,idName:"currentContent",cidName:"currentChilContent"}),(0,e.jsx)(it,{id:$,index:Z,idName:"currentContent",cidName:"currentChilContent"})]}):(0,e.jsx)(e.Fragment,{})]})]},Z)}):(0,e.jsx)(e.Fragment,{}),(0,e.jsx)(Zt,{messageApi:n,setCurrentMessageContent:b,sendValue:l,agentList:_,scrollDomRef:x,upButtonDom:u,setIsStop:g,setisEnd:k,setSendValue:N})]})}),Bt=(0,a.memo)(function(i){var n=i.messageApi,r=i.scrollDomRef,l=i.instruction,_=i.setIsStop,x=i.upButtonDom,u=i.setInstruction,g=i.agentList,N=(0,X.useIntl)(),w=(0,X.useParams)(),m=w.id,d=(0,a.useState)([]),S=o()(d,2),b=S[0],t=S[1],C=(0,a.useRef)(!1),s=(0,a.useState)(""),k=o()(s,2),B=k[0],$=k[1],h=(0,a.useRef)(null),Z=(0,a.useRef)(null),Y=(0,a.useRef)(!0),te=(0,a.useRef)(2),L=(0,a.useRef)(1),z=(0,a.useRef)(0),P=function(){var M=re()(A()().mark(function R(f){var K,G,se=arguments;return A()().wrap(function(le){for(;;)switch(le.prev=le.next){case 0:if(K=se.length>1&&se[1]!==void 0?se[1]:function(){},!m){le.next=6;break}return le.next=4,(0,pe.KH)(m,{page:L.current,page_size:20});case 4:G=le.sent,G.code==0&&(te.current=G.data.total_pages,t(function(xe){return f?ue()(G.data.list):[].concat(ue()(G.data.list),ue()(xe))}),f?setTimeout(function(){r.current.scrollTop=r.current.scrollHeight,x.current.style.display="none"}):z.current=G.data.list.length);case 6:case"end":return le.stop()}},R)}));return function(f){return M.apply(this,arguments)}}(),E=function(R){var f=R.target.scrollHeight-R.target.scrollTop-R.target.clientHeight;if(C.current!==Math.ceil(f)>50&&(C.current=Math.ceil(f)>50,x.current.style.display=C.current?"flex":"none"),R.target.scrollTop==0&&Y.current){Y.current=!1;var K=h.current.firstChild;L.current=L.current+1,Z.current.style.display="flex",te.current,te.current>=L.current?P(!1):Z.current.style.display="none"}},v=function(R,f){f==="0"&&(f=Number(f));var K=["".concat(R),f===0||f?f:null];$(JSON.stringify(K))},D=Q(function(M){return M.disableInput}),y=Q(function(M){return M.clearMemory});return(0,a.useEffect)(function(){y&&y.length&&v(y[0],y[1])},[y]),(0,a.useEffect)(function(){l&&l.length&&(v(l[0],l[1]?l[1]:""),u([]))},[l]),(0,a.useEffect)(function(){z.current&&h.current.children[z.current]&&(r.current.scrollTop=h.current.children[z.current].offsetTop,Y.current=!0)},[b]),(0,a.useEffect)(function(){L.current=1,P(!0)},[]),(0,e.jsxs)("div",{className:"flex-1 box-border relative overflow-y-auto chatroom overflow-x-hidden",ref:r,onScroll:E,children:[(0,e.jsx)("div",{className:"text-center justify-center items-center flex",style:{display:"none"},ref:Z,children:(0,e.jsx)(Ne.Z,{})}),(0,e.jsxs)("div",{className:"max-w-[920px] mx-auto",style:{minHeight:"calc(100% - 50px)"},ref:h,children:[b.map(function(M,R){return(0,e.jsxs)("div",{id:"c".concat(M.id),className:"w-full flex gap-[15px] pt-[15px] pb-[15px] ".concat(M.is_agent!=1?"flex-row-reverse":""),children:[(0,e.jsx)("div",{className:"w-[40px] h-[40px] bg-[#F4F8F1] rounded-[6px] flex items-center justify-center shrink-0",children:M.is_agent==1?(0,e.jsx)("img",{src:(0,ve.s9)("single",M.icon),alt:"",className:"w-[18px]  h-[18px]"}):(0,e.jsx)("img",{src:"/icons/user_header.svg",className:"w-[18px]  h-[18px]"})}),(0,e.jsxs)("div",{className:"flex1 max-w-[560px] text-right",id:"content".concat(R),children:[(0,e.jsx)("div",{className:"".concat(M.is_agent==1?"text-left":"text-right"," font-[500] text-[14px] text-[#213044] pb-[8px]"),children:M.name?M.name:(0,ve.Qy)("GET").nickname}),(0,e.jsx)("div",{className:"text-left markdown-container inline-block text-[14px] font-[400] text-[#213044] bg-[#F7F7F7] p-[15px] pb-[1px] leading-[22px]",style:M.is_agent==1?{borderRadius:" 0px 8px 8px 8px"}:{borderRadius:"8px 0px 8px 8px",background:"rgba(27,100,243,0.1)",whiteSpace:"pre-wrap"},id:"chilContent".concat(R),children:(0,e.jsx)(we.U,{rehypePlugins:[be.Z],components:Ye(R,N),children:M.content})}),M.is_agent==1?(0,e.jsxs)("div",{className:"flex gap-x-[20px]",children:[(0,e.jsx)(st,{messageApi:n,idName:"content",cidName:"chilContent",index:R}),(0,e.jsx)(it,{id:m,index:R,idName:"content",cidName:"chilContent"})]}):(0,e.jsx)(e.Fragment,{})]})]},R)}),(0,e.jsx)(Ht,{messageApi:n,setUserMessage:t,sendValue:B,agentList:g,scrollDomRef:r,upButtonDom:x,setIsStop:_,setSendValue:$})]}),(0,e.jsx)("div",{className:"w-full flex justify-center pb-[10px]",children:!D&&b.length?(0,e.jsx)(Lt,{roomid:m}):(0,e.jsx)(e.Fragment,{})})]})}),zt=(0,a.memo)(function(i){var n=i.agentList,r=(0,a.useRef)(null),l=(0,a.useRef)(null),_=(0,a.useState)(!1),x=o()(_,2),u=x[0],g=x[1],N=(0,a.useState)([]),w=o()(N,2),m=w[0],d=w[1],S=Ee.ZP.useMessage(),b=o()(S,2),t=b[0],C=b[1];return(0,e.jsxs)(e.Fragment,{children:[C,(0,e.jsx)("div",{className:"mx-[44px] flex justify-center relative box-border pt-[12px]   overflow-auto",style:{height:"calc(100% )"},children:(0,e.jsxs)("div",{className:"flex flex-col w-full",children:[(0,e.jsx)(Bt,{instruction:m,setInstruction:d,messageApi:t,scrollDomRef:r,setIsStop:g,upButtonDom:l,agentList:n}),(0,e.jsx)(Pt,{setInstruction:d,messageApi:t,isStop:u,upButtonDom:l,scrollDomRef:r})]})})]})}),Vt=c(42881),Ut=function(n){var r=n.children,l=n.className,_=l===void 0?"":l,x=n.dragDirection,u=x===void 0?"left":x,g=n.minWidth,N=g===void 0?415:g,w=n.maxWidth,m=w===void 0?820:w,d=n.minHeight,S=d===void 0?200:d,b=n.maxHeight,t=b===void 0?800:b,C=n.defaultWidth,s=C===void 0?415:C,k=n.defaultHeight,B=k===void 0?300:k,$=(0,a.useState)(s),h=o()($,2),Z=h[0],Y=h[1],te=(0,a.useState)(B),L=o()(te,2),z=L[0],P=L[1],E=(0,a.useCallback)(function(M,R){Y(M),R&&P(R)},[Y,P]),v=(0,Vt.W)({direction:["left","right"].includes(u)?"horizontal":"vertical",triggerDirection:u,minWidth:N,maxWidth:m,minHeight:S,maxHeight:t,onResize:E}),D=v.triggerRef,y=v.containerRef;return(0,e.jsxs)("div",{ref:y,style:{width:["left","right"].includes(u)?"".concat(Z,"px"):void 0,height:["top","bottom"].includes(u)?"".concat(z,"px"):void 0},className:"flex flex-col p-4 shadow-lg rounded-md border border-blue-300 bg-white z-10 wrapPanel ".concat(_),children:[u==="left"&&(0,e.jsx)("div",{ref:D,className:"absolute top-1/2 -translate-y-1/2 -left-2 w-3 h-6 cursor-col-resize resize-x",children:(0,e.jsx)("div",{className:"w-1 h-6 bg-gray-300 rounded-sm"})}),u==="right"&&(0,e.jsx)("div",{ref:D,className:"absolute top-1/2 -translate-y-1/2 -right-2 flex justify-end w-3 h-6 cursor-col-resize resize-x",children:(0,e.jsx)("div",{className:"w-1 h-6 bg-gray-300 rounded-sm"})}),u==="top"&&(0,e.jsx)("div",{ref:D,className:"absolute left-1/2 -translate-x-1/2 -top-2 h-3 w-6 cursor-row-resize resize-y",children:(0,e.jsx)("div",{className:"h-1 w-6 bg-gray-300 rounded-sm"})}),u==="bottom"&&(0,e.jsx)("div",{ref:D,className:"absolute left-1/2 -translate-x-1/2 -bottom-2 h-3 w-6 cursor-row-resize resize-y",children:(0,e.jsx)("div",{className:"h-1 w-6 bg-gray-300 rounded-sm"})}),r]})},Wt=(0,a.memo)(Ut),Gt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M762 164h-64c-4.4 0-8 3.6-8 8v688c0 4.4 3.6 8 8 8h64c4.4 0 8-3.6 8-8V172c0-4.4-3.6-8-8-8zm-508 0v72.4c0 9.5 4.2 18.4 11.4 24.5L564.6 512 265.4 763.1c-7.2 6.1-11.4 15-11.4 24.5V860c0 6.8 7.9 10.5 13.1 6.1L689 512 267.1 157.9A7.95 7.95 0 00254 164z"}}]},name:"vertical-left",theme:"outlined"},Kt=Gt,Jt=function(n,r){return a.createElement(ke.Z,(0,de.Z)((0,de.Z)({},n),{},{ref:r,icon:Kt}))},Qt=a.forwardRef(Jt),Xt=Qt,Yt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M326 164h-64c-4.4 0-8 3.6-8 8v688c0 4.4 3.6 8 8 8h64c4.4 0 8-3.6 8-8V172c0-4.4-3.6-8-8-8zm444 72.4V164c0-6.8-7.9-10.5-13.1-6.1L335 512l421.9 354.1c5.2 4.4 13.1.7 13.1-6.1v-72.4c0-9.4-4.2-18.4-11.4-24.5L459.4 512l299.2-251.1c7.2-6.1 11.4-15.1 11.4-24.5z"}}]},name:"vertical-right",theme:"outlined"},qt=Yt,ea=function(n,r){return a.createElement(ke.Z,(0,de.Z)((0,de.Z)({},n),{},{ref:r,icon:qt}))},ta=a.forwardRef(ea),aa=ta,na=c(83159),ra=c(66309),lt=c(42237),sa={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M464 144H160c-8.8 0-16 7.2-16 16v304c0 8.8 7.2 16 16 16h304c8.8 0 16-7.2 16-16V160c0-8.8-7.2-16-16-16zm-52 268H212V212h200v200zm452-268H560c-8.8 0-16 7.2-16 16v304c0 8.8 7.2 16 16 16h304c8.8 0 16-7.2 16-16V160c0-8.8-7.2-16-16-16zm-52 268H612V212h200v200zm52 132H560c-8.8 0-16 7.2-16 16v304c0 8.8 7.2 16 16 16h304c8.8 0 16-7.2 16-16V560c0-8.8-7.2-16-16-16zm-52 268H612V612h200v200zM424 712H296V584c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v128H104c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h128v128c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V776h128c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8z"}}]},name:"appstore-add",theme:"outlined"},ia=sa,la=function(n,r){return a.createElement(ke.Z,(0,de.Z)((0,de.Z)({},n),{},{ref:r,icon:ia}))},ca=a.forwardRef(la),oa=ca,ua=c(93696),da=function(n,r){return a.createElement(ke.Z,(0,de.Z)((0,de.Z)({},n),{},{ref:r,icon:ua.Z}))},pa=a.forwardRef(da),xa=pa,qe=c(86),fa=c(34994),ma=c(4981),va=c(2216),ha=c(85877),ga=c(29432),ja=c(39944),ya=c(11551),et=c(29608),ct=c(55927),Sa=(0,a.memo)(function(i){var n=i.progressObj,r=function(){return parseFloat(n.elapsed_time).toFixed(6)},l=function(x){var u=new Date(x),g=u.getFullYear(),N=(u.getMonth()+1).toString().padStart(2,"0"),w=u.getDate().toString().padStart(2,"0"),m=u.getHours().toString().padStart(2,"0"),d=u.getMinutes().toString().padStart(2,"0"),S=u.getSeconds().toString().padStart(2,"0");return(0,e.jsx)(e.Fragment,{children:"".concat(g,".").concat(N,".").concat(w," ").concat(m,":").concat(d,":").concat(S)})};return(0,e.jsx)("div",{className:"inline-flex gap-x-4 justify-end max-w-[100%]",children:(0,e.jsxs)("div",{className:"inline-flex gap-x-[20px] max-w-[100%]",children:[(0,e.jsx)("div",{className:"truncate min-w-[70px]",children:n.created_time&&l(n.created_time)}),(0,e.jsx)("div",{className:"truncate",children:n.apps_name||n.app_name}),(0,e.jsxs)("div",{className:"flex items-center gap-x-[7px] truncate min-w-[50px]",children:[(0,e.jsx)("div",{className:"shrink-0 rounded-full ".concat(n.status==1?"bg-blue-600":n.status==2?"bg-green-500":"bg-red-500"),style:{width:"3px",height:"3px"}}),(0,e.jsxs)("div",{className:"truncate",children:[r(),"S"]})]})]})})}),Na=function(n){var r,l,_,x,u,g,N=(0,X.useIntl)(),w=n.runid,m=n.id,d=n.setBoxLoading,S=n.scrollDom,b=n.setinputShow,t=(0,a.useState)(null),C=o()(t,2),s=C[0],k=C[1],B=(0,a.useState)(null),$=o()(B,2),h=$[0],Z=$[1],Y=(0,a.useState)("agent"),te=o()(Y,2),L=te[0],z=te[1],P=(0,a.useState)({type:"agent",checkItem:[],show:!1}),E=o()(P,2),v=E[0],D=E[1],y=(0,a.useState)([]),M=o()(y,2),R=M[0],f=M[1],K=(0,a.useState)(""),G=o()(K,2),se=G[0],me=G[1],le=(0,a.useState)(!1),xe=o()(le,2),ie=xe[0],ge=xe[1],je=(0,a.useState)(null),j=o()(je,2),F=j[0],I=j[1],ce=(0,a.useState)(null),W=o()(ce,2),ee=W[0],De=W[1],J=(0,a.useState)(""),oe=o()(J,2),ye=oe[0],Se=oe[1],_e=(0,a.useRef)(""),Ie=(0,a.useRef)(null),Ae=(0,a.useRef)(""),ot=(0,a.useRef)(""),Ea=(0,et.Z)(function(T){return T.setDealtWithData}),Oa=(0,et.Z)(function(T){return T.setRunPanelLogRecord}),Pa=[{key:"1",label:(0,e.jsx)("div",{className:"hover:text-[#1B64F3]",onClick:function(){D(function(p){return U()(U()({},p),{},{type:"agent",show:!0})})},children:N.formatMessage({id:"app.summary.SelectAgent"})})},{key:"2",label:(0,e.jsx)("div",{className:"hover:text-[#1B64F3]",onClick:function(){D(function(p){return U()(U()({},p),{},{type:"workflow",show:!0})})},children:N.formatMessage({id:"app.summary.SelectWorkflow"})})}],Ta=function(){var T=re()(A()().mark(function p(O,ae){var H,ne;return A()().wrap(function(q){for(;;)switch(q.prev=q.next){case 0:return q.next=2,(0,pe.xT)(O,ae);case 2:H=q.sent,(H==null?void 0:H.code)==0&&(Ae.current=H==null||(ne=H.data)===null||ne===void 0?void 0:ne.app_run_id);case 4:case"end":return q.stop()}},p)}));return function(O,ae){return T.apply(this,arguments)}}(),$a=function(){var T=re()(A()().mark(function p(O,ae){var H,ne;return A()().wrap(function(q){for(;;)switch(q.prev=q.next){case 0:if(ae=="agent"){q.next=5;break}return q.next=3,(0,lt.zO)(O);case 3:H=q.sent,H.code==0&&Z(H==null||(ne=H.data)===null||ne===void 0?void 0:ne.need_confirm_nodes);case 5:Ta(m,{app_id:O,app_run_id:w,status:1,corrected_parameter:""});case 6:case"end":return q.stop()}},p)}));return function(O,ae){return T.apply(this,arguments)}}(),La=function(){D(function(p){return U()(U()({},p),{},{show:!1})})},Za=function(p){d(!0),k(null),D(function(O){return U()(U()({},O),{},{checkItem:p.checkItem})}),z(v.type),$a(p.checkItem[0].app_id,v.type),_e.current=p.checkItem[0].app_id,setTimeout(function(){S.current.scrollTo({top:S.current.scrollHeight})},300)},Ha=function(p){return p.completed_progress?parseInt(p.completed_progress.slice(0,-1)):!1},Ba=function(p){ot.current=ut(p);var O={user:{value:ut(p)}};me(new ja.z(O))},ut=function T(p){return p.map(function(O){return O.type==="mention"?O.id:O.children?T(O.children):O.text}).join("")},za=function(){var T=re()(A()().mark(function p(){var O,ae;return A()().wrap(function(ne){for(;;)switch(ne.prev=ne.next){case 0:O=Ce==null?void 0:Ce.filter(function(V){return V.type=="workflow_run_progress"&&V.data.app_run_id==Ae.current}).map(function(V){var q=V.data;return q}),O&&O.length&&(ae=O[O.length-1],I(ae),d(!1));case 2:case"end":return ne.stop()}},p)}));return function(){return T.apply(this,arguments)}}(),Va=function(){var T=re()(A()().mark(function p(){var O,ae,H,ne,V;return A()().wrap(function(ze){for(;;)switch(ze.prev=ze.next){case 0:ae=Ce==null?void 0:Ce.filter(function(fe){return fe.type=="workflow_need_human_confirm"&&fe.data.app_run_id==Ae.current}),H=(O=ae.map(function(fe){var Re=fe.data,tt=fe.need_human_confirm;return{data:Re,need_human_confirm:tt}}))===null||O===void 0?void 0:O.filter(function(fe){return fe.data.type!==1}),H&&H.length&&(V=H[H.length-1].data,V.exec_id=V==null||(ne=V.node_exec_data)===null||ne===void 0?void 0:ne.node_exec_id,De(H[H.length-1]),d(!1));case 3:case"end":return ze.stop()}},p)}));return function(){return T.apply(this,arguments)}}(),Ua=function(){var T=re()(A()().mark(function p(O){var ae,H,ne,V,q;return A()().wrap(function(fe){for(;;)switch(fe.prev=fe.next){case 0:return d(!0),ae=Object.keys(O),H={},ae.forEach(function(Re){Ie.current.properties[Re]&&(Ie.current.properties[Re].value=O[Re]),h&&h.forEach(function(tt){tt.node_id==Re&&(H[Re]=O[Re])})}),ne={inputs:Ie.current,node_confirm_users:H,run_name:"chatroom-".concat(m,"-run-").concat(Ae.current,"-driven"),run_type:1,data_source_run_id:Ae.current},fe.next=7,(0,lt.UE)(_e.current,ne);case 7:V=fe.sent,V.code==0&&(Ae.current=V==null||(q=V.data)===null||q===void 0?void 0:q.app_run_id,ge(!0));case 9:case"end":return fe.stop()}},p)}));return function(O){return T.apply(this,arguments)}}(),Wa=function(){var T=re()(A()().mark(function p(O){var ae,H;return A()().wrap(function(V){for(;;)switch(V.prev=V.next){case 0:return console.log(se),d(!0),ae=Object.keys(O),ae.forEach(function(q){Ie.current.properties[q]&&(Ie.current.properties[q].value=O[q])}),V.next=6,(0,ya.LH)({agent_id:v.checkItem[0].agent_id,ability_id:0,input_dict:Ie.current,prompt:se,data_source_run_id:Ae.current});case 6:H=V.sent,H.code==0&&(Se(H.data.outputs_md),d(!1));case 8:case"end":return V.stop()}},p)}));return function(O){return T.apply(this,arguments)}}(),Ce=(0,ct.Z)(function(T){return T.flowMessage});return(0,a.useEffect)(function(){za(),Va();var T=Ce.filter(function(V){return V.data.app_run_id==w&&V.type.indexOf("generate_meeting_action_items")!==-1});if(T.length!=0){var p,O=(p=T[T.length-1])===null||p===void 0||(p=p.data)===null||p===void 0||(p=p.exec_data)===null||p===void 0||(p=p.outputs)===null||p===void 0?void 0:p.value;if(O){var ae=JSON.parse(O);Ie.current=ae;var H=Object.keys(ae.properties);if(H.length&&(k(ae.properties),L=="agent")){var ne=H.map(function(V){return{value:"<<".concat(ga.qX,".inputs.").concat(V,">>"),label:V}});f(ne)}b(!1),d(!1)}}},[Ce]),(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)("div",{className:"pt-[24px]  border-[#ddd]",style:{minHeight:v!=null&&(r=v.checkItem)!==null&&r!==void 0&&r.length?S==null||(l=S.current)===null||l===void 0?void 0:l.offsetHeight:"100%"},children:[(0,e.jsxs)("div",{className:"text-[14px] font-[500] flex item-center",children:[(0,e.jsx)("div",{className:"flex-1",children:N.formatMessage({id:"app.summary.Runapp"})}),(0,e.jsx)("div",{className:"px-[10px]",children:!ie&&!ye?(0,e.jsx)(na.Z,{menu:{items:Pa},children:(0,e.jsx)(oa,{className:"transition cursor-pointer text-[#999] text-[18px] hover:text-[#1B64F3]"})}):(0,e.jsx)(e.Fragment,{})})]}),(0,e.jsx)("div",{children:v!=null&&(_=v.checkItem)!==null&&_!==void 0&&_.length?(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("div",{className:"py-[6px]",children:(0,e.jsx)(qe.Z,{icon:v==null||(x=v.checkItem[0])===null||x===void 0?void 0:x.icon,title:v==null||(u=v.checkItem[0])===null||u===void 0?void 0:u.name,textDetails:v==null||(g=v.checkItem[0])===null||g===void 0?void 0:g.description,iconType:L=="agent"?"robot_icon":"workflow_icon",handleClick:function(){}})}),!ie&&s!=null?(0,e.jsxs)(fa.A,{submitter:{resetButtonProps:!1,submitButtonProps:{className:"w-full",disabled:L=="agent"&&!ot.current},searchConfig:{submitText:N.formatMessage({id:"workflow.button.run"})}},onFinish:function(p){L=="workflow"?Ua(p):Wa(p)},children:[(0,e.jsx)("div",{className:"py-[6px]",children:(0,e.jsx)(va._,{data:s})}),L=="workflow"?(0,e.jsx)(ma.e,{data:h}):(0,e.jsx)("div",{className:"h-[150px] overflow-y-auto border border-color-[#eee] py-[4px] px-[11px] mb-[8px]",children:(0,e.jsx)(ha.Z,{onChange:function(p){Ba(p)},options:R,placeholder:"\u8BF7\u8F93\u5165\u8FD0\u884C\u6307\u4EE4\uFF0C\u8F93\u5165@\u63D2\u5165\u53D8\u91CF"})})]}):(0,e.jsx)(e.Fragment,{}),ye?(0,e.jsx)("div",{className:"max-h-[400px] overflow-y-auto mt-[16px]",children:(0,e.jsx)("div",{className:"p-[12px]  bg-[#F7F7F7] leading-[22px]",children:(0,e.jsx)(we.U,{rehypePlugins:[be.Z],children:ye})})}):(0,e.jsx)(e.Fragment,{}),ee&&ee.need_human_confirm!=0?(0,e.jsx)("div",{className:"pt-[12px]",children:(0,e.jsxs)("div",{className:"flex gap-x-[6px] items-center h-[20px] cursor-pointer",onClick:function(){Ea(ee.data)},children:[(0,e.jsx)("div",{children:(0,e.jsx)(xa,{className:"text-[#1B64F3] text-[16px]"})}),(0,e.jsx)("span",{children:N.formatMessage({id:"app.summary.backlogTips"})})]})}):(0,e.jsx)(e.Fragment,{}),F?(0,e.jsx)("div",{className:"pt-[10px]",children:(0,e.jsx)(qe.Z,{status:F.status,icon:F.icon,title:(0,e.jsxs)("div",{className:"items-center gap-x-[8px] inline-flex justify-end w-full",children:[(0,e.jsx)("span",{className:"flex-1 truncate",children:F.run_name}),F.need_human_confirm==1?(0,e.jsx)(ra.Z,{className:" text-[12px] flex items-center justify-center margin-0",color:"blue",children:N.formatMessage({id:"app.summaryhistory.tag"})}):(0,e.jsx)(e.Fragment,{})]}),textDetails:(0,e.jsx)(Sa,{progressObj:F}),handleClick:function(){Oa(F)},progress:Ha(F)})}):(0,e.jsx)(e.Fragment,{})]}):(0,e.jsxs)("div",{className:"flex gap-x-[20px] min-h-[70px] items-center px-[20px]",children:[(0,e.jsxs)(he.ZP,{className:"flex-1 text-[14px]",onClick:function(){D(function(p){return U()(U()({},p),{},{type:"agent",show:!0})})},children:[(0,e.jsx)("img",{src:"/icons/robot_icon.svg",alt:"",className:"w-[14px] h-[14px]"}),N.formatMessage({id:"app.summary.SelectAgent"})]}),(0,e.jsxs)(he.ZP,{className:"flex-1 text-[14px]",onClick:function(){D(function(p){return U()(U()({},p),{},{type:"workflow",show:!0})})},children:[(0,e.jsx)("img",{src:"/icons/workflow_icon.svg",alt:"",className:"w-[14px] h-[14px]"}),N.formatMessage({id:"app.summary.SelectWorkflow"})]})]})})]}),(0,e.jsx)(Pe.Z,{show:v.show,nodetype:v.type,popupClose:La,popupSave:Za,checkList:L==v.type?v.checkItem:[],zIndex:99,radio:!0})]})},wa=(0,a.memo)(Na),ba=function(n){var r=n.setShow,l=n.inputShow,_=n.setBoxLoading,x=n.setAppRunId,u=(0,X.useIntl)(),g=(0,a.useState)(!1),N=o()(g,2),w=N[0],m=N[1],d=(0,a.useState)(""),S=o()(d,2),b=S[0],t=S[1],C=(0,a.useState)(""),s=o()(C,2),k=s[0],B=s[1],$=(0,a.useRef)(""),h=(0,a.useRef)(""),Z=Q(function(P){return P.setSummaryClick}),Y=function(){var P=re()(A()().mark(function E(v){var D,y,M,R,f=arguments;return A()().wrap(function(G){for(;;)switch(G.prev=G.next){case 0:return D=f.length>1&&f[1]!==void 0?f[1]:{app_run_id:"",corrected_parameter:""},G.next=3,(0,pe.Rp)(v,D);case 3:y=G.sent,(y==null?void 0:y.code)==0&&(x(y==null||(M=y.data)===null||M===void 0?void 0:M.app_run_id),h.current=y==null||(R=y.data)===null||R===void 0?void 0:R.app_run_id);case 5:case"end":return G.stop()}},E)}));return function(v){return P.apply(this,arguments)}}(),te=function(){var P=re()(A()().mark(function E(v,D){var y,M,R,f,K;return A()().wrap(function(se){for(;;)switch(se.prev=se.next){case 0:return se.next=2,(0,pe.xM)(v,{message:D});case 2:y=se.sent,(y==null?void 0:y.code)==0&&(h.current=y==null||(M=y.data)===null||M===void 0?void 0:M.app_run_id,x(y==null||(R=y.data)===null||R===void 0?void 0:R.app_run_id),y!=null&&(f=y.data)!==null&&f!==void 0&&(f=f.outputs)!==null&&f!==void 0&&f.value&&(t(y==null||(K=y.data)===null||K===void 0||(K=K.outputs)===null||K===void 0?void 0:K.value),r(!0),_(!1),Z(!0)));case 4:case"end":return se.stop()}},E)}));return function(v,D){return P.apply(this,arguments)}}(),L=(0,ct.Z)(function(P){return P.flowMessage});(0,a.useEffect)(function(){var P=L.filter(function(D){return D.data.app_run_id==h.current&&D.type.indexOf("generate_meeting_summary")!==-1});if(P.length!=0){var E,v=(E=P[P.length-1])===null||E===void 0||(E=E.data)===null||E===void 0||(E=E.exec_data)===null||E===void 0||(E=E.outputs)===null||E===void 0?void 0:E.value;v&&(t(v),r(!0),Z(!0),_(!1))}},[L]);var z=Q(function(P){return P.summaryParams});return(0,a.useEffect)(function(){z&&z.id&&($.current=z.id,b&&t(""),m(!0),z.message?(_(!0),te(z.id,z.message)):Y(z.id))},[z]),(0,e.jsx)(e.Fragment,{children:w?(0,e.jsxs)("div",{className:"pb-[16px]",children:[(0,e.jsx)("div",{className:"text-[16px] font-[600] pt-[12px]",children:u.formatMessage({id:"app.summary.title"})}),(0,e.jsx)("div",{className:"text-[14px] pt-[12px] leading-[23px] px-[8px]",children:b?(0,e.jsx)("div",{className:" ".concat("max-h-[400px]"," p-[12px]  bg-[#F7F7F7]  relative overflow-y-auto"),children:(0,e.jsx)(we.U,{rehypePlugins:[be.Z],children:b})}):(0,e.jsx)("div",{className:"min-h-[120px] flex items-center justify-center",children:(0,e.jsx)(Ne.Z,{size:"large"})})}),l?(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("div",{className:"pt-[12px]",children:(0,e.jsx)(nt.Z.TextArea,{onChange:function(E){B(E.target.value)},value:k,disabled:!b,rows:4,placeholder:u.formatMessage({id:"app.summary.placeholder"})})}),(0,e.jsx)("div",{className:"flex pt-[12px] gap-x-[4px]",children:(0,e.jsx)(he.ZP,{type:"primary",disabled:!b||!k,className:"bg-[#1B64F3] rounded-[4px] w-[88px] h-[40px] flex-1",onClick:function(){Y($.current,{app_run_id:String(h.current),corrected_parameter:k}),_(!0),B(""),r("")},children:u.formatMessage({id:"app.summary.submitText"})})})]}):(0,e.jsx)(e.Fragment,{})]}):(0,e.jsx)(e.Fragment,{})})},_a=(0,a.memo)(ba),Ca=(0,a.memo)(function(i){var n=i.progressObj;console.log(n);var r=function(){return parseFloat(n.elapsed_time).toFixed(6)},l=function(x){var u=new Date(x),g=u.getFullYear(),N=(u.getMonth()+1).toString().padStart(2,"0"),w=u.getDate().toString().padStart(2,"0"),m=u.getHours().toString().padStart(2,"0"),d=u.getMinutes().toString().padStart(2,"0"),S=u.getSeconds().toString().padStart(2,"0");return(0,e.jsx)(e.Fragment,{children:"".concat(g,".").concat(N,".").concat(w," ").concat(m,":").concat(d,":").concat(S)})};return(0,e.jsx)("div",{className:"inline-flex gap-x-4 justify-end max-w-[100%]",children:(0,e.jsxs)("div",{className:"inline-flex gap-x-[20px] max-w-[100%]",children:[(0,e.jsx)("div",{className:"truncate min-w-[70px]",children:n.created_time&&l(n.created_time)}),(0,e.jsx)("div",{className:"truncate",children:n.apps_name||n.app_name}),(0,e.jsxs)("div",{className:"flex items-center gap-x-[7px] truncate min-w-[50px]",children:[(0,e.jsx)("div",{className:"shrink-0 rounded-full ".concat(n.status==1?"bg-blue-600":n.status==2?"bg-green-500":"bg-red-500"),style:{width:"3px",height:"3px"}}),(0,e.jsxs)("div",{className:"truncate",children:[r(),"S"]})]})]})})}),Ra=function(n){var r=n.list,l=n.scrollDom,_=n.historyHeight,x=(0,X.useIntl)(),u=(0,a.useState)([]),g=o()(u,2),N=g[0],w=g[1],m=(0,a.useRef)("100%"),d=(0,et.Z)(function(t){return t.setRunPanelLogRecord}),S=function(C){var s=new Date(C),k=s.getMonth()+1,B=s.getDate(),$=s.getHours(),h=s.getMinutes(),Z=s.getSeconds();return s.getFullYear()+"-"+(k<10?"0"+k:k)+"-"+(B<10?"0"+B:B)+" "+($<10?"0"+$:$)+":"+(h<10?"0"+h:h)+":"+(Z<10?"0"+Z:Z)},b=function(C){var s=Object.keys(C),k=[];return s.forEach(function(B){k.push(C[B])}),k};return(0,a.useEffect)(function(){if(l){var t;m.current=l==null||(t=l.current)===null||t===void 0?void 0:t.offsetHeight}},[l]),(0,a.useEffect)(function(){_&&(m.current="auto")},[_]),(0,a.useEffect)(function(){w(ue()(r.reverse()))},[r]),(0,e.jsx)(e.Fragment,{children:(0,e.jsx)("div",{className:"px-4",style:{minHeight:m.current},children:N&&N.length?N.map(function(t){var C,s,k,B,$,h,Z,Y,te,L,z,P,E,v,D,y,M,R;return t!=null&&t.source_run&&t!==null&&t!==void 0&&t.source_run.summary?(0,e.jsx)("div",{className:"pt-[16px] border-b-[1px] border-color-[#eee] ",children:(0,e.jsxs)("div",{className:"pb-[60px]",children:[(0,e.jsx)("div",{className:"text-[16px] font-[600] pb-[8px] flex items-center",children:(0,e.jsx)("span",{className:"flex-1",children:x.formatMessage({id:"app.summary.title"})})}),(0,e.jsx)("p",{className:"text-[12px] color-[#eee] mb-[8px]",children:S(t==null||(C=t.source_run)===null||C===void 0?void 0:C.created_time)}),(0,e.jsx)("div",{className:"p-[12px]  leading-[22px] ".concat(t!=null&&t.source_corrections&&(t==null?void 0:t.source_corrections.length)>0?"bg-[#F7F7F7]":"bg-blue-100 rounded-[4px]"),children:(0,e.jsx)(we.U,{rehypePlugins:[be.Z],children:t==null||(s=t.source_run)===null||s===void 0?void 0:s.summary})}),t!=null&&t.source_corrections&&(t==null?void 0:t.source_corrections.length)>0?(0,e.jsxs)("div",{children:[(0,e.jsxs)("div",{className:"text-[16px] font-[600] py-[8px]",children:[x.formatMessage({id:"app.summaryhistory.orientation"}),":"]}),t==null?void 0:t.source_corrections.map(function(f){return(0,e.jsx)("div",{className:"last-of-type:bg-blue-100 rounded-[4px] bg-[#F7F7F7] mb-[16px]",children:(0,e.jsxs)("div",{className:"p-[12px]   leading-[22px]",children:[(0,e.jsxs)("div",{className:"tetx-[14px] font-[600] pb-[12px]",children:[x.formatMessage({id:"app.summaryhistory.userPrompt"}),": ",f.user_prompt]}),(0,e.jsxs)("div",{className:"tetx-[14px] font-[600] pb-[12px]",children:[x.formatMessage({id:"app.summaryhistory.time"}),": ",S(f.created_time)]}),(0,e.jsx)(we.U,{rehypePlugins:[be.Z],children:f==null?void 0:f.corrected_summary})]})},f.created_time)})]}):(0,e.jsx)(e.Fragment,{}),t!=null&&t.target_run?(0,e.jsxs)("div",{className:"py-[12px]",children:[(0,e.jsxs)("div",{className:"text-[16px] font-[600] py-[8px]",children:[x.formatMessage({id:"app.summaryhistory.runapp"}),":"]}),(0,e.jsx)("div",{children:(0,e.jsxs)("div",{className:"text-[14px] py-[6px]",children:[(0,e.jsx)("span",{className:"font-[500] ",children:t!=null&&(k=t.target_run)!==null&&k!==void 0&&k.agent_id?"agent":"workflow"}),(0,e.jsx)("span",{className:"px-[6px]",children:":"}),(0,e.jsx)("span",{children:t==null||(B=t.target_run)===null||B===void 0||(B=B.app)===null||B===void 0?void 0:B.name})]})}),(0,e.jsx)("div",{children:t!=null&&($=t.target_run)!==null&&$!==void 0&&($=$.inputs)!==null&&$!==void 0&&$.properties?(0,e.jsxs)("div",{children:[(0,e.jsxs)("div",{className:"text-[16px] color-[#000] font-[600] py-[12px]",children:[x.formatMessage({id:"app.summaryhistory.input"}),":"]}),b(t==null||(h=t.target_run)===null||h===void 0||(h=h.inputs)===null||h===void 0?void 0:h.properties).map(function(f){return(0,e.jsxs)("div",{children:[(0,e.jsx)("div",{className:"pb-[8px] font-[600]",children:f.display_name||f.name}),(0,e.jsx)("div",{className:"py-[4px] px-[11px] text-[14px] leading-[1.5] h-[]",children:f.value})]})})]}):(0,e.jsx)(e.Fragment,{})}),(0,e.jsx)("div",{children:t!=null&&(Z=t.target_run)!==null&&Z!==void 0&&Z.raw_user_prompt?(0,e.jsxs)("div",{children:[(0,e.jsxs)("div",{className:"text-[16px] color-[#000] font-[600] py-[12px] pb-[6px]",children:[x.formatMessage({id:"app.summaryhistory.prompt"}),":"]}),(0,e.jsx)("div",{className:"py-[4px] px-[11px] text-[14px] leading-[1.5] ",children:t==null||(Y=t.target_run)===null||Y===void 0?void 0:Y.raw_user_prompt})]}):(0,e.jsx)(e.Fragment,{})}),(0,e.jsxs)("div",{children:[(0,e.jsxs)("div",{className:"text-[16px] font-[600] py-[8px]",children:[x.formatMessage({id:"app.summaryhistory.results"}),":"]}),(0,e.jsx)("div",{className:"p-[12px]  bg-[#F7F7F7]",children:(t==null||(te=t.target_run)===null||te===void 0?void 0:te.agent_id)!=0?(0,e.jsx)("div",{className:"p-[12px]  bg-[#F7F7F7] leading-[22px]",children:(0,e.jsx)(we.U,{rehypePlugins:[be.Z],children:t==null||(L=t.target_run)===null||L===void 0||(L=L.outputs)===null||L===void 0?void 0:L.value})}):(0,e.jsx)(qe.Z,{status:t==null||(z=t.target_run)===null||z===void 0?void 0:z.status,icon:t==null||(P=t.target_run)===null||P===void 0?void 0:P.icon,title:t==null||(E=t.target_run)===null||E===void 0?void 0:E.name,textDetails:(0,e.jsx)(Ca,{progressObj:{created_time:t==null||(v=t.target_run)===null||v===void 0?void 0:v.created_time,elapsed_time:t==null||(D=t.target_run)===null||D===void 0?void 0:D.elapsed_time,app_name:t==null||(y=t.target_run)===null||y===void 0?void 0:y.app.name,status:t==null||(M=t.target_run)===null||M===void 0?void 0:M.status}}),handleClick:function(){var K,G,se,me,le,xe,ie,ge,je,j;d({app_id:t==null||(K=t.target_run)===null||K===void 0||(K=K.app)===null||K===void 0?void 0:K.id,app_name:t==null||(G=t.target_run)===null||G===void 0||(G=G.app)===null||G===void 0?void 0:G.name,icon:t==null||(se=t.target_run)===null||se===void 0?void 0:se.icon,workflow_id:t==null||(me=t.target_run)===null||me===void 0?void 0:me.workflow_id,type:2,app_run_id:t==null||(le=t.target_run)===null||le===void 0?void 0:le.id,run_name:t==null||(xe=t.target_run)===null||xe===void 0?void 0:xe.name,status:t==null||(ie=t.target_run)===null||ie===void 0?void 0:ie.status,created_time:t==null||(ge=t.target_run)===null||ge===void 0?void 0:ge.created_time,elapsed_time:t==null||(je=t.target_run)===null||je===void 0?void 0:je.elapsed_time,completed_progress:"".concat(t==null||(j=t.target_run)===null||j===void 0?void 0:j.percentage,"%")})},progress:t==null||(R=t.target_run)===null||R===void 0?void 0:R.percentage})})]})]}):(0,e.jsx)(e.Fragment,{})]})},t.source_run.id):(0,e.jsx)(e.Fragment,{})}):(0,e.jsx)(e.Fragment,{})})})},Ma=(0,a.memo)(Ra),Fa=function(n){var r,l=n.id,_=(0,a.useState)(""),x=o()(_,2),u=x[0],g=x[1],N=(0,a.useState)(!1),w=o()(N,2),m=w[0],d=w[1],S=(0,a.useState)([]),b=o()(S,2),t=b[0],C=b[1],s=(0,a.useState)(!1),k=o()(s,2),B=k[0],$=k[1],h=(0,a.useState)(!1),Z=o()(h,2),Y=Z[0],te=Z[1],L=(0,a.useState)(""),z=o()(L,2),P=z[0],E=z[1],v=(0,a.useState)(!1),D=o()(v,2),y=D[0],M=D[1],R=(0,a.useState)(!1),f=o()(R,2),K=f[0],G=f[1],se=(0,a.useState)(!0),me=o()(se,2),le=me[0],xe=me[1],ie=(0,a.useRef)(null),ge=(0,a.useRef)(!1),je=function(){var I=re()(A()().mark(function ce(){var W,ee,De,J,oe=arguments;return A()().wrap(function(Se){for(;;)switch(Se.prev=Se.next){case 0:return W=oe.length>0&&oe[0]!==void 0?oe[0]:!0,Se.next=3,(0,pe.sh)({chatroom_id:l,page:1,page_size:9999});case 3:ee=Se.sent,ee.code==0&&(ee!=null&&(De=ee.data)!==null&&De!==void 0&&De.list&&ee!==null&&ee!==void 0&&(J=ee.data)!==null&&J!==void 0&&(J=J.list)!==null&&J!==void 0&&J.length&&(C(ee.data.list),d(!0)),W||(setTimeout(function(){var _e;ie==null||(_e=ie.current)===null||_e===void 0||_e.scrollTo({top:ie.current.scrollHeight})},200),g(j.id),F({})));case 5:case"end":return Se.stop()}},ce)}));return function(){return I.apply(this,arguments)}}();(0,a.useEffect)(function(){je()},[l]);var j=Q(function(I){return I.summaryParams}),F=Q(function(I){return I.setSummaryParams});return(0,a.useEffect)(function(){j&&j.id&&(d(!0),le||xe(!0),B&&$(!1),y&&M(!1),te(!0),je(!1),ge.current=!0)},[j]),(0,a.useEffect)(function(){console.log(K)},[K]),(0,e.jsx)(e.Fragment,{children:m?(0,e.jsxs)(Wt,{minWidth:400,className:"relative h-full right-0 border-0 returned-0 px-[0] ".concat(y?"translate-x-full flex-[0]":""),children:[K?(0,e.jsx)("div",{className:"h-full w-full absolute top-0 left-0 flex justify-center items-center z-[100] bg-[rgba(255,255,255,0.5)]",children:(0,e.jsx)(Ne.Z,{size:"large"})}):(0,e.jsx)(e.Fragment,{}),(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("div",{onClick:function(){M(function(ce){return!ce})},className:`
                                        `.concat(y?"right-[100%] top-[4px]":"right-[6px] top-[60px]",`
                                        fixed w-[40px] h-[40px]  flex justify-center items-center cursor-pointer z-[99]
                                    `),children:y?(0,e.jsx)(aa,{className:"text-[20px]"}):(0,e.jsx)(Xt,{className:"text-[20px]"})}),(0,e.jsx)("div",{className:"h-full min-h-full overflow-y-auto flex flex-col-reverse scroll-smooth",ref:ie,children:(0,e.jsxs)("div",{children:[t.length?(0,e.jsx)(Ma,{scrollDom:ie,list:t,historyHeight:ge.current}):(0,e.jsx)(e.Fragment,{}),(0,e.jsxs)("div",{className:"w-full px-4 h-full",style:{minHeight:Y?ie==null||(r=ie.current)===null||r===void 0?void 0:r.offsetHeight:""},children:[(0,e.jsx)(_a,{setShow:$,inputShow:le,setBoxLoading:G,setAppRunId:E}),B?(0,e.jsx)(wa,{id:u,runid:P,setBoxLoading:G,scrollDom:ie,setinputShow:xe}):(0,e.jsx)(e.Fragment,{})]})]})})]})]}):(0,e.jsx)(e.Fragment,{})})},ka=(0,a.memo)(Fa),Da=function(n){return(0,e.jsx)("div",{className:"flex items-center h-full justify-center",children:(0,e.jsx)(Me.Z,{image:Me.Z.PRESENTED_IMAGE_SIMPLE})})},Ia=(0,a.memo)(function(){var i=(0,X.useParams)(),n=i.id,r=(0,a.useRef)([]),l=(0,a.useRef)(null),_=(0,a.useState)(!1),x=o()(_,2),u=x[0],g=x[1],N=function(){var w=re()(A()().mark(function m(){var d;return A()().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:if(!n){b.next=5;break}return b.next=3,(0,pe.cH)({id:n});case 3:d=b.sent,d.code==0?(g(!0),l.current=d.data,r.current=d.data.agent_list):X.history.replace("/meeting");case 5:case"end":return b.stop()}},m)}));return function(){return w.apply(this,arguments)}}();return(0,a.useEffect)(function(){N()},[]),(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)("div",{className:"w-full flex bg-[#fff] overflow-hidden",style:{height:"calc(100vh - 56px)"},children:[(0,e.jsx)(xt,{roomDetail:l.current,setAgent:r}),(0,e.jsx)("div",{className:"flex-1",children:u?(0,e.jsx)(zt,{agentList:r}):(0,e.jsx)(Da,{})}),(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(ka,{id:n})})]})})}),Aa=Ia}}]);
