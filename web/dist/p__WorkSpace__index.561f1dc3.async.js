"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[316],{35790:function(J,M,a){var D=a(1413),P=a(67294),j=a(19369),k=a(91146),w=function(L,A){return P.createElement(k.Z,(0,D.Z)((0,D.Z)({},L),{},{ref:A,icon:j.Z}))},W=P.forwardRef(w);M.Z=W},78697:function(J,M,a){var D=a(67294),P=a(85893),j=function(w){var W=w.Image,z=w.icon;return(0,D.useEffect)(function(){},[]),(0,P.jsxs)("div",{className:"w-[42px] h-[42px] bg-[#F4F8F1] rounded-md flex items-center justify-center relative",children:[(0,P.jsx)("div",{children:(0,P.jsx)("img",{src:W,alt:""})}),z?(0,P.jsx)("div",{className:"absolute bottom-[-3px] right-[-3px] w-4 h-4 bg-white rounded-sm flex items-center justify-center shadow-[0_0_4px_-0_rgba(0,0,0,0.2)]",children:(0,P.jsx)("img",{className:" w-[12px] h-[12px]",src:z,alt:""})}):null]})};M.Z=j},46569:function(J,M,a){a.r(M),a.d(M,{default:function(){return ze}});var D=a(56264),P=a(91962),j=a(67294),k=a(15009),w=a.n(k),W=a(99289),z=a.n(W),L=a(5574),A=a.n(L),F=a(42237),E=a(29608),_=a(35790),ee=a(9577),ae=a(52982),te=(0,ee.f)(function(){return ae.Z?sessionStorage:void 0}),ne=te,Z=a(97582),B=a(22638),re=a(3917),se=function(v,n){var s;n===void 0&&(n={});var h=n.defaultPageSize,g=h===void 0?10:h,o=n.defaultCurrent,c=o===void 0?1:o,S=(0,Z._T)(n,["defaultPageSize","defaultCurrent"]),i=(0,re.Z)(v,(0,Z.pi)({defaultParams:[{current:c,pageSize:g}],refreshDepsAction:function(){r(1)}},S)),f=i.params[0]||{},m=f.current,x=m===void 0?1:m,d=f.pageSize,l=d===void 0?g:d,t=((s=i.data)===null||s===void 0?void 0:s.total)||0,C=(0,j.useMemo)(function(){return Math.ceil(t/l)},[l,t]),p=function(u,T){var O=u<=0?1:u,I=T<=0?1:T,V=Math.ceil(t/I);O>V&&(O=Math.max(1,V));var N=(0,Z.CR)(i.params||[]),q=N[0],Me=q===void 0?{}:q,De=N.slice(1);i.run.apply(i,(0,Z.ev)([(0,Z.pi)((0,Z.pi)({},Me),{current:O,pageSize:I})],(0,Z.CR)(De),!1))},r=function(u){p(u,l)},y=function(u){p(x,u)};return(0,Z.pi)((0,Z.pi)({},i),{pagination:{current:x,pageSize:l,total:t,totalPage:C,onChange:(0,B.Z)(p),changeCurrent:(0,B.Z)(r),changePageSize:(0,B.Z)(y)}})},$=se,ie=a(77598),U=a(78697),H=a(32332),R=a(35312),Q=a(74330),K=a(32983),le=a(29432),oe=a(72252),X=a(5154),e=a(85893),G=function(n){var s=n.iconSrc,h=n.titleText,g=n.pagination,o=(0,R.useIntl)();return(0,e.jsxs)("div",{className:"flex items-center gap-4",children:[(0,e.jsx)("img",{src:s,alt:""}),(0,e.jsx)("div",{children:h}),(0,e.jsx)("div",{children:(0,e.jsx)(oe.Z,{size:"small",simple:!0,showTotal:function(S,i){return"".concat(o.formatMessage({id:"app.workflow.title.1"})).concat(i[0],"-").concat(i[1]).concat(o.formatMessage({id:"app.workflow.title.2"})," / ").concat(o.formatMessage({id:"app.workflow.title.3"})).concat(S," ").concat(o.formatMessage({id:"app.workflow.title.2"}))},current:g.current,pageSize:g.pageSize,onShowSizeChange:null,total:g.total,onChange:g.onChange})})]})},ce=function(n){var s=n.item;console.log(s);var h=(0,R.useIntl)(),g="/icons/creation/",o="",c="";switch(s.type){case 1:c=h.formatMessage({id:"app.itemHeader.agent"}),o="Agent";break;case 2:c=h.formatMessage({id:"app.itemHeader.chatRoom"}),o="ChatRoom";break;case 3:c=h.formatMessage({id:"app.itemHeader.workFlow"}),o="WorkFlow";break;default:break}return g+=le.Le[o],(0,e.jsxs)("div",{className:"flex gap-5 shrink-0",children:[(0,e.jsx)("div",{className:"shrink-0",children:(0,e.jsx)(U.Z,{Image:s.type==2?"/icons/chat_room.svg":(0,H.s9)("single",s.icon),icon:"".concat(g,".svg")})}),(0,e.jsxs)("div",{className:"flex flex-col justify-center",children:[(0,e.jsx)("div",{className:"text-sm text-[#213044]",children:(0,e.jsx)(X.Z.Paragraph,{ellipsis:{rows:2,tooltip:s.name},className:"!mb-0",children:s.name})}),(0,e.jsx)("div",{className:"text-xs text-[#999999]",children:c})]})]})},de=function(){var v,n,s=(0,E.Z)(function(r){return r.setDealtWithData}),h=(0,E.Z)(function(r){return r.setRunPanelLogRecord}),g=(0,E.Z)(function(r){return r.submitPromptId}),o=(0,R.useIntl)(),c=(0,j.useRef)(null),S=ne("pageNumber"),i=A()(S,2),f=i[0],m=i[1],x=function(y){console.log(y),s(y)},d=function(){var r=z()(w()().mark(function y(u){var T,O,I;return w()().wrap(function(N){for(;;)switch(N.prev=N.next){case 0:return T=u.current,O=u.pageSize,N.next=3,(0,F.VE)({current:T,pageSize:O});case 3:return I=N.sent,N.abrupt("return",{list:I.data.list,success:!0,total:I.data.total_count});case 5:case"end":return N.stop()}},y)}));return function(u){return r.apply(this,arguments)}}(),l=$(d,{defaultPageSize:8}),t=l.data,C=l.loading,p=l.pagination;return(0,ie.Z)(function(){c.current&&c.current.reload()},[g]),(0,e.jsx)(Q.Z,{spinning:C,children:(0,e.jsxs)("div",{style:{height:"calc(100vh - 596px)"},children:[(0,e.jsx)(G,{iconSrc:"/icons/back_log.svg",titleText:o.formatMessage({id:"app.workflow.backlogs.title"}),pagination:p}),(0,e.jsxs)("div",{className:"bg-white rounded-lg p-2.5 mt-4 overflow-y-auto h-full",style:{boxShadow:" 0px 2px 4px 0px rgba(0,0,0,0.05)"},children:[t==null||(v=t.list)===null||v===void 0?void 0:v.map(function(r,y){return r.type=3,(0,e.jsxs)("div",{onClick:function(){s(r),h(!1)},className:"flex items-center gap-5 cursor-pointer duration-200 rounded-lg  p-2.5 hover:bg-[#fafafa]",children:[(0,e.jsx)(U.Z,{Image:(0,H.s9)("single",r.icon)}),(0,e.jsxs)("div",{className:"flex flex-col gap-1 truncate",children:[(0,e.jsxs)("div",{children:[(0,e.jsx)("span",{children:r.app_name})," ",(0,e.jsx)(_.Z,{}),(0,e.jsx)("span",{className:"text-[#1B64F3]",children:r.node_name})]}),(0,e.jsx)("div",{className:"text-[#999999] text-xs truncate",children:r.app_run_name})]})]},r.exec_id)}),!C&&(t==null||(n=t.list)===null||n===void 0?void 0:n.length)===0&&(0,e.jsx)("div",{className:"h-full flex items-center justify-center",children:(0,e.jsx)(K.Z,{image:"/images/empty.svg",description:o.formatMessage({id:"app.workflow.backlogs.empty"})})})]})]})})},ue=a(29933),ve=a(4393),Oe=ve.Z.Meta,ge=function(){var v,n,s=(0,R.useIntl)(),h=function(m){console.log(m);var x=m.app_id||m.apps_id;switch(m.type){case 1:R.history.push("/Agents?app_id=".concat(x));break;case 2:R.history.push("/chat_room/".concat(m.chatroom_id));break;case 3:R.history.push("/workspace/workflow?app_id=".concat(x));break;default:break}},g=function(){var f=z()(w()().mark(function m(x){var d,l,t;return w()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return d=x.current,l=x.pageSize,p.next=3,(0,F.vu)({current:d,pageSize:l});case 3:return t=p.sent,p.abrupt("return",{list:t.data.list,success:!0,total:t.data.total_count});case 5:case"end":return p.stop()}},m)}));return function(x){return f.apply(this,arguments)}}(),o=$(g,{defaultPageSize:8}),c=o.data,S=o.loading,i=o.pagination;return console.log(S),(0,e.jsxs)("div",{className:"flex-grow-0",children:[(0,e.jsx)(G,{iconSrc:"/icons/recently_active.svg",titleText:s.formatMessage({id:"app.workflow.ra.title"}),pagination:i}),(0,e.jsx)("div",{className:"grid grid-cols-4  gap-4 mt-4",children:c==null||(v=c.list)===null||v===void 0?void 0:v.map(function(f,m){var x=f.type==3?f.process_name:f.last_agent_name;return(0,e.jsx)(ue.Z,{className:"h-[160px] cursor-pointer transition shadow-lg shadow-gray-100 hover:shadow-gray-200",title:(0,e.jsx)(ce,{item:f}),onClick:function(){return h(f)},bodyStyle:{padding:"15px 20px"},children:(0,e.jsx)(X.Z.Paragraph,{ellipsis:{rows:2,tooltip:x},children:x})},f.app_id)})}),!(c!=null&&(n=c.list)!==null&&n!==void 0&&n.length)&&(0,e.jsxs)("div",{className:"h-[400px] w-full flex items-center justify-center",children:[!S&&(0,e.jsx)(K.Z,{imageStyle:{display:"flex",justifyContent:"center"},image:"/images/empty.svg",description:s.formatMessage({id:"app.workflow.ra.empty"})}),(0,e.jsx)(Q.Z,{spinning:S})]})]})},b=a(1413),pe=a(99011),Y=a(91146),fe=function(n,s){return j.createElement(Y.Z,(0,b.Z)((0,b.Z)({},n),{},{ref:s,icon:pe.Z}))},me=j.forwardRef(fe),xe=me,he=a(88284),je={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M464 720a48 48 0 1096 0 48 48 0 10-96 0zm16-304v184c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V416c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8zm475.7 440l-416-720c-6.2-10.7-16.9-16-27.7-16s-21.6 5.3-27.7 16l-416 720C56 877.4 71.4 904 96 904h832c24.6 0 40-26.6 27.7-48zm-783.5-27.9L512 239.9l339.8 588.2H172.2z"}}]},name:"warning",theme:"outlined"},Se=je,ye=function(n,s){return j.createElement(Y.Z,(0,b.Z)((0,b.Z)({},n),{},{ref:s,icon:Se}))},we=j.forwardRef(ye),Ce=we,Pe=a(44720),Ze=a(38703),Ne=(0,j.memo)(function(){var v,n,s=(0,E.Z)(function(d){return d.setDealtWithData}),h=(0,E.Z)(function(d){return d.setRunPanelLogRecord}),g=(0,R.useIntl)(),o=function(l){var t=l.text;switch(t){case 1:return(0,e.jsx)(xe,{className:"text-blue-500"});case 2:return(0,e.jsx)(he.Z,{className:"text-green-500"});case 3:return(0,e.jsx)(Ce,{className:"text-red-500"})}return(0,e.jsx)("span",{children:t})},c=function(){var d=z()(w()().mark(function l(t){var C,p,r;return w()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return C=t.current,p=t.pageSize,u.next=3,(0,F.PE)({current:C,pageSize:p});case 3:return r=u.sent,u.abrupt("return",{list:r.data.list,success:!0,total:r.data.total_count});case 5:case"end":return u.stop()}},l)}));return function(t){return d.apply(this,arguments)}}(),S=$(c,{defaultPageSize:8}),i=S.data,f=S.loading,m=S.pagination,x=(0,j.memo)(function(d){var l,t=d.item,C=t.status==1?"#1B64F3":t.status==2?"#22C55F":"#F04444",p=t.status==1?"#f9fafe":t.status==2?"#f6fcf3":"#fafafa",r=(0,j.useRef)(null),y=(0,Pe.Z)(r);return(0,e.jsxs)("div",{onClick:function(){h(t),s(null)},ref:r,className:"flex relative rounded truncate gap-5  items-center shrink-0 cursor-pointer duration-200  box-border py-2.5 pr-5 ",children:[(0,e.jsx)("div",{style:{backgroundColor:y?p:"",width:y?"".concat(t.completed_steps/t.total_steps*100,"%"):"0%",transition:"0.5s"},className:"w-full h-full absolute left-0 duration-500"}),(0,e.jsx)("div",{style:{backgroundColor:C},className:"w-[4px] h-full z-10 mr-[10px] absolute"}),(0,e.jsx)("div",{className:"ml-5",children:(0,e.jsx)(U.Z,{Image:(0,H.s9)("single",t.icon)})}),(0,e.jsxs)("div",{className:"flex flex-col gap-1 truncate flex-1  z-10",children:[(0,e.jsx)("div",{children:(0,e.jsx)("span",{children:t.app_runs_name})}),(0,e.jsx)("div",{className:"text-[#999999] text-xs truncate  max-w-7/8",children:(0,e.jsxs)("div",{className:"flex items-center truncate",children:[(0,e.jsxs)("span",{children:[" ",t.created_time," "]}),(0,e.jsx)("span",{style:{maxWidth:"calc(100% - 200px)"},className:"truncate ml-2 ",children:t.apps_name}),(0,e.jsxs)("span",{className:"inline-flex items-center ml-2 gap-2",children:[(0,e.jsx)("span",{style:{backgroundColor:C},className:"inline-block w-1 h-1 rounded-sm"}),(l=t.elapsed_time)===null||l===void 0?void 0:l.toFixed(6),"S"]})]})})]}),(0,e.jsx)("div",{className:"flex items-center justify-center",children:(0,e.jsx)(Ze.Z,{type:"circle",size:30,percent:parseInt(t.completed_steps/t.total_steps*100)})})]},t.app_run_id)});return(0,e.jsxs)("div",{style:{height:"calc(100vh - 596px)"},children:[(0,e.jsx)(G,{iconSrc:"/icons/workflows.svg",titleText:g.formatMessage({id:"app.workflow.log.title"}),pagination:m}),(0,e.jsxs)("div",{className:"bg-white rounded-lg p-4 h-full mt-4 overflow-y-auto box-border relative flex flex-col gap-5",style:{boxShadow:" 0px 2px 4px 0px rgba(0,0,0,0.05)"},children:[i==null||(v=i.list)===null||v===void 0?void 0:v.map(function(d,l){return(0,e.jsx)(x,{item:d})}),!f&&(i==null||(n=i.list)===null||n===void 0?void 0:n.length)===0&&(0,e.jsx)("div",{className:"h-full flex items-center justify-center",children:(0,e.jsx)(K.Z,{image:"/images/empty.svg",description:g.formatMessage({id:"app.workflow.log.empty"})})})]})]})}),Re=function(){return(0,e.jsxs)("div",{style:{height:"calc(100vh - 56px)"},className:"w-full p-[30px] flex flex-col gap-6 overflow-x-auto box-border",children:[(0,e.jsx)(ge,{}),(0,e.jsxs)("div",{className:"grid grid-cols-2 gap-6 flex-1",children:[(0,e.jsx)(de,{}),(0,e.jsx)(Ne,{})]}),(0,e.jsx)(D.$_,{}),(0,e.jsx)(P.Z,{})]})},ze=Re}}]);
