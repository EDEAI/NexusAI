"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[316],{11475:function(J,M,a){a.d(M,{Z:function(){return A}});var N=a(1413),y=a(67294),l={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}},{tag:"path",attrs:{d:"M464 688a48 48 0 1096 0 48 48 0 10-96 0zm24-112h48c4.4 0 8-3.6 8-8V296c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v272c0 4.4 3.6 8 8 8z"}}]},name:"exclamation-circle",theme:"outlined"},T=l,Z=a(91146),I=function(Q,F){return y.createElement(Z.Z,(0,N.Z)((0,N.Z)({},Q),{},{ref:F,icon:T}))},R=y.forwardRef(I),A=R},35790:function(J,M,a){var N=a(1413),y=a(67294),l=a(19369),T=a(91146),Z=function(A,B){return y.createElement(T.Z,(0,N.Z)((0,N.Z)({},A),{},{ref:B,icon:l.Z}))},I=y.forwardRef(Z);M.Z=I},78697:function(J,M,a){var N=a(67294),y=a(85893),l=function(Z){var I=Z.Image,R=Z.icon;return(0,N.useEffect)(function(){},[]),(0,y.jsxs)("div",{className:"w-[42px] h-[42px] bg-[#F4F8F1] rounded-md flex items-center justify-center relative",children:[(0,y.jsx)("div",{children:(0,y.jsx)("img",{src:I,alt:""})}),R?(0,y.jsx)("div",{className:"absolute bottom-[-3px] right-[-3px] w-4 h-4 bg-white rounded-sm flex items-center justify-center shadow-[0_0_4px_-0_rgba(0,0,0,0.2)]",children:(0,y.jsx)("img",{className:" w-[12px] h-[12px]",src:R,alt:""})}):null]})};M.Z=l},46569:function(J,M,a){a.r(M),a.d(M,{default:function(){return $e}});var N=a(56264),y=a(91962),l=a(67294),T=a(15009),Z=a.n(T),I=a(99289),R=a.n(I),A=a(97857),B=a.n(A),Q=a(5574),F=a.n(Q),X=a(42237),W=a(29608),ve=a(35790),fe=a(11475),ge=a(8751),me=a(9577),pe=a(52982),xe=(0,me.f)(function(){return pe.Z?sessionStorage:void 0}),he=xe,se=a(77598),z=a(97582),Y=a(22638),je=a(3917),Se=function(u,n){var s;n===void 0&&(n={});var j=n.defaultPageSize,m=j===void 0?10:j,o=n.defaultCurrent,v=o===void 0?1:o,p=(0,z._T)(n,["defaultPageSize","defaultCurrent"]),i=(0,je.Z)(u,(0,z.pi)({defaultParams:[{current:v,pageSize:m}],refreshDepsAction:function(){P(1)}},p)),x=i.params[0]||{},g=x.current,S=g===void 0?1:g,c=x.pageSize,d=c===void 0?m:c,t=((s=i.data)===null||s===void 0?void 0:s.total)||0,D=(0,l.useMemo)(function(){return Math.ceil(t/d)},[d,t]),h=function(f,k){var b=f<=0?1:f,U=k<=0?1:k,K=Math.ceil(t/U);b>K&&(b=Math.max(1,K));var $=(0,z.CR)(i.params||[]),w=$[0],V=w===void 0?{}:w,ne=$.slice(1);i.run.apply(i,(0,z.ev)([(0,z.pi)((0,z.pi)({},V),{current:b,pageSize:U})],(0,z.CR)(ne),!1))},P=function(f){h(f,d)},E=function(f){h(S,f)};return(0,z.pi)((0,z.pi)({},i),{pagination:{current:S,pageSize:d,total:t,totalPage:D,onChange:(0,Y.Z)(h),changeCurrent:(0,Y.Z)(P),changePageSize:(0,Y.Z)(E)}})},q=Se,_=a(78697),ee=a(32332),O=a(35312),ie=a(74330),le=a(83062),ae=a(32983),Ce=a(29432),ye=a(72252),oe=a(71471),e=a(85893),te=function(n){var s=n.iconSrc,j=n.titleText,m=n.pagination,o=(0,O.useIntl)();return(0,e.jsxs)("div",{className:"flex items-center gap-4",children:[(0,e.jsx)("img",{src:s,alt:""}),(0,e.jsx)("div",{children:j}),(0,e.jsx)("div",{children:(0,e.jsx)(ye.Z,{size:"small",simple:!0,showTotal:function(p,i){return"".concat(o.formatMessage({id:"app.workflow.title.1"})).concat(i[0],"-").concat(i[1]).concat(o.formatMessage({id:"app.workflow.title.2"})," / ").concat(o.formatMessage({id:"app.workflow.title.3"})).concat(p," ").concat(o.formatMessage({id:"app.workflow.title.2"}))},current:m.current,pageSize:m.pageSize,onShowSizeChange:null,total:m.total,onChange:m.onChange})})]})},Ze=function(n){var s=n.item;console.log(s);var j=(0,O.useIntl)(),m="/icons/creation/",o="",v="";switch(s.type){case 1:v=j.formatMessage({id:"app.itemHeader.agent"}),o="Agent";break;case 2:v=j.formatMessage({id:"app.itemHeader.chatRoom"}),o="ChatRoom";break;case 3:v=j.formatMessage({id:"app.itemHeader.workFlow"}),o="WorkFlow";break;default:break}return m+=Ce.Le[o],(0,e.jsxs)("div",{className:"flex gap-5 shrink-0",children:[(0,e.jsx)("div",{className:"shrink-0",children:(0,e.jsx)(_.Z,{Image:s.type==2?"/icons/chat_room.svg":(0,ee.s9)("single",s.icon),icon:"".concat(m,".svg")})}),(0,e.jsxs)("div",{className:"flex flex-col justify-center",children:[(0,e.jsx)("div",{className:"text-sm text-[#213044]",children:(0,e.jsx)(oe.Z.Paragraph,{ellipsis:{rows:2,tooltip:s.name},className:"!mb-0",children:s.name})}),(0,e.jsx)("div",{className:"text-xs text-[#999999]",children:v})]})]})},we=function(){var u,n,s=(0,W.Z)(function(r){return r.setDealtWithData}),j=(0,W.Z)(function(r){return r.prevConfirmDealtWith}),m=(0,W.Z)(function(r){return r.dealtWithData}),o=(0,W.Z)(function(r){return r.setRunPanelLogRecord}),v=(0,W.Z)(function(r){return r.submitPromptId}),p=(0,O.useIntl)(),i=(0,l.useRef)(null),x=(0,l.useState)(null),g=F()(x,2),S=g[0],c=g[1],d=he("pageNumber"),t=F()(d,2),D=t[0],h=t[1],P=function(C){console.log(C),s(C)};(0,se.Z)(function(){var r=w.list.map(function(C){return C.exec_id==j.exec_id&&(C.need_human_confirm=0),C});V(B()(B()({},w),{},{list:r}))},[j]);var E=function(){var r=R()(Z()().mark(function C(G){var de,ue,re;return Z()().wrap(function(L){for(;;)switch(L.prev=L.next){case 0:return de=G.current,ue=G.pageSize,L.next=3,(0,X.VE)({current:de,pageSize:ue});case 3:return re=L.sent,L.abrupt("return",{list:re.data.list,success:!0,total:re.data.total_count});case 5:case"end":return L.stop()}},C)}));return function(G){return r.apply(this,arguments)}}(),f=q(E,{defaultPageSize:10}),k=f.data,b=f.loading,U=f.pagination,K=(0,l.useState)(k),$=F()(K,2),w=$[0],V=$[1];(0,l.useEffect)(function(){V(k)},[k]),(0,se.Z)(function(){i.current&&i.current.reload()},[v]);var ne=(0,l.useCallback)(function(r){var C=r.item;return(0,e.jsxs)("div",{className:"flex flex-col gap-1 truncate flex-1",children:[(0,e.jsxs)("div",{children:[(0,e.jsx)("span",{children:C.app_name})," ",(0,e.jsx)(ve.Z,{}),(0,e.jsx)("span",{className:C.need_human_confirm==1?"text-[#1B64F3]":"text-[#808183]",children:C.node_name})]}),(0,e.jsx)("div",{className:"text-[#999999] text-xs truncate",children:C.app_run_name})]})},[w]);return(0,e.jsx)(ie.Z,{spinning:b,children:(0,e.jsxs)("div",{style:{height:"calc(100vh - 596px)"},children:[(0,e.jsx)(te,{iconSrc:"/icons/back_log.svg",titleText:p.formatMessage({id:"app.workflow.backlogs.title"}),pagination:U}),(0,e.jsxs)("div",{className:"bg-white rounded-lg p-2.5 mt-4 overflow-y-auto h-full",style:{boxShadow:" 0px 2px 4px 0px rgba(0,0,0,0.05)"},children:[w==null||(u=w.list)===null||u===void 0?void 0:u.map(function(r,C){return r.type=3,(0,e.jsxs)("div",{onClick:function(){console.log(r),r.need_human_confirm&&(s(r),c(r),o(!1))},className:"flex items-center gap-5 cursor-pointer duration-200 rounded-lg  p-2.5 hover:bg-[#fafafa]",children:[(0,e.jsx)(_.Z,{Image:(0,ee.s9)("single",r.icon)}),(0,e.jsx)(ne,{item:r}),(0,e.jsx)("div",{children:r.need_human_confirm?(0,e.jsx)(le.Z,{title:p.formatMessage({id:"workflow.needHumanConfirm"}),children:(0,e.jsx)(fe.Z,{className:"text-[#1B64F3]"})}):(0,e.jsx)(le.Z,{title:p.formatMessage({id:"workflow.noHumanConfirm"}),children:(0,e.jsx)(ge.Z,{className:"text-[#808183]"})})})]},r.exec_id)}),!b&&(w==null||(n=w.list)===null||n===void 0?void 0:n.length)===0&&(0,e.jsx)("div",{className:"h-full flex items-center justify-center",children:(0,e.jsx)(ae.Z,{image:"/images/empty.svg",description:p.formatMessage({id:"app.workflow.backlogs.empty"})})})]})]})})},Pe=a(29933),Ne=a(4393),He=Ne.Z.Meta,Re=function(){var u,n,s=(0,O.useIntl)(),j=function(g){console.log(g);var S=g.app_id||g.apps_id;switch(g.type){case 1:O.history.push("/Agents?app_id=".concat(S));break;case 2:O.history.push("/chat_room/".concat(g.chatroom_id));break;case 3:O.history.push("/workspace/workflow?app_id=".concat(S));break;default:break}},m=function(){var x=R()(Z()().mark(function g(S){var c,d,t;return Z()().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return c=S.current,d=S.pageSize,h.next=3,(0,X.vu)({current:c,pageSize:d});case 3:return t=h.sent,h.abrupt("return",{list:t.data.list,success:!0,total:t.data.total_count});case 5:case"end":return h.stop()}},g)}));return function(S){return x.apply(this,arguments)}}(),o=q(m,{defaultPageSize:8}),v=o.data,p=o.loading,i=o.pagination;return console.log(p),(0,e.jsxs)("div",{className:"flex-grow-0",children:[(0,e.jsx)(te,{iconSrc:"/icons/recently_active.svg",titleText:s.formatMessage({id:"app.workflow.ra.title"}),pagination:i}),(0,e.jsx)("div",{className:"grid grid-cols-4  gap-4 mt-4",children:v==null||(u=v.list)===null||u===void 0?void 0:u.map(function(x,g){var S=x.type==3?x.process_name:x.last_agent_name;return(0,e.jsx)(Pe.Z,{className:"h-[160px] cursor-pointer transition shadow-lg shadow-gray-100 hover:shadow-gray-200",title:(0,e.jsx)(Ze,{item:x}),onClick:function(){return j(x)},bodyStyle:{padding:"15px 20px"},children:(0,e.jsx)(oe.Z.Paragraph,{ellipsis:{rows:2,tooltip:S},children:S})},x.app_id)})}),!(v!=null&&(n=v.list)!==null&&n!==void 0&&n.length)&&(0,e.jsxs)("div",{className:"h-[400px] w-full flex items-center justify-center",children:[!p&&(0,e.jsx)(ae.Z,{imageStyle:{display:"flex",justifyContent:"center"},image:"/images/empty.svg",description:s.formatMessage({id:"app.workflow.ra.empty"})}),(0,e.jsx)(ie.Z,{spinning:p})]})]})},H=a(1413),ze=a(99011),ce=a(91146),De=function(n,s){return l.createElement(ce.Z,(0,H.Z)((0,H.Z)({},n),{},{ref:s,icon:ze.Z}))},Me=l.forwardRef(De),Oe=Me,Ee=a(88284),Ie={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M464 720a48 48 0 1096 0 48 48 0 10-96 0zm16-304v184c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V416c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8zm475.7 440l-416-720c-6.2-10.7-16.9-16-27.7-16s-21.6 5.3-27.7 16l-416 720C56 877.4 71.4 904 96 904h832c24.6 0 40-26.6 27.7-48zm-783.5-27.9L512 239.9l339.8 588.2H172.2z"}}]},name:"warning",theme:"outlined"},We=Ie,Te=function(n,s){return l.createElement(ce.Z,(0,H.Z)((0,H.Z)({},n),{},{ref:s,icon:We}))},ke=l.forwardRef(Te),be=ke,Le=a(44720),Ae=a(38703),Be=(0,l.memo)(function(){var u,n,s=(0,W.Z)(function(c){return c.setDealtWithData}),j=(0,W.Z)(function(c){return c.setRunPanelLogRecord}),m=(0,O.useIntl)(),o=function(d){var t=d.text;switch(t){case 1:return(0,e.jsx)(Oe,{className:"text-blue-500"});case 2:return(0,e.jsx)(Ee.Z,{className:"text-green-500"});case 3:return(0,e.jsx)(be,{className:"text-red-500"})}return(0,e.jsx)("span",{children:t})},v=function(){var c=R()(Z()().mark(function d(t){var D,h,P;return Z()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return D=t.current,h=t.pageSize,f.next=3,(0,X.PE)({current:D,pageSize:h});case 3:return P=f.sent,f.abrupt("return",{list:P.data.list,success:!0,total:P.data.total_count});case 5:case"end":return f.stop()}},d)}));return function(t){return c.apply(this,arguments)}}(),p=q(v,{defaultPageSize:10}),i=p.data,x=p.loading,g=p.pagination,S=(0,l.memo)(function(c){var d,t=c.item,D=t.status==1?"#1B64F3":t.status==2?"#22C55F":"#F04444",h=t.status==1?"#f9fafe":t.status==2?"#f6fcf3":"#fafafa",P=(0,l.useRef)(null),E=(0,Le.Z)(P);return(0,e.jsxs)("div",{onClick:function(){j(t),s(null)},ref:P,className:"flex relative rounded truncate gap-5  items-center shrink-0 cursor-pointer duration-200  box-border py-2.5 pr-5 ",children:[(0,e.jsx)("div",{style:{backgroundColor:E?h:"",width:E?"".concat(t.completed_steps/t.total_steps*100,"%"):"0%",transition:"0.5s"},className:"w-full h-full absolute left-0 duration-500"}),(0,e.jsx)("div",{style:{backgroundColor:D},className:"w-[4px] h-full z-10 mr-[10px] absolute"}),(0,e.jsx)("div",{className:"ml-5",children:(0,e.jsx)(_.Z,{Image:(0,ee.s9)("single",t.icon)})}),(0,e.jsxs)("div",{className:"flex flex-col gap-1 truncate flex-1  z-10",children:[(0,e.jsx)("div",{children:(0,e.jsx)("span",{children:t.app_runs_name})}),(0,e.jsx)("div",{className:"text-[#999999] text-xs truncate  max-w-7/8",children:(0,e.jsxs)("div",{className:"flex items-center truncate",children:[(0,e.jsxs)("span",{children:[" ",t.created_time," "]}),(0,e.jsx)("span",{style:{maxWidth:"calc(100% - 200px)"},className:"truncate ml-2 ",children:t.apps_name}),(0,e.jsxs)("span",{className:"inline-flex items-center ml-2 gap-2",children:[(0,e.jsx)("span",{style:{backgroundColor:D},className:"inline-block w-1 h-1 rounded-sm"}),(d=t.elapsed_time)===null||d===void 0?void 0:d.toFixed(6),"S"]})]})})]}),(0,e.jsx)("div",{className:"flex items-center justify-center",children:(0,e.jsx)(Ae.Z,{type:"circle",size:30,percent:parseInt(t.completed_steps/t.total_steps*100)})})]},t.app_run_id)});return(0,e.jsxs)("div",{style:{height:"calc(100vh - 596px)"},children:[(0,e.jsx)(te,{iconSrc:"/icons/workflows.svg",titleText:m.formatMessage({id:"app.workflow.log.title"}),pagination:g}),(0,e.jsxs)("div",{className:"bg-white rounded-lg p-4 h-full mt-4 overflow-y-auto box-border relative flex flex-col gap-5",style:{boxShadow:" 0px 2px 4px 0px rgba(0,0,0,0.05)"},children:[i==null||(u=i.list)===null||u===void 0?void 0:u.map(function(c,d){return(0,e.jsx)(S,{item:c})}),!x&&(i==null||(n=i.list)===null||n===void 0?void 0:n.length)===0&&(0,e.jsx)("div",{className:"h-full flex items-center justify-center",children:(0,e.jsx)(ae.Z,{image:"/images/empty.svg",description:m.formatMessage({id:"app.workflow.log.empty"})})})]})]})}),Fe=function(){return(0,e.jsxs)("div",{style:{height:"calc(100vh - 56px)"},className:"w-full p-[30px] flex flex-col gap-6 overflow-x-auto box-border",children:[(0,e.jsx)(Re,{}),(0,e.jsxs)("div",{className:"grid grid-cols-2 gap-6 flex-1",children:[(0,e.jsx)(we,{}),(0,e.jsx)(Be,{})]}),(0,e.jsx)(N.$_,{}),(0,e.jsx)(y.Z,{})]})},$e=Fe}}]);
