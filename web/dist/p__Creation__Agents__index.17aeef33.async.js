"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[178],{83510:function(bt,Se,s){s.d(Se,{LK:function(){return ne},bs:function(){return Le},go:function(){return ge},uy:function(){return Oe}});var Ee=s(15009),w=s.n(Ee),Te=s(99289),L=s.n(Te),H=s(47520),t="/v1/apps/apps_list",Ie="/v1/agent/agent_delete/",p="/v1/workflow/workflow_app_delete/",R="/v1/vector/delete_dataset/",Be="/v1/skill/delete_skill_by_app_id/",Ve="/v1/apps/apps_create",Ze="/v1/apps/app_update/",ge=function(){var X=L()(w()().mark(function B(S){var C;return w()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,H.ZP)("".concat(t),{method:"GET",data:S});case 2:return C=n.sent,n.abrupt("return",C);case 4:case"end":return n.stop()}},B)}));return function(S){return X.apply(this,arguments)}}(),ne=function(){var X=L()(w()().mark(function B(S){var C;return w()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return console.log(S),n.next=3,S.mode;case 3:if(n.t0=n.sent,n.t0!=1){n.next=8;break}n.t1=(0,H.ZP)("".concat(Ie).concat(S.app_id),{method:"DELETE"}),n.next=9;break;case 8:n.t1=S.mode==2?(0,H.ZP)("".concat(p).concat(S.app_id),{method:"DELETE"}):S.mode==3?(0,H.ZP)("".concat(R).concat(S.app_id),{method:"DELETE"}):(0,H.ZP)("".concat(Be).concat(S.app_id),{method:"DELETE",data:{is_soft:1}});case 9:return C=n.t1,n.abrupt("return",C);case 11:case"end":return n.stop()}},B)}));return function(S){return X.apply(this,arguments)}}(),Oe=function(){var X=L()(w()().mark(function B(S){var C;return w()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,H.ZP)("".concat(Ve),{method:"POST",data:S});case 2:return C=n.sent,n.abrupt("return",C);case 4:case"end":return n.stop()}},B)}));return function(S){return X.apply(this,arguments)}}(),Le=function(){var X=L()(w()().mark(function B(S){var C;return w()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,H.ZP)("".concat(Ze).concat(S.app_id),{method:"PUT",data:S});case 2:return C=n.sent,n.abrupt("return",C);case 4:case"end":return n.stop()}},B)}));return function(S){return X.apply(this,arguments)}}()},6180:function(bt,Se,s){s.r(Se),s.d(Se,{default:function(){return Ot}});var Ee=s(15009),w=s.n(Ee),Te=s(99289),L=s.n(Te),H=s(97857),t=s.n(H),Ie=s(5574),p=s.n(Ie),R=s(11551),Be=s(83510),Ve=s(47520),Ze=s(29432),ge=s(10759),ne=s(32332),Oe=s(2068),Le=s(89035),X=s(15360),B=s(82826),S=s(69243),C=s(35312),m=s(40741),n=s(2453),K=s(28036),yt=s(50136),Ke=s(74330),h=s(67294),jt=s(13769),Re=s.n(jt),pe=s(92939),We=s(51042),He=s(82061),J=s(26915),_e=s(72269),Me=s(34041),$=s(78045),e=s(85893),_t=["key","name"],wt=J.Z.TextArea,Ft=function(l){var ie=l.FirstValue,a=l.Detaillist,T=l.setDetaillist,fe=l.repository,xe=l.setRepository,k=l.Operationbentate,G=l.Ffromref,re=l.setFourthly_config_id,le=l.Fourthly_config_id,oe=l.Fourthly_select_list,b=l.Newproperties,y=l.setNewproperties,te=l.pageKeyfun,ue=l.firstjudgingcondition,Y=l.setAgentmunudisabled,de=l.agentmenudisabled,u=(0,C.useIntl)(),_=(0,h.useState)([]),z=p()(_,2),ae=z[0],Q=z[1],ce=(0,h.useState)({agent_id:0,data:{is_public:1,enable_api:0,obligations:null,input_variables:{},dataset_ids:[]}}),D=p()(ce,2),x=D[0],E=D[1];(0,h.useEffect)(function(){ve()},[]);var I=function(o){re(o)},V=function(o){E(t()(t()({},x),{},{data:t()(t()({},x.data),{},{obligations:o.target.value})})),T(t()(t()({},a),{},{agent:t()(t()({},a.agent),{},{obligations:o.target.value})}))},U=function(o,f){var g=new Set;return o.some(function(F){var j=F[f];return g.has(j)?g.add(j):g.add(j)&&!1})},me=function(o){T(t()(t()({},a),{},{app:t()(t()({},a.app),{},{is_public:o?1:0})})),E(t()(t()({},x),{},{data:t()(t()({},x.data),{},{is_public:o?1:0})}))},W=function(o){T(t()(t()({},a),{},{app:t()(t()({},a.app),{},{enable_api:o?1:0})})),E(t()(t()({},x),{},{data:t()(t()({},x.data),{},{enable_api:o?1:0})}))},q=function(o){T(t()(t()({},a),{},{agent:t()(t()({},a.agent),{},{allow_upload_file:o?1:0})}))},he=function(o){E(t()(t()({},x),{},{data:t()(t()({},x.data),{},{dataset_ids:o})})),xe(o)},ve=function(){var A=L()(w()().mark(function o(){var f;return w()().wrap(function(F){for(;;)switch(F.prev=F.next){case 0:return F.next=2,(0,R.zl)();case 2:f=F.sent,Q(f.data.data.map(function(j){return{value:j.dataset_id,label:j.name}}));case 4:case"end":return F.stop()}},o)}));return function(){return A.apply(this,arguments)}}(),Pe=function(){var A=L()(w()().mark(function o(){return w()().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:ue()||(te("2"),Y(t()(t()({},de),{},{first:!1,second:!1})));case 1:case"end":return g.stop()}},o)}));return function(){return A.apply(this,arguments)}}(),we=function(o){T(t()(t()({},a),{},{agent:t()(t()({},a.agent),{},{default_output_format:o.target.value})}))};return(0,e.jsxs)("div",{style:{height:"100%",width:"900px",marginBottom:"30px"},children:[(0,e.jsx)("div",{className:"flex align-center justify-between mt-[30px]",children:(0,e.jsx)("div",{className:"text-base font-medium mb-[30px] text-[#333333]",children:u.formatMessage({id:"agent.menu.basicsetup"})})}),(0,e.jsx)("div",{className:"w-full",children:(0,e.jsxs)(m.Z,{name:"dynamic_form_nest_item",style:{width:"900px"},autoComplete:"off",form:G,children:[(0,e.jsx)(m.Z.List,{name:"users",children:function(o,f){var g=f.add,F=f.remove;return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(m.Z.Item,{className:"mb-[30px]",children:(0,e.jsxs)("div",{className:"text-[#555555] text-xs",children:[(0,e.jsx)("div",{className:"font-medium  mb-[15px]",children:u.formatMessage({id:"agent.appname"})}),(0,e.jsxs)("div",{className:"w-full p-[15px] flex font-normal items-center bg-[#F7F7F7] rounded-lg",children:[(0,e.jsxs)("div",{children:[a&&a.app&&a.app.name,"\xA0"]}),(0,e.jsx)("div",{className:"",children:k==="true"?u.formatMessage({id:"agent.cannotmodify"}):""})]})]})}),(0,e.jsx)(m.Z.Item,{className:"mb-[30px]",children:(0,e.jsxs)("div",{className:"text-[#555555] text-xs",children:[(0,e.jsx)("div",{className:"font-medium  mb-[15px]",children:u.formatMessage({id:"agent.appdescription"})}),(0,e.jsx)("div",{className:"w-full p-[15px] flex font-normal items-center bg-[#F7F7F7] rounded-lg",children:a&&a.app&&a.app.description})]})}),(0,e.jsx)(m.Z.Item,{className:"mb-[30px]",children:(0,e.jsxs)("div",{children:[(0,e.jsxs)("div",{className:"mb-[30px]",children:[(0,e.jsx)("div",{className:"mb-[15px] text-[#555555] text-xs",children:(0,e.jsx)(pe.Z,{className:"font-medium",name:u.formatMessage({id:"agent.teamvisibility"}),title:u.formatMessage({id:"agent.explain.teamvisibility"})})}),(0,e.jsx)(_e.Z,{size:"small",onChange:me,checked:!!(a&&a.app.is_public===1)})]}),(0,e.jsxs)("div",{className:"mb-[30px]  font-medium",children:[(0,e.jsx)("div",{className:"mb-[15px] text-[#555555] text-xs",children:u.formatMessage({id:"agent.APIswitch"})}),(0,e.jsx)(_e.Z,{size:"small",onChange:W,checked:!!(a&&a.app.enable_api===1)})]}),(0,e.jsxs)("div",{className:"font-medium",children:[(0,e.jsx)("div",{className:"mb-[15px] text-[#555555] text-xs",children:u.formatMessage({id:"agent.filesupload"})}),(0,e.jsx)(_e.Z,{size:"small",onChange:q,checked:!!(a&&a.agent.allow_upload_file==1)})]})]})}),(0,e.jsx)(m.Z.Item,{className:"mb-[30px]",children:(0,e.jsxs)("div",{children:[(0,e.jsxs)("div",{className:"mb-[15px] text-[#555555] text-xs font-medium",children:[(0,e.jsx)("span",{className:"text-[#E80000]",children:"* "}),u.formatMessage({id:"agent.LLMmodel"})]}),(0,e.jsx)(Me.Z,{placeholder:u.formatMessage({id:"agent.pleaseselect"}),style:{width:270},value:le==0?u.formatMessage({id:"agent.pleaseselect"}):le,onChange:I,options:oe})]})}),(0,e.jsx)(m.Z.Item,{className:"mb-[30px]",name:"obligations",children:(0,e.jsxs)("div",{className:"w-full",children:[(0,e.jsx)("div",{className:"mb-[15px] text-[#555555] text-xs",children:(0,e.jsx)(pe.Z,{className:"font-medium",required:!0,name:u.formatMessage({id:"agent.functiondescription"}),title:u.formatMessage({id:"agent.explain.function"})})}),(0,e.jsx)(wt,{onChange:V,value:a&&a.agent&&a.agent.obligations,placeholder:"Agent".concat(u.formatMessage({id:"agent.functiondescription"})),autoSize:{minRows:8,maxRows:10}})]})}),(0,e.jsxs)("div",{className:"mb-[11px] text-xs font-bold flex justify-between items-center",children:[(0,e.jsx)("div",{className:"text-[#555555] text-xs",children:(0,e.jsx)(pe.Z,{className:"font-medium",required:!0,name:u.formatMessage({id:"agent.inputvariable"}),title:u.formatMessage({id:"agent.explain.inputvariable"})})}),(0,e.jsx)("div",{children:(0,e.jsx)(K.ZP,{type:"link",onClick:function(){return g()},block:!0,icon:(0,e.jsx)(We.Z,{}),children:u.formatMessage({id:"agent.add"})})})]}),(0,e.jsxs)("div",{className:"w-full flex justify-start items-center text-xs font-medium px-2.5 text-[#555555] h-12 bg-[#F7F7F7] rounded-t-lg",children:[(0,e.jsx)("div",{className:"w-48 mr-5 ml-[10px]",children:u.formatMessage({id:"agent.variable.name"})}),(0,e.jsx)("div",{className:"w-52 mr-5",children:u.formatMessage({id:"agent.variable.display"})}),(0,e.jsx)("div",{className:"w-36 mr-[100px]",children:u.formatMessage({id:"agent.variable.type"})}),(0,e.jsx)("div",{className:"w-14 mr-[90px]",children:u.formatMessage({id:"agent.variable.required"})}),(0,e.jsx)("div",{children:u.formatMessage({id:"agent.variable.operation"})})]}),(0,e.jsx)("div",{className:"mb-[30px]",children:o.map(function(j){var N=j.key,O=j.name,be=Re()(j,_t);return(0,e.jsxs)("div",{className:"w-full h-20 flex justify-start  px-2.5 border-b border-x pt-7 last:rounded-b-lg",children:[(0,e.jsx)(m.Z.Item,t()(t()({className:"m-0"},be),{},{name:[O,"name"],rules:[{required:!0,message:u.formatMessage({id:"agent.rules.name"})},{pattern:/^[a-zA-Z0-9_]+$/,message:u.formatMessage({id:"agent.rules.verifydescription"})}],children:(0,e.jsx)(J.Z,{placeholder:u.formatMessage({id:"agent.variable.name"}),className:"w-48 mr-5"})})),(0,e.jsx)(m.Z.Item,t()(t()({className:"m-0"},be),{},{name:[O,"content"],rules:[{required:!0,message:u.formatMessage({id:"agent.rules.displayname"})}],children:(0,e.jsx)(J.Z,{placeholder:u.formatMessage({id:"agent.variable.display"}),className:"w-52 mr-5"})})),(0,e.jsx)(m.Z.Item,t()(t()({className:"w-36 mr-[110px] m-0"},be),{},{name:[O,"type"],children:(0,e.jsx)(Me.Z,{defaultValue:"string",options:[{value:"string",label:"string"},{value:"number",label:"number"}]})})),(0,e.jsx)(m.Z.Item,t()(t()({className:"w-12 mr-[100px] m-0"},be),{},{name:[O,"status"],children:(0,e.jsx)(_e.Z,{size:"small"})})),G&&G.getFieldsValue().users.length>1?(0,e.jsx)(m.Z.Item,{className:"m-0",children:(0,e.jsx)(He.Z,{onClick:function(){return F(O)}})}):null]})})}),(0,e.jsxs)(m.Z.Item,{className:"mb-[30px]",children:[(0,e.jsx)("div",{className:"text-[#555555] text-xs mb-[15px]",children:(0,e.jsx)(pe.Z,{className:"font-medium",name:u.formatMessage({id:"agent.associatedknowledgebase"}),title:u.formatMessage({id:"agent.explain.associatedknowledgebase"})})}),(0,e.jsx)(Me.Z,{size:"large",mode:"tags",style:{width:"100%"},placeholder:u.formatMessage({id:"agent.pleaseselect"}),value:fe,onChange:he,options:ae})]}),(0,e.jsx)(m.Z.Item,{className:"mb-[30px]",children:(0,e.jsxs)("div",{className:"",children:[(0,e.jsxs)("div",{className:"text-[#555555] text-xs mb-[15px]",children:[" ",u.formatMessage({id:"agent.defaultoutputformat"})]}),(0,e.jsxs)($.ZP.Group,{value:a&&a.agent.default_output_format,onChange:function(N){we(N)},children:[(0,e.jsx)($.ZP,{value:1,children:(0,e.jsx)("div",{className:"text-[#555555] text-xs font-normal",children:"text"})}),(0,e.jsx)($.ZP,{value:2,children:(0,e.jsx)("div",{className:"text-[#555555] text-xs font-normal",children:"json"})}),(0,e.jsx)($.ZP,{value:3,children:(0,e.jsx)("div",{className:"text-[#555555] text-xs font-normal",children:"code"})})]})]})})]})}}),(0,e.jsxs)("div",{children:[(0,e.jsx)(K.ZP,{type:"primary",className:"mr-[20px]",onClick:function(){Pe()},children:u.formatMessage({id:"agent.btn.nextstep"})}),(0,e.jsxs)(K.ZP,{onClick:function(){history.back()},children:[" ",u.formatMessage({id:"agent.btn.back"})]})]}),(0,e.jsx)("div",{className:"h-[30px] w-1"})]})})]})},Nt=Ft,St=s(49677),Zt=s.n(St),Mt=s(92485),Pt=s(85877),Xe=s(39944),At=s(71471),Ct=["key","name"],ga=At.Z.Title,pa=J.Z.TextArea,fa=J.Z.Search,kt=function(l){var ie=l.handleBack,a=l.Detaillist,T=l.setDetaillist,fe=l.Fourthly_select_list,xe=l.setFourthly_config_id,k=l.Fourthly_config_id,G=l.Fourthlyref,re=l.Fourthly_abilities_list,le=l.Operationbentate,oe=l.callwordlist,b=l.newagentid,y=(0,C.useIntl)(),te=(0,h.useState)(0),ue=p()(te,2),Y=ue[0],de=ue[1],u=(0,h.useState)(""),_=p()(u,2),z=_[0],ae=_[1],Q=(0,h.useState)(""),ce=p()(Q,2),D=ce[0],x=ce[1],E=(0,h.useState)(!1),I=p()(E,2),V=I[0],U=I[1],me=function(f){var g={user:{value:ve(f)}};ae(new Xe.z(g))},W=function(f){var g={user:{value:f.target.value}};ae(new Xe.z(g))},q=function(f){de(f)},he=function(f){var g=f.users.filter(function(N,O){return N.type=="number"&&!Number(N.value)&&!!N.value});if(!z.user)n.ZP.warning(y.formatMessage({id:"agent.message.warning.callword"}));else if(g.length>0)n.ZP.warning(y.formatMessage({id:"agent.message.warning.datatype"}));else{U(!0);var F=new ge.Kr("input","","");f.users.forEach(function(N){var O=new ge._w(N.name,N.type?N.type:"string",N.type=="string"?N.value:Number(N.value),N.content,N.status);F.addProperty(N.name,O)});var j={agent_id:b||a.agent.agent_id,ability_id:Y,input_dict:F,prompt:z};Pe(j)}},ve=function o(f){return f.map(function(g){return g.type==="mention"?g.id:g.children?o(g.children):g.text}).join("")},Pe=function(f){(0,R.LH)(f).then(function(g){n.ZP.success(y.formatMessage({id:"agent.message.success.runpublish"})),x(g.data.outputs.text),U(!1)}).catch(function(g){U(!1)})},we=function(){var o=L()(w()().mark(function f(){var g;return w()().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return j.next=2,(0,R.Dh)(b||a.agent.agent_id);case 2:g=j.sent,g.code==0?n.ZP.success(y.formatMessage({id:"agent.message.success.publish"})):n.ZP.error(y.formatMessage({id:"agent.message.fail.publish"}));case 4:case"end":return j.stop()}},f)}));return function(){return o.apply(this,arguments)}}(),A=function(){var o=L()(w()().mark(function f(){return w()().wrap(function(F){for(;;)switch(F.prev=F.next){case 0:C.history.push("/Agents?app_id=".concat(a.app.app_id,"&type=false")),location.reload();case 2:case"end":return F.stop()}},f)}));return function(){return o.apply(this,arguments)}}();return(0,h.useEffect)(function(){},[]),(0,e.jsxs)("div",{style:{height:"100%"},children:[(0,e.jsx)("div",{className:"text-base font-medium text-[#333333] my-[30px]",children:y.formatMessage({id:"agent.operationrun"})}),(0,e.jsxs)("div",{className:"mb-[30px]",children:[(0,e.jsx)("div",{className:"mb-[15px] text-[#555555] text-xs font-medium",children:y.formatMessage({id:"agent.selectivepower"})}),(0,e.jsx)(Me.Z,{placeholder:y.formatMessage({id:"agent.pleaseselect"}),defaultValue:y.formatMessage({id:"agent.allability"}),style:{width:390,fontSize:"12px",color:"#BBBBBB",fontWeight:"400"},onChange:q,options:re})]}),(0,e.jsx)("div",{children:(0,e.jsxs)(m.Z,{name:"dynamic_form_nest_item",onFinish:he,style:{width:900},autoComplete:"off",form:G,children:[(0,e.jsx)("div",{className:"mb-[15px] text-[#555555] text-xs font-medium",children:y.formatMessage({id:"agent.inputvariable"})}),(0,e.jsx)(m.Z.List,{name:"users",children:function(f,g){return Zt()(g),(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)("div",{className:"w-full flex justify-start items-center text-xs font-medium px-[10px] text-[#213044] h-12 bg-[#F7F7F7]  rounded-t-lg",children:[(0,e.jsx)("div",{className:"w-48 mr-5 ml-2.5",children:y.formatMessage({id:"agent.variable.name"})}),(0,e.jsx)("div",{className:"w-52",children:y.formatMessage({id:"agent.variable.value"})})]}),(0,e.jsx)("div",{className:"mb-[30px]",children:f.map(function(F){var j=F.key,N=F.name,O=Re()(F,Ct);return(0,e.jsxs)("div",{className:"w-full h-20 flex justify-start  px-2.5 border-b border-x pt-7 last:rounded-b-lg",children:[(0,e.jsx)(m.Z.Item,t()(t()({},O),{},{name:[N,"content"],children:(0,e.jsx)(J.Z,{className:"w-48 mr-5",style:{color:"#213044",fontWeight:"400",fontSize:"12px"},variant:"borderless",disabled:!0})})),(0,e.jsx)(m.Z.Item,t()(t()({},O),{},{name:[N,"value"],rules:[{required:!!(G.getFieldsValue()&&G.getFieldsValue().users[j].status==!0),message:y.formatMessage({id:"agent.rules.veriablevalue"})}],children:(0,e.jsx)(J.Z,{style:{width:"660px"},placeholder:G.getFieldsValue()&&G.getFieldsValue().users[j].status==!0?y.formatMessage({id:"agent.variable.required.value"}):y.formatMessage({id:"agent.variable.value"})})}))]})})})]})}}),(0,e.jsxs)(m.Z.Item,{rules:[{required:!0,message:y.formatMessage({id:"agent.rules.callwordvalue"})}],children:[(0,e.jsx)("div",{className:"mb-[15px] text-[#555555] text-xs font-medium",children:y.formatMessage({id:"agent.runpreview"})}),(0,e.jsx)(Ke.Z,{spinning:V,children:(0,e.jsxs)("div",{className:"bg-[#F7F7F7] p-3.5 rounded-lg",children:[(0,e.jsx)("div",{className:"h-[345px] mb-[30px]",children:D?(0,e.jsx)(Mt.Z,{language:"python3",value:D&&JSON.stringify(D)}):null}),(0,e.jsxs)("div",{className:"agents-input p-2 bg-white border rounded-md my-2 flex items-center justify-between",style:{border:"1px solid #EEE"},children:[(0,e.jsx)("div",{className:"w-full",children:(0,e.jsx)(Pt.Z,{onChange:function(f){me(f)},options:oe})}),(0,e.jsx)("div",{className:"w-8 h-8 bg-[#e8effc] rounded-md",children:(0,e.jsx)(K.ZP,{className:"bg-[#e8effc]",icon:(0,e.jsx)("img",{src:"/icons/fs.svg"}),type:"link",htmlType:"submit",block:!0})})]})]})})]})]})}),(0,e.jsx)("div",{className:"w-28",children:(a==null?void 0:a.agent.publish_status)===1&&(a==null?void 0:a.is_creator)===1?(0,e.jsx)("div",{children:(0,e.jsx)(K.ZP,{type:"primary",htmlType:"submit",className:"w-full",onClick:A,children:y.formatMessage({id:"agent.amend"})})}):(0,e.jsx)("div",{children:(0,e.jsx)(K.ZP,{type:"primary",htmlType:"submit",className:"w-full",disabled:le!="false",onClick:we,children:y.formatMessage({id:"agent.publish"})})})}),(0,e.jsx)("div",{className:"h-[30px] w-1"})]})},Dt=kt,Et=["key","name"],Tt=J.Z.TextArea,It=function(l){var ie=l.SecondValue,a=l.handleBack,T=l.Detaillist,fe=l.setDetaillist,xe=l.Sformref,k=l.Operationbentate,G=l.pageKeyfun,re=l.secondjudgingcondition,le=l.SkillMenuClick,oe=l.agentupdata,b=(0,C.useIntl)(),y=n.ZP.useMessage(),te=p()(y,2),ue=te[0],Y=te[1],de=(0,h.useState)({auto_match_ability:0,agent_abilities:[{agent_ability_id:0,name:"string",content:"string",status:0}]}),u=p()(de,2),_=u[0],z=u[1];(0,h.useEffect)(function(){});var ae=function(x){if(x.users.length==1&&(!x.users[0].content&&x.users[0].name||x.users[0].content&&!x.users[0].name))return n.ZP.warning(b.formatMessage({id:"agent.message.warning.selectknowledgebase"}));var E=x.users.map(function(V){return t()(t()({},V),{},{status:V.status?1:2,agent_ability_id:V.agent_ability_id?V.agent_ability_id:0})}),I={agent_id:T.agent.agent_id,data:{auto_match_ability:T.agent.auto_match_ability,agent_abilities:x.users.length==1&&!x.users[0].content&&!x.users[0].name?[]:E}};k=="false"&&Q(),ie(t()({},_))},Q=function(){var D=L()(w()().mark(function x(){return w()().wrap(function(I){for(;;)switch(I.prev=I.next){case 0:re()||oe();case 1:case"end":return I.stop()}},x)}));return function(){return D.apply(this,arguments)}}(),ce=function(x){fe(t()(t()({},T),{},{agent:t()(t()({},T.agent),{},{auto_match_ability:x?1:0})}))};return(0,e.jsxs)("div",{style:{height:"100%"},children:[(0,e.jsx)("div",{className:"text-base font-medium text-[#333333] my-[30px]",children:b.formatMessage({id:"agent.Applicationcapabilitysetting"})}),(0,e.jsxs)("div",{className:"mb-[30px]",children:[(0,e.jsx)("div",{className:"mb-[15px] text-[#555555] text-xs font-medium",children:(0,e.jsx)(pe.Z,{name:b.formatMessage({id:"agent.automatch"}),title:b.formatMessage({id:"agent.explain.automatch"})})}),(0,e.jsx)(_e.Z,{size:"small",checked:!!(T&&T.agent.auto_match_ability==1),onChange:ce})]}),(0,e.jsx)("div",{className:"w-full",children:(0,e.jsxs)(m.Z,{name:"dynamic_form_nest_item",onFinish:ae,style:{width:900},autoComplete:"off",form:xe,children:[(0,e.jsx)(m.Z.List,{name:"users",children:function(x,E){var I=E.add,V=E.remove;return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)("div",{className:"w-full flex items-center justify-between mb-[11px]",children:[(0,e.jsx)("div",{className:" text-[#555555] text-xs font-medium",children:b.formatMessage({id:"agent.capability"})}),(0,e.jsx)("div",{children:(0,e.jsx)(K.ZP,{type:"link",onClick:function(){return I()},block:!0,icon:(0,e.jsx)(We.Z,{}),children:b.formatMessage({id:"agent.add"})})})]}),x.map(function(U){var me=U.key,W=U.name,q=Re()(U,Et);return(0,e.jsxs)("div",{className:"bg-[#F7F7F7] p-[15px] rounded-lg mb-[20px]",children:[(0,e.jsx)(m.Z.Item,{className:"mb-0",children:(0,e.jsxs)("div",{className:"w-full flex justify-between items-center mb-[15px]",children:[(0,e.jsx)("div",{className:"text-[#555555] text-xs font-medium",children:b.formatMessage({id:"agent.capabilityname"})}),(0,e.jsxs)("div",{children:[" ",(0,e.jsx)(He.Z,{onClick:function(){return V(W)}})]})]})}),(0,e.jsx)(m.Z.Item,t()(t()({className:"mb-[20px]"},q),{},{name:[W,"name"],rules:[{required:x.length!==1,message:b.formatMessage({id:"agent.capabilityname"})}],children:(0,e.jsx)(J.Z,{placeholder:b.formatMessage({id:"agent.capabilityname"}),className:"w-full"})})),(0,e.jsx)("div",{className:"mb-[15px]",children:(0,e.jsx)(pe.Z,{className:"text-[#555555] text-xs font-medium",name:b.formatMessage({id:"agent.capabilitydescription"}),title:b.formatMessage({id:"agent.explain.capabilitydescription"})})}),(0,e.jsx)(m.Z.Item,t()(t()({className:"w-full mb-[20px]"},q),{},{name:[W,"content"],rules:[{required:x.length!==1,message:b.formatMessage({id:"agent.capabilitydescription"})}],children:(0,e.jsx)(Tt,{placeholder:b.formatMessage({id:"agent.capabilitydescription"}),autoSize:{minRows:3,maxRows:10},className:"w-full"})})),(0,e.jsx)("div",{className:"text-[#555555] text-xs font-medium mb-[15px]",children:b.formatMessage({id:"agent.capabilitystatus"})}),(0,e.jsx)(m.Z.Item,t()(t()({className:"mb-[20px]"},q),{},{name:[W,"status"],children:(0,e.jsxs)($.ZP.Group,{optionType:"button",buttonStyle:"solid",defaultValue:!0,children:[(0,e.jsx)($.ZP,{value:!0,children:b.formatMessage({id:"agent.capabilitystatus.enable"})}),(0,e.jsx)($.ZP,{value:!1,children:b.formatMessage({id:"agent.capabilitystatus.disable"})})]})})),(0,e.jsx)("div",{className:"text-[#555555] text-xs font-medium mb-[11px]",children:b.formatMessage({id:"agent.enableall"})}),(0,e.jsx)(m.Z.Item,{className:"mb-0",name:[W,"output_format"],children:(0,e.jsxs)($.ZP.Group,{defaultValue:0,children:[(0,e.jsx)($.ZP,{value:0,children:(0,e.jsx)("div",{className:"text-[#555555] text-xs font-normal",children:b.formatMessage({id:"agent.menu"})})}),(0,e.jsx)($.ZP,{value:1,children:(0,e.jsx)("div",{className:"text-[#555555] text-xs font-normal",children:"text string"})}),(0,e.jsx)($.ZP,{value:2,children:(0,e.jsx)("div",{className:"text-[#555555] text-xs font-normal",children:"format json"})}),(0,e.jsx)($.ZP,{value:3,children:(0,e.jsx)("div",{className:"text-[#555555] text-xs font-normal",children:"code"})})]})})]})})]})}}),(0,e.jsxs)("div",{children:[(0,e.jsx)(K.ZP,{type:"primary",className:"mr-[20px]",onClick:function(){Q()},children:b.formatMessage({id:"agent.btn.savedebug"})}),(0,e.jsx)(K.ZP,{onClick:function(){history.back()},children:b.formatMessage({id:"agent.btn.back"})})]}),(0,e.jsx)("div",{className:"h-[30px] w-1"})]})})]})},Bt=It,Vt=function(){var l,ie,a=(0,C.useIntl)(),T=(0,h.useRef)(null),fe=m.Z.useForm(),xe=p()(fe,1),k=xe[0],G=m.Z.useForm(),re=p()(G,1),le=re[0],oe=m.Z.useForm(),b=p()(oe,1),y=b[0],te=m.Z.useForm(),ue=p()(te,1),Y=ue[0],de=(0,h.useState)(null),u=p()(de,2),_=u[0],z=u[1],ae=(0,h.useState)(0),Q=p()(ae,2),ce=Q[0],D=Q[1],x=(0,h.useState)(null),E=p()(x,2),I=E[0],V=E[1],U=(0,h.useState)(null),me=p()(U,2),W=me[0],q=me[1],he=(0,h.useState)(null),ve=p()(he,2),Pe=ve[0],we=ve[1],A=(0,h.useState)(null),o=p()(A,2),f=o[0],g=o[1],F=(0,h.useState)(null),j=p()(F,2),N=j[0],O=j[1],be=(0,h.useState)(null),Ge=p()(be,2),Ae=Ge[0],Ce=Ge[1],Lt=(0,h.useState)(null),Je=p()(Lt,2),xa=Je[0],ha=Je[1],Rt=(0,h.useState)(null),Ye=p()(Rt,2),$t=Ye[0],Gt=Ye[1],zt=(0,h.useState)(null),Qe=p()(zt,2),ye=Qe[0],Ut=Qe[1],Kt=(0,h.useState)("1"),qe=p()(Kt,2),se=qe[0],je=qe[1],Wt=(0,h.useState)(null),et=p()(Wt,2),Ht=et[0],tt=et[1],Xt=(0,h.useState)(null),at=p()(Xt,2),Jt=at[0],Yt=at[1],Qt=(0,h.useState)(null),st=p()(Qt,2),qt=st[0],nt=st[1],ea=(0,h.useState)(null),it=p()(ea,2),Fe=it[0],rt=it[1],ta=(0,h.useState)(!1),lt=p()(ta,2),aa=lt[0],ot=lt[1],sa=(0,h.useState)({first:!1,second:!1,fourthly:!1}),ut=p()(sa,2),Ne=ut[0],ke=ut[1],na=[{key:"1",icon:(0,e.jsx)(Oe.Z,{}),label:a.formatMessage({id:"agent.menu.basicsetup"}),disabled:Ne.first,style:{padding:"15px",width:"100%",margin:"0px",marginBottom:"10px",fontSize:"16px",fontWeight:"500",lineHeight:"22px",color:se=="1"?"#1B64F3":"#213044"}},{key:"2",disabled:Ne.second,icon:(0,e.jsx)(Le.Z,{}),label:a.formatMessage({id:"agent.menu.Capacityoutput"}),style:{padding:"15px",width:"100%",margin:"0px",marginBottom:"10px",fontSize:"16px",lineHeight:"22px",fontWeight:"500",color:se=="2"?"#1B64F3":"#213044"}},{key:"4",disabled:Ne.fourthly,icon:(0,e.jsx)(X.Z,{}),label:a.formatMessage({id:"agent.operationrun"}),style:{padding:"15px",width:"100%",margin:"0px",marginBottom:"10px",fontSize:"16px",lineHeight:"22px",fontWeight:"500",color:se=="4"?"#1B64F3":"#213044"}}];(0,h.useEffect)(function(){var Z=new URLSearchParams(window.location.search);Z.get("app_id")||ke(t()(t()({},Ne),{},{first:!1,second:!0,fourthly:!0})),De()},[]);var De=function(){var Z=L()(w()().mark(function d(r){var i,M,v,c,xt,Ue,ht,vt;return w()().wrap(function(ee){for(;;)switch(ee.prev=ee.next){case 0:if(M=new URLSearchParams(window.location.search),M.get("from")&&Yt(M.get("from")),v=null,!(M.get("app_id")||r)){ee.next=10;break}return ee.next=6,(0,R.ek)(r||M.get("app_id"),M.get("type"));case 6:v=ee.sent,rt(v.data.app.app_id),ee.next=13;break;case 10:return ee.next=12,(0,ne.cI)();case 12:v=ee.sent;case 13:c=v.data,xt=(i=v.data)===null||i===void 0||(i=i.agent_dataset_relation_list)===null||i===void 0?void 0:i.map(function(P){return P.dataset_id}),V(xt),z(v.data),Ut(v.data.agent.publish_status===0&&v.data.is_creator===1?"false":"true"),v.data.agent.publish_status===1&&n.ZP.warning(a.formatMessage({id:"agent.message.listwarning"}),5),k.setFieldsValue(dt(c.agent.input_variables)),Ue=v.data.agent_abilities_list.map(function(P){return P.status==1?t()(t()({},P),{},{status:!0}):t()(t()({},P),{},{status:!1})}),y.setFieldsValue({users:Ue[0]?Ue:[{agent_ability_id:0,name:"",content:"",status:!0,output_format:0}]}),we(ze(c.agent_abilities_list)),g(ze(c.agent_abilities_list)),ht=c.agent_abilities_list.filter(function(P){return P.output_format!==0}),le.setFieldsValue({users:ht.map(function(P){return{agent_ability_id:P.agent_ability_id,output_format:P.output_format}})}),Y.setFieldsValue(dt(c.agent.input_variables)),O(c.m_configurations_list.map(function(P){return{value:P.m_config_id?P.m_config_id:P.model_config_id,label:P.m_name?P.m_name:P.model_name}})),c.agent.m_config_id||c.agent.model_config_id?Ce(c.agent.m_config_id?c.agent.m_config_id:c.agent.model_config_id):Ce(c.m_configurations_list[0].model_config_id),vt=c.agent_abilities_list.filter(function(P,ba){return P.status===1}),Gt(ze(vt).concat([{value:0,label:a.formatMessage({id:"agent.allability"})}]));case 31:case"end":return ee.stop()}},d)}));return function(r){return Z.apply(this,arguments)}}(),dt=function(d){var r={users:d&&d.properties?Object.values(d.properties).map(function(i){return{name:i.name,type:i.type,content:i.display_name,status:i.required}}):[{name:"",content:"",type:"string",agent_ability_id:0,output_format:0,status:0}]};return r},ze=function(d){return d.map(function(r){return{value:r.agent_ability_id,label:r.name}})},ia=function(d){ft(d,1),Y.setFieldsValue(k.getFieldsValue())},ra=function(){De()},ct=function(d){D(d)},la=function(){history.back()},oa=function(){var d=k.getFieldsValue().users.filter(function(r){return!r||!r.name||!r.content});if(k.getFieldsValue().users[0])if(Ae)if(_.agent.obligations){if(d.length!==0)return n.ZP.warning(a.formatMessage({id:"agent.message.warning.completevariable"})),!0;if(ca(k.getFieldsValue().users,"name"))return n.ZP.warning(a.formatMessage({id:"agent.message.warning.repetition"})),!0}else return n.ZP.warning(a.formatMessage({id:"agent.message.warning.functiondescribe"})),!0;else return n.ZP.warning(a.formatMessage({id:"agent.message.warning.LLM"})),!0;else return n.ZP.warning(a.formatMessage({id:"agent.message.warning.variable"})),!0;return!1},ua=function(){var d=y.getFieldsValue().users.filter(function(i){return!!i}),r=d.filter(function(i){return!i.name||!i.content});return r.length!==0&&!(r.length==1&&r[0].name==""&&r[0].content=="")?(n.ZP.warning(a.formatMessage({id:"agent.message.warning.integritycapacity"})),!0):!1},mt=function(d){if((d==null?void 0:d.key)=="4"){var r=k.getFieldsValue().users.map(function(i){return{value:"<<".concat(Ze.qX,".inputs.").concat(i.name,">>"),label:i.name}});tt(r)}je(d.key)},da=function(){ot(!0);var d=0;Fe?(0,R.ek)(Fe,!1).then(function(r){d=r.data.agent.agent_id,gt(d),setTimeout(function(){pt(d),n.ZP.success(a.formatMessage({id:"skill.conserve.success"}))},500),setTimeout(function(){De(Fe)},1e3),nt(d)}).catch(function(r){}):(0,Be.uy)((0,ne.Go)("GET")).then(function(r){rt(r.data.app_id),(0,R.ek)(Fe||r.data.app_id,!1).then(function(i){d=i.data.agent.agent_id,gt(d),setTimeout(function(){pt(d),n.ZP.success(a.formatMessage({id:"skill.conserve.success"}))},500),setTimeout(function(){De(r.data.app_id);var M=t()(t()({},(0,ne.Go)("GET")),{},{app_id:r.data.app_id});(0,ne.Go)("SET",M)},1e3),nt(d)}).catch(function(i){})}).catch(function(r){})},gt=function(d,r){k.validateFields().then(function(i){var M={agent_id:d,data:{is_public:_.app.is_public,enable_api:_.app.enable_api,obligations:_.agent.obligations,input_variables:ma(k.getFieldsValue()),dataset_ids:I,m_config_id:Ae,allow_upload_file:_.agent.allow_upload_file,default_output_format:_.agent.default_output_format}};ye=="false"&&ft(M,1),Y.setFieldsValue(k.getFieldsValue());var v=k.getFieldsValue().users.map(function(c){return{value:"<<".concat(Ze.qX,".inputs.").concat(c.name,">>"),label:c.name}});tt(v),r&&je(r.key)}).catch(function(i){})},pt=function(d){var r=y.getFieldsValue().users.filter(function(v){return!!v}),i=r.map(function(v){return t()(t()({},v),{},{status:v.status==!1?2:1,agent_ability_id:v.agent_ability_id?v.agent_ability_id:0,output_format:v.output_format?v.output_format:0})}),M={agent_id:d,data:{auto_match_ability:_.agent.auto_match_ability,agent_abilities:i}};ye=="false"&&(i.length==1&&i[0].name==""&&i[0].content==""?(ke({first:!1,second:!1,fourthly:!1}),je("4")):(0,R.Iw)(M).then(function(v){v.code==0&&(ke({first:!1,second:!1,fourthly:!1}),je("4"))}).catch(function(v){}))},ft=function(){var Z=L()(w()().mark(function d(r,i){var M;return w()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(ye!=="false"){c.next=19;break}if(i!==1){c.next=7;break}return c.next=4,(0,R.XB)(r);case 4:c.t0=c.sent,c.next=17;break;case 7:if(i!==2){c.next=13;break}return c.next=10,(0,R.Iw)(r);case 10:c.t1=c.sent,c.next=16;break;case 13:return c.next=15,(0,R.Ce)(r);case 15:c.t1=c.sent;case 16:c.t0=c.t1;case 17:M=c.t0,M&&M.code===0&&ot(!1);case 19:case"end":return c.stop()}},d)}));return function(r,i){return Z.apply(this,arguments)}}(),ca=function(d,r){var i=new Set;return d.some(function(M){var v=M[r];return i.has(v)?i.add(v):i.add(v)&&!1})},ma=function(d){var r=new ge.Kr("input","","");return d.users.forEach(function(i){var M=new ge._w(i.name,i.type?i.type:"string",i.value?i.value:"",i.content,i.status);r.addProperty(i.name,M)}),r};return(0,e.jsxs)("div",{className:" flex bg-white",style:{height:"calc(100vh - 56px)"},children:[(0,e.jsxs)("div",{className:"flex flex-col w-[300px]",style:{height:"calc(100vh - 56px)"},children:[(0,e.jsx)("div",{className:"flex w-full items-center bg-white px-[30px] pt-[30px] border-[#e5e7eb] border-solid border-r",children:(0,e.jsxs)(K.ZP,{type:"link",shape:"circle",size:"middle",className:"",onClick:la,children:[(0,e.jsx)(B.Z,{}),(0,e.jsx)("span",{className:"text-sm font-medium text-[#213044]",children:Jt=="chat_room"?a.formatMessage({id:"agent.back_meeting"}):a.formatMessage({id:"agent.back"})})]})}),(0,e.jsxs)("div",{className:"w-full flex-1 px-[30px] py-[30px] bg-white border-[#e5e7eb] border-solid border-r",children:[(0,e.jsx)(yt.Z,{selectedKeys:[se],onClick:mt,style:{width:"100%",borderInlineEnd:"1px solid rgba(0,0,0,0)"},defaultSelectedKeys:[se],mode:"inline",items:na}),_&&_.app.enable_api===1&&_.app.publish_status===1?(0,e.jsx)("div",{className:"w-full h-[40px] rounded-lg text-[#000] hover:bg-[#f0f0f0] p-[12px] pl-[16px] cursor-pointer",onClick:function(){window.open(Ve._n+_.app.api_url)},children:(0,e.jsxs)("div",{className:"mr-[20px] text-base font-medium text-[#213044] -mt-1",children:[(0,e.jsx)(S.Z,{className:"mr-3"}),a.formatMessage({id:"agent.visit"})," API"]})}):null]})]}),(0,e.jsx)(Ke.Z,{spinning:aa,size:"large",className:"mt-[112px]",children:(0,e.jsx)("div",{className:"flex flex-col",style:{height:"calc(100vh - 56px)",width:"calc(100vw - 230px)",overflowY:"scroll",scrollbarWidth:"none"},children:(0,e.jsxs)("div",{className:"px-[30px] ",style:{overflowX:"auto",minWidth:"960px",height:"100%"},children:[(0,e.jsx)("div",{className:"w-full flex justify-center  mt-[30px]",children:(0,e.jsxs)("div",{className:"flex items-center  w-[900px] ",children:[(0,e.jsx)("div",{className:"mr-[10px] w-[16px] h-[16px]",children:(0,e.jsx)("img",{src:"/icons/flag.svg",alt:"",className:"w-[16px] h-[16px]"})}),(0,e.jsxs)("div",{className:"flex items-center",children:[(0,e.jsxs)("div",{className:"mr-[6px] text-lg text-[#213044] font-medium",children:[(l=(0,ne.Go)("GET"))!==null&&l!==void 0&&l.app_id?a.formatMessage({id:"agent.compile"}):a.formatMessage({id:"agent.created"}),a.formatMessage({id:"agent"})]}),(_==null||(ie=_.app)===null||ie===void 0?void 0:ie.publish_status)===1?(0,e.jsx)("div",{className:"bg-[#1B64F3] px-[7px] text-[#fff] rounded font-normal text-xs flex items-center justify-center h-[18px]",children:a.formatMessage({id:"agent.havepublished"})}):(0,e.jsx)("div",{className:" bg-[#EEE] px-[7px]  text-[#999] rounded font-normal text-xs flex items-center justify-center h-[18px]",children:a.formatMessage({id:"agent.unpublish"})})]})]})}),(0,e.jsx)("div",{style:{display:se==="1"?"flex":"none",height:"calc(100vh - 146px)",justifyContent:"center"},children:(0,e.jsx)(Nt,{FirstValue:ia,Ffromref:k,Detaillist:_,setDetaillist:z,repository:I,setRepository:V,Newproperties:W,setNewproperties:q,Operationbentate:ye,Fourthly_config_id:Ae,setFourthly_config_id:Ce,Fourthly_select_list:N,pageKeyfun:je,firstjudgingcondition:oa,agentmenudisabled:Ne,setAgentmunudisabled:ke})}),(0,e.jsx)("div",{style:{display:se==="2"?"flex":"none",height:"calc(100vh - 146px)",justifyContent:"center"},children:(0,e.jsx)(Bt,{SecondValue:ra,Detaillist:_,setDetaillist:z,Sformref:y,Operationbentate:ye,handleBack:ct,pageKeyfun:je,SkillMenuClick:mt,secondjudgingcondition:ua,agentupdata:da})}),(0,e.jsx)("div",{style:{display:se==="4"?"flex":"none",height:"calc(100vh - 146px)",justifyContent:"center"},children:(0,e.jsx)(Dt,{handleBack:ct,Detaillist:_,setDetaillist:z,Fourthly_select_list:N,Fourthly_config_id:Ae,setFourthly_config_id:Ce,Fourthlyref:Y,Fourthly_abilities_list:$t,Operationbentate:ye,callwordlist:Ht,newagentid:qt})})]})})})]})},Ot=Vt}}]);
