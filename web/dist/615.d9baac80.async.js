"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[615],{85422:function(Ke,ve,a){var fe=a(15009),R=a.n(fe),ge=a(99289),J=a.n(ge),_e=a(5574),g=a.n(_e),he=a(11551),N=a(39873),pe=a(28508),w=a(29933),A=a(35312),c=a(3917),$=a(66309),Y=a(28036),t=a(71471),Q=a(74330),O=a(26412),y=a(12845),Z=a(67294),X=a(22683),q=a(97807),le=a(92485),l=a(85893);ve.Z=(0,Z.memo)(function(ee){var T,ae,W,b=ee.data,k=ee.onClose,D=(0,A.useIntl)(),ie=(0,Z.useState)(500),oe=g()(ie,2),xe=oe[0],Me=oe[1],de=(0,c.Z)(function(){var m=J()(R()().mark(function _(u,I){var E;return R()().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:return B.next=2,(0,he.pC)(u,I);case 2:return E=B.sent,B.abrupt("return",E.data);case 4:case"end":return B.stop()}},_)}));return function(_,u){return m.apply(this,arguments)}}(),{manual:!0}),e=de.data,n=de.loading,d=de.run;(0,Z.useEffect)(function(){b!=null&&b.app_id&&b!==null&&b!==void 0&&b.app_run_id&&d(b.app_id,b.app_run_id)},[b==null?void 0:b.app_id,b==null?void 0:b.app_run_id,d]);var j=function(_){var u={1:{color:"processing",text:D.formatMessage({id:"workflow.running"})},2:{color:"success",text:D.formatMessage({id:"workflow.runSc"})},3:{color:"error",text:D.formatMessage({id:"workflow.runF"})}},I=u[_]||{color:"default",text:"Unknown"};return(0,l.jsx)($.Z,{color:I.color,children:I.text})},h=function(_){Me(_)};return(0,l.jsx)(N.Z,{className:"fixed top-[65px] right-2 p-0",dragDirection:"left",minWidth:400,maxWidth:800,defaultWidth:xe,onChange:h,children:(0,l.jsx)(w.Z,{className:"border-none h-full",style:{height:"calc(100vh - 50px - 60px)"},bodyStyle:{overflowY:"auto",padding:"16px"},extra:(0,l.jsx)(Y.ZP,{type:"text",className:"-mr-4 -mt-8",onClick:k,icon:(0,l.jsx)(pe.Z,{})}),title:(0,l.jsx)(t.Z.Title,{level:5,children:D.formatMessage({id:"agent.log.detail"})}),loading:n,children:(0,l.jsx)("div",{className:"space-y-6",children:n?(0,l.jsx)("div",{className:"flex items-center justify-center h-40",children:(0,l.jsx)(Q.Z,{})}):e?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(O.Z,{column:1,bordered:!0,size:"small",children:[(0,l.jsx)(O.Z.Item,{label:D.formatMessage({id:"workflow.user"}),children:e.nickname}),(0,l.jsx)(O.Z.Item,{label:D.formatMessage({id:"workflow.status"}),children:j(e.status)}),(0,l.jsx)(O.Z.Item,{label:D.formatMessage({id:"workflow.created_time"}),children:e.created_time}),(0,l.jsxs)(O.Z.Item,{label:D.formatMessage({id:"workflow.elapsed_time"}),children:[e.elapsed_time,"s"]}),(0,l.jsx)(O.Z.Item,{label:"Tokens",children:e.total_tokens})]}),(0,l.jsxs)("div",{className:"mt-4",children:[(0,l.jsx)(t.Z.Title,{level:5,children:D.formatMessage({id:"agent.log.output"})}),e.outputs?(0,l.jsx)("div",{children:(e==null||(T=e.outputs)===null||T===void 0?void 0:T.type)=="json"?(0,l.jsx)("div",{className:"h-80",children:(0,l.jsx)(le.Z,{language:"python3",value:JSON.parse((ae=e.outputs)===null||ae===void 0?void 0:ae.value)||"{}",readOnly:!0,isJSONStringifyBeauty:!0,onChange:function(){},title:"JSON"})}):(0,l.jsx)("div",{className:"bg-gray-50 p-4 rounded mt-2",children:(0,l.jsx)(X.U,{rehypePlugins:[q.Z],children:((W=e.outputs)===null||W===void 0?void 0:W.value)||""})})}):e.error?(0,l.jsxs)("div",{className:"bg-gray-50 p-4 rounded mt-2 border-l-4 border-red-500",children:[(0,l.jsx)("div",{className:"text-red-500 font-medium mb-2",children:D.formatMessage({id:"agent.log.error"})}),(0,l.jsx)("pre",{className:"whitespace-pre-wrap text-sm text-red-500",children:e.error})]}):(0,l.jsx)("div",{className:"bg-gray-50 p-4 rounded mt-2",children:(0,l.jsx)("div",{className:"text-sm text-gray-500",children:D.formatMessage({id:"agent.log.no.output"})})})]}),Array.isArray(e==null?void 0:e.prompt_data)&&e.prompt_data.length>0&&(0,l.jsxs)("div",{className:"mt-4",children:[(0,l.jsx)(t.Z.Title,{level:5,children:D.formatMessage({id:"agent.log.conversation"})}),(0,l.jsx)(y.Z,{className:"mt-2",children:e.prompt_data.map(function(m,_){var u=g()(m,2),I=u[0],E=u[1];return(0,l.jsx)(y.Z.Item,{color:I==="human"?"blue":"green",children:(0,l.jsxs)("div",{className:"bg-gray-50 p-3 rounded",children:[(0,l.jsx)("div",{className:"text-xs text-gray-500 mb-1",children:I}),(0,l.jsx)("div",{className:"text-sm whitespace-pre-wrap",children:E.value})]})},_)})})]})]}):null})})})})},13085:function(Ke,ve,a){a.d(ve,{Z:function(){return de}});var fe=a(19632),R=a.n(fe),ge=a(97857),J=a.n(ge),_e=a(15009),g=a.n(_e),he=a(99289),N=a.n(he),pe=a(5574),w=a.n(pe),A=a(11551),c=a(67294),$=a(74330),Y=a(35312),t=a(85893),Q=function(n){var d=n.children,j=n.onLoadMore,h=n.onLoadPrevious,m=n.hasMore,_=n.hasPrevious,u=_===void 0?!1:_,I=n.threshold,E=I===void 0?100:I,be=n.className,B=be===void 0?"":be,F=n.loadingComponent,te=F===void 0?(0,t.jsx)($.Z,{size:"small"}):F,$e=n.errorComponent,je=n.initialScrollPosition,He=je===void 0?"bottom":je,se=n.preserveScrollPosition,Ge=se===void 0?!0:se,ye=n.scrollBehavior,ze=ye===void 0?"smooth":ye,Ze=(0,Y.useIntl)(),K=(0,c.useRef)(null),Ie=(0,c.useState)(!1),Le=w()(Ie,2),ue=Le[0],Te=Le[1],we=(0,c.useState)(!1),Ee=w()(we,2),ce=Ee[0],Se=Ee[1],Ne=(0,c.useState)(null),me=w()(Ne,2),Pe=me[0],ke=me[1],V=(0,c.useRef)(!1),Oe=(0,c.useRef)(!0),Ce=function(){K.current&&(K.current.scrollTop=K.current.scrollHeight)};(0,c.useEffect)(function(){Oe.current&&K.current&&(K.current.scrollTop=K.current.scrollHeight,Oe.current=!1)},[]),(0,c.useEffect)(function(){var P=K.current;if(P){var De=function(){var ne=N()(g()().mark(function z(){var H,G,Re,Ae,Be;return g()().wrap(function(L){for(;;)switch(L.prev=L.next){case 0:if(!V.current){L.next=2;break}return L.abrupt("return");case 2:if(H=P.scrollTop,G=P.scrollHeight,Re=P.clientHeight,!(u&&!ce&&H<E)){L.next=16;break}return L.prev=4,V.current=!0,Se(!0),Ae=P.scrollHeight,Be=P.scrollTop,L.next=11,h==null?void 0:h();case 11:requestAnimationFrame(function(){var We=P.scrollHeight,r=We-Ae;P.scrollTop=Be+r});case 12:return L.prev=12,V.current=!1,Se(!1),L.finish(12);case 16:if(!(m&&!ue&&G-H-Re<E)){L.next=27;break}return L.prev=17,V.current=!0,Te(!0),L.next=22,j==null?void 0:j();case 22:P.scrollTop=P.scrollHeight;case 23:return L.prev=23,V.current=!1,Te(!1),L.finish(23);case 27:case"end":return L.stop()}},z,null,[[4,,12,16],[17,,23,27]])}));return function(){return ne.apply(this,arguments)}}(),p=re(De,150);return P.addEventListener("scroll",p),function(){return P.removeEventListener("scroll",p)}}},[m,u,j,h,E,ue,ce]);function re(P,De){var p;return function(){for(var ne=this,z=arguments.length,H=new Array(z),G=0;G<z;G++)H[G]=arguments[G];clearTimeout(p),p=setTimeout(function(){return P.apply(ne,H)},De)}}return(0,t.jsxs)("div",{ref:K,className:"relative overflow-y-auto ".concat(B),children:[(0,t.jsxs)("div",{className:"flex flex-col-reverse min-h-full",children:[ce&&(0,t.jsx)("div",{className:"sticky top-0 left-0 right-0 flex justify-center py-2 bg-white/80 z-10",children:te}),d,ue&&(0,t.jsx)("div",{className:"sticky bottom-0 left-0 right-0 flex justify-center py-2 bg-white/80 z-10",children:te})]}),Pe&&(0,t.jsx)("div",{className:"sticky top-0 w-full text-center py-2 text-red-500",children:$e||Pe.message})]})},O=Q,y=a(39944),Z=a(55927),X=a(82114),q=a(27496),le=a(82061),l=a(34994),ee=a(90672),T=a(64317),ae=a(77598),W=a(45360),b=a(85576),k=a(28036),D=a(22683),ie=a(97807),oe=(0,c.memo)(function(e){var n=e.message;return(0,t.jsx)("div",{className:"flex justify-end",children:(0,t.jsx)("div",{className:"max-w-[70%] rounded-lg p-3 bg-blue-100 text-blue-900",children:n.message})})}),xe=(0,c.memo)(function(e){var n,d=e.message,j=e.detailList,h=e.abilitiesList,m=(0,Y.useIntl)(),_=h==null?void 0:h.find(function(u){return u.value===d.ability_id});return(0,t.jsx)("div",{className:"flex justify-start pb-4",children:(0,t.jsxs)("div",{className:"max-w-full",children:[(0,t.jsxs)("div",{className:"text-sm font-bold mb-2",children:[j==null||(n=j.app)===null||n===void 0?void 0:n.name," ",(_==null?void 0:_.label)&&(0,t.jsxs)("span",{className:"text-gray-500 font-normal text-xs",children:["(",_==null?void 0:_.label,")"]})]}),(0,t.jsxs)("div",{className:"max-w-[90%] rounded-lg  relative bg-white text-gray-900 border border-gray-200",children:[d.message&&(0,t.jsx)("div",{className:"p-3 child  max-w-full [&_p]:mb-0 [&_div]:max-w-full break-words",children:(0,t.jsx)(D.U,{rehypePlugins:[ie.Z],children:d.message})}),d.error&&(0,t.jsxs)("div",{className:"p-3 text-red-500",children:[(0,t.jsx)("div",{children:m.formatMessage({id:"agent.chat.error.message"})}),d.error]}),(0,t.jsx)("div",{className:"absolute w-full mt-1",children:(0,t.jsxs)("div",{className:"text-xs text-gray-500 flex justify-between",children:[(0,t.jsx)("div",{children:d.created_time}),(0,t.jsx)("div",{})]})})]})]})})}),Me=(0,c.memo)(function(e){var n,d=e.detailList,j=(0,Y.useIntl)();return(0,t.jsx)("div",{className:"flex justify-start pb-4 max-w-[90%] min-w-[70%]",children:(0,t.jsxs)("div",{className:"max-w-full",children:[(0,t.jsx)("div",{className:"text-sm font-bold mb-2",children:d==null||(n=d.app)===null||n===void 0?void 0:n.name}),(0,t.jsx)("div",{className:"max-w-[90%] min-w-[200px] rounded-lg relative bg-white text-gray-900 border border-gray-200 p-4",children:(0,t.jsxs)("div",{className:"flex items-center gap-2 pr-4",children:[(0,t.jsx)($.Z,{size:"small"}),(0,t.jsx)("span",{className:"text-gray-500",children:j.formatMessage({id:"agent.chat.waiting"})})]})})]})})}),de=(0,c.memo)(function(e){var n,d,j,h,m,_,u,I,E,be=(0,c.useState)([]),B=w()(be,2),F=B[0],te=B[1],$e=(0,c.useState)(!0),je=w()($e,2),He=je[0],se=je[1],Ge=(0,c.useState)(1),ye=w()(Ge,2),ze=ye[0],Ze=ye[1],K=(0,c.useState)(!1),Ie=w()(K,2),Le=Ie[0],ue=Ie[1],Te=(0,c.useState)(!1),we=w()(Te,2),Ee=we[0],ce=we[1],Se=(0,c.useState)(!1),Ne=w()(Se,2),me=Ne[0],Pe=Ne[1],ke=(0,c.useState)(!1),V=w()(ke,2),Oe=V[0],Ce=V[1],re=(0,c.useRef)(),P=(0,c.useRef)(null),De=(0,c.useRef)(null),p=(0,Y.useIntl)(),ne=(0,Z.Z)(function(r){return r.getTypedMessages("chat_message_llm_return")}),z=(0,Z.Z)(function(r){return r.getTypedLastMessage("chat_message_llm_return")}),H=function(){var i;(i=P.current)===null||i===void 0||i.scrollIntoView({behavior:"smooth"})},G=function(){var r=N()(g()().mark(function i(){var s,v,f;return g()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(!(e!=null&&(s=e.saveInfo)!==null&&s!==void 0&&s.firstjudgingcondition())){o.next=4;break}return o.abrupt("return",!0);case 4:if(!(e!=null&&(v=e.saveInfo)!==null&&v!==void 0&&v.secondjudgingcondition())){o.next=8;break}return o.abrupt("return",!0);case 8:return o.next=10,e==null||(f=e.saveInfo)===null||f===void 0?void 0:f.agentupdata();case 10:return o.abrupt("return",o.sent);case 11:case"end":return o.stop()}},i)}));return function(){return r.apply(this,arguments)}}();(0,ae.Z)(function(){var r,i=z==null?void 0:z.data;if(i&&(i==null?void 0:i.agent_id)===((r=e.data)===null||r===void 0||(r=r.detailList)===null||r===void 0||(r=r.agent)===null||r===void 0?void 0:r.agent_id)){var s=J()(J()({},i),{},{id:i.message_id});ne&&ne.length>0&&(Ce(!1),te(function(v){return[].concat(R()(v),[s])}),setTimeout(H,100))}},[ne]);var Re=function(){var r=N()(g()().mark(function i(s){var v,f,x,o,M,C,Ue,S,Ve;return g()().wrap(function(U){for(;;)switch(U.prev=U.next){case 0:if(console.log(s),o=(v=re.current)===null||v===void 0?void 0:v.getFieldsValue(),!(!o||!((f=s.content)!==null&&f!==void 0&&f.trim()))){U.next=4;break}return U.abrupt("return");case 4:return M=e.data.detailList.agent.agent_id,C=e.data.detailList.agent.input_variables,Ue=o.ability_id,S=new y.z({user:{value:o.content}}),Ve={id:Date.now(),content:s.content,isUser:!0,ability_id:Ue,agent_id:M,agent_run_id:0,completion_tokens:0,created_time:new Date().toISOString(),message:o.content,prompt_tokens:0,total_tokens:0},Ce(!0),te(function(Je){return[].concat(R()(Je),[Ve])}),(x=re.current)===null||x===void 0||x.resetFields(["content"]),U.prev=12,U.next=15,(0,A.CY)({agent_id:M,input_dict:C,ability_id:Ue,prompt:S});case 15:U.next=21;break;case 17:U.prev=17,U.t0=U.catch(12),Ce(!1),W.ZP.error("\u53D1\u9001\u6D88\u606F\u5931\u8D25\uFF0C\u8BF7\u91CD\u8BD5");case 21:setTimeout(H,100);case 22:case"end":return U.stop()}},i,null,[[12,17]])}));return function(s){return r.apply(this,arguments)}}(),Ae=function(){var r=N()(g()().mark(function i(){var s,v,f;return g()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if((s=e.data)!==null&&s!==void 0&&(s=s.detailList)!==null&&s!==void 0&&(s=s.agent)!==null&&s!==void 0&&s.agent_id){o.next=2;break}return o.abrupt("return");case 2:return o.prev=2,Pe(!0),o.next=6,(0,A.CU)(String(e.data.detailList.agent.agent_id),1);case 6:f=o.sent,(v=f.data)!==null&&v!==void 0&&v.list&&(te(f.data.list),se(f.data.total_pages>1),Ze(1)),o.next=13;break;case 10:o.prev=10,o.t0=o.catch(2),console.error("Failed to fetch initial messages:",o.t0);case 13:return o.prev=13,Pe(!1),o.finish(13);case 16:case"end":return o.stop()}},i,null,[[2,10,13,16]])}));return function(){return r.apply(this,arguments)}}(),Be=function(){var r=N()(g()().mark(function i(){var s,v,f,x;return g()().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:if(!(Le||!((s=e.data)!==null&&s!==void 0&&(s=s.detailList)!==null&&s!==void 0&&(s=s.agent)!==null&&s!==void 0&&s.agent_id))){M.next=2;break}return M.abrupt("return");case 2:return M.prev=2,ue(!0),f=ze+1,M.next=7,(0,A.CU)(String(e.data.detailList.agent.agent_id),f);case 7:x=M.sent,((v=x.data)===null||v===void 0||(v=v.list)===null||v===void 0?void 0:v.length)>0?(te(function(C){return[].concat(R()(x.data.list),R()(C))}),Ze(f),se(f<x.data.total_pages)):se(!1),M.next=15;break;case 11:M.prev=11,M.t0=M.catch(2),console.error("Failed to load more messages:",M.t0),se(!1);case 15:return M.prev=15,ue(!1),M.finish(15);case 18:case"end":return M.stop()}},i,null,[[2,11,15,18]])}));return function(){return r.apply(this,arguments)}}(),Fe=function(){var r=N()(g()().mark(function i(){var s;return g()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(!(!((s=e.data)!==null&&s!==void 0&&(s=s.detailList)!==null&&s!==void 0&&(s=s.agent)!==null&&s!==void 0&&s.agent_id)||Ee||!F.length)){f.next=2;break}return f.abrupt("return");case 2:b.Z.confirm({title:p.formatMessage({id:"agent.chat.clear.memory.confirm.title"}),icon:(0,t.jsx)(X.Z,{}),content:p.formatMessage({id:"agent.chat.clear.memory.confirm.content"}),okText:p.formatMessage({id:"agent.chat.clear.memory.confirm.ok"}),cancelText:p.formatMessage({id:"agent.chat.clear.memory.confirm.cancel"}),onOk:function(){var x=N()(g()().mark(function M(){var C;return g()().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return S.prev=0,ce(!0),C=F[F.length-1].id,S.next=5,(0,A.Nj)(String(e.data.detailList.agent.agent_id),C);case 5:W.ZP.success(p.formatMessage({id:"agent.chat.clear.memory.success"})),S.next=11;break;case 8:S.prev=8,S.t0=S.catch(0),console.error("Failed to clear context memory:",S.t0);case 11:return S.prev=11,ce(!1),S.finish(11);case 14:case"end":return S.stop()}},M,null,[[0,8,11,14]])}));function o(){return x.apply(this,arguments)}return o}()});case 3:case"end":return f.stop()}},i)}));return function(){return r.apply(this,arguments)}}();(0,c.useEffect)(function(){var r;(r=e.data)!==null&&r!==void 0&&(r=r.detailList)!==null&&r!==void 0&&(r=r.agent)!==null&&r!==void 0&&r.agent_id&&Ae()},[(n=e.data)===null||n===void 0||(n=n.detailList)===null||n===void 0||(n=n.agent)===null||n===void 0?void 0:n.agent_id]),(0,c.useEffect)(function(){!me&&F.length>0&&H()},[me]);var L=function(){return(0,t.jsxs)("div",{className:"flex items-center justify-center py-2 bg-white/80",children:[(0,t.jsx)($.Z,{size:"small"}),(0,t.jsx)("span",{className:"ml-2 text-sm text-gray-500",children:p.formatMessage({id:"agent.chat.loading.more"})})]})};if(me)return(0,t.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,t.jsx)($.Z,{})});var We=function(){var r=N()(g()().mark(function i(){return g()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return v.next=2,G();case 2:setTimeout(N()(g()().mark(function f(){var x,o;return g()().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:return C.next=2,(0,A.Dh)((x=e.data)===null||x===void 0||(x=x.detailList)===null||x===void 0||(x=x.agent)===null||x===void 0?void 0:x.agent_id);case 2:o=C.sent,o.code==0?W.ZP.success(p.formatMessage({id:"agent.message.success.publish"})):W.ZP.error(p.formatMessage({id:"agent.message.fail.publish"}));case 4:case"end":return C.stop()}},f)})),500);case 3:case"end":return v.stop()}},i)}));return function(){return r.apply(this,arguments)}}();return(0,t.jsx)("div",{className:"!h-[calc(100vh-65px)] p-4 !pb-0 box-border",style:{height:"calc(100vh - 65px)"},children:(0,t.jsxs)(l.A,{formRef:re,submitter:!1,onFinish:Re,layout:"horizontal",initialValues:{ability_id:0},style:{height:"calc(100vh - 57px - 16px)"},className:"m-0 flex flex-col overflow-y-auto ",children:[(0,t.jsxs)("div",{className:"pb-4 flex gap-[10px] ",style:{paddingBottom:"16px"},children:[(0,t.jsx)("div",{className:"flex-1 flex items-center font-bold text-base",children:(d=e.data)===null||d===void 0||(d=d.detailList)===null||d===void 0||(d=d.app)===null||d===void 0?void 0:d.name}),e.operationbentate=="false"&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(k.ZP,{type:"primary",disabled:e.operationbentate!="false",onClick:G,className:"min-w-24",children:p.formatMessage({id:"agent.btn.savedebug"})}),(0,t.jsx)(k.ZP,{type:"primary",disabled:e.operationbentate!="false",onClick:We,className:"min-w-24",children:p.formatMessage({id:"agent.publish"})})]})]}),(0,t.jsxs)("div",{className:"bg-gray-50 rounded-md border border-[#ccc] flex-1 overflow-y-auto flex flex-col",children:[(0,t.jsx)("div",{className:"flex-1 overflow-y-auto ",ref:De,children:(0,t.jsx)(O,{className:"h-full",onLoadPrevious:Be,hasPrevious:He,hasMore:!1,threshold:50,loadingComponent:(0,t.jsx)(L,{}),children:(0,t.jsxs)("div",{className:"px-4 py-2 space-y-4",children:[F.map(function(r){var i,s;return r.agent_run_id===0?(0,t.jsx)(oe,{message:r},r.id):(0,t.jsx)(xe,{detailList:e==null||(i=e.data)===null||i===void 0?void 0:i.detailList,abilitiesList:e==null||(s=e.data)===null||s===void 0?void 0:s.abilitiesList,message:r},r.id)}),Oe&&(0,t.jsx)(Me,{detailList:e==null||(j=e.data)===null||j===void 0?void 0:j.detailList}),(0,t.jsx)("div",{ref:P})]})})}),(0,t.jsxs)("div",{className:"border-t border-gray-200 bg-white  px-4 py-2 relative",children:[(0,t.jsxs)("div",{className:"flex items-center p-[8px] gap-[10px] box-border border bg-white rounded-[8px]",children:[(0,t.jsx)("div",{className:"flex-1",children:(0,t.jsx)(ee.Z,{name:"content",placeholder:p.formatMessage({id:"agent.chat.input.placeholder"}),disabled:(e==null||(h=e.data)===null||h===void 0||(h=h.detailList)===null||h===void 0||(h=h.agent)===null||h===void 0?void 0:h.agent_id)==0,fieldProps:{autoSize:{minRows:1,maxRows:4},variant:"borderless",onPressEnter:function(i){if(!i.shiftKey){var s;i.preventDefault(),(s=re.current)===null||s===void 0||s.submit()}},size:"small",className:"",title:p.formatMessage({id:"agent.chat.input.shift.enter"})},formItemProps:{className:"mb-0"},className:"mb-0"})}),(0,t.jsx)(k.ZP,{onClick:function(){var i;return(i=re.current)===null||i===void 0?void 0:i.submit()},type:"primary",disabled:(e==null||(m=e.data)===null||m===void 0||(m=m.detailList)===null||m===void 0||(m=m.agent)===null||m===void 0?void 0:m.agent_id)==0,className:"min-w-[30px] h-[30px] flex items-center justify-center cursor-pointer rounded-[6px]",icon:(0,t.jsx)(q.Z,{}),title:p.formatMessage({id:"agent.chat.send"})})]}),(0,t.jsxs)("div",{className:"flex items-center mt-1 gap-2",children:[(0,t.jsx)(T.Z,{name:"ability_id",options:((_=e.data)===null||_===void 0?void 0:_.abilitiesList)||[{value:0,label:p.formatMessage({id:"agent.allability"})}],fieldProps:{placeholder:p.formatMessage({id:"agent.pleaseselect"}),size:"small"},disabled:(e==null||(u=e.data)===null||u===void 0||(u=u.detailList)===null||u===void 0||(u=u.agent)===null||u===void 0?void 0:u.agent_id)==0||!((I=e.data)!==null&&I!==void 0&&(I=I.abilitiesList)!==null&&I!==void 0&&I.length),formItemProps:{className:"mb-0"}}),(0,t.jsx)(k.ZP,{icon:(0,t.jsx)(le.Z,{}),disabled:(e==null||(E=e.data)===null||E===void 0||(E=E.detailList)===null||E===void 0||(E=E.agent)===null||E===void 0?void 0:E.agent_id)==0,loading:Ee,onClick:Fe,size:"small",children:p.formatMessage({id:"agent.chat.clear.memory"})})]})]})]})]})})})},27842:function(Ke,ve,a){var fe=a(5574),R=a.n(fe),ge=a(15009),J=a.n(ge),_e=a(99289),g=a.n(_e),he=a(11551),N=a(29608),pe=a(32592),w=a(35312),A=a(67294),c=a(85422),$=a(85893),Y=null,t=null;ve.ZP=function(Q){var O=Q.agent_id,y=(0,w.useIntl)(),Z=(0,w.useSearchParams)(),X=R()(Z,1),q=X[0],le=(0,A.useRef)(null),l=(0,A.useState)(null),ee=R()(l,2),T=ee[0],ae=ee[1],W=(0,A.useState)(!1),b=R()(W,2),k=b[0],D=b[1],ie=q.get("app_id"),oe=function(){D(!1)},xe=function(n){ae({app_id:ie,app_run_id:n.id}),D(!0)},Me=[{dataIndex:"index",valueType:"indexBorder",width:48},{disable:!0,title:y.formatMessage({id:"workflow.status",defaultMessage:""}),dataIndex:"status",ellipsis:!0,search:!1,valueEnum:{1:{text:y.formatMessage({id:"workflow.running",defaultMessage:""}),status:"Processing"},2:{text:y.formatMessage({id:"workflow.runSc",defaultMessage:""}),status:"Success"},3:{text:y.formatMessage({id:"workflow.runF",defaultMessage:""}),status:"Error"}}},{title:y.formatMessage({id:"workflow.created_time",defaultMessage:""}),dataIndex:"created_time",ellipsis:!0,tooltip:y.formatMessage({id:"workflow.created_time_des",defaultMessage:y.formatMessage({id:"workflow.created_time_des",defaultMessage:""})}),search:!1},{title:"".concat(y.formatMessage({id:"workflow.elapsed_time",defaultMessage:""}),"S"),dataIndex:"elapsed_time",ellipsis:!0,tooltip:y.formatMessage({id:"workflow.run_time"}),search:!1},{title:"Tokens",key:"showTime",dataIndex:"total_tokens",hideInSearch:!0},{title:y.formatMessage({id:"workflow.user"}),dataIndex:"nickname",search:!1,ellipsis:!0,key:"user"}],de=(0,N.Z)(function(e){return e.setRunPanelLogRecord});return(0,$.jsxs)("div",{className:"h-full",children:[(0,$.jsx)(pe.Z,{columns:Me,formRef:le,form:{submitter:!1},cardBordered:!0,style:{height:"calc(100% - 20px)"},scroll:{y:"calc(100vh - 230px)"},request:function(){var e=g()(J()().mark(function n(d,j,h){var m;return J()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return console.log(d,j,h),u.next=3,(0,he.My)(ie,{page:d.current,page_size:d.pageSize});case 3:return m=u.sent,console.log(m),u.abrupt("return",{data:m.data.list,success:!0,total:m.data.total_count});case 6:case"end":return u.stop()}},n)}));return function(n,d,j){return e.apply(this,arguments)}}(),onRow:function(n){return{onClick:function(){xe(n)},className:(T==null?void 0:T.app_run_id)===n.id?"bg-blue-50":""}},editable:{type:"multiple"},rowKey:"app_runs_id",search:!1,options:{search:!1,setting:{listsHeight:600}},pagination:{pageSize:20,showSizeChanger:!1},dateFormatter:"string",headerTitle:y.formatMessage({id:"agent.log.list"})}),k&&(T==null?void 0:T.app_id)&&(T==null?void 0:T.app_run_id)&&(0,$.jsx)(c.Z,{data:T,onClose:oe})]})}}}]);
