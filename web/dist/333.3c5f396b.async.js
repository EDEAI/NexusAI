"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[333],{11551:function(ne,K,i){i.d(K,{CU:function(){return F},CY:function(){return B},Ce:function(){return D},Dh:function(){return m},Iw:function(){return V},LH:function(){return k},My:function(){return L},Nj:function(){return I},XB:function(){return c},ek:function(){return g},pC:function(){return W},zl:function(){return Z}});var H=i(15009),o=i.n(H),G=i(99289),l=i.n(G),d=i(47520),x="/v1/agent/agent_info/",X="/v1/vector/dataset_list/2",E="/v1/agent/agent_base_update/",z="/v1/agent/agent_abilities_set/",C="/v1/agent/agent_output_set/",$="/v1/agent/agent_engine_set/",R="/v1/agent/agent_publish/",P="/v1/agent/agent_run",g=function(){var _=l()(o()().mark(function s(a,r){var t;return o()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,d.ZP)("".concat(x).concat(a),{method:"GET",data:{publish_status:r=="true"?1:0}});case 2:return t=n.sent,n.abrupt("return",t);case 4:case"end":return n.stop()}},s)}));return function(a,r){return _.apply(this,arguments)}}(),Z=function(){var _=l()(o()().mark(function s(){var a;return o()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,d.ZP)("".concat(X),{method:"GET"});case 2:return a=t.sent,t.abrupt("return",a);case 4:case"end":return t.stop()}},s)}));return function(){return _.apply(this,arguments)}}(),c=function(){var _=l()(o()().mark(function s(a){var r;return o()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,d.ZP)("".concat(E).concat(a.agent_id),{method:"PUT",data:a.data});case 2:return r=e.sent,e.abrupt("return",r);case 4:case"end":return e.stop()}},s)}));return function(a){return _.apply(this,arguments)}}(),V=function(){var _=l()(o()().mark(function s(a){var r;return o()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,d.ZP)("".concat(z).concat(a.agent_id),{method:"PUT",data:a.data});case 2:return r=e.sent,e.abrupt("return",r);case 4:case"end":return e.stop()}},s)}));return function(a){return _.apply(this,arguments)}}(),D=function(){var _=l()(o()().mark(function s(a){var r;return o()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,d.ZP)("".concat(C).concat(a.agent_id),{method:"PUT",data:a});case 2:return r=e.sent,e.abrupt("return",r);case 4:case"end":return e.stop()}},s)}));return function(a){return _.apply(this,arguments)}}(),U=null,m=function(){var _=l()(o()().mark(function s(a){var r;return o()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,d.ZP)("".concat(R).concat(a),{method:"PUT"});case 2:return r=e.sent,e.abrupt("return",r);case 4:case"end":return e.stop()}},s)}));return function(a){return _.apply(this,arguments)}}(),k=function(){var _=l()(o()().mark(function s(a){var r;return o()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,d.ZP)("".concat(P),{method:"POST",data:a});case 2:return r=e.sent,e.abrupt("return",r);case 4:case"end":return e.stop()}},s)}));return function(a){return _.apply(this,arguments)}}(),B=function(){var _=l()(o()().mark(function s(a){var r;return o()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,d.ZP)("/v1/agent/agent_chat_message",{method:"POST",data:a});case 2:return r=e.sent,e.abrupt("return",r);case 4:case"end":return e.stop()}},s)}));return function(a){return _.apply(this,arguments)}}(),F=function(){var _=l()(o()().mark(function s(a,r){var t;return o()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,d.ZP)("/v1/agent/".concat(a,"/agent_message_list"),{method:"GET",data:{page:r,page_size:20}});case 2:return t=n.sent,n.abrupt("return",t);case 4:case"end":return n.stop()}},s)}));return function(a,r){return _.apply(this,arguments)}}(),L=function(){var _=l()(o()().mark(function s(a,r){var t;return o()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,d.ZP)("/v1/agent/".concat(a,"/agent_log_list"),{method:"GET",data:r});case 2:return t=n.sent,n.abrupt("return",t);case 4:case"end":return n.stop()}},s)}));return function(a,r){return _.apply(this,arguments)}}(),W=function(){var _=l()(o()().mark(function s(a,r){var t;return o()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,d.ZP)("/v1/agent/".concat(a,"/agent_log_details"),{method:"GET",data:{app_run_id:r}});case 2:return t=n.sent,n.abrupt("return",t);case 4:case"end":return n.stop()}},s)}));return function(a,r){return _.apply(this,arguments)}}(),I=function(){var _=l()(o()().mark(function s(a,r){var t;return o()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,d.ZP)("/v1/agent/".concat(a,"/clear_agent_chat_memory"),{method:"POST",data:{message_id:r,agent_id:a}});case 2:return t=n.sent,n.abrupt("return",t);case 4:case"end":return n.stop()}},s)}));return function(a,r){return _.apply(this,arguments)}}()},39873:function(ne,K,i){var H=i(5574),o=i.n(H),G=i(42881),l=i(67294),d=i(85893),x=function(E){var z=E.children,C=E.className,$=C===void 0?"":C,R=E.dragDirection,P=R===void 0?"left":R,g=E.minWidth,Z=g===void 0?415:g,c=E.maxWidth,V=c===void 0?820:c,D=E.minHeight,U=D===void 0?200:D,m=E.maxHeight,k=m===void 0?800:m,B=E.defaultWidth,F=B===void 0?415:B,L=E.defaultHeight,W=L===void 0?300:L,I=E.onChange,_=(0,l.useState)(F),s=o()(_,2),a=s[0],r=s[1],t=(0,l.useState)(W),e=o()(t,2),n=e[0],v=e[1],h=(0,l.useCallback)(function(Q,N){r(Q),N&&v(N),I==null||I(Q,N)},[r,v,I]),M=(0,G.W)({direction:["left","right"].includes(P)?"horizontal":"vertical",triggerDirection:P,minWidth:Z,maxWidth:V,minHeight:U,maxHeight:k,onResize:h}),O=M.triggerRef,J=M.containerRef;return(0,d.jsxs)("div",{ref:J,style:{width:["left","right"].includes(P)?"".concat(a,"px"):void 0,height:["top","bottom"].includes(P)?"".concat(n,"px"):void 0},className:"flex flex-col p-4 shadow-lg rounded-md border border-blue-300 bg-white z-10 wrapPanel ".concat($),children:[P==="left"&&(0,d.jsx)("div",{ref:O,className:"absolute top-1/2 -translate-y-1/2 -left-2 w-3 h-6 cursor-col-resize resize-x",children:(0,d.jsx)("div",{className:"w-1 h-6 bg-gray-300 rounded-sm"})}),P==="right"&&(0,d.jsx)("div",{ref:O,className:"absolute top-1/2 -translate-y-1/2 -right-2 flex justify-end w-3 h-6 cursor-col-resize resize-x",children:(0,d.jsx)("div",{className:"w-1 h-6 bg-gray-300 rounded-sm"})}),P==="top"&&(0,d.jsx)("div",{ref:O,className:"absolute left-1/2 -translate-x-1/2 -top-2 h-3 w-6 cursor-row-resize resize-y",children:(0,d.jsx)("div",{className:"h-1 w-6 bg-gray-300 rounded-sm"})}),P==="bottom"&&(0,d.jsx)("div",{ref:O,className:"absolute left-1/2 -translate-x-1/2 -bottom-2 h-3 w-6 cursor-row-resize resize-y",children:(0,d.jsx)("div",{className:"h-1 w-6 bg-gray-300 rounded-sm"})}),z]})};K.Z=(0,l.memo)(x)},85877:function(ne,K,i){var H=i(19632),o=i.n(H),G=i(97857),l=i.n(G),d=i(5574),x=i.n(d),X=i(52677),E=i.n(X),z=i(35312),C=i(78234),$=i(77598),R=i(96486),P=i.n(R),g=i(67294),Z=i(73935),c=i(43413),V=i(92858),D=i(16845),U=i(15425),m=i(85893),k=function(t){var e=t.children;return(typeof document=="undefined"?"undefined":E()(document))==="object"?Z.createPortal(e,document.body):null},B=typeof navigator!="undefined"&&/Mac OS X/.test(navigator.userAgent),F=function(t){var e=t.value,n=t.onChange,v=t.id,h=t.placeholder,M=t.options,O=(0,z.useIntl)(),J=(0,g.useRef)(),Q=(0,g.useState)(),N=x()(Q,2),T=N[0],w=N[1],_e=(0,g.useState)(0),ae=x()(_e,2),A=ae[0],q=ae[1],de=(0,g.useState)(""),re=x()(de,2),ce=re[0],me=re[1],fe=(0,g.useCallback)(function(u){return(0,m.jsx)(_,l()({},u))},[]),ge=(0,g.useCallback)(function(u){return(0,m.jsx)(I,l()({},u))},[]),p=(0,g.useMemo)(function(){return L((0,D.BU)((0,V.VC)((0,c.Jh)())))},[]),pe=(0,g.useState)(null),se=x()(pe,2),he=se[0],ve=se[1],Oe=(0,U.Z)(function(u){return u.selectedNode}),xe=(0,U.Z)(function(u){return u.getOutputVariables}),ye=(0,U.Z)(function(u){return u.getInputVariables}),be=(0,g.useState)([]),ue=x()(be,2),y=ue[0],ie=ue[1];(0,C.Z)(function(){e&&e.length>0&&ee(e),M!=null&&M.length&&ie(M.map(function(u){return l()(l()({},u),{},{name:u.label,id:u.value})}))}),(0,$.Z)(function(){var u=P().isEqual(he,e);u||(e&&e.length>0?ee(e):e&&P().isArray(e)&&e.length==0&&ee([{type:"paragraph",children:[]}]))},[e,v]),(0,$.Z)(function(){M.length&&ie(M.map(function(u){return l()(l()({},u),{},{name:u.label,id:u.value})})),console.log(M)},[M]);var ee=function(f){ve(f),le(p,{nodes:[{type:"paragraph",children:[]}]}),le(p,{nodes:f})},Ee=(0,g.useCallback)(function(u){if(T&&y.length>0)switch(u.key){case"ArrowDown":u.preventDefault();var f=A>=y.length-1?0:A+1;q(f);return;case"ArrowUp":u.preventDefault();var b=A<=0?y.length-1:A-1;q(b);return;case"Tab":case"Enter":u.preventDefault(),c.YR.select(p,T),W(p,y[A]),w(null);return;case"Escape":u.preventDefault(),w(null);return}else if(u.key==="@"){setTimeout(function(){return Pe()},10);return}w(null)},[y,p,A,T]),le=function(f){var b=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},te=o()(f.children);if(te.forEach(function(j){return f.apply({type:"remove_node",path:[0],node:j})}),b.nodes){var S=c.NB.isNode(b.nodes)?[b.nodes]:b.nodes;S.forEach(function(j,oe){return f.apply({type:"insert_node",path:[oe],node:j})})}var Y=b.at&&c.E9.isPoint(b.at)?b.at:c.ML.end(f,[]);Y&&c.YR.select(f,Y)};(0,g.useEffect)(function(){if(T&&y.length>0){var u=J.current,f=D.F3.toDOMRange(p,T),b=f.getBoundingClientRect();u.style.top="".concat(b.top+window.pageYOffset+24,"px"),u.style.left="".concat(b.left+window.pageXOffset,"px")}},[y.length,p,A,ce,T]);var Pe=function(){var f=p.selection;if(f&&c.e6.isCollapsed(f)){var b=c.e6.edges(f),te=x()(b,1),S=te[0],Y=c.ML.before(p,S),j=Y&&c.ML.range(p,Y,S),oe=j&&c.ML.string(p,j),Me=c.ML.after(p,S),De=c.ML.range(p,S,Me),Ie=c.ML.string(p,De);w(j),me(""),q(0);return}w(null)};return(0,m.jsxs)(D.mH,{editor:p,initialValue:a,onChange:function(f){n==null||n(f),w(null)},children:[(0,m.jsx)(D.CX,{renderElement:fe,renderLeaf:ge,onKeyDown:Ee,className:"!outline-none",placeholder:h!=null?h:O.formatMessage({id:"workflow.placeholder.enterContent",defaultMessage:"\uFF0C@"})}),T&&(0,m.jsx)(k,{children:(0,m.jsx)("div",{ref:J,style:{top:"-9999px",left:"-9999px",position:"absolute",zIndex:10,padding:"3px",background:"white",borderRadius:"4px",boxShadow:"0 1px 5px rgba(0,0,0,.2)"},className:"px-1 pt-1 z-10","data-cy":"mentions-portal",children:y.length?y.map(function(u,f){return(0,m.jsx)("div",{onClick:function(){console.log(u),c.YR.select(p,T),W(p,u),w(null)},className:"hover:bg-blue-100 text-sm mb-1",style:{padding:"1px 3px",borderRadius:"3px",cursor:"pointer",background:f===A?"#B4D5FF":""},children:(0,m.jsx)("span",{children:u.name})},u.name+f)}):(0,m.jsx)(m.Fragment,{children:O.formatMessage({id:"workflow.message.noVariablesFound",defaultMessage:""})})})})]})},L=function(t){var e=t.isInline,n=t.isVoid,v=t.markableVoid;return t.isInline=function(h){return h.type==="mention"?!0:e(h)},t.isVoid=function(h){return h.type==="mention"?!0:n(h)},t.markableVoid=function(h){return h.type==="mention"||v(h)},t},W=function(t,e){var n={type:"mention",id:(e==null?void 0:e.id)||"",character:e.name,base:e,children:[{bold:!0,text:"11111"}]};c.YR.insertNodes(t,n),c.YR.move(t)},I=function(t){var e=t.attributes,n=t.children,v=t.leaf;return(0,m.jsx)("span",l()(l()({},e),{},{children:n}))},_=function(t){var e=t.attributes,n=t.children,v=t.element;switch(v.type){case"mention":return(0,m.jsx)(s,l()({},t));default:return(0,m.jsx)("p",l()(l()({},e),{},{children:n}))}},s=function(t){var e=t.attributes,n=t.children,v=t.element,h=(0,D.vt)(),M=(0,D.UE)(),O={padding:"3px 3px 2px",margin:"0 1px",verticalAlign:"baseline",display:"inline-block",borderRadius:"4px",backgroundColor:"#eee",fontSize:"0.9em",boxShadow:h&&M?"0 0 0 2px #B4D5FF":"none"};return v.children[0].bold&&(O.fontWeight="bold"),v.children[0].italic&&(O.fontStyle="italic"),(0,m.jsx)("span",l()(l()({},e),{},{className:"m-2",contentEditable:!1,"data-cy":"mention-".concat(v.character.replace(" ","-")),style:O,children:B?(0,m.jsxs)(g.Fragment,{children:["1",n,"/",v.character]}):(0,m.jsxs)(g.Fragment,{children:[(0,m.jsx)("span",{children:v.character}),n]})}))},a=[{type:"paragraph",children:[{text:""}]}];K.Z=F}}]);
