"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[521],{13085:function(Ue,Le,r){r.d(Le,{Z:function(){return te}});var Pe=r(15009),x=r.n(Pe),Te=r(99289),Z=r.n(Te),Ze=r(19632),G=r.n(Ze),xe=r(97857),ye=r.n(xe),Ie=r(5574),P=r.n(Ie),I=r(11551),c=r(67294),ee=r(74330),ae=r(35312),e=r(85893),Ce=function(s){var u=s.children,y=s.onLoadMore,T=s.onLoadPrevious,R=s.hasMore,g=s.hasPrevious,h=g===void 0?!1:g,w=s.threshold,N=w===void 0?100:w,$=s.className,k=$===void 0?"":$,m=s.loadingComponent,E=m===void 0?(0,e.jsx)(ee.Z,{size:"small"}):m,J=s.errorComponent,re=s.initialScrollPosition,O=re===void 0?"bottom":re,ie=s.preserveScrollPosition,F=ie===void 0?!0:ie,be=s.scrollBehavior,He=be===void 0?"smooth":be,Be=(0,ae.useIntl)(),D=(0,c.useRef)(null),Se=(0,c.useState)(!1),oe=P()(Se,2),de=oe[0],ue=oe[1],ce=(0,c.useState)(!1),ve=P()(ce,2),me=ve[0],fe=ve[1],ze=(0,c.useState)(null),se=P()(ze,2),U=se[0],Ee=se[1],Q=(0,c.useRef)(!1),M=(0,c.useRef)(!0),Me=function(){D.current&&(D.current.scrollTop=D.current.scrollHeight)};(0,c.useEffect)(function(){M.current&&D.current&&(D.current.scrollTop=D.current.scrollHeight,M.current=!1)},[]),(0,c.useEffect)(function(){var j=D.current;if(j){var he=function(){var pe=Z()(x()().mark(function q(){var W,B,we,n,i;return x()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(!Q.current){o.next=2;break}return o.abrupt("return");case 2:if(W=j.scrollTop,B=j.scrollHeight,we=j.clientHeight,!(h&&!me&&W<N)){o.next=16;break}return o.prev=4,Q.current=!0,fe(!0),n=j.scrollHeight,i=j.scrollTop,o.next=11,T==null?void 0:T();case 11:requestAnimationFrame(function(){var f=j.scrollHeight,b=f-n;j.scrollTop=i+b});case 12:return o.prev=12,Q.current=!1,fe(!1),o.finish(12);case 16:if(!(R&&!de&&B-W-we<N)){o.next=27;break}return o.prev=17,Q.current=!0,ue(!0),o.next=22,y==null?void 0:y();case 22:j.scrollTop=j.scrollHeight;case 23:return o.prev=23,Q.current=!1,ue(!1),o.finish(23);case 27:case"end":return o.stop()}},q,null,[[4,,12,16],[17,,23,27]])}));return function(){return pe.apply(this,arguments)}}(),X=ge(he,150);return j.addEventListener("scroll",X),function(){return j.removeEventListener("scroll",X)}}},[R,h,y,T,N,de,me]);function ge(j,he){var X;return function(){for(var pe=this,q=arguments.length,W=new Array(q),B=0;B<q;B++)W[B]=arguments[B];clearTimeout(X),X=setTimeout(function(){return j.apply(pe,W)},he)}}return(0,e.jsxs)("div",{ref:D,className:"relative overflow-y-auto ".concat(k),children:[(0,e.jsxs)("div",{className:"flex flex-col-reverse min-h-full",children:[me&&(0,e.jsx)("div",{className:"sticky top-0 left-0 right-0 flex justify-center py-2 bg-white/80 z-10",children:E}),u,de&&(0,e.jsx)("div",{className:"sticky bottom-0 left-0 right-0 flex justify-center py-2 bg-white/80 z-10",children:E})]}),U&&(0,e.jsx)("div",{className:"sticky top-0 w-full text-center py-2 text-red-500",children:J||U.message})]})},ne=Ce,Re=r(39944),A=r(55927),je=r(82114),$e=r(27496),l=r(82061),ke=r(34994),Fe=r(90672),Ae=r(64317),De=r(77598),C=r(45360),z=r(85576),d=r(28036),V=r(22683),S=r(97807),K=(0,c.memo)(function(t){var s=t.message;return(0,e.jsx)("div",{className:"flex justify-end",children:(0,e.jsx)("div",{className:"max-w-[70%] rounded-lg p-3 bg-blue-100 text-blue-900",children:s.message})})}),Y=(0,c.memo)(function(t){var s,u=t.message,y=t.detailList,T=t.abilitiesList,R=(0,ae.useIntl)(),g=T.find(function(h){return h.value===u.ability_id});return(0,e.jsx)("div",{className:"flex justify-start pb-4",children:(0,e.jsxs)("div",{children:[(0,e.jsxs)("div",{className:"text-sm font-bold mb-2",children:[y==null||(s=y.app)===null||s===void 0?void 0:s.name," ",(g==null?void 0:g.label)&&(0,e.jsxs)("span",{className:"text-gray-500 font-normal text-xs",children:["(",g==null?void 0:g.label,")"]})]}),(0,e.jsxs)("div",{className:"max-w-[90%] rounded-lg  relative bg-white text-gray-900 border border-gray-200",children:[u.message&&(0,e.jsx)("div",{className:"p-3",children:(0,e.jsx)(V.U,{rehypePlugins:[S.Z],children:u.message})}),u.error&&(0,e.jsxs)("div",{className:"p-3 text-red-500",children:[(0,e.jsx)("div",{children:R.formatMessage({id:"agent.chat.error.message"})}),u.error]}),(0,e.jsx)("div",{className:"absolute w-full mt-1",children:(0,e.jsxs)("div",{className:"text-xs text-gray-500 flex justify-between",children:[(0,e.jsx)("div",{children:u.created_time}),(0,e.jsx)("div",{})]})})]})]})})}),le=(0,c.memo)(function(t){var s,u=t.detailList,y=(0,ae.useIntl)();return(0,e.jsx)("div",{className:"flex justify-start pb-4 max-w-[90%] min-w-[70%]",children:(0,e.jsxs)("div",{children:[(0,e.jsx)("div",{className:"text-sm font-bold mb-2",children:u==null||(s=u.app)===null||s===void 0?void 0:s.name}),(0,e.jsx)("div",{className:"max-w-[90%] min-w-[200px] rounded-lg relative bg-white text-gray-900 border border-gray-200 p-4",children:(0,e.jsxs)("div",{className:"flex items-center gap-2 pr-4",children:[(0,e.jsx)(ee.Z,{size:"small"}),(0,e.jsx)("span",{className:"text-gray-500",children:y.formatMessage({id:"agent.chat.waiting"})})]})})]})})}),te=(0,c.memo)(function(t){var s,u,y,T,R=(0,c.useState)([]),g=P()(R,2),h=g[0],w=g[1],N=(0,c.useState)(!0),$=P()(N,2),k=$[0],m=$[1],E=(0,c.useState)(1),J=P()(E,2),re=J[0],O=J[1],ie=(0,c.useState)(!1),F=P()(ie,2),be=F[0],He=F[1],Be=(0,c.useState)(!1),D=P()(Be,2),Se=D[0],oe=D[1],de=(0,c.useState)(!0),ue=P()(de,2),ce=ue[0],ve=ue[1],me=(0,c.useState)(!1),fe=P()(me,2),ze=fe[0],se=fe[1],U=(0,c.useRef)(),Ee=(0,c.useRef)(null),Q=(0,c.useRef)(null),M=(0,ae.useIntl)(),Me=(0,A.Z)(function(n){return n.getTypedMessages("chat_message_llm_return")}),ge=(0,A.Z)(function(n){return n.getTypedLastMessage("chat_message_llm_return")});console.log(t.data);var j=function(){var i;(i=Ee.current)===null||i===void 0||i.scrollIntoView({behavior:"smooth"})},he=function(){var i,a;if(!(t!=null&&(i=t.saveInfo)!==null&&i!==void 0&&i.firstjudgingcondition())){if(!(t!=null&&(a=t.saveInfo)!==null&&a!==void 0&&a.secondjudgingcondition())){var o;t==null||(o=t.saveInfo)===null||o===void 0||o.agentupdata()}}};(0,De.Z)(function(){var n=ge==null?void 0:ge.data;if(n){var i=ye()(ye()({},n),{},{id:n.message_id});Me&&Me.length>0&&(se(!1),w(function(a){return[].concat(G()(a),[i])}),setTimeout(j,100))}},[Me]);var X=function(){var n=Z()(x()().mark(function i(a){var o,f,b,v,p,_,Ne,L,Oe;return x()().wrap(function(H){for(;;)switch(H.prev=H.next){case 0:if(console.log(a),v=(o=U.current)===null||o===void 0?void 0:o.getFieldsValue(),!(!v||!((f=a.content)!==null&&f!==void 0&&f.trim()))){H.next=4;break}return H.abrupt("return");case 4:return p=t.data.detailList.agent.agent_id,_=t.data.detailList.agent.input_variables,Ne=v.ability_id,L=new Re.z({user:{value:v.content}}),Oe={id:Date.now(),content:a.content,isUser:!0,ability_id:Ne,agent_id:p,agent_run_id:0,completion_tokens:0,created_time:new Date().toISOString(),message:v.content,prompt_tokens:0,total_tokens:0},se(!0),w(function(We){return[].concat(G()(We),[Oe])}),(b=U.current)===null||b===void 0||b.resetFields(["content"]),H.prev=12,H.next=15,(0,I.CY)({agent_id:p,input_dict:_,ability_id:Ne,prompt:L});case 15:H.next=21;break;case 17:H.prev=17,H.t0=H.catch(12),se(!1),C.ZP.error("\u53D1\u9001\u6D88\u606F\u5931\u8D25\uFF0C\u8BF7\u91CD\u8BD5");case 21:setTimeout(j,100);case 22:case"end":return H.stop()}},i,null,[[12,17]])}));return function(a){return n.apply(this,arguments)}}(),pe=function(){var n=Z()(x()().mark(function i(){var a,o,f;return x()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if((a=t.data)!==null&&a!==void 0&&(a=a.detailList)!==null&&a!==void 0&&(a=a.agent)!==null&&a!==void 0&&a.agent_id){v.next=2;break}return v.abrupt("return");case 2:return v.prev=2,ve(!0),v.next=6,(0,I.CU)(String(t.data.detailList.agent.agent_id),1);case 6:f=v.sent,(o=f.data)!==null&&o!==void 0&&o.list&&(w(f.data.list),m(f.data.total_pages>1),O(1)),v.next=13;break;case 10:v.prev=10,v.t0=v.catch(2),console.error("Failed to fetch initial messages:",v.t0);case 13:return v.prev=13,ve(!1),v.finish(13);case 16:case"end":return v.stop()}},i,null,[[2,10,13,16]])}));return function(){return n.apply(this,arguments)}}(),q=function(){var n=Z()(x()().mark(function i(){var a,o,f,b;return x()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:if(!(be||!((a=t.data)!==null&&a!==void 0&&(a=a.detailList)!==null&&a!==void 0&&(a=a.agent)!==null&&a!==void 0&&a.agent_id))){p.next=2;break}return p.abrupt("return");case 2:return p.prev=2,He(!0),f=re+1,p.next=7,(0,I.CU)(String(t.data.detailList.agent.agent_id),f);case 7:b=p.sent,((o=b.data)===null||o===void 0||(o=o.list)===null||o===void 0?void 0:o.length)>0?(w(function(_){return[].concat(G()(b.data.list),G()(_))}),O(f),m(f<b.data.total_pages)):m(!1),p.next=15;break;case 11:p.prev=11,p.t0=p.catch(2),console.error("Failed to load more messages:",p.t0),m(!1);case 15:return p.prev=15,He(!1),p.finish(15);case 18:case"end":return p.stop()}},i,null,[[2,11,15,18]])}));return function(){return n.apply(this,arguments)}}(),W=function(){var n=Z()(x()().mark(function i(){var a;return x()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(!(!((a=t.data)!==null&&a!==void 0&&(a=a.detailList)!==null&&a!==void 0&&(a=a.agent)!==null&&a!==void 0&&a.agent_id)||Se||!h.length)){f.next=2;break}return f.abrupt("return");case 2:z.Z.confirm({title:M.formatMessage({id:"agent.chat.clear.memory.confirm.title"}),icon:(0,e.jsx)(je.Z,{}),content:M.formatMessage({id:"agent.chat.clear.memory.confirm.content"}),okText:M.formatMessage({id:"agent.chat.clear.memory.confirm.ok"}),cancelText:M.formatMessage({id:"agent.chat.clear.memory.confirm.cancel"}),onOk:function(){var b=Z()(x()().mark(function p(){var _;return x()().wrap(function(L){for(;;)switch(L.prev=L.next){case 0:return L.prev=0,oe(!0),_=h[h.length-1].id,L.next=5,(0,I.Nj)(String(t.data.detailList.agent.agent_id),_);case 5:C.ZP.success(M.formatMessage({id:"agent.chat.clear.memory.success"})),L.next=11;break;case 8:L.prev=8,L.t0=L.catch(0),console.error("Failed to clear context memory:",L.t0);case 11:return L.prev=11,oe(!1),L.finish(11);case 14:case"end":return L.stop()}},p,null,[[0,8,11,14]])}));function v(){return b.apply(this,arguments)}return v}()});case 3:case"end":return f.stop()}},i)}));return function(){return n.apply(this,arguments)}}();(0,c.useEffect)(function(){var n;(n=t.data)!==null&&n!==void 0&&(n=n.detailList)!==null&&n!==void 0&&(n=n.agent)!==null&&n!==void 0&&n.agent_id&&pe()},[(s=t.data)===null||s===void 0||(s=s.detailList)===null||s===void 0||(s=s.agent)===null||s===void 0?void 0:s.agent_id]),(0,c.useEffect)(function(){!ce&&h.length>0&&j()},[ce]);var B=function(){return(0,e.jsxs)("div",{className:"flex items-center justify-center py-2 bg-white/80",children:[(0,e.jsx)(ee.Z,{size:"small"}),(0,e.jsx)("span",{className:"ml-2 text-sm text-gray-500",children:M.formatMessage({id:"agent.chat.loading.more"})})]})};if(ce)return(0,e.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,e.jsx)(ee.Z,{})});var we=function(){var n=Z()(x()().mark(function i(){var a,o;return x()().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.next=2,(0,I.Dh)((a=t.data)===null||a===void 0||(a=a.detailList)===null||a===void 0||(a=a.agent)===null||a===void 0?void 0:a.agent_id);case 2:o=b.sent,o.code==0?C.ZP.success(M.formatMessage({id:"agent.message.success.publish"})):C.ZP.error(M.formatMessage({id:"agent.message.fail.publish"}));case 4:case"end":return b.stop()}},i)}));return function(){return n.apply(this,arguments)}}();return(0,e.jsx)("div",{className:"!h-[calc(100vh-65px)] p-4 !pb-0 box-border",children:(0,e.jsxs)(ke.A,{formRef:U,submitter:!1,onFinish:X,layout:"horizontal",initialValues:{ability_id:0},style:{height:"calc(100vh - 57px - 16px)"},className:"m-0 flex flex-col overflow-y-auto ",children:[(0,e.jsxs)("div",{className:"pb-4 flex gap-[10px] ",style:{paddingBottom:"16px"},children:[(0,e.jsx)("div",{className:"flex-1 flex items-center font-bold text-base",children:(u=t.data)===null||u===void 0||(u=u.detailList)===null||u===void 0||(u=u.app)===null||u===void 0?void 0:u.name}),(0,e.jsx)(d.ZP,{type:"primary",disabled:t.operationbentate!="false",onClick:he,className:"min-w-24",children:M.formatMessage({id:"agent.btn.savedebug"})}),(0,e.jsx)(d.ZP,{type:"primary",disabled:t.operationbentate!="false",onClick:we,className:"min-w-24",children:M.formatMessage({id:"agent.publish"})})]}),(0,e.jsxs)("div",{className:"bg-gray-50 rounded-md border border-[#ccc] flex-1 overflow-y-auto flex flex-col",children:[(0,e.jsx)("div",{className:"flex-1 overflow-y-auto ",ref:Q,children:(0,e.jsx)(ne,{className:"h-full",onLoadPrevious:q,hasPrevious:k,hasMore:!1,threshold:50,loadingComponent:(0,e.jsx)(B,{}),children:(0,e.jsxs)("div",{className:"px-4 py-2 space-y-4",children:[h.map(function(n){var i,a;return n.agent_run_id===0?(0,e.jsx)(K,{message:n},n.id):(0,e.jsx)(Y,{detailList:t==null||(i=t.data)===null||i===void 0?void 0:i.detailList,abilitiesList:t==null||(a=t.data)===null||a===void 0?void 0:a.abilitiesList,message:n},n.id)}),ze&&(0,e.jsx)(le,{detailList:t==null||(y=t.data)===null||y===void 0?void 0:y.detailList}),(0,e.jsx)("div",{ref:Ee})]})})}),(0,e.jsxs)("div",{className:"border-t border-gray-200 bg-white  px-4 py-2 relative",children:[(0,e.jsxs)("div",{className:"flex items-center p-[8px] gap-[10px] box-border border bg-white rounded-[8px]",children:[(0,e.jsx)("div",{className:"flex-1",children:(0,e.jsx)(Fe.Z,{name:"content",placeholder:M.formatMessage({id:"agent.chat.input.placeholder"}),fieldProps:{autoSize:{minRows:1,maxRows:4},variant:"borderless",onPressEnter:function(i){if(!i.shiftKey){var a;i.preventDefault(),(a=U.current)===null||a===void 0||a.submit()}},size:"small",className:"",title:M.formatMessage({id:"agent.chat.input.shift.enter"})},formItemProps:{className:"mb-0"},className:"mb-0"})}),(0,e.jsx)(d.ZP,{onClick:function(){var i;return(i=U.current)===null||i===void 0?void 0:i.submit()},type:"primary",className:"min-w-[30px] h-[30px] flex items-center justify-center cursor-pointer rounded-[6px]",icon:(0,e.jsx)($e.Z,{}),title:M.formatMessage({id:"agent.chat.send"})})]}),(0,e.jsxs)("div",{className:"flex items-center mt-1 gap-2",children:[(0,e.jsx)(Ae.Z,{name:"ability_id",options:(T=t.data)===null||T===void 0?void 0:T.abilitiesList,fieldProps:{placeholder:M.formatMessage({id:"agent.pleaseselect"}),size:"small"},formItemProps:{className:"mb-0"}}),(0,e.jsx)(d.ZP,{icon:(0,e.jsx)(l.Z,{}),loading:Se,onClick:W,size:"small",children:M.formatMessage({id:"agent.chat.clear.memory"})})]})]})]})]})})})},43822:function(Ue,Le,r){r.d(Le,{ZP:function(){return De}});var Pe=r(5574),x=r.n(Pe),Te=r(15009),Z=r.n(Te),Ze=r(99289),G=r.n(Ze),xe=r(11551),ye=r(29608),Ie=r(32592),P=r(35312),I=r(67294),c=r(28508),ee=r(29933),ae=r(3917),e=r(66309),Ce=r(28036),ne=r(71471),Re=r(74330),A=r(26412),je=r(12845),$e=r(39873),l=r(85893),ke=(0,I.memo)(function(C){var z,d=C.data,V=C.onClose,S=(0,P.useIntl)(),K=(0,I.useState)(500),Y=x()(K,2),le=Y[0],te=Y[1],t=(0,ae.Z)(function(){var g=G()(Z()().mark(function h(w,N){var $;return Z()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,(0,xe.pC)(w,N);case 2:return $=m.sent,m.abrupt("return",$.data);case 4:case"end":return m.stop()}},h)}));return function(h,w){return g.apply(this,arguments)}}(),{manual:!0}),s=t.data,u=t.loading,y=t.run;(0,I.useEffect)(function(){d!=null&&d.app_id&&d!==null&&d!==void 0&&d.app_run_id&&y(d.app_id,d.app_run_id)},[d==null?void 0:d.app_id,d==null?void 0:d.app_run_id,y]);var T=function(h){var w={1:{color:"processing",text:S.formatMessage({id:"workflow.running"})},2:{color:"success",text:S.formatMessage({id:"workflow.runSc"})},3:{color:"error",text:S.formatMessage({id:"workflow.runF"})}},N=w[h]||{color:"default",text:"Unknown"};return(0,l.jsx)(e.Z,{color:N.color,children:N.text})},R=function(h){te(h)};return(0,l.jsx)($e.Z,{className:"fixed top-[65px] right-2 p-0",dragDirection:"left",minWidth:400,maxWidth:800,defaultWidth:le,onChange:R,children:(0,l.jsx)(ee.Z,{className:"border-none h-full",style:{height:"calc(100vh - 10px - 60px)"},bodyStyle:{overflowY:"auto",padding:"16px"},extra:(0,l.jsx)(Ce.ZP,{type:"text",className:"-mr-4 -mt-8",onClick:V,icon:(0,l.jsx)(c.Z,{})}),title:(0,l.jsx)(ne.Z.Title,{level:5,children:S.formatMessage({id:"agent.log.detail"})}),loading:u,children:(0,l.jsx)("div",{className:"space-y-6",children:u?(0,l.jsx)("div",{className:"flex items-center justify-center h-40",children:(0,l.jsx)(Re.Z,{})}):s?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(A.Z,{column:1,bordered:!0,size:"small",children:[(0,l.jsx)(A.Z.Item,{label:S.formatMessage({id:"workflow.user"}),children:s.nickname}),(0,l.jsx)(A.Z.Item,{label:S.formatMessage({id:"workflow.status"}),children:T(s.status)}),(0,l.jsx)(A.Z.Item,{label:S.formatMessage({id:"workflow.created_time"}),children:s.created_time}),(0,l.jsxs)(A.Z.Item,{label:S.formatMessage({id:"workflow.elapsed_time"}),children:[s.elapsed_time,"s"]}),(0,l.jsx)(A.Z.Item,{label:"Tokens",children:s.total_tokens})]}),(0,l.jsxs)("div",{className:"mt-4",children:[(0,l.jsx)(ne.Z.Title,{level:5,children:S.formatMessage({id:"agent.log.output"})}),s.outputs?(0,l.jsx)("div",{className:"bg-gray-50 p-4 rounded mt-2",children:(0,l.jsx)("pre",{className:"whitespace-pre-wrap text-sm",children:((z=s.outputs)===null||z===void 0?void 0:z.value)||""})}):s.error?(0,l.jsxs)("div",{className:"bg-gray-50 p-4 rounded mt-2 border-l-4 border-red-500",children:[(0,l.jsx)("div",{className:"text-red-500 font-medium mb-2",children:S.formatMessage({id:"agent.log.error"})}),(0,l.jsx)("pre",{className:"whitespace-pre-wrap text-sm text-red-500",children:s.error})]}):(0,l.jsx)("div",{className:"bg-gray-50 p-4 rounded mt-2",children:(0,l.jsx)("div",{className:"text-sm text-gray-500",children:S.formatMessage({id:"agent.log.no.output"})})})]}),Array.isArray(s==null?void 0:s.prompt_data)&&s.prompt_data.length>0&&(0,l.jsxs)("div",{className:"mt-4",children:[(0,l.jsx)(ne.Z.Title,{level:5,children:S.formatMessage({id:"agent.log.conversation"})}),(0,l.jsx)(je.Z,{className:"mt-2",children:s.prompt_data.map(function(g,h){var w=x()(g,2),N=w[0],$=w[1];return(0,l.jsx)(je.Z.Item,{color:N==="human"?"blue":"green",children:(0,l.jsxs)("div",{className:"bg-gray-50 p-3 rounded",children:[(0,l.jsx)("div",{className:"text-xs text-gray-500 mb-1",children:N}),(0,l.jsx)("div",{className:"text-sm whitespace-pre-wrap",children:$.value})]})},h)})})]})]}):null})})})}),Fe=null,Ae=null,De=function(C){var z=C.agent_id,d=(0,P.useIntl)(),V=(0,P.useSearchParams)(),S=x()(V,1),K=S[0],Y=(0,I.useRef)(null),le=(0,I.useState)(null),te=x()(le,2),t=te[0],s=te[1],u=(0,I.useState)(!1),y=x()(u,2),T=y[0],R=y[1],g=K.get("app_id"),h=function(){R(!1)},w=function(m){s({app_id:g,app_run_id:m.id}),R(!0)},N=[{dataIndex:"index",valueType:"indexBorder",width:48},{disable:!0,title:d.formatMessage({id:"workflow.status",defaultMessage:""}),dataIndex:"status",ellipsis:!0,search:!1,valueEnum:{1:{text:d.formatMessage({id:"workflow.running",defaultMessage:""}),status:"Processing"},2:{text:d.formatMessage({id:"workflow.runSc",defaultMessage:""}),status:"Success"},3:{text:d.formatMessage({id:"workflow.runF",defaultMessage:""}),status:"Error"}}},{title:d.formatMessage({id:"workflow.created_time",defaultMessage:""}),dataIndex:"created_time",ellipsis:!0,tooltip:d.formatMessage({id:"workflow.created_time_des",defaultMessage:d.formatMessage({id:"workflow.created_time_des",defaultMessage:""})}),search:!1},{title:"".concat(d.formatMessage({id:"workflow.elapsed_time",defaultMessage:""}),"S"),dataIndex:"elapsed_time",ellipsis:!0,tooltip:d.formatMessage({id:"workflow.run_time"}),search:!1},{title:"Tokens",key:"showTime",dataIndex:"total_tokens",hideInSearch:!0},{title:d.formatMessage({id:"workflow.user"}),dataIndex:"nickname",search:!1,ellipsis:!0,key:"user"}],$=(0,ye.Z)(function(k){return k.setRunPanelLogRecord});return(0,l.jsxs)("div",{className:"h-full",children:[(0,l.jsx)(Ie.Z,{columns:N,formRef:Y,form:{submitter:!1},cardBordered:!0,style:{height:"calc(100% - 20px)"},scroll:{y:"calc(100vh - 230px)"},request:function(){var k=G()(Z()().mark(function m(E,J,re){var O;return Z()().wrap(function(F){for(;;)switch(F.prev=F.next){case 0:return console.log(E,J,re),F.next=3,(0,xe.My)(g,{page:E.current,page_size:E.pageSize});case 3:return O=F.sent,console.log(O),F.abrupt("return",{data:O.data.list,success:!0,total:O.data.total_count});case 6:case"end":return F.stop()}},m)}));return function(m,E,J){return k.apply(this,arguments)}}(),onRow:function(m){return{onClick:function(){w(m)},className:(t==null?void 0:t.app_run_id)===m.id?"bg-blue-50":""}},editable:{type:"multiple"},rowKey:"app_runs_id",search:!1,options:{search:!1,setting:{listsHeight:600}},pagination:{pageSize:20,showSizeChanger:!1},dateFormatter:"string",headerTitle:d.formatMessage({id:"agent.log.list"})}),T&&(t==null?void 0:t.app_id)&&(t==null?void 0:t.app_run_id)&&(0,l.jsx)(ke,{data:t,onClose:h})]})}}}]);
