"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[951],{11551:function(le,L,i){i.d(L,{CU:function(){return F},CY:function(){return $},Ce:function(){return D},Dh:function(){return p},Iw:function(){return H},LH:function(){return k},My:function(){return Y},Nj:function(){return z},XB:function(){return d},ek:function(){return v},pC:function(){return B},zl:function(){return V}});var x=i(15009),l=i.n(x),R=i(99289),_=i.n(R),m=i(47520),M="/v1/agent/agent_info/",S="/v1/vector/dataset_list/2",K="/v1/agent/agent_base_update/",W="/v1/agent/agent_abilities_set/",G="/v1/agent/agent_output_set/",N="/v1/agent/agent_engine_set/",Z="/v1/agent/agent_publish/",j="/v1/agent/agent_run",v=function(){var o=_()(l()().mark(function s(a,r){var n;return l()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,m.ZP)("".concat(M).concat(a),{method:"GET",data:{publish_status:r=="true"?1:0}});case 2:return n=t.sent,t.abrupt("return",n);case 4:case"end":return t.stop()}},s)}));return function(a,r){return o.apply(this,arguments)}}(),V=function(){var o=_()(l()().mark(function s(){var a;return l()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,m.ZP)("".concat(S),{method:"GET"});case 2:return a=n.sent,n.abrupt("return",a);case 4:case"end":return n.stop()}},s)}));return function(){return o.apply(this,arguments)}}(),d=function(){var o=_()(l()().mark(function s(a){var r;return l()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,m.ZP)("".concat(K).concat(a.agent_id),{method:"PUT",data:a.data});case 2:return r=e.sent,e.abrupt("return",r);case 4:case"end":return e.stop()}},s)}));return function(a){return o.apply(this,arguments)}}(),H=function(){var o=_()(l()().mark(function s(a){var r;return l()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,m.ZP)("".concat(W).concat(a.agent_id),{method:"PUT",data:a.data});case 2:return r=e.sent,e.abrupt("return",r);case 4:case"end":return e.stop()}},s)}));return function(a){return o.apply(this,arguments)}}(),D=function(){var o=_()(l()().mark(function s(a){var r;return l()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,m.ZP)("".concat(G).concat(a.agent_id),{method:"PUT",data:a});case 2:return r=e.sent,e.abrupt("return",r);case 4:case"end":return e.stop()}},s)}));return function(a){return o.apply(this,arguments)}}(),U=null,p=function(){var o=_()(l()().mark(function s(a){var r;return l()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,m.ZP)("".concat(Z).concat(a),{method:"PUT"});case 2:return r=e.sent,e.abrupt("return",r);case 4:case"end":return e.stop()}},s)}));return function(a){return o.apply(this,arguments)}}(),k=function(){var o=_()(l()().mark(function s(a){var r;return l()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,m.ZP)("".concat(j),{method:"POST",data:a});case 2:return r=e.sent,e.abrupt("return",r);case 4:case"end":return e.stop()}},s)}));return function(a){return o.apply(this,arguments)}}(),$=function(){var o=_()(l()().mark(function s(a){var r;return l()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,m.ZP)("/v1/agent/agent_chat_message",{method:"POST",data:a});case 2:return r=e.sent,e.abrupt("return",r);case 4:case"end":return e.stop()}},s)}));return function(a){return o.apply(this,arguments)}}(),F=function(){var o=_()(l()().mark(function s(a,r){var n;return l()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,m.ZP)("/v1/agent/".concat(a,"/agent_message_list"),{method:"GET",data:{page:r,page_size:20}});case 2:return n=t.sent,t.abrupt("return",n);case 4:case"end":return t.stop()}},s)}));return function(a,r){return o.apply(this,arguments)}}(),Y=function(){var o=_()(l()().mark(function s(a,r){var n;return l()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,m.ZP)("/v1/agent/".concat(a,"/agent_log_list"),{method:"GET",data:r});case 2:return n=t.sent,t.abrupt("return",n);case 4:case"end":return t.stop()}},s)}));return function(a,r){return o.apply(this,arguments)}}(),B=function(){var o=_()(l()().mark(function s(a,r){var n;return l()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,m.ZP)("/v1/agent/".concat(a,"/agent_log_details"),{method:"GET",data:{app_run_id:r}});case 2:return n=t.sent,t.abrupt("return",n);case 4:case"end":return t.stop()}},s)}));return function(a,r){return o.apply(this,arguments)}}(),z=function(){var o=_()(l()().mark(function s(a,r){var n;return l()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,m.ZP)("/v1/agent/".concat(a,"/clear_agent_chat_memory"),{method:"POST",data:{message_id:r,agent_id:a}});case 2:return n=t.sent,t.abrupt("return",n);case 4:case"end":return t.stop()}},s)}));return function(a,r){return o.apply(this,arguments)}}()},85877:function(le,L,i){var x=i(19632),l=i.n(x),R=i(97857),_=i.n(R),m=i(5574),M=i.n(m),S=i(52677),K=i.n(S),W=i(35312),G=i(78234),N=i(77598),Z=i(96486),j=i.n(Z),v=i(67294),V=i(73935),d=i(43413),H=i(92858),D=i(16845),U=i(15425),p=i(85893),k=function(n){var e=n.children;return(typeof document=="undefined"?"undefined":K()(document))==="object"?V.createPortal(e,document.body):null},$=typeof navigator!="undefined"&&/Mac OS X/.test(navigator.userAgent),F=function(n){var e=n.value,t=n.onChange,b=n.id,h=n.placeholder,E=n.options,A=(0,W.useIntl)(),q=(0,v.useRef)(),_e=(0,v.useState)(),ee=M()(_e,2),O=ee[0],T=ee[1],oe=(0,v.useState)(0),ne=M()(oe,2),I=ne[0],X=ne[1],ce=(0,v.useState)(""),te=M()(ce,2),de=te[0],pe=te[1],fe=(0,v.useCallback)(function(u){return(0,p.jsx)(o,_()({},u))},[]),ve=(0,v.useCallback)(function(u){return(0,p.jsx)(z,_()({},u))},[]),f=(0,v.useMemo)(function(){return Y((0,D.BU)((0,H.VC)((0,d.Jh)())))},[]),ge=(0,v.useState)(null),ae=M()(ge,2),me=ae[0],he=ae[1],Oe=(0,U.Z)(function(u){return u.selectedNode}),Ie=(0,U.Z)(function(u){return u.getOutputVariables}),Te=(0,U.Z)(function(u){return u.getInputVariables}),be=(0,v.useState)([]),re=M()(be,2),P=re[0],se=re[1];(0,G.Z)(function(){e&&e.length>0&&J(e),E!=null&&E.length&&se(E.map(function(u){return _()(_()({},u),{},{name:u.label,id:u.value})}))}),(0,N.Z)(function(){var u=j().isEqual(me,e);u||(e&&e.length>0?J(e):e&&j().isArray(e)&&e.length==0&&J([{type:"paragraph",children:[]}]))},[e,b]),(0,N.Z)(function(){E.length&&se(E.map(function(u){return _()(_()({},u),{},{name:u.label,id:u.value})})),console.log(E)},[E]);var J=function(c){he(c),ue(f,{nodes:[{type:"paragraph",children:[]}]}),ue(f,{nodes:c})},Ee=(0,v.useCallback)(function(u){if(O&&P.length>0)switch(u.key){case"ArrowDown":u.preventDefault();var c=I>=P.length-1?0:I+1;X(c);return;case"ArrowUp":u.preventDefault();var g=I<=0?P.length-1:I-1;X(g);return;case"Tab":case"Enter":u.preventDefault(),d.YR.select(f,O),B(f,P[I]),T(null);return;case"Escape":u.preventDefault(),T(null);return}else if(u.key==="@"){setTimeout(function(){return Pe()},10);return}T(null)},[P,f,I,O]),ue=function(c){var g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},Q=l()(c.children);if(Q.forEach(function(y){return c.apply({type:"remove_node",path:[0],node:y})}),g.nodes){var w=d.NB.isNode(g.nodes)?[g.nodes]:g.nodes;w.forEach(function(y,ie){return c.apply({type:"insert_node",path:[ie],node:y})})}var C=g.at&&d.E9.isPoint(g.at)?g.at:d.ML.end(c,[]);C&&d.YR.select(c,C)};(0,v.useEffect)(function(){if(O&&P.length>0){var u=q.current,c=D.F3.toDOMRange(f,O),g=c.getBoundingClientRect();u.style.top="".concat(g.top+window.pageYOffset+24,"px"),u.style.left="".concat(g.left+window.pageXOffset,"px")}},[P.length,f,I,de,O]);var Pe=function(){var c=f.selection;if(c&&d.e6.isCollapsed(c)){var g=d.e6.edges(c),Q=M()(g,1),w=Q[0],C=d.ML.before(f,w),y=C&&d.ML.range(f,C,w),ie=y&&d.ML.string(f,y),Me=d.ML.after(f,w),De=d.ML.range(f,w,Me),ye=d.ML.string(f,De);T(y),pe(""),X(0);return}T(null)};return(0,p.jsxs)(D.mH,{editor:f,initialValue:a,onChange:function(c){t==null||t(c),T(null)},children:[(0,p.jsx)(D.CX,{renderElement:fe,renderLeaf:ve,onKeyDown:Ee,className:"!outline-none",placeholder:h!=null?h:A.formatMessage({id:"workflow.placeholder.enterContent",defaultMessage:"\uFF0C@"})}),O&&(0,p.jsx)(k,{children:(0,p.jsx)("div",{ref:q,style:{top:"-9999px",left:"-9999px",position:"absolute",zIndex:10,padding:"3px",background:"white",borderRadius:"4px",boxShadow:"0 1px 5px rgba(0,0,0,.2)"},className:"px-1 pt-1 z-10","data-cy":"mentions-portal",children:P.length?P.map(function(u,c){return(0,p.jsx)("div",{onClick:function(){console.log(u),d.YR.select(f,O),B(f,u),T(null)},className:"hover:bg-blue-100 text-sm mb-1",style:{padding:"1px 3px",borderRadius:"3px",cursor:"pointer",background:c===I?"#B4D5FF":""},children:(0,p.jsx)("span",{children:u.name})},u.name+c)}):(0,p.jsx)(p.Fragment,{children:A.formatMessage({id:"workflow.message.noVariablesFound",defaultMessage:""})})})})]})},Y=function(n){var e=n.isInline,t=n.isVoid,b=n.markableVoid;return n.isInline=function(h){return h.type==="mention"?!0:e(h)},n.isVoid=function(h){return h.type==="mention"?!0:t(h)},n.markableVoid=function(h){return h.type==="mention"||b(h)},n},B=function(n,e){var t={type:"mention",id:(e==null?void 0:e.id)||"",character:e.name,base:e,children:[{bold:!0,text:"11111"}]};d.YR.insertNodes(n,t),d.YR.move(n)},z=function(n){var e=n.attributes,t=n.children,b=n.leaf;return(0,p.jsx)("span",_()(_()({},e),{},{children:t}))},o=function(n){var e=n.attributes,t=n.children,b=n.element;switch(b.type){case"mention":return(0,p.jsx)(s,_()({},n));default:return(0,p.jsx)("p",_()(_()({},e),{},{children:t}))}},s=function(n){var e=n.attributes,t=n.children,b=n.element,h=(0,D.vt)(),E=(0,D.UE)(),A={padding:"3px 3px 2px",margin:"0 1px",verticalAlign:"baseline",display:"inline-block",borderRadius:"4px",backgroundColor:"#eee",fontSize:"0.9em",boxShadow:h&&E?"0 0 0 2px #B4D5FF":"none"};return b.children[0].bold&&(A.fontWeight="bold"),b.children[0].italic&&(A.fontStyle="italic"),(0,p.jsx)("span",_()(_()({},e),{},{className:"m-2",contentEditable:!1,"data-cy":"mention-".concat(b.character.replace(" ","-")),style:A,children:$?(0,p.jsxs)(v.Fragment,{children:["1",t,"/",b.character]}):(0,p.jsxs)(v.Fragment,{children:[(0,p.jsx)("span",{children:b.character}),t]})}))},a=[{type:"paragraph",children:[{text:""}]}];L.Z=F}}]);
