"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[979],{52700:function(Ue,ae,t){t.r(ae),t.d(ae,{default:function(){return De}});var pe=t(97857),s=t.n(pe),xe=t(15009),N=t.n(xe),ue=t(99289),$=t.n(ue),me=t(5574),j=t.n(me),k=t(43722),he=t(72406),se=t(32332),fe=t(82114),ge=t(3471),K=t(35312),P=t(15746),re=t(2453),ve=t(17788),je=t(83159),q=t(71230),ne=t(32983),Ne=t(74330),x=t(67294),ye=t(19632),Ce=t.n(ye),Se=t(28508),le=t(26915),O=t(40741),Me=t(37804),ie=t(28036),be=t(96486),Fe=t(92004),e=t(85893),we=le.Z.TextArea,Re=function(n){var l=(0,K.useIntl)(),Z=n.show,c=n.id,E=n.close,G=n.save,g=n.isUpdata,I=O.Z.useForm(),T=j()(I,1),F=T[0],y=(0,x.useRef)(!1),w=(0,K.useLocation)(),H=(0,x.useRef)(null),V=re.ZP.useMessage(),A=j()(V,2),L=A[0],S=A[1],v=(0,x.useState)({name:"",description:"",max_round:10,agent:[]}),C=j()(v,2),a=C[0],u=C[1],W=(0,x.useState)([]),z=j()(W,2),M=z[0],Y=z[1],R=(0,x.useRef)(!1),_=(0,be.throttle)(function(){var d=$()(N()().mark(function p(U){var h,b;return N()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!R.current){r.next=2;break}return r.abrupt("return");case 2:if(R.current=!0,h=M.map(function(ce){var Te=ce.agent_id,de=ce.active,ze=de===void 0?1:de;return{agent_id:Te,active:ze}}),a.name){r.next=7;break}return R.current=!1,r.abrupt("return");case 7:if(h.length!=0){r.next=11;break}return R.current=!1,L.open({type:"error",content:l.formatMessage({id:"app.create_chatroom.label_4_tips"})}),r.abrupt("return");case 11:if(u(s()(s()({},a),{},{agent:h})),L.open({key:"create",type:"loading",content:"Loading..."}),y.current){r.next=19;break}return r.next=16,(0,k.dB)(s()(s()({},a),{},{agent:h}));case 16:r.t0=r.sent,r.next=22;break;case 19:return r.next=21,(0,k.sI)(s()(s()({},a),{},{agent:h}),c);case 21:r.t0=r.sent;case 22:b=r.t0,b.code==0&&(L.open({key:"create",type:"success",content:y.current?l.formatMessage({id:"app.edit_chatroom.succeed"}):l.formatMessage({id:"app.create_chatroom.succeed"}),duration:2}),G(!0),te()),R.current=!1;case 25:case"end":return r.stop()}},p)}));return function(p){return d.apply(this,arguments)}}(),300),ee=(0,x.useState)(!1),X=j()(ee,2),o=X[0],m=X[1],f=function(p){var U={};return p.slice(1).split("&").forEach(function(h){var b=h.split("=");U[b[0]]=b[1]}),U},i=function(){var d=$()(N()().mark(function p(U){var h,b;return N()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,(0,k.cH)({id:U});case 2:h=r.sent,h.code==0&&(b=h.data.chat_info,u(s()(s()({},a),{},{name:b.name,description:b.description,max_round:h.data.max_round?h.data.max_round:10,agent:h.data.agent_list})),Y(h.data.agent_list));case 4:case"end":return r.stop()}},p)}));return function(U){return d.apply(this,arguments)}}(),J=function(){m(!0)},oe=function(){m(!1)},B=function(p){Y(Ce()(p.checkAgent))},D=function(){y.current=!1,g&&c!=0&&(y.current=!0,i(c))},te=function(){F.setFieldsValue({Title:"",Description:"",MaxRound:10}),u(s()(s()({},a),{},{name:"",description:"",max_round:10,agent:[]})),Y([]),R.current=!1,E()};return(0,x.useEffect)(function(){Z&&D()},[Z]),(0,x.useEffect)(function(){F.setFieldsValue({Title:a.name,Description:a.description,MaxRound:a.max_round})},[a,F]),(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)("div",{ref:H,className:"w-full h-full fixed top-[0] left-[0] bg-[rgba(0,0,0,0.5)] flex items-center justify-center z-20",children:[(0,e.jsxs)("div",{className:"w-[980px] h-[646px] bg-[#fff] rounded-[6px]",children:[S,(0,e.jsx)("div",{className:"w-full flex relative",style:{height:"100%"},children:(0,e.jsx)("div",{className:"w-full relative box-border flex-1",style:{height:"100%"},children:(0,e.jsx)(O.Z,{form:F,className:"h-full",initialValues:{Title:a.name,Description:a.description,MaxRound:a.max_round},children:(0,e.jsxs)("div",{className:"flex flex-col h-full",children:[(0,e.jsxs)("div",{className:"text-[16px] flex items-center p-[20px]",style:{borderBottom:"1px solid #ebebeb"},children:[(0,e.jsx)("span",{className:"flex-1 text-[14px] font-[500] text-[#213044]",children:y.current?l.formatMessage({id:"app.edit_chatroom.title"}):l.formatMessage({id:"app.create_chatroom.title"})}),(0,e.jsx)(Se.Z,{className:"text-[16px] cursor-pointer",onClick:te})]}),(0,e.jsx)("div",{className:"flex-1 min-h-[0] overflow-auto",children:(0,e.jsxs)("div",{className:"pt-[20px] px-[20px]",children:[(0,e.jsxs)("div",{className:"text-[12px] text-[#213044]",children:[(0,e.jsx)("span",{style:{color:"red",paddingRight:"4px"},children:"*"}),l.formatMessage({id:"app.create_chatroom.label_1"})]}),(0,e.jsx)("div",{className:"pt-[15px]",children:(0,e.jsx)(O.Z.Item,{name:"Title",rules:[{required:!0,message:l.formatMessage({id:"app.create_chatroom.label_1_tips"})}],style:{marginBottom:"0px"},children:(0,e.jsx)(le.Z,{placeholder:l.formatMessage({id:"app.create_chatroom.label_1_pl"}),maxLength:20,style:{height:40,background:"#F7F7F7"},className:"placeholder:text-[#bbb] placeholder:text-[12px] h-[40px] border-[#eee] text-[#213044]",onChange:function(p){u(s()(s()({},a),{},{name:p.target.value}))}})})}),(0,e.jsx)("div",{className:"text-[12px] text-[#213044] pt-[20px]",children:l.formatMessage({id:"app.create_chatroom.label_2"})}),(0,e.jsx)("div",{className:"pt-[10px]",children:(0,e.jsx)(O.Z.Item,{name:"Description",style:{marginBottom:"0px"},children:(0,e.jsx)(we,{showCount:!0,maxLength:100,placeholder:l.formatMessage({id:"app.create_chatroom.label_2_pl"}),value:a.description,style:{height:57,resize:"none",background:"#F7F7F7"},className:"placeholder:text-[#bbb] placeholder:text-[12px] h-[40px] border-[#eee] text-[#213044]",onChange:function(p){u(s()(s()({},a),{},{description:p.target.value}))}})})}),(0,e.jsxs)("div",{className:"text-[12px] text-[#213044] pt-[20px]",children:[(0,e.jsx)("span",{style:{color:"red",paddingRight:"4px"},children:"*"}),l.formatMessage({id:"app.create_chatroom.label_3"})]}),(0,e.jsx)("div",{className:"pt-[10px]",children:(0,e.jsx)(O.Z.Item,{name:"MaxRound",rules:[{required:!0,message:l.formatMessage({id:"app.create_chatroom.label_3_tips"})}],style:{marginBottom:"0px"},children:(0,e.jsx)(Me.Z,{min:10,step:1,max:100,size:"large",style:{background:"#F7F7F7"},className:"placeholder:text-[#bbb] placeholder:text-[12px]  border-[#eee] text-[#213044] w-full",onChange:function(p){u(s()(s()({},a),{},{max_round:p}))},formatter:function(p){return p!==void 0?Math.floor(p).toString():a.max_round.toString()}})})}),(0,e.jsxs)("div",{className:"text-[14px]  pt-[20px] flex",children:[(0,e.jsx)("span",{style:{color:"red",paddingRight:"4px"},children:"*"}),(0,e.jsx)("span",{className:"text-[12px] text-[#213044]",children:l.formatMessage({id:"app.create_chatroom.label_4"})})]}),(0,e.jsx)("div",{className:"pt-[15px] pb-[20px] overflow-hidden w-full",children:(0,e.jsxs)(q.Z,{gutter:[15,15],children:[(0,e.jsx)(P.Z,{span:6,children:(0,e.jsx)("div",{className:"text-[12px] text-[#BBBBBB] h-[62px] rounded-[4px] bg-[#F7F7F7] leading-[62px] text-center cursor-pointer",onClick:J,style:{border:"1px solid #EEEEEE"},children:l.formatMessage({id:"app.create_chatroom.add_button"})})}),M&&M.length?M.map(function(d){return(0,e.jsx)(P.Z,{span:6,children:(0,e.jsxs)("div",{className:"bg-[#fff] flex gap-x-[20px] p-[10px] cursor-pointer border-solid border-[1px] rounded-[4px] border-[#eee]",children:[(0,e.jsx)("div",{className:"w-[40px] h-[40px] bg-[#F4F8F1] rounded-[6px] relative flex items-center justify-center shrink-0",children:(0,e.jsx)("img",{src:(0,se.s9)("single",d.icon),alt:"",className:"w-[20px]  h-[20px]"})}),(0,e.jsxs)("div",{className:"flex flex-col gap-y-[5px] justify-center flex-1 min-w-[0]",children:[(0,e.jsx)("div",{className:"text-[#213044] text-[12px] font-[500] w-full truncate",children:d.name}),(0,e.jsx)("div",{className:"text-[#999] text-[12px] w-full truncate",children:d.description})]})]})},d.agent_id)}):(0,e.jsx)(e.Fragment,{})]})})]})}),(0,e.jsxs)("div",{className:"p-[20px] flex gap-x-[20px] justify-end",style:{borderTop:"1px solid #e8e8e8"},children:[(0,e.jsx)(ie.ZP,{className:"text-[14px] text-[#213044] w-[88px] h-[40px]",style:{border:"1px solid #D8D8D8"},onClick:te,children:l.formatMessage({id:"app.create_chatroom.cancel"})}),(0,e.jsx)(ie.ZP,{type:"primary",className:"bg-[#1B64F3] rounded-[4px] w-[88px] h-[40px]",htmlType:"submit",onClick:_,children:l.formatMessage({id:"app.create_chatroom.save"})})]})]})})})})]}),o?(0,e.jsx)(Fe.Z,{show:o,popupClose:oe,popupSave:B,checkList:M}):(0,e.jsx)(e.Fragment,{})]})})},Ze=Re,Ee=function(n){return(0,e.jsx)(P.Z,{className:"gutter-row",xs:24,sm:24,md:12,lg:8,xl:6,children:(0,e.jsxs)("div",{className:"h-[236px] rounded-[8px] bg-[#EFF0F2] flex flex-col items-center justify-center gap-y-[10px] cursor-pointer",style:{border:"1px solid #E9E9E9"},onClick:function(){n.setCreateShow(!0),n.isUpdataChatRoom.current=!1,n.upDataId.current=0},children:[(0,e.jsx)("img",{src:"/icons/plaza_m2_c2.svg",className:"w-[42px] h-[42px]",alt:""}),(0,e.jsx)("span",{className:"text-[#213044] text-[12px]",children:n.intl.formatMessage({id:"app.chatroom_list.create"})})]})})},Ae=function(n){var l=n.item,Z=n.resetList,c=n.setCreateShow,E=n.isUpdataChatRoom,G=n.upDataId,g=n.intl,I=re.ZP.useMessage(),T=j()(I,2),F=T[0],y=T[1],w=ve.Z.confirm,H=function(){w({title:g.formatMessage({id:"app.chatroom.del.title"}),icon:(0,e.jsx)(fe.Z,{}),content:g.formatMessage({id:"app.chatroom.del.tips"}),okText:g.formatMessage({id:"app.chatroom.del.confirm"}),okType:"danger",cancelText:g.formatMessage({id:"app.chatroom.del.cancel"}),onOk:function(){V()}})},V=function(){var S=$()(N()().mark(function v(){var C;return N()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,(0,k.Gn)({id:l.chatroom_id});case 2:C=u.sent,C.code==0&&(F.open({key:"del",type:"success",content:g.formatMessage({id:"app.chatroom.del.delsuccess"}),duration:10}),Z(l.chatroom_id));case 4:case"end":return u.stop()}},v)}));return function(){return S.apply(this,arguments)}}(),A=function(){var S=$()(N()().mark(function v(){return N()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:c(!0),E.current=!0,G.current=l.chatroom_id;case 3:case"end":return a.stop()}},v)}));return function(){return S.apply(this,arguments)}}(),L=[{key:"1",label:(0,e.jsx)("div",{className:"py-[3px] px-[3px]",children:(0,e.jsxs)("div",{className:"flex gap-x-[5px] text-[12px] text-[#213044] items-center p-y-[8]",onClick:A,children:[(0,e.jsx)("img",{src:"/icons/edit_icon.svg",className:"w-[16px] h-[16px]"}),(0,e.jsx)("span",{children:g.formatMessage({id:"app.chatroom_list.fun_button_1"})})]})})},{key:"2",label:(0,e.jsx)("div",{className:"py-[3px] px-[3px]",children:(0,e.jsxs)("div",{className:"flex gap-x-[5px] text-[12px] text-[#E12222] items-center",onClick:H,children:[(0,e.jsx)("img",{src:"/icons/delete_icon.svg",className:"w-[16px] h-[16px]"}),(0,e.jsx)("span",{children:g.formatMessage({id:"app.chatroom_list.fun_button_2"})})]})})}];return(0,e.jsxs)(e.Fragment,{children:[y,(0,e.jsxs)("div",{className:"flex  items-center",children:[(0,e.jsx)("div",{className:"flex gap-x-[6px] items-center flex-1"}),(0,e.jsx)(je.Z,{menu:{items:L},placement:"topRight",className:"cursor-pointer",children:(0,e.jsx)("div",{className:"w-[18px] h-[18px] bg-[#ebebeb] rounded-[4px] flex justify-center items-center",children:(0,e.jsx)(ge.Z,{className:"hover:text-[#1B64F3]",style:{fontSize:"14px"}})})})]})]})},Le=function(){var n=(0,K.useIntl)(),l=(0,x.useState)(null),Z=j()(l,2),c=Z[0],E=Z[1],G=(0,x.useState)(!1),g=j()(G,2),I=g[0],T=g[1],F=(0,x.useState)({page:1,page_size:20,name:""}),y=j()(F,2),w=y[0],H=y[1],V=(0,x.useState)(!0),A=j()(V,2),L=A[0],S=A[1],v=(0,x.useRef)(!1),C=(0,x.useRef)(0),a=(0,x.useState)(!1),u=j()(a,2),W=u[0],z=u[1],M=function(){var o=$()(N()().mark(function m(){var f,i,J=arguments;return N()().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:return f=J.length>0&&J[0]!==void 0?J[0]:!1,B.next=3,(0,k.vu)(w);case 3:i=B.sent,f&&T(!0),i.code==0&&(S(i.data.total_pages>w.page),i.data.total_pages>=w.page&&!f&&(i.data.list=c.list.concat(i.data.list)),i.data.list&&i.data.list.length&&i.data.list.forEach(function(D){D.agent_list&&D.agent_list.length&&(D.agent_list.length=D.agent_list.length>6?6:D.agent_list.length)}),E(i.data));case 6:case"end":return B.stop()}},m)}));return function(){return o.apply(this,arguments)}}();(0,x.useEffect)(function(){M(!0),S(!0)},[]);var Y=function(m){H(function(f){return s()(s()({},f),{},{page:w.page++})}),M()},R=function(m){var f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0;c&&c.list.length&&(f!=null?E(s()(s()({},c),{},{list:c.list.map(function(i){return s()(s()({},i),{},{smart_selection:i.chatroom_id===m?f:i.smart_selection})})})):E(s()(s()({},c),{},{list:c.list.filter(function(i){return i.chatroom_id!==m})})))},_=function(m){K.history.push("/chat_room/".concat(m.chatroom_id))},ee=function(){z(!1)},X=function(m){m&&M(!0)};return(0,e.jsx)("div",{className:"pt-0 w-full",id:"Meeting",style:{height:"calc(100vh - 94px)",overflowY:"auto"},children:(0,e.jsx)(he.Z,{dataLength:c&&c.list.length,elid:"Meeting",ishasMore:L,upSlide:Y,isFooter:!0,pageNumber:w.page,children:(0,e.jsx)("div",{className:"px-[30px] pt-[30px]",children:(0,e.jsxs)(q.Z,{gutter:[20,20],style:{margin:0},children:[I&&(0,e.jsx)(Ee,{setCreateShow:z,isUpdataChatRoom:v,intl:n,upDataId:C}),c&&c.list.length?c.list.map(function(o,m){return(0,e.jsx)(P.Z,{className:"gutter-row",xs:24,sm:24,md:12,lg:8,xl:6,xxl:6,children:(0,e.jsx)("div",{className:"relative h-[236px] rounded-[8px] cursor-pointer shadow-lg shadow-gray-100 hover:shadow-gray-200",onClick:function(){_(o)},children:(0,e.jsxs)("div",{className:"bg-[#fff] rounded-[8px] h-full",style:{boxShadow:"0px 2px 4px 0px rgba(0,0,0,0.05)"},children:[(0,e.jsxs)("div",{className:"flex pt-[20px] pb-[15px] px-[20px] text-[#213044] text-[14px] font-[500] gap-x-[6px]",children:[(0,e.jsx)("span",{className:"flex-1 min-w-[0px] truncate",children:o.name}),(0,e.jsxs)("div",{className:"flex gap-x-[5px] items-center",children:[(0,e.jsx)("img",{src:"".concat(o.active==0?"/icons/plaza_m2_c2.svg":"/icons/plaza_m2_c1.svg"),className:"w-[14px] h-[14px]"}),(0,e.jsx)("span",{className:"text-[12px]",children:o.active==0?(0,e.jsx)("span",{className:"text-[#aaa]",children:n.formatMessage({id:"app.chatroom_list.status"})}):(0,e.jsx)("span",{className:"text-[#1B64F3]",children:n.formatMessage({id:"app.chatroom_list.status_succeed"})})})]})]}),(0,e.jsxs)("div",{children:[(0,e.jsx)("div",{className:"px-[20px]",children:(0,e.jsxs)("div",{style:{borderBottom:"1px solid #eee"},children:[(0,e.jsx)("div",{className:"text-[#666666] text-[12px] font-[400] w-full truncate min-h-[14px]",children:o.description?o.description:(0,e.jsx)(e.Fragment,{})}),(0,e.jsx)("div",{className:"py-[20px] h-[115px] overflow-hidden",children:o.agent_list&&o.agent_list.length?(0,e.jsx)(q.Z,{gutter:[20,18],children:o.agent_list.map(function(f,i){return(0,e.jsx)(P.Z,{md:12,lg:12,xl:12,xxl:8,children:(0,e.jsxs)("div",{className:"flex gap-x-[10px] items-center",children:[(0,e.jsx)("div",{className:"w-[30px] h-[30px] shrink-0 flex items-center rounded-[6px] justify-center bg-[#F4F8F1]",children:(0,e.jsx)("img",{src:(0,se.s9)("single",f.icon),alt:"",className:"w-[18px]  h-[18px]"})}),(0,e.jsx)("div",{className:"text-[#666] text-[12px] truncate",children:f.name})]})},i)})}):(0,e.jsx)(ne.Z,{style:{margin:"0px",fontSize:"12px"},imageStyle:{width:"60px",margin:"0 auto",marginBottom:"2px"},description:n.formatMessage({id:"app.dashboard.None"}),image:ne.Z.PRESENTED_IMAGE_SIMPLE})})]})}),(0,e.jsx)("div",{className:"pt-[15px] pb-[16px] px-[20px]",onClick:function(i){return i.stopPropagation(),!1},children:(0,e.jsx)(Ae,{item:o,resetList:R,setCreateShow:z,isUpdataChatRoom:v,upDataId:C,intl:n})})]})]})})},m)}):(0,e.jsx)(e.Fragment,{children:!I&&(0,e.jsx)("div",{className:"w-full h-full flex items-center justify-center ",style:{height:"calc(100vh - 300px)"},children:(0,e.jsx)(Ne.Z,{size:"large"})})}),W?(0,e.jsx)(Ze,{show:W,id:C.current,close:ee,save:X,isUpdata:v.current}):(0,e.jsx)(e.Fragment,{})]})})})})},Be=function(){return(0,e.jsx)(e.Fragment,{children:(0,e.jsx)("div",{className:"w-full",children:(0,e.jsx)(Le,{})})})},De=Be}}]);
