(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[57],{77171:function(q,b,t){"use strict";t.d(b,{Z:function(){return F}});var g=t(1413),l=t(67294),D={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M862 465.3h-81c-4.6 0-9 2-12.1 5.5L550 723.1V160c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v563.1L255.1 470.8c-3-3.5-7.4-5.5-12.1-5.5h-81c-6.8 0-10.5 8.1-6 13.2L487.9 861a31.96 31.96 0 0048.3 0L868 478.5c4.5-5.2.8-13.2-6-13.2z"}}]},name:"arrow-down",theme:"outlined"},h=D,k=t(91146),o=function(a,R){return l.createElement(k.Z,(0,g.Z)((0,g.Z)({},a),{},{ref:R,icon:h}))},N=l.forwardRef(o),F=N},82826:function(q,b,t){"use strict";t.d(b,{Z:function(){return F}});var g=t(1413),l=t(67294),D={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M872 474H286.9l350.2-304c5.6-4.9 2.2-14-5.2-14h-88.5c-3.9 0-7.6 1.4-10.5 3.9L155 487.8a31.96 31.96 0 000 48.3L535.1 866c1.5 1.3 3.3 2 5.2 2h91.5c7.4 0 10.8-9.2 5.2-14L286.9 550H872c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8z"}}]},name:"arrow-left",theme:"outlined"},h=D,k=t(91146),o=function(a,R){return l.createElement(k.Z,(0,g.Z)((0,g.Z)({},a),{},{ref:R,icon:h}))},N=l.forwardRef(o),F=N},52645:function(q,b,t){"use strict";t.d(b,{Z:function(){return F}});var g=t(1413),l=t(67294),D={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M899.1 869.6l-53-305.6H864c14.4 0 26-11.6 26-26V346c0-14.4-11.6-26-26-26H618V138c0-14.4-11.6-26-26-26H432c-14.4 0-26 11.6-26 26v182H160c-14.4 0-26 11.6-26 26v192c0 14.4 11.6 26 26 26h17.9l-53 305.6a25.95 25.95 0 0025.6 30.4h723c1.5 0 3-.1 4.4-.4a25.88 25.88 0 0021.2-30zM204 390h272V182h72v208h272v104H204V390zm468 440V674c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v156H416V674c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v156H202.8l45.1-260H776l45.1 260H672z"}}]},name:"clear",theme:"outlined"},h=D,k=t(91146),o=function(a,R){return l.createElement(k.Z,(0,g.Z)((0,g.Z)({},a),{},{ref:R,icon:h}))},N=l.forwardRef(o),F=N},16596:function(q,b,t){"use strict";t.d(b,{Z:function(){return F}});var g=t(1413),l=t(67294),D={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M518.3 459a8 8 0 00-12.6 0l-112 141.7a7.98 7.98 0 006.3 12.9h73.9V856c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V613.7H624c6.7 0 10.4-7.7 6.3-12.9L518.3 459z"}},{tag:"path",attrs:{d:"M811.4 366.7C765.6 245.9 648.9 160 512.2 160S258.8 245.8 213 366.6C127.3 389.1 64 467.2 64 560c0 110.5 89.5 200 199.9 200H304c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8h-40.1c-33.7 0-65.4-13.4-89-37.7-23.5-24.2-36-56.8-34.9-90.6.9-26.4 9.9-51.2 26.2-72.1 16.7-21.3 40.1-36.8 66.1-43.7l37.9-9.9 13.9-36.6c8.6-22.8 20.6-44.1 35.7-63.4a245.6 245.6 0 0152.4-49.9c41.1-28.9 89.5-44.2 140-44.2s98.9 15.3 140 44.2c19.9 14 37.5 30.8 52.4 49.9 15.1 19.3 27.1 40.7 35.7 63.4l13.8 36.5 37.8 10C846.1 454.5 884 503.8 884 560c0 33.1-12.9 64.3-36.3 87.7a123.07 123.07 0 01-87.6 36.3H720c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h40.1C870.5 760 960 670.5 960 560c0-92.7-63.1-170.7-148.6-193.3z"}}]},name:"cloud-upload",theme:"outlined"},h=D,k=t(91146),o=function(a,R){return l.createElement(k.Z,(0,g.Z)((0,g.Z)({},a),{},{ref:R,icon:h}))},N=l.forwardRef(o),F=N},3471:function(q,b,t){"use strict";var g=t(1413),l=t(67294),D=t(29245),h=t(91146),k=function(F,le){return l.createElement(h.Z,(0,g.Z)((0,g.Z)({},F),{},{ref:le,icon:D.Z}))},o=l.forwardRef(k);b.Z=o},97175:function(q,b,t){"use strict";t.d(b,{Z:function(){return F}});var g=t(1413),l=t(67294),D={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M854.6 288.6L639.4 73.4c-6-6-14.1-9.4-22.6-9.4H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V311.3c0-8.5-3.4-16.7-9.4-22.7zM790.2 326H602V137.8L790.2 326zm1.8 562H232V136h302v216a42 42 0 0042 42h216v494zM514.1 580.1l-61.8-102.4c-2.2-3.6-6.1-5.8-10.3-5.8h-38.4c-2.3 0-4.5.6-6.4 1.9-5.6 3.5-7.3 10.9-3.7 16.6l82.3 130.4-83.4 132.8a12.04 12.04 0 0010.2 18.4h34.5c4.2 0 8-2.2 10.2-5.7L510 664.8l62.3 101.4c2.2 3.6 6.1 5.7 10.2 5.7H620c2.3 0 4.5-.7 6.5-1.9 5.6-3.6 7.2-11 3.6-16.6l-84-130.4 85.3-132.5a12.04 12.04 0 00-10.1-18.5h-35.7c-4.2 0-8.1 2.2-10.3 5.8l-61.2 102.3z"}}]},name:"file-excel",theme:"outlined"},h=D,k=t(91146),o=function(a,R){return l.createElement(k.Z,(0,g.Z)((0,g.Z)({},a),{},{ref:R,icon:h}))},N=l.forwardRef(o),F=N},45699:function(q,b,t){"use strict";t.d(b,{Z:function(){return F}});var g=t(1413),l=t(67294),D={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M553.1 509.1l-77.8 99.2-41.1-52.4a8 8 0 00-12.6 0l-99.8 127.2a7.98 7.98 0 006.3 12.9H696c6.7 0 10.4-7.7 6.3-12.9l-136.5-174a8.1 8.1 0 00-12.7 0zM360 442a40 40 0 1080 0 40 40 0 10-80 0zm494.6-153.4L639.4 73.4c-6-6-14.1-9.4-22.6-9.4H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V311.3c0-8.5-3.4-16.7-9.4-22.7zM790.2 326H602V137.8L790.2 326zm1.8 562H232V136h302v216a42 42 0 0042 42h216v494z"}}]},name:"file-image",theme:"outlined"},h=D,k=t(91146),o=function(a,R){return l.createElement(k.Z,(0,g.Z)((0,g.Z)({},a),{},{ref:R,icon:h}))},N=l.forwardRef(o),F=N},49354:function(q,b,t){"use strict";t.d(b,{Z:function(){return F}});var g=t(1413),l=t(67294),D={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M531.3 574.4l.3-1.4c5.8-23.9 13.1-53.7 7.4-80.7-3.8-21.3-19.5-29.6-32.9-30.2-15.8-.7-29.9 8.3-33.4 21.4-6.6 24-.7 56.8 10.1 98.6-13.6 32.4-35.3 79.5-51.2 107.5-29.6 15.3-69.3 38.9-75.2 68.7-1.2 5.5.2 12.5 3.5 18.8 3.7 7 9.6 12.4 16.5 15 3 1.1 6.6 2 10.8 2 17.6 0 46.1-14.2 84.1-79.4 5.8-1.9 11.8-3.9 17.6-5.9 27.2-9.2 55.4-18.8 80.9-23.1 28.2 15.1 60.3 24.8 82.1 24.8 21.6 0 30.1-12.8 33.3-20.5 5.6-13.5 2.9-30.5-6.2-39.6-13.2-13-45.3-16.4-95.3-10.2-24.6-15-40.7-35.4-52.4-65.8zM421.6 726.3c-13.9 20.2-24.4 30.3-30.1 34.7 6.7-12.3 19.8-25.3 30.1-34.7zm87.6-235.5c5.2 8.9 4.5 35.8.5 49.4-4.9-19.9-5.6-48.1-2.7-51.4.8.1 1.5.7 2.2 2zm-1.6 120.5c10.7 18.5 24.2 34.4 39.1 46.2-21.6 4.9-41.3 13-58.9 20.2-4.2 1.7-8.3 3.4-12.3 5 13.3-24.1 24.4-51.4 32.1-71.4zm155.6 65.5c.1.2.2.5-.4.9h-.2l-.2.3c-.8.5-9 5.3-44.3-8.6 40.6-1.9 45 7.3 45.1 7.4zm191.4-388.2L639.4 73.4c-6-6-14.1-9.4-22.6-9.4H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V311.3c0-8.5-3.4-16.7-9.4-22.7zM790.2 326H602V137.8L790.2 326zm1.8 562H232V136h302v216a42 42 0 0042 42h216v494z"}}]},name:"file-pdf",theme:"outlined"},h=D,k=t(91146),o=function(a,R){return l.createElement(k.Z,(0,g.Z)((0,g.Z)({},a),{},{ref:R,icon:h}))},N=l.forwardRef(o),F=N},4161:function(q,b,t){"use strict";t.d(b,{Z:function(){return F}});var g=t(1413),l=t(67294),D={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M854.6 288.6L639.4 73.4c-6-6-14.1-9.4-22.6-9.4H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V311.3c0-8.5-3.4-16.7-9.4-22.7zM790.2 326H602V137.8L790.2 326zm1.8 562H232V136h302v216a42 42 0 0042 42h216v494zM528.1 472h-32.2c-5.5 0-10.3 3.7-11.6 9.1L434.6 680l-46.1-198.7c-1.3-5.4-6.1-9.3-11.7-9.3h-35.4a12.02 12.02 0 00-11.6 15.1l74.2 276c1.4 5.2 6.2 8.9 11.6 8.9h32c5.4 0 10.2-3.6 11.6-8.9l52.8-197 52.8 197c1.4 5.2 6.2 8.9 11.6 8.9h31.8c5.4 0 10.2-3.6 11.6-8.9l74.4-276a12.04 12.04 0 00-11.6-15.1H647c-5.6 0-10.4 3.9-11.7 9.3l-45.8 199.1-49.8-199.3c-1.3-5.4-6.1-9.1-11.6-9.1z"}}]},name:"file-word",theme:"outlined"},h=D,k=t(91146),o=function(a,R){return l.createElement(k.Z,(0,g.Z)((0,g.Z)({},a),{},{ref:R,icon:h}))},N=l.forwardRef(o),F=N},41428:function(q,b,t){"use strict";t.d(b,{Z:function(){return F}});var g=t(1413),l=t(67294),D={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M312.1 591.5c3.1 3.1 8.2 3.1 11.3 0l101.8-101.8 86.1 86.2c3.1 3.1 8.2 3.1 11.3 0l226.3-226.5c3.1-3.1 3.1-8.2 0-11.3l-36.8-36.8a8.03 8.03 0 00-11.3 0L517 485.3l-86.1-86.2a8.03 8.03 0 00-11.3 0L275.3 543.4a8.03 8.03 0 000 11.3l36.8 36.8z"}},{tag:"path",attrs:{d:"M904 160H548V96c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v64H120c-17.7 0-32 14.3-32 32v520c0 17.7 14.3 32 32 32h356.4v32L311.6 884.1a7.92 7.92 0 00-2.3 11l30.3 47.2v.1c2.4 3.7 7.4 4.7 11.1 2.3L512 838.9l161.3 105.8c3.7 2.4 8.7 1.4 11.1-2.3v-.1l30.3-47.2a8 8 0 00-2.3-11L548 776.3V744h356c17.7 0 32-14.3 32-32V192c0-17.7-14.3-32-32-32zm-40 512H160V232h704v440z"}}]},name:"fund-projection-screen",theme:"outlined"},h=D,k=t(91146),o=function(a,R){return l.createElement(k.Z,(0,g.Z)((0,g.Z)({},a),{},{ref:R,icon:h}))},N=l.forwardRef(o),F=N},30159:function(q,b,t){"use strict";t.d(b,{Z:function(){return F}});var g=t(1413),l=t(67294),D={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372zm-88-532h-48c-4.4 0-8 3.6-8 8v304c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V360c0-4.4-3.6-8-8-8zm224 0h-48c-4.4 0-8 3.6-8 8v304c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V360c0-4.4-3.6-8-8-8z"}}]},name:"pause-circle",theme:"outlined"},h=D,k=t(91146),o=function(a,R){return l.createElement(k.Z,(0,g.Z)((0,g.Z)({},a),{},{ref:R,icon:h}))},N=l.forwardRef(o),F=N},88484:function(q,b,t){"use strict";t.d(b,{Z:function(){return F}});var g=t(1413),l=t(67294),D={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M400 317.7h73.9V656c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V317.7H624c6.7 0 10.4-7.7 6.3-12.9L518.3 163a8 8 0 00-12.6 0l-112 141.7c-4.1 5.3-.4 13 6.3 13zM878 626h-60c-4.4 0-8 3.6-8 8v154H214V634c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v198c0 17.7 14.3 32 32 32h684c17.7 0 32-14.3 32-32V634c0-4.4-3.6-8-8-8z"}}]},name:"upload",theme:"outlined"},h=D,k=t(91146),o=function(a,R){return l.createElement(k.Z,(0,g.Z)((0,g.Z)({},a),{},{ref:R,icon:h}))},N=l.forwardRef(o),F=N},88872:function(q,b,t){"use strict";t.r(b),t.d(b,{default:function(){return _t}});var g=t(15009),l=t.n(g),D=t(99289),h=t.n(D),k=t(5574),o=t.n(k),N=t(43722),F=t(32983),le=t(55026),a=t(67294),R=t(76772),Qe=t(19632),Re=t.n(Qe),Xe=t(97857),U=t.n(Xe),Be=t(80459),_e=t(82114),qe=t(82826),et=t(63783),tt=t(3471),at=t(45360),nt=t(85576),Ze=t(28036),rt=t(83062),Ve=t(72269),Ce=t(74330),st=t(96486),Te=t(44010),ve=t(39e3),e=t(85893),it=function(d){var f=(0,R.useIntl)(),I=d.roomDetail,$=d.setAgent,Z=at.ZP.useMessage(),u=o()(Z,2),H=u[0],z=u[1],B=(0,R.useParams)(),O=B.id,j=(0,ve.Z)(function(s){return s.disableInput}),K=(0,ve.Z)(function(s){return s.truncatable}),T=(0,ve.Z)(function(s){return s.setClearMemory}),J=(0,a.useState)([]),te=o()(J,2),Y=te[0],ae=te[1],P=(0,a.useState)(U()({},I)),A=o()(P,2),W=A[0],ne=A[1],re=(0,a.useState)([]),se=o()(re,2),G=se[0],E=se[1],Q=(0,a.useRef)(!1),pe=(0,a.useRef)(!1),me=(0,a.useState)(!1),ie=o()(me,2),X=ie[0],ce=ie[1],he=function(){var i=nt.Z.confirm;i({title:f.formatMessage({id:"app.chatroom.clear.title"}),icon:(0,e.jsx)(_e.Z,{}),content:f.formatMessage({id:"app.chatroom.clear.tips"}),okText:f.formatMessage({id:"app.chatroom.clear.confirm"}),okType:"danger",cancelText:f.formatMessage({id:"app.chatroom.clear.cancel"}),onOk:function(){T(["TRUNCATE","0"])}})},M=function(){var s=h()(l()().mark(function i(){var n;return l()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(!O){c.next=5;break}return c.next=3,(0,N.cH)({id:O});case 3:if(n=c.sent,n.code==0)try{ne(function(){return U()(U()({},n.data.chat_info),{},{max_round:n.data.max_round,smart_selection:n.data.smart_selection})}),ae(n.data.agent_list),Q.current=!0}catch(m){}case 5:case"end":return c.stop()}},i)}));return function(){return s.apply(this,arguments)}}(),de=function(){var s=h()(l()().mark(function i(){var n;return l()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,(0,N.j2)({id:O});case 2:n=c.sent,n.code==0&&(E(n.data.list),pe.current=!0);case 4:case"end":return c.stop()}},i)}));return function(){return s.apply(this,arguments)}}(),fe=function(){var s=h()(l()().mark(function i(n){var r,c,m;return l()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(!O){v.next=11;break}if(r=n.active==1?0:1,r!=0){v.next=7;break}if(c=Y.filter(function(S){return S.active==1}),c.length-1!=0){v.next=7;break}return H.open({type:"error",content:f.formatMessage({id:"app.chatroom.sidebar.agent_tips"}),duration:2}),v.abrupt("return",!1);case 7:return v.next=9,(0,N.sT)({active:r},O,n.agent_id);case 9:m=v.sent,m.code==0&&ae(function(S){return S.map(function(L){return U()(U()({},L),{},{active:L.agent_id==n.agent_id?r:L.active})})});case 11:case"end":return v.stop()}},i)}));return function(n){return s.apply(this,arguments)}}(),xe=function(i){return i.length>6?i.length=6:i.lenth,i},ge=function(i){i.type=="my_agent"?R.history.push("/Agents?app_id=".concat(i.app_id,"&type=false&from=chat_room")):R.history.push("/ReadOnlyAgent?app_id=".concat(i.app_id,"&type=true&from=chat_room"))},V=function(i){R.history.replace("/chat_room/".concat(i.chatroom_id)),window.location.reload()},y=function(){ce(!0)},w=function(){ce(!1)},C=function(){var s=h()(l()().mark(function i(n){var r,c,m;return l()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(!(n.checkItem&&n.checkItem.length==0)){v.next=3;break}return H.open({type:"error",content:f.formatMessage({id:"app.chatroom.content.addAgentTips_fail"}),duration:2}),v.abrupt("return");case 3:return r=Re()(n.checkItem).map(function(S){var L=S.agent_id,Se=S.active,_=Se===void 0?1:Se;return{agent_id:L,active:_}}),c={description:W.description,name:W.name,max_round:W.max_round},v.next=7,(0,N.sI)(U()(U()({},c),{},{agent:r}),O);case 7:m=v.sent,m.code==0?(n.checkItem.map(function(S){S.active=S.active==null?1:S.active}),ae(Re()(n.checkItem)),$.current=Re()(n.checkItem),H.open({type:"success",content:f.formatMessage({id:"app.chatroom.content.addAgentTips"}),duration:2})):H.open({type:"error",content:f.formatMessage({id:"app.chatroom.content.addAgentTips_fail"}),duration:2});case 9:case"end":return v.stop()}},i)}));return function(n){return s.apply(this,arguments)}}(),p=function(){var s=h()(l()().mark(function i(){var n;return l()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return n=W.smart_selection==1?0:1,c.next=3,(0,N.r5)({smart_selection:n},O);case 3:ne(function(m){return U()(U()({},m),{},{smart_selection:n})});case 4:case"end":return c.stop()}},i)}));return function(){return s.apply(this,arguments)}}();return(0,a.useEffect)(function(){M(),de()},[]),(0,e.jsxs)(e.Fragment,{children:[z,(0,e.jsxs)("div",{className:"h-full w-[320px] bg-[#fff] shrink-0",style:{boxShadow:"0px 2px 4px 0px rgba(0,0,0,0.1)"},id:"sider",children:[(0,e.jsxs)("div",{className:"flex flex-col  h-full",children:[(0,e.jsx)("div",{className:"w-full flex  justify-start px-[30px]",children:(0,e.jsxs)("div",{className:"py-[20px] text-[14px] text-[#213044] font-[500] flex gap-x-[10px] items-center w-full",children:[(0,e.jsxs)("div",{className:"cursor-pointer flex items-center shrink-0",onClick:function(){R.history.go(-1)},children:[(0,e.jsx)(Ze.ZP,{type:"link",danger:!0,className:"p-0",children:(0,e.jsx)(qe.Z,{className:"text-[#1B64F3] w-[16px] h-[16px]"})}),(0,e.jsx)("span",{className:"ml-[5px] text-[#213044] text-sm",children:f.formatMessage({id:"app.chatroom.sidebar.return"})})]}),(0,e.jsx)("div",{className:"h-full flex items-center shrink-0",children:(0,e.jsx)("div",{className:"w-[1px] h-[13px] bg-[#ebebeb]"})}),(0,e.jsx)("div",{className:"flex-1 min-w-0 truncate",children:W.name})]})}),(0,e.jsx)("div",{className:"h-[360px]",children:(0,e.jsxs)("div",{className:"pb-[20px] border-b-[1px] px-[10px]",children:[(0,e.jsxs)("div",{className:"flex items-center cursor-pointer px-[20px]",children:[(0,e.jsx)("div",{className:"flex gap-x-[5px] flex-1",children:(0,e.jsx)("span",{className:"text-[#666] text-[14px]",children:f.formatMessage({id:"app.chatroom.sidebar.agent_title"})})}),(0,e.jsxs)("div",{className:"shrink-0 flex items-center",children:[(0,e.jsx)(rt.Z,{className:"pr-[2px]",overlayStyle:{fontSize:"12px"},title:f.formatMessage({id:"app.chatroom.sidebar.chatroom_switch_tips"}),children:(0,e.jsx)(et.Z,{className:"cursor-pointer text-[#666] text-[12px]"})}),(0,e.jsx)("span",{className:"text-[12px] text-[#666] pr-[5px]",children:f.formatHTMLMessage({id:"app.chatroom_list.switch"})}),(0,e.jsx)(Ve.Z,{size:"small",defaultChecked:!0,className:"w-[28px]",checked:W.smart_selection==1,onChange:p,disabled:j})]})]}),(0,e.jsx)("div",{className:"py-[20px] pt-[10px]",children:(0,e.jsx)("div",{className:"h-[220px] overflow-y-auto px-[10px]",children:Q.current?(0,e.jsx)("div",{className:"flex flex-col",children:Y&&Y.length>0?Y.map(function(s){return(0,e.jsxs)("div",{className:"flex items-center gap-x-[5px] hover:bg-[#FAFAFA] transition p-[10px] slider_agent_box",children:[(0,e.jsxs)("div",{className:"flex gap-x-[15px] flex-1 min-w-[0]",children:[(0,e.jsx)(Be.Z,{data:s}),(0,e.jsxs)("div",{className:"flex flex-col gap-y-[5px] justify-center flex-1 min-w-[0]",children:[(0,e.jsx)("span",{className:"text-[#213044] text-[12px] font-[500] truncate w-full",children:s.name}),(0,e.jsx)("span",{className:"text-[#999999] text-[12px] truncate",children:s.description})]})]}),(0,e.jsxs)("div",{className:"shrink-0 flex gap-x-[15px] items-center",children:[(0,e.jsx)("div",{className:"edit cursor-pointer w-[20px] h-[20px] flex justify-center items-center opacity-0 transition",onClick:function(){ge(s)},children:(0,e.jsx)("img",{className:"w-[16px] h-[16px]",src:"/icons/edit_icon_1.svg"})}),(0,e.jsx)(Ve.Z,{size:"small",disabled:j,defaultChecked:!0,className:"w-[28px]",checked:s.active==1,onChange:function(){fe(s)}})]})]},s.agent_id)}):(0,e.jsx)("div",{className:"w-full min-h-[220px] flex items-center justify-center",children:(0,e.jsx)(F.Z,{image:F.Z.PRESENTED_IMAGE_SIMPLE})})}):(0,e.jsx)("div",{className:"flex justify-center w-full h-full items-center",children:(0,e.jsx)(Ce.Z,{})})})}),(0,e.jsx)("div",{className:"px-[20px] ",children:(0,e.jsx)("div",{style:{border:"1px solid #1B64F3"},onClick:y,className:"w-full h-[30px] transition text-[#1B64F3] flex items-center justify-center cursor-pointer rounded-[6px] hover:text-[#fff] hover:bg-[#1B64F3]",children:(0,e.jsx)("span",{className:"text-[12px]",children:f.formatMessage({id:"app.chatroom.add.agent"})})})}),(0,e.jsx)("div",{className:"px-[20px] pt-[15px]",children:(0,e.jsx)("div",{style:K&&!j?{border:"1px solid #1B64F3"}:{background:"#d9d9d9",color:"rgba(0,0,0,0.25)",cursor:"not-allowed"},onClick:(0,st.throttle)(function(){K&&!j&&he()}),className:"w-full h-[30px] transition text-[#1B64F3] flex items-center justify-center cursor-pointer rounded-[6px] hover:text-[#fff] hover:bg-[#1B64F3]",children:(0,e.jsx)("span",{className:"text-[12px]",children:f.formatMessage({id:"app.chatroom.sidebar.agent_button"})})})})]})}),(0,e.jsxs)("div",{className:"flex-1 min-h-[0] flex flex-col",children:[(0,e.jsx)("div",{className:"pt-[30px] px-[30px] text-[#666] text-[14px] shrink-0",children:f.formatMessage({id:"app.chatroom.sidebar.othe_title"})}),(0,e.jsx)("div",{className:"px-[10px] flex-1 min-h-[0] py-[10px]",children:(0,e.jsx)("div",{style:{height:"calc(100% - 20px)"},className:"px-[10px]  overflow-y-auto",children:pe.current?(0,e.jsx)("div",{className:"h-full flex flex-col",children:G&&G.length>0?G.map(function(s){return(0,e.jsxs)("div",{className:"w-full transition hover:bg-[#FAFAFA] p-[10px] cursor-pointer",onClick:function(){V(s)},children:[(0,e.jsxs)("div",{className:"flex pb-[10px]",children:[(0,e.jsx)("div",{className:"flex-1 min-w-[0] truncate text-[#333] text-[14px]",children:s.name}),s.active==0?(0,e.jsxs)("div",{className:"flex items-center gap-x-[6px]",children:[(0,e.jsx)("img",{className:"w-[12px] h-[12px]",src:"/icons/plaza_m2_c2.svg",alt:""}),(0,e.jsx)("span",{className:"text-[12px] text-[#aaa]",children:f.formatMessage({id:"app.chatroom.sidebar.othe_status"})})]}):(0,e.jsxs)("div",{className:"flex items-center gap-x-[6px]",children:[(0,e.jsx)("img",{className:"w-[12px] h-[12px]",src:"/icons/plaza_m2_c1.svg",alt:""}),(0,e.jsx)("span",{className:"text-[12px] text-[#aaa]",children:f.formatMessage({id:"app.chatroom.sidebar.othe_status_succeed"})})]})]}),(0,e.jsx)("div",{className:"flex gap-x-[10px]",children:s.agent_list&&s.agent_list.length>0?(0,e.jsxs)(e.Fragment,{children:[xe(s.agent_list).map(function(i,n){return(0,e.jsx)("div",{className:"flex",children:(0,e.jsx)(Be.Z,{data:i,width:"30px"})},n)}),s.agent_list.length>=6?(0,e.jsx)(tt.Z,{}):(0,e.jsx)(e.Fragment,{})]}):(0,e.jsx)(e.Fragment,{})})]},s.chatroom_id)}):(0,e.jsx)("div",{className:"w-full h-full",children:(0,e.jsx)(F.Z,{image:F.Z.PRESENTED_IMAGE_SIMPLE})})}):(0,e.jsx)("div",{className:"flex justify-center w-full h-full items-center",children:(0,e.jsx)(Ce.Z,{})})})})]})]}),(0,e.jsx)(Te.Z,{show:X,popupClose:w,popupSave:C,checkList:Y,zIndex:99})]})]})},lt=(0,a.memo)(it),ct=t(61806),ot=t(39873),we=t(1413),ut={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM142.4 642.1L298.7 519a8.84 8.84 0 000-13.9L142.4 381.9c-5.8-4.6-14.4-.5-14.4 6.9v246.3a8.9 8.9 0 0014.4 7z"}}]},name:"menu-unfold",theme:"outlined"},dt=ut,Ee=t(91146),ft=function(d,f){return a.createElement(Ee.Z,(0,we.Z)((0,we.Z)({},d),{},{ref:f,icon:dt}))},vt=a.forwardRef(ft),pt=vt,mt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 000 13.8z"}}]},name:"menu-fold",theme:"outlined"},ht=mt,xt=function(d,f){return a.createElement(Ee.Z,(0,we.Z)((0,we.Z)({},d),{},{ref:f,icon:ht}))},gt=a.forwardRef(xt),jt=gt,St=t(50136),yt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M464 144H160c-8.8 0-16 7.2-16 16v304c0 8.8 7.2 16 16 16h304c8.8 0 16-7.2 16-16V160c0-8.8-7.2-16-16-16zm-52 268H212V212h200v200zm452-268H560c-8.8 0-16 7.2-16 16v304c0 8.8 7.2 16 16 16h304c8.8 0 16-7.2 16-16V160c0-8.8-7.2-16-16-16zm-52 268H612V212h200v200zm52 132H560c-8.8 0-16 7.2-16 16v304c0 8.8 7.2 16 16 16h304c8.8 0 16-7.2 16-16V560c0-8.8-7.2-16-16-16zm-52 268H612V612h200v200zM424 712H296V584c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v128H104c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h128v128c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V776h128c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8z"}}]},name:"appstore-add",theme:"outlined"},wt=yt,Nt=function(d,f){return a.createElement(Ee.Z,(0,we.Z)((0,we.Z)({},d),{},{ref:f,icon:wt}))},Rt=a.forwardRef(Nt),Ot=Rt,be=t(86),Ue=t(34994),We=t(2216),Mt=t(85877),Ft=t(29432),Zt=t(39944),Ct=t(11551),De=t(55927),ke=t(22683),Le=t(97807),It=function(d){var f,I,$,Z,u=d.selectApp,H=d.runid,z=d.setBoxLoading,B=d.setinputShow,O=d.appId,j=d.id,K=d.setisRun,T=(0,R.useIntl)(),J=(0,a.useRef)(""),te=(0,a.useRef)(""),Y=(0,a.useRef)(null),ae=(0,a.useState)(""),P=o()(ae,2),A=P[0],W=P[1],ne=(0,a.useState)(null),re=o()(ne,2),se=re[0],G=re[1],E=(0,a.useState)([]),Q=o()(E,2),pe=Q[0],me=Q[1],ie=(0,a.useState)(""),X=o()(ie,2),ce=X[0],he=X[1],M=(0,De.Z)(function(V){return V.flowMessage}),de=function(y){te.current=fe(y);var w={user:{value:fe(y)}};he(new Zt.z(w))},fe=function V(y){return y.map(function(w){return w.type==="mention"?w.id:w.children?V(w.children):w.text}).join("")},xe=function(){var V=h()(l()().mark(function y(w){var C,p;return l()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return z(!0),C=Object.keys(w),C.forEach(function(n){Y.current.properties[n]&&(Y.current.properties[n].value=w[n])}),i.next=5,(0,Ct.LH)({agent_id:u.checkItem[0].agent_id,ability_id:0,input_dict:Y.current,prompt:ce,data_source_run_id:J.current});case 5:p=i.sent,p.code==0&&(W(p.data.outputs_md),z(!1),K(!1));case 7:case"end":return i.stop()}},y)}));return function(w){return V.apply(this,arguments)}}(),ge=function(){var V=h()(l()().mark(function y(w,C){var p,s;return l()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,N.xT)(w,C);case 2:p=n.sent,(p==null?void 0:p.code)==0&&(J.current=p==null||(s=p.data)===null||s===void 0?void 0:s.app_run_id);case 4:case"end":return n.stop()}},y)}));return function(w,C){return V.apply(this,arguments)}}();return(0,a.useEffect)(function(){u&&u.checkItem.length&&(K(!0),ge(j,{app_id:O,app_run_id:H,status:1,corrected_parameter:""}))},[u]),(0,a.useEffect)(function(){var V=M.filter(function(i){return i.data.app_run_id==H&&i.type.indexOf("generate_meeting_action_items")!==-1});if(V.length!=0){var y,w=(y=V[V.length-1])===null||y===void 0||(y=y.data)===null||y===void 0||(y=y.exec_data)===null||y===void 0||(y=y.outputs)===null||y===void 0?void 0:y.value;if(w){var C=JSON.parse(w);Y.current=C;var p=Object.keys(C.properties);if(p.length){G(C.properties);var s=p.map(function(i){return{value:"<<".concat(Ft.qX,".inputs.").concat(i,">>"),label:i}});me(s)}B(!1),z(!1)}}},[M]),console.log(u),(0,e.jsxs)("div",{children:[(0,e.jsx)("div",{className:"py-[6px]",children:(0,e.jsx)(be.Z,{icon:u==null||(f=u.checkItem[0])===null||f===void 0?void 0:f.icon,title:u==null||(I=u.checkItem[0])===null||I===void 0?void 0:I.name,textDetails:u==null||($=u.checkItem[0])===null||$===void 0?void 0:$.description,iconType:"robot_icon",avatar:u==null||(Z=u.checkItem[0])===null||Z===void 0?void 0:Z.avatar,handleClick:function(){}})}),se!=null?(0,e.jsxs)(Ue.A,{submitter:{resetButtonProps:!1,submitButtonProps:{className:"w-full",disabled:!te.current},searchConfig:{submitText:T.formatMessage({id:"workflow.button.run"})}},onFinish:function(y){xe(y)},children:[(0,e.jsx)("div",{className:"py-[6px]",children:(0,e.jsx)(We._,{data:se})}),(0,e.jsx)("div",{className:"h-[150px] overflow-y-auto border border-color-[#eee] py-[4px] px-[11px] mb-[8px]",children:(0,e.jsx)(Mt.Z,{onChange:function(y){de(y)},options:pe,placeholder:"\u8BF7\u8F93\u5165\u8FD0\u884C\u6307\u4EE4\uFF0C\u8F93\u5165@\u63D2\u5165\u53D8\u91CF"})})]}):(0,e.jsx)(e.Fragment,{}),A?(0,e.jsx)("div",{className:"max-h-[400px] overflow-y-auto mt-[16px]",children:(0,e.jsx)("div",{className:"p-[12px]  bg-[#F7F7F7] leading-[22px]",children:(0,e.jsx)(ke.U,{rehypePlugins:[Le.Z],children:A})})}):(0,e.jsx)(e.Fragment,{})]})},At=(0,a.memo)(It),Et=t(66309),Ge=t(42237),bt=t(93696),Dt=function(d,f){return a.createElement(Ee.Z,(0,we.Z)((0,we.Z)({},d),{},{ref:f,icon:bt.Z}))},kt=a.forwardRef(Dt),Lt=kt,Ht=t(4981),Ke=t(29608),zt=(0,a.memo)(function(ee){var d=ee.progressObj,f=function(){return parseFloat(d.elapsed_time).toFixed(6)},I=function(Z){var u=new Date(Z),H=u.getFullYear(),z=(u.getMonth()+1).toString().padStart(2,"0"),B=u.getDate().toString().padStart(2,"0"),O=u.getHours().toString().padStart(2,"0"),j=u.getMinutes().toString().padStart(2,"0"),K=u.getSeconds().toString().padStart(2,"0");return(0,e.jsx)(e.Fragment,{children:"".concat(H,".").concat(z,".").concat(B," ").concat(O,":").concat(j,":").concat(K)})};return(0,e.jsx)("div",{className:"inline-flex gap-x-4 justify-end max-w-[100%]",children:(0,e.jsxs)("div",{className:"inline-flex gap-x-[20px] max-w-[100%]",children:[(0,e.jsx)("div",{className:"truncate min-w-[70px]",children:d.created_time&&I(d.created_time)}),(0,e.jsx)("div",{className:"truncate",children:d.apps_name||d.app_name}),(0,e.jsxs)("div",{className:"flex items-center gap-x-[7px] truncate min-w-[50px]",children:[(0,e.jsx)("div",{className:"shrink-0 rounded-full ".concat(d.status==1?"bg-blue-600":d.status==2?"bg-green-500":"bg-red-500"),style:{width:"3px",height:"3px"}}),(0,e.jsxs)("div",{className:"truncate",children:[f(),"S"]})]})]})})}),Pt=function(d){var f,I,$,Z,u=d.selectApp,H=d.runid,z=d.setBoxLoading,B=d.setinputShow,O=d.appId,j=d.id,K=d.setisRun,T=(0,R.useIntl)(),J=(0,a.useRef)(""),te=(0,a.useRef)(null),Y=(0,a.useState)(null),ae=o()(Y,2),P=ae[0],A=ae[1],W=(0,a.useState)(!1),ne=o()(W,2),re=ne[0],se=ne[1],G=(0,a.useState)(null),E=o()(G,2),Q=E[0],pe=E[1],me=(0,a.useState)(null),ie=o()(me,2),X=ie[0],ce=ie[1],he=(0,a.useState)(null),M=o()(he,2),de=M[0],fe=M[1],xe=(0,Ke.Z)(function(n){return n.setDealtWithData}),ge=(0,Ke.Z)(function(n){return n.setRunPanelLogRecord}),V=function(){var n=h()(l()().mark(function r(c){var m,x,v,S,L;return l()().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return z(!0),m=Object.keys(c),x={},m.forEach(function(je){te.current.properties[je]&&(te.current.properties[je].value=c[je]),X&&X.forEach(function(Oe){Oe.node_id==je&&(x[je]=c[je])})}),v={inputs:te.current,node_confirm_users:x,run_name:"chatroom-".concat(j,"-run-").concat(J.current,"-driven"),run_type:1,data_source_run_id:J.current},_.next=7,(0,Ge.UE)(O,v);case 7:S=_.sent,S.code==0&&(J.current=S==null||(L=S.data)===null||L===void 0?void 0:L.app_run_id,se(!0),K(!1));case 9:case"end":return _.stop()}},r)}));return function(c){return n.apply(this,arguments)}}(),y=function(){var n=h()(l()().mark(function r(){var c,m;return l()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:c=i==null?void 0:i.filter(function(S){return S.type=="workflow_run_progress"&&S.data.app_run_id==J.current}).map(function(S){var L=S.data;return L}),c&&c.length&&(m=c[c.length-1],A(m),z(!1));case 2:case"end":return v.stop()}},r)}));return function(){return n.apply(this,arguments)}}(),w=function(){var n=h()(l()().mark(function r(){var c,m,x,v,S;return l()().wrap(function(Se){for(;;)switch(Se.prev=Se.next){case 0:m=i==null?void 0:i.filter(function(_){return _.type=="workflow_need_human_confirm"&&_.data.app_run_id==J.current}),x=(c=m.map(function(_){var je=_.data,Oe=_.need_human_confirm;return{data:je,need_human_confirm:Oe}}))===null||c===void 0?void 0:c.filter(function(_){return _.data.type!==1}),x&&x.length&&(S=x[x.length-1].data,S.exec_id=S==null||(v=S.node_exec_data)===null||v===void 0?void 0:v.node_exec_id,fe(x[x.length-1]),z(!1));case 3:case"end":return Se.stop()}},r)}));return function(){return n.apply(this,arguments)}}(),C=function(r){return r.completed_progress?parseInt(r.completed_progress.slice(0,-1)):!1},p=function(){var n=h()(l()().mark(function r(c,m){var x,v;return l()().wrap(function(L){for(;;)switch(L.prev=L.next){case 0:return L.next=2,(0,N.xT)(c,m);case 2:x=L.sent,(x==null?void 0:x.code)==0&&(J.current=x==null||(v=x.data)===null||v===void 0?void 0:v.app_run_id);case 4:case"end":return L.stop()}},r)}));return function(c,m){return n.apply(this,arguments)}}(),s=function(){var n=h()(l()().mark(function r(){var c,m;return l()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return console.log(O),v.next=3,(0,Ge.zO)(O);case 3:c=v.sent,c.code==0&&ce(c==null||(m=c.data)===null||m===void 0?void 0:m.need_confirm_nodes),p(j,{app_id:O,app_run_id:H,status:1,corrected_parameter:""});case 6:case"end":return v.stop()}},r)}));return function(){return n.apply(this,arguments)}}();(0,a.useEffect)(function(){u&&u.checkItem.length&&(K(!0),s())},[u]);var i=(0,De.Z)(function(n){return n.flowMessage});return(0,a.useEffect)(function(){y(),w();var n=i.filter(function(v){return v.data.app_run_id==H&&v.type.indexOf("generate_meeting_action_items")!==-1});if(n.length!=0){var r,c=(r=n[n.length-1])===null||r===void 0||(r=r.data)===null||r===void 0||(r=r.exec_data)===null||r===void 0||(r=r.outputs)===null||r===void 0?void 0:r.value;if(c){var m=JSON.parse(c);te.current=m;var x=Object.keys(m.properties);x.length&&(console.log(m.properties),pe(m.properties)),B(!1),z(!1)}}},[i]),(0,e.jsxs)("div",{children:[(0,e.jsx)("div",{className:"py-[6px]",children:(0,e.jsx)(be.Z,{icon:u==null||(f=u.checkItem[0])===null||f===void 0?void 0:f.icon,title:u==null||(I=u.checkItem[0])===null||I===void 0?void 0:I.name,textDetails:u==null||($=u.checkItem[0])===null||$===void 0?void 0:$.description,iconType:"workflow_icon",avatar:u==null||(Z=u.checkItem[0])===null||Z===void 0?void 0:Z.avatar,handleClick:function(){}})}),!re&&Q!=null?(0,e.jsxs)(Ue.A,{submitter:{resetButtonProps:!1,submitButtonProps:{className:"w-full"},searchConfig:{submitText:T.formatMessage({id:"workflow.button.run"})}},onFinish:V,children:[(0,e.jsx)("div",{className:"py-[6px]",children:(0,e.jsx)(We._,{data:Q})}),(0,e.jsx)(Ht.e,{data:X})]}):(0,e.jsx)(e.Fragment,{children:Q!=null?(0,e.jsxs)("div",{children:[(0,e.jsxs)("div",{className:"text-[16px] color-[#000] font-[600] py-[12px]",children:[T.formatMessage({id:"app.summaryhistory.input"}),":"]}),Object.values(Q).map(function(n){return(0,e.jsxs)("div",{className:"pb-[10px]",children:[(0,e.jsx)("div",{className:"pb-[8px] font-[600]",children:n.display_name||n.name}),(0,e.jsx)("div",{className:"py-[4px] px-[11px] text-[14px] leading-[1.5] ",children:n.value})]})})]}):(0,e.jsx)(e.Fragment,{})}),de&&de.need_human_confirm!=0?(0,e.jsx)("div",{className:"pt-[12px]",children:(0,e.jsxs)("div",{className:"flex gap-x-[6px] items-center h-[20px] cursor-pointer",onClick:function(){xe(de.data)},children:[(0,e.jsx)("div",{children:(0,e.jsx)(Lt,{className:"text-[#1B64F3] text-[16px]"})}),(0,e.jsx)("span",{children:T.formatMessage({id:"app.summary.backlogTips"})})]})}):(0,e.jsx)(e.Fragment,{}),P?(0,e.jsx)("div",{className:"pt-[10px]",children:(0,e.jsx)(be.Z,{status:P.status,icon:P.icon,title:(0,e.jsxs)("div",{className:"items-center gap-x-[8px] inline-flex justify-end w-full",children:[(0,e.jsx)("span",{className:"flex-1 truncate",children:P.run_name}),P.need_human_confirm==1?(0,e.jsx)(Et.Z,{className:" text-[12px] flex items-center justify-center margin-0",color:"blue",children:T.formatMessage({id:"app.summaryhistory.tag"})}):(0,e.jsx)(e.Fragment,{})]}),textDetails:(0,e.jsx)(zt,{progressObj:P}),handleClick:function(){ge(P)},progress:C(P)})}):(0,e.jsx)(e.Fragment,{})]})},$t=(0,a.memo)(Pt),Bt=function(d){var f,I,$,Z=(0,R.useIntl)(),u=d.runid,H=d.id,z=d.setBoxLoading,B=d.scrollDom,O=d.setinputShow,j=(0,a.useRef)("agent"),K=(0,a.useRef)(""),T=(0,a.useState)(!1),J=o()(T,2),te=J[0],Y=J[1],ae=(0,a.useState)({type:"agent",checkItem:[],show:!1}),P=o()(ae,2),A=P[0],W=P[1],ne=[{key:"1",label:(0,e.jsx)("div",{className:"hover:text-[#1B64F3]",onClick:function(){W(function(E){return U()(U()({},E),{},{type:"agent",show:!0})})},children:Z.formatMessage({id:"app.summary.SelectAgent"})})},{key:"2",label:(0,e.jsx)("div",{className:"hover:text-[#1B64F3]",onClick:function(){W(function(E){return U()(U()({},E),{},{type:"workflow",show:!0})})},children:Z.formatMessage({id:"app.summary.SelectWorkflow"})})}],re=function(){W(function(E){return U()(U()({},E),{},{show:!1})})},se=function(E){z(!0),W(function(Q){return U()(U()({},Q),{},{checkItem:E.checkItem})}),j.current=A.type,K.current=E.checkItem[0].app_id};return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)("div",{className:"pt-[24px]  border-[#ddd]",style:{minHeight:A!=null&&(f=A.checkItem)!==null&&f!==void 0&&f.length?B==null||(I=B.current)===null||I===void 0?void 0:I.offsetHeight:"100%"},children:[(0,e.jsxs)("div",{className:"text-[14px] font-[500] flex item-center",children:[(0,e.jsx)("div",{className:"flex-1",children:Z.formatMessage({id:"app.summary.Runapp"})}),(0,e.jsx)("div",{className:"px-[10px]",children:te?(0,e.jsx)(St.Z,{menu:{items:ne},children:(0,e.jsx)(Ot,{className:"transition cursor-pointer text-[#999] text-[18px] hover:text-[#1B64F3]"})}):(0,e.jsx)(e.Fragment,{})})]}),(0,e.jsx)("div",{children:A!=null&&($=A.checkItem)!==null&&$!==void 0&&$.length?(0,e.jsx)(e.Fragment,{children:j.current=="agent"?(0,e.jsx)(At,{id:H,appId:K.current,selectApp:A,runid:u,setBoxLoading:z,scrollDom:B,setinputShow:O,setisRun:Y}):(0,e.jsx)($t,{id:H,appId:K.current,selectApp:A,runid:u,setBoxLoading:z,scrollDom:B,setinputShow:O,setisRun:Y})}):(0,e.jsxs)("div",{className:"flex gap-x-[20px] min-h-[70px] items-center px-[20px]",children:[(0,e.jsxs)(Ze.ZP,{className:"flex-1 text-[14px]",onClick:function(){W(function(E){return U()(U()({},E),{},{type:"agent",show:!0})})},children:[(0,e.jsx)("img",{src:"/icons/robot_icon.svg",alt:"",className:"w-[14px] h-[14px]"}),Z.formatMessage({id:"app.summary.SelectAgent"})]}),(0,e.jsxs)(Ze.ZP,{className:"flex-1 text-[14px]",onClick:function(){W(function(E){return U()(U()({},E),{},{type:"workflow",show:!0})})},children:[(0,e.jsx)("img",{src:"/icons/workflow_icon.svg",alt:"",className:"w-[14px] h-[14px]"}),Z.formatMessage({id:"app.summary.SelectWorkflow"})]})]})})]}),(0,e.jsx)(Te.Z,{show:A.show,nodetype:A.type,popupClose:re,popupSave:se,checkList:j.current==A.type?A.checkItem:[],zIndex:99,radio:!0})]})},Vt=(0,a.memo)(Bt),Tt=t(26915),Ut=t(87740),Je=(0,a.memo)(function(ee){var d=ee.id,f=ee.message,I=(0,R.useIntl)(),$=(0,ve.Z)(function(j){return j.setSummaryClick}),Z=(0,a.useState)(!0),u=o()(Z,2),H=u[0],z=u[1],B=(0,ve.Z)(function(j){return j.summaryClick}),O=(0,ve.Z)(function(j){return j.setSummaryParams});return(0,a.useEffect)(function(){z(B)},[B]),(0,e.jsx)("div",{className:"flex flex-row-reverse",children:(0,e.jsxs)(Ze.ZP,{type:"primary",className:"bg-[#1B64F3] rounded-[4px] my-3 h-[30px] w-[110px] gap-[6px]",onClick:function(K){H&&(O({id:d,message:f}),$(!1))},children:[(0,e.jsx)("span",{className:"text-[12px]",children:I.formatMessage({id:"app.summaryhistory.submitText"})}),(0,e.jsx)(Ut.Z,{className:"text-[14px]"})]})})}),Wt=function(d){var f,I,$,Z,u=d.setShow,H=d.inputShow,z=d.setBoxLoading,B=d.setAppRunId,O=d.scrollDom,j=(0,R.useIntl)(),K=(0,a.useState)(!1),T=o()(K,2),J=T[0],te=T[1],Y=(0,a.useState)(""),ae=o()(Y,2),P=ae[0],A=ae[1],W=(0,a.useState)(""),ne=o()(W,2),re=ne[0],se=ne[1],G=(0,a.useRef)(""),E=(0,a.useRef)(""),Q=(0,a.useRef)(!1),pe=(0,a.useState)(!1),me=o()(pe,2),ie=me[0],X=me[1],ce=(0,a.useState)(null),he=o()(ce,2),M=he[0],de=he[1],fe=(0,ve.Z)(function(p){return p.setSummaryClick}),xe=function(){var p=h()(l()().mark(function s(i){var n,r,c,m,x=arguments;return l()().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return n=x.length>1&&x[1]!==void 0?x[1]:{app_run_id:"",corrected_parameter:""},S.next=3,(0,N.Rp)(i,n);case 3:r=S.sent,(r==null?void 0:r.code)==0&&(B(r==null||(c=r.data)===null||c===void 0?void 0:c.app_run_id),E.current=r==null||(m=r.data)===null||m===void 0?void 0:m.app_run_id,n.app_run_id&&(Q.current=!0));case 5:case"end":return S.stop()}},s)}));return function(i){return p.apply(this,arguments)}}(),ge=function(){var p=h()(l()().mark(function s(i,n){var r,c,m,x,v;return l()().wrap(function(L){for(;;)switch(L.prev=L.next){case 0:return L.next=2,(0,N.xM)(i,{message:n});case 2:r=L.sent,(r==null?void 0:r.code)==0&&(E.current=r==null||(c=r.data)===null||c===void 0?void 0:c.app_run_id,B(r==null||(m=r.data)===null||m===void 0?void 0:m.app_run_id),r!=null&&(x=r.data)!==null&&x!==void 0&&(x=x.outputs)!==null&&x!==void 0&&x.value&&(A(r==null||(v=r.data)===null||v===void 0||(v=v.outputs)===null||v===void 0?void 0:v.value),u(!0),z(!1),fe(!0),O.current.scrollTo({top:0})));case 4:case"end":return L.stop()}},s)}));return function(i,n){return p.apply(this,arguments)}}(),V=function(){var p=h()(l()().mark(function s(){var i;return l()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,(0,N.Gh)({chatroom_id:G.current,app_run_id:E.current});case 2:i=r.sent,i&&i!==null&&i!==void 0&&i.data&&de(i.data);case 4:case"end":return r.stop()}},s)}));return function(){return p.apply(this,arguments)}}(),y=function(s){var i=new Date(s),n=i.getMonth()+1,r=i.getDate(),c=i.getHours(),m=i.getMinutes(),x=i.getSeconds();return i.getFullYear()+"-"+(n<10?"0"+n:n)+"-"+(r<10?"0"+r:r)+" "+(c<10?"0"+c:c)+":"+(m<10?"0"+m:m)+":"+(x<10?"0"+x:x)},w=(0,De.Z)(function(p){return p.flowMessage});(0,a.useEffect)(function(){var p=w.filter(function(n){return n.data.app_run_id==E.current&&n.type.indexOf("generate_meeting_summary")!==-1});if(p.length!=0){var s,i=(s=p[p.length-1])===null||s===void 0||(s=s.data)===null||s===void 0||(s=s.exec_data)===null||s===void 0||(s=s.outputs)===null||s===void 0?void 0:s.value;i&&(Q.current&&V(),A(i),X(!1),u(!0),fe(!0),z(!1),O.current.scrollTo({top:0}))}},[w]);var C=(0,ve.Z)(function(p){return p.summaryParams});return(0,a.useEffect)(function(){C&&C.id&&(G.current=C.id,M&&de(null),ie&&X(!1),P&&A(""),te(!0),C.message?(z(!0),ge(C.id,C.message)):xe(C.id))},[C]),(0,e.jsx)(e.Fragment,{children:J?(0,e.jsxs)("div",{className:"pb-[16px]",children:[(0,e.jsx)("div",{className:"text-[16px] font-[600] pt-[12px]",children:j.formatMessage({id:"app.summary.title"})}),(0,e.jsx)("div",{className:"text-[14px] pt-[12px] leading-[23px] px-[8px]",children:P?(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("div",{className:" ".concat("max-h-[400px]"," p-[12px]  bg-[#F7F7F7]  relative overflow-y-auto"),children:(0,e.jsx)(ke.U,{rehypePlugins:[Le.Z],children:M?M==null||(f=M.source_run)===null||f===void 0?void 0:f.summary:P})}),M&&(M==null||(I=M.source_corrections)===null||I===void 0?void 0:I.length)>0||!H?(0,e.jsx)(Je,{id:G.current,message:M?M==null||($=M.source_run)===null||$===void 0?void 0:$.summary:P}):(0,e.jsx)(e.Fragment,{})]}):(0,e.jsx)("div",{className:"min-h-[120px] flex items-center justify-center",children:(0,e.jsx)(Ce.Z,{size:"large"})})}),M&&(M==null||(Z=M.source_corrections)===null||Z===void 0?void 0:Z.length)>0?(0,e.jsxs)("div",{children:[(0,e.jsxs)("div",{className:"text-[16px] font-[600] py-[8px]",children:[j.formatMessage({id:"app.summaryhistory.orientation"}),":"]}),M.source_corrections.map(function(p,s){return(0,e.jsxs)("div",{className:"mb-[16px]",children:[(0,e.jsx)("div",{className:"rounded-[4px]  ".concat(M.source_corrections.length-1==s?"bg-blue-100":"bg-[#F7F7F7]"),children:(0,e.jsxs)("div",{className:"p-[12px]   leading-[22px]",children:[(0,e.jsxs)("div",{className:"tetx-[14px] font-[600] pb-[12px]",children:[j.formatMessage({id:"app.summaryhistory.userPrompt"}),": ",p.user_prompt]}),(0,e.jsxs)("div",{className:"tetx-[14px] font-[600] pb-[12px]",children:[j.formatMessage({id:"app.summaryhistory.time"}),": ",y(p.created_time)]}),(0,e.jsx)(ke.U,{rehypePlugins:[Le.Z],children:p==null?void 0:p.corrected_summary})]})},p.created_time),!H||M.source_corrections.length-1!=s?(0,e.jsx)(Je,{id:G.current,message:p==null?void 0:p.corrected_summary}):(0,e.jsx)(e.Fragment,{})]},p.created_time)})]}):(0,e.jsx)(e.Fragment,{}),H?(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("div",{className:"pt-[12px]",children:(0,e.jsx)(Tt.Z.TextArea,{onChange:function(s){se(s.target.value)},value:re,disabled:!P||ie,rows:4,placeholder:j.formatMessage({id:"app.summary.placeholder"})})}),(0,e.jsx)("div",{className:"flex pt-[12px] gap-x-[4px]",children:(0,e.jsx)(Ze.ZP,{type:"primary",disabled:!P||!re,loading:ie,className:"bg-[#1B64F3] rounded-[4px] w-[88px] h-[40px] flex-1",onClick:function(){xe(G.current,{app_run_id:String(E.current),corrected_parameter:re}),X(!0),se(""),u("")},children:j.formatMessage({id:"app.summary.submitText"})})})]}):(0,e.jsx)(e.Fragment,{})]}):(0,e.jsx)(e.Fragment,{})})},Gt=(0,a.memo)(Wt),Kt=t(38027),Jt=function(d){var f,I=d.id,$=(0,a.useState)(""),Z=o()($,2),u=Z[0],H=Z[1],z=(0,a.useState)(!1),B=o()(z,2),O=B[0],j=B[1],K=(0,a.useState)([]),T=o()(K,2),J=T[0],te=T[1],Y=(0,a.useState)(!1),ae=o()(Y,2),P=ae[0],A=ae[1],W=(0,a.useState)(!1),ne=o()(W,2),re=ne[0],se=ne[1],G=(0,a.useState)(""),E=o()(G,2),Q=E[0],pe=E[1],me=(0,a.useState)(!1),ie=o()(me,2),X=ie[0],ce=ie[1],he=(0,a.useState)(!1),M=o()(he,2),de=M[0],fe=M[1],xe=(0,a.useState)(!0),ge=o()(xe,2),V=ge[0],y=ge[1],w=(0,a.useRef)(null),C=(0,a.useRef)(1),p=(0,a.useRef)(!1),s=(0,a.useRef)(!0),i=(0,a.useRef)(0),n=(0,a.useState)(!1),r=o()(n,2),c=r[0],m=r[1],x=(0,a.useState)(800),v=o()(x,2),S=v[0],L=v[1],Se=(0,a.useState)(!1),_=o()(Se,2),je=_[0],Oe=_[1],Ie=(0,ve.Z)(function(oe){return oe.summaryParams}),qt=(0,ve.Z)(function(oe){return oe.setSummaryParams}),He=function(){var oe=h()(l()().mark(function ye(){var Ye,ze,ue,Pe,Me,$e,Fe=arguments;return l()().wrap(function(Ne){for(;;)switch(Ne.prev=Ne.next){case 0:if(Ye=Fe.length>0&&Fe[0]!==void 0?Fe[0]:!0,ze=Fe.length>1&&Fe[1]!==void 0?Fe[1]:!0,!(i.current!=0&&i.current<C.current)){Ne.next=5;break}return m(!1),Ne.abrupt("return");case 5:return Ne.next=8,(0,N.sh)({chatroom_id:I,page:C.current,page_size:10});case 8:ue=Ne.sent,ue.code==0&&(ue!=null&&(Pe=ue.data)!==null&&Pe!==void 0&&Pe.list&&ue!==null&&ue!==void 0&&(Me=ue.data)!==null&&Me!==void 0&&(Me=Me.list)!==null&&Me!==void 0&&Me.length&&(i.current=ue==null||($e=ue.data)===null||$e===void 0?void 0:$e.total_pages,te(function(Ae){return ze?Re()(ue.data.list.reverse()):[].concat(Re()(ue.data.list.reverse()),Re()(Ae))}),s.current=!0,j(!0),m(!0)),ze&&setTimeout(function(){var Ae;w==null||(Ae=w.current)===null||Ae===void 0||Ae.scrollTo({top:0})},200),Ye||(H(Ie.id),qt({})));case 10:case"end":return Ne.stop()}},ye)}));return function(){return oe.apply(this,arguments)}}(),ea=function(ye){ye.target.scrollHeight+(ye.target.scrollTop-ye.target.clientHeight)<400&&s.current&&(s.current=!1,m(!0),C.current=C.current+=1,He(!0,!1))};(0,a.useEffect)(function(){C.current=1,He()},[I]),(0,a.useEffect)(function(){console.log(Ie),Ie&&Ie.id&&(j(!0),V||y(!0),P&&A(!1),X&&ce(!1),C.current=1,se(!0),He(!1),p.current=!0)},[Ie]);var ta=(0,ve.Z)(function(oe){return oe.setOrientationShow});return(0,a.useEffect)(function(){O&&ta(!0)},[O]),(0,a.useEffect)(function(){console.log(c);var oe=function(){window.innerWidth<1280?(L(400),Oe(!0),console.log(w),setTimeout(function(){ce(!0)},200)):(L((window.innerWidth-320)/2),Oe(!1),ce(!1))};return oe(),window.addEventListener("resize",oe),function(){window.removeEventListener("resize",oe)}},[]),(0,e.jsx)(e.Fragment,{children:O?(0,e.jsxs)("div",{style:{overflow:X?"hidden":"initial"},className:"pl-[32px] box-border ".concat(je?"fixed  right-0 bottom-0 top-[56px]":"relative"),children:[(0,e.jsx)("div",{onClick:function(){ce(function(ye){return!ye})},className:`
                                `.concat(X?"absolute left-[2px]  top-[60px]":"absolute left-[2px] top-[60px]",`
                                history_packup
                                hover:text-[#1B64F3]
                                w-[30px] h-[60px] bg-[rgba(255,255,255,1)] shadow-md flex justify-center items-center cursor-pointer z-[99]
                            `),children:X?(0,e.jsx)(jt,{className:"text-[18px]"}):(0,e.jsx)(pt,{className:"text-[18px]"})}),(0,e.jsxs)(ot.Z,{minWidth:400,maxWidth:S,className:"relative h-full right-0 border-0 returned-0 px-[0] ".concat(X?"hidden flex-[0]":"block"),children:[de?(0,e.jsx)("div",{className:"h-full w-full absolute top-0 left-0 flex justify-center items-center z-[100] bg-[rgba(255,255,255,0.5)]",children:(0,e.jsx)(Ce.Z,{size:"large"})}):(0,e.jsx)(e.Fragment,{}),(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)("div",{className:"h-full min-h-full overflow-y-auto flex flex-col-reverse scroll-smooth relative",onScroll:ea,ref:w,children:[(0,e.jsxs)("div",{children:[J.length?(0,e.jsx)(Kt.ZP,{id:I,runid:Q,scrollDom:w,list:J,historyHeight:p.current}):(0,e.jsx)(e.Fragment,{}),(0,e.jsxs)("div",{className:"w-full px-4 h-full",style:{minHeight:re?w==null||(f=w.current)===null||f===void 0?void 0:f.offsetHeight:""},children:[(0,e.jsx)(Gt,{setShow:A,inputShow:V,setBoxLoading:fe,setAppRunId:pe,scrollDom:w}),P?(0,e.jsx)(Vt,{id:u,runid:Q,setBoxLoading:fe,scrollDom:w,setinputShow:y}):(0,e.jsx)(e.Fragment,{})]})]}),c?(0,e.jsx)("div",{className:"text-center justify-center items-center flex",children:(0,e.jsx)(Ce.Z,{})}):(0,e.jsx)(e.Fragment,{})]})})]})]}):(0,e.jsx)(e.Fragment,{})})},Yt=(0,a.memo)(Jt),Qt=function(d){return(0,e.jsx)("div",{className:"flex items-center h-full justify-center",children:(0,e.jsx)(F.Z,{image:F.Z.PRESENTED_IMAGE_SIMPLE})})},Xt=(0,a.memo)(function(){var ee=(0,R.useParams)(),d=ee.id,f=(0,a.useRef)([]),I=(0,a.useRef)(null),$=(0,a.useState)(!1),Z=o()($,2),u=Z[0],H=Z[1],z=function(){var B=h()(l()().mark(function O(){var j;return l()().wrap(function(T){for(;;)switch(T.prev=T.next){case 0:if(!d){T.next=5;break}return T.next=3,(0,N.cH)({id:d});case 3:j=T.sent,j.code==0?(H(!0),I.current=j.data,f.current=j.data.agent_list):R.history.replace("/meeting");case 5:case"end":return T.stop()}},O)}));return function(){return B.apply(this,arguments)}}();return(0,a.useEffect)(function(){z()},[]),(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)("div",{className:"w-full flex bg-[#fff] overflow-hidden overflow-x-auto",style:{height:"calc(100vh - 56px)"},children:[(0,e.jsx)(lt,{roomDetail:I.current,setAgent:f}),(0,e.jsx)("div",{className:"flex-1 min-h-0 h-full",children:u?(0,e.jsx)(ct.F,{agentList:f}):(0,e.jsx)(Qt,{})}),(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(Yt,{id:d})})]})})}),_t=Xt},55026:function(){"use strict"},61227:function(q,b,t){var g=t(82187),l=t(96936),D=t(96263),h=t(69094);function k(o){return g(o)||l(o)||D(o)||h()}q.exports=k,q.exports.__esModule=!0,q.exports.default=q.exports}}]);
