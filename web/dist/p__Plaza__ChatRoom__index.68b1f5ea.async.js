"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[57],{86:function(dt,Pe,l){var Ve=l(5574),I=l.n(Ve),Ue=l(32332),re=l(38703),We=l(67294),c=l(85893),fe=function(a){var Y=a.subtitle,Ge=a.handleClick,ce=a.lineClamp,at=ce===void 0?2:ce,K=a.textDetails,ge=a.title,Ke=a.icon,Te=a.iconType,$e=Te===void 0?"":Te,Le=a.operation,Ae=Le===void 0?"":Le,Fe=a.progress,je=a.status,Ze=a.backlogTips,He=(0,We.useState)(0),Ne=I()(He,2),Ee=Ne[0],Oe=Ne[1],Je=function(){Oe(Fe)},Qe=function(){Oe(0)},Xe=function(e){return"rounded-[4px] border-l-[4px] ".concat(e==1?"border-[#1B64F3]":e==2?"border-[#52C41C]":"border-[#F04444]"," ")};return(0,c.jsxs)("div",{className:"flex  p-[10px] cursor-pointer overflow-hidden relative bg-[#fff] ".concat(je!==void 0?Xe(je):"graphicbox"),onClick:Ge,onMouseEnter:function(){Fe!=null&&Je()},onMouseLeave:function(){Fe!=null&&Qe()},children:[je!==void 0&&(0,c.jsx)("div",{style:{width:"".concat(Ee,"%"),transition:"width 0.5s "},className:"absolute bottom-0 left-0 top-0 bottom-0 h-full ".concat(je==1?"bg-[#1B64F3]/[.03]":je==2?"bg-[#52c41c]/[.05]":"bg-[#FAFAFA]"," ")}),(0,c.jsxs)("div",{className:"flex gap-x-[20px] w-full relative z-20",children:[(0,c.jsx)("div",{className:"shrink-0 flex gap-x-[7px] items-center",style:{fontSize:0},children:(0,c.jsxs)("div",{className:"w-[40px] h-[40px] rounded-[6px] flex items-center justify-center bg-[#F4F8F1] relative",children:[(0,c.jsx)("img",{src:(0,Ue.s9)("single",Ke),className:"w-[22px] h-[22px]"}),$e&&(0,c.jsx)("div",{className:"w-[16px] h-[16px] absolute top-[28px] left-[28px] flex items-center justify-center bg-[#fff] rounded-[3px]",style:{boxShadow:"0px 0px 4px 0px rgba(0,0,0,0.1)"},children:(0,c.jsx)("img",{src:"/icons/".concat($e,".svg"),alt:"",className:"w-[12px] h-[12px]"})})]})}),(0,c.jsx)("div",{className:"flex flex-1 min-w-0",children:(0,c.jsxs)("div",{className:"flex justify-center flex-col gap-y-[5px] flex-1 min-w-0",children:[(0,c.jsxs)("span",{className:"text-[12px] flex items-center",style:{color:"#213044"},children:[(0,c.jsx)("span",{className:"truncate",children:ge}),(0,c.jsx)("span",{className:"flex items-center flex-1",children:Y})]}),(0,c.jsx)("span",{className:"text-[12px] max-w-full truncate",style:{color:"#999999"},children:K})]})}),Ze||(0,c.jsx)(c.Fragment,{}),Ae&&(0,c.jsx)("div",{className:"flex items-center w-[24px]",children:(0,c.jsx)("span",{className:"operation",children:Ae})}),Fe!=null&&(0,c.jsx)("div",{className:"graphic_progress flex items-center pl-[30px]",children:(0,c.jsx)(re.Z,{type:"circle",percent:Fe,size:29})})]})]})};Pe.Z=fe},78129:function(dt,Pe,l){l.r(Pe),l.d(Pe,{default:function(){return Aa}});var Ve=l(15009),I=l.n(Ve),Ue=l(99289),re=l.n(Ue),We=l(5574),c=l.n(We),fe=l(43722),Me=l(32983),a=l(67294),Y=l(35312),Ge=l(19632),ce=l.n(Ge),at=l(97857),K=l.n(at),ge=l(32332),Ke=l(82114),Te=l(82826),$e=l(63783),Le=l(3471),Ae=l(45360),Fe=l(85576),je=l(28036),Ze=l(83062),He=l(72269),Ne=l(74330),Ee=l(96486),Oe=l(44010),Je=l(73445),Qe=l(782),Xe=(0,Je.Ue)((0,Qe.mW)(function(s,n){return{clearMemory:null,truncatable:!1,disableInput:!1,summaryParams:null,runsSummaryShow:!1,summaryClick:!0,setClearMemory:function(i){s({clearMemory:i})},setTruncatable:function(i){s({truncatable:i})},setDisableInput:function(i){s({disableInput:i})},setSummaryParams:function(i){s({summaryParams:i})},setRunsSummaryShow:function(i){s({runsSummaryShow:i})},setSummaryClick:function(i){console.log(i),s({summaryClick:i})}}})),Q=Xe,e=l(85893),pt=function(n){var r=(0,Y.useIntl)(),i=n.roomDetail,h=n.setAgent,j=Ae.ZP.useMessage(),o=c()(j,2),m=o[0],_=o[1],w=(0,Y.useParams)(),f=w.id,u=Q(function(y){return y.disableInput}),S=Q(function(y){return y.truncatable}),b=Q(function(y){return y.setClearMemory}),R=(0,a.useState)([]),O=c()(R,2),t=O[0],P=O[1],z=(0,a.useState)(K()({},i)),Z=c()(z,2),p=Z[0],T=Z[1],V=(0,a.useState)([]),J=c()(V,2),U=J[0],W=J[1],k=(0,a.useRef)(!1),A=(0,a.useRef)(!1),x=(0,a.useState)(!1),D=c()(x,2),g=D[0],M=D[1],C=function(){var v=Fe.Z.confirm;v({title:r.formatMessage({id:"app.chatroom.clear.title"}),icon:(0,e.jsx)(Ke.Z,{}),content:r.formatMessage({id:"app.chatroom.clear.tips"}),okText:r.formatMessage({id:"app.chatroom.clear.confirm"}),okType:"danger",cancelText:r.formatMessage({id:"app.chatroom.clear.cancel"}),onOk:function(){b(["TRUNCATE","0"])}})},N=function(){var y=re()(I()().mark(function v(){var F;return I()().wrap(function($){for(;;)switch($.prev=$.next){case 0:if(!f){$.next=5;break}return $.next=3,(0,fe.cH)({id:f});case 3:if(F=$.sent,F.code==0)try{T(function(){return K()(K()({},F.data.chat_info),{},{max_round:F.data.max_round,smart_selection:F.data.smart_selection})}),P(F.data.agent_list),k.current=!0}catch(le){}case 5:case"end":return $.stop()}},v)}));return function(){return y.apply(this,arguments)}}(),X=function(){var y=re()(I()().mark(function v(){var F;return I()().wrap(function($){for(;;)switch($.prev=$.next){case 0:return $.next=2,(0,fe.j2)({id:f});case 2:F=$.sent,F.code==0&&(W(F.data.list),A.current=!0);case 4:case"end":return $.stop()}},v)}));return function(){return y.apply(this,arguments)}}(),H=function(){var y=re()(I()().mark(function v(F){var oe,$,le;return I()().wrap(function(ee){for(;;)switch(ee.prev=ee.next){case 0:if(!f){ee.next=11;break}if(oe=F.active==1?0:1,oe!=0){ee.next=7;break}if($=t.filter(function(xe){return xe.active==1}),$.length-1!=0){ee.next=7;break}return m.open({type:"error",content:r.formatMessage({id:"app.chatroom.sidebar.agent_tips"}),duration:2}),ee.abrupt("return",!1);case 7:return ee.next=9,(0,fe.sT)({active:oe},f,F.agent_id);case 9:le=ee.sent,le.code==0&&P(function(xe){return xe.map(function(ue){return K()(K()({},ue),{},{active:ue.agent_id==F.agent_id?oe:ue.active})})});case 11:case"end":return ee.stop()}},v)}));return function(F){return y.apply(this,arguments)}}(),q=function(v){return v.length>6?v.length=6:v.lenth,v},pe=function(v){v.type=="my_agent"?Y.history.push("/Agents?app_id=".concat(v.app_id,"&type=false&from=chat_room")):Y.history.push("/ReadOnlyAgent?app_id=".concat(v.app_id,"&type=true&from=chat_room"))},ie=function(v){Y.history.replace("/chat_room/".concat(v.chatroom_id)),window.location.reload()},me=function(){M(!0)},se=function(){M(!1)},ye=function(){var y=re()(I()().mark(function v(F){var oe,$,le;return I()().wrap(function(ee){for(;;)switch(ee.prev=ee.next){case 0:if(!(F.checkItem&&F.checkItem.length==0)){ee.next=3;break}return m.open({type:"error",content:r.formatMessage({id:"app.chatroom.content.addAgentTips_fail"}),duration:2}),ee.abrupt("return");case 3:return oe=ce()(F.checkItem).map(function(xe){var ue=xe.agent_id,_e=xe.active,Be=_e===void 0?1:_e;return{agent_id:ue,active:Be}}),$={description:p.description,name:p.name,max_round:p.max_round},ee.next=7,(0,fe.sI)(K()(K()({},$),{},{agent:oe}),f);case 7:le=ee.sent,le.code==0?(F.checkItem.map(function(xe){xe.active=xe.active==null?1:xe.active}),P(ce()(F.checkItem)),h.current=ce()(F.checkItem),m.open({type:"success",content:r.formatMessage({id:"app.chatroom.content.addAgentTips"}),duration:2})):m.open({type:"error",content:r.formatMessage({id:"app.chatroom.content.addAgentTips_fail"}),duration:2});case 9:case"end":return ee.stop()}},v)}));return function(F){return y.apply(this,arguments)}}(),he=function(){var y=re()(I()().mark(function v(){var F;return I()().wrap(function($){for(;;)switch($.prev=$.next){case 0:return F=p.smart_selection==1?0:1,$.next=3,(0,fe.r5)({smart_selection:F},f);case 3:T(function(le){return K()(K()({},le),{},{smart_selection:F})});case 4:case"end":return $.stop()}},v)}));return function(){return y.apply(this,arguments)}}();return(0,a.useEffect)(function(){N(),X()},[]),(0,e.jsxs)(e.Fragment,{children:[_,(0,e.jsxs)("div",{className:"h-full w-[320px] bg-[#fff] shrink-0",style:{boxShadow:"0px 2px 4px 0px rgba(0,0,0,0.1)"},id:"sider",children:[(0,e.jsxs)("div",{className:"flex flex-col  h-full",children:[(0,e.jsx)("div",{className:"w-full flex  justify-start px-[30px]",children:(0,e.jsxs)("div",{className:"py-[20px] text-[14px] text-[#213044] font-[500] flex gap-x-[10px] items-center w-full",children:[(0,e.jsxs)("div",{className:"cursor-pointer flex items-center shrink-0",onClick:function(){Y.history.go(-1)},children:[(0,e.jsx)(je.ZP,{type:"link",danger:!0,className:"p-0",children:(0,e.jsx)(Te.Z,{className:"text-[#1B64F3] w-[16px] h-[16px]"})}),(0,e.jsx)("span",{className:"ml-[5px] text-[#213044] text-sm",children:r.formatMessage({id:"app.chatroom.sidebar.return"})})]}),(0,e.jsx)("div",{className:"h-full flex items-center shrink-0",children:(0,e.jsx)("div",{className:"w-[1px] h-[13px] bg-[#ebebeb]"})}),(0,e.jsx)("div",{className:"flex-1 min-w-0 truncate",children:p.name})]})}),(0,e.jsx)("div",{className:"h-[360px]",children:(0,e.jsxs)("div",{className:"pb-[20px] border-b-[1px] px-[10px]",children:[(0,e.jsxs)("div",{className:"flex items-center cursor-pointer px-[20px]",children:[(0,e.jsx)("div",{className:"flex gap-x-[5px] flex-1",children:(0,e.jsx)("span",{className:"text-[#666] text-[14px]",children:r.formatMessage({id:"app.chatroom.sidebar.agent_title"})})}),(0,e.jsxs)("div",{className:"shrink-0 flex items-center",children:[(0,e.jsx)(Ze.Z,{className:"pr-[2px]",overlayStyle:{fontSize:"12px"},title:r.formatMessage({id:"app.chatroom.sidebar.chatroom_switch_tips"}),children:(0,e.jsx)($e.Z,{className:"cursor-pointer text-[#666] text-[12px]"})}),(0,e.jsx)("span",{className:"text-[12px] text-[#666] pr-[5px]",children:r.formatHTMLMessage({id:"app.chatroom_list.switch"})}),(0,e.jsx)(He.Z,{size:"small",defaultChecked:!0,className:"w-[28px]",checked:p.smart_selection==1,onChange:he,disabled:u})]})]}),(0,e.jsx)("div",{className:"py-[20px] pt-[10px]",children:(0,e.jsx)("div",{className:"h-[220px] overflow-y-auto px-[10px]",children:k.current?(0,e.jsx)("div",{className:"flex flex-col",children:t&&t.length>0?t.map(function(y){return(0,e.jsxs)("div",{className:"flex items-center gap-x-[5px] hover:bg-[#FAFAFA] transition p-[10px] slider_agent_box",children:[(0,e.jsxs)("div",{className:"flex gap-x-[15px] flex-1 min-w-[0]",children:[(0,e.jsx)("div",{className:"w-[40px] h-[40px] bg-[#F4F8F1] rounded-[6px] flex items-center justify-center shrink-0",children:(0,e.jsx)("img",{src:(0,ge.s9)("single",y.icon),alt:"",className:"w-[18px]  h-[18px]"})}),(0,e.jsxs)("div",{className:"flex flex-col gap-y-[5px] justify-center flex-1 min-w-[0]",children:[(0,e.jsx)("span",{className:"text-[#213044] text-[12px] font-[500] truncate w-full",children:y.name}),(0,e.jsx)("span",{className:"text-[#999999] text-[12px] truncate",children:y.description})]})]}),(0,e.jsxs)("div",{className:"shrink-0 flex gap-x-[15px] items-center",children:[(0,e.jsx)("div",{className:"edit cursor-pointer w-[20px] h-[20px] flex justify-center items-center opacity-0 transition",onClick:function(){pe(y)},children:(0,e.jsx)("img",{className:"w-[16px] h-[16px]",src:"/icons/edit_icon_1.svg"})}),(0,e.jsx)(He.Z,{size:"small",disabled:u,defaultChecked:!0,className:"w-[28px]",checked:y.active==1,onChange:function(){H(y)}})]})]},y.agent_id)}):(0,e.jsx)("div",{className:"w-full min-h-[220px] flex items-center justify-center",children:(0,e.jsx)(Me.Z,{image:Me.Z.PRESENTED_IMAGE_SIMPLE})})}):(0,e.jsx)("div",{className:"flex justify-center w-full h-full items-center",children:(0,e.jsx)(Ne.Z,{})})})}),(0,e.jsx)("div",{className:"px-[20px] ",children:(0,e.jsx)("div",{style:{border:"1px solid #1B64F3"},onClick:me,className:"w-full h-[30px] transition text-[#1B64F3] flex items-center justify-center cursor-pointer rounded-[6px] hover:text-[#fff] hover:bg-[#1B64F3]",children:(0,e.jsx)("span",{className:"text-[12px]",children:r.formatMessage({id:"app.chatroom.add.agent"})})})}),(0,e.jsx)("div",{className:"px-[20px] pt-[15px]",children:(0,e.jsx)("div",{style:S&&!u?{border:"1px solid #1B64F3"}:{background:"#d9d9d9",color:"rgba(0,0,0,0.25)",cursor:"not-allowed"},onClick:(0,Ee.throttle)(function(){S&&!u&&C()}),className:"w-full h-[30px] transition text-[#1B64F3] flex items-center justify-center cursor-pointer rounded-[6px] hover:text-[#fff] hover:bg-[#1B64F3]",children:(0,e.jsx)("span",{className:"text-[12px]",children:r.formatMessage({id:"app.chatroom.sidebar.agent_button"})})})})]})}),(0,e.jsxs)("div",{className:"flex-1 min-h-[0] flex flex-col",children:[(0,e.jsx)("div",{className:"pt-[30px] px-[30px] text-[#666] text-[14px] shrink-0",children:r.formatMessage({id:"app.chatroom.sidebar.othe_title"})}),(0,e.jsx)("div",{className:"px-[10px] flex-1 min-h-[0] py-[10px]",children:(0,e.jsx)("div",{style:{height:"calc(100% - 20px)"},className:"px-[10px]  overflow-y-auto",children:A.current?(0,e.jsx)("div",{className:"h-full flex flex-col",children:U&&U.length>0?U.map(function(y){return(0,e.jsxs)("div",{className:"w-full transition hover:bg-[#FAFAFA] p-[10px] cursor-pointer",onClick:function(){ie(y)},children:[(0,e.jsxs)("div",{className:"flex pb-[10px]",children:[(0,e.jsx)("div",{className:"flex-1 min-w-[0] truncate text-[#333] text-[14px]",children:y.name}),y.active==0?(0,e.jsxs)("div",{className:"flex items-center gap-x-[6px]",children:[(0,e.jsx)("img",{className:"w-[12px] h-[12px]",src:"/icons/plaza_m2_c2.svg",alt:""}),(0,e.jsx)("span",{className:"text-[12px] text-[#aaa]",children:r.formatMessage({id:"app.chatroom.sidebar.othe_status"})})]}):(0,e.jsxs)("div",{className:"flex items-center gap-x-[6px]",children:[(0,e.jsx)("img",{className:"w-[12px] h-[12px]",src:"/icons/plaza_m2_c1.svg",alt:""}),(0,e.jsx)("span",{className:"text-[12px] text-[#aaa]",children:r.formatMessage({id:"app.chatroom.sidebar.othe_status_succeed"})})]})]}),(0,e.jsx)("div",{className:"flex gap-x-[10px]",children:y.agent_list&&y.agent_list.length>0?(0,e.jsxs)(e.Fragment,{children:[q(y.agent_list).map(function(v,F){return(0,e.jsx)("div",{className:"flex",children:(0,e.jsx)("div",{className:"w-[30px] h-[30px] bg-[#F4F8F1] rounded-[6px] flex items-center justify-center",children:(0,e.jsx)("img",{src:(0,ge.s9)("single",v.icon),alt:"",className:"w-[18px]  h-[18px]"})})},F)}),y.agent_list.length>=6?(0,e.jsx)(Le.Z,{}):(0,e.jsx)(e.Fragment,{})]}):(0,e.jsx)(e.Fragment,{})})]},y.chatroom_id)}):(0,e.jsx)("div",{className:"w-full h-full",children:(0,e.jsx)(Me.Z,{image:Me.Z.PRESENTED_IMAGE_SIMPLE})})}):(0,e.jsx)("div",{className:"flex justify-center w-full h-full items-center",children:(0,e.jsx)(Ne.Z,{})})})})]})]}),(0,e.jsx)(Oe.Z,{show:g,popupClose:se,popupSave:ye,checkList:t,zIndex:99})]})]})},xt=(0,a.memo)(pt),ft=l(13769),mt=l.n(ft),vt=l(47635),de=l(1413),ht={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M862 465.3h-81c-4.6 0-9 2-12.1 5.5L550 723.1V160c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v563.1L255.1 470.8c-3-3.5-7.4-5.5-12.1-5.5h-81c-6.8 0-10.5 8.1-6 13.2L487.9 861a31.96 31.96 0 0048.3 0L868 478.5c4.5-5.2.8-13.2-6-13.2z"}}]},name:"arrow-down",theme:"outlined"},gt=ht,ke=l(91146),jt=function(n,r){return a.createElement(ke.Z,(0,de.Z)((0,de.Z)({},n),{},{ref:r,icon:gt}))},yt=a.forwardRef(jt),St=yt,Nt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372zm-88-532h-48c-4.4 0-8 3.6-8 8v304c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V360c0-4.4-3.6-8-8-8zm224 0h-48c-4.4 0-8 3.6-8 8v304c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V360c0-4.4-3.6-8-8-8z"}}]},name:"pause-circle",theme:"outlined"},wt=Nt,bt=function(n,r){return a.createElement(ke.Z,(0,de.Z)((0,de.Z)({},n),{},{ref:r,icon:wt}))},_t=a.forwardRef(bt),Ct=_t,Rt=l(2068),Mt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M312.1 591.5c3.1 3.1 8.2 3.1 11.3 0l101.8-101.8 86.1 86.2c3.1 3.1 8.2 3.1 11.3 0l226.3-226.5c3.1-3.1 3.1-8.2 0-11.3l-36.8-36.8a8.03 8.03 0 00-11.3 0L517 485.3l-86.1-86.2a8.03 8.03 0 00-11.3 0L275.3 543.4a8.03 8.03 0 000 11.3l36.8 36.8z"}},{tag:"path",attrs:{d:"M904 160H548V96c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v64H120c-17.7 0-32 14.3-32 32v520c0 17.7 14.3 32 32 32h356.4v32L311.6 884.1a7.92 7.92 0 00-2.3 11l30.3 47.2v.1c2.4 3.7 7.4 4.7 11.1 2.3L512 838.9l161.3 105.8c3.7 2.4 8.7 1.4 11.1-2.3v-.1l30.3-47.2a8 8 0 00-2.3-11L548 776.3V744h356c17.7 0 32-14.3 32-32V192c0-17.7-14.3-32-32-32zm-40 512H160V232h704v440z"}}]},name:"fund-projection-screen",theme:"outlined"},Ft=Mt,kt=function(n,r){return a.createElement(ke.Z,(0,de.Z)((0,de.Z)({},n),{},{ref:r,icon:Ft}))},Dt=a.forwardRef(kt),It=Dt,nt=l(26915),At=l(20640),rt=l.n(At),we=l(22683),be=l(97807),Et=["node","className","children"],Ot=nt.Z.TextArea,Pt=(0,a.memo)(function(s){var n=s.setInstruction,r=s.messageApi,i=s.isStop,h=s.scrollDomRef,j=s.upButtonDom,o=(0,Y.useIntl)(),m=Q(function(O){return O.disableInput}),_=Q(function(O){return O.setDisableInput}),w=(0,a.useState)(""),f=c()(w,2),u=f[0],S=f[1],b=function(t){!t.shiftKey&&t.target.value==""&&(r.open({type:"warning",content:o.formatMessage({id:"app.chatroom.content.input"}),duration:10}),S(""),t.preventDefault()),!t.shiftKey&&t.keyCode==13&&t.target.value!=""&&(_(!0),S(""),n(["INPUT",t.target.value]),t.preventDefault())},R=(0,Ee.throttle)(function(){n(["STOP",null])},300);return(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)("div",{className:"max-w-[920px] w-full min-h-[60px] mt-[20px] mb-[20px] mx-auto relative",children:[(0,e.jsx)("div",{ref:j,className:"w-[40px] h-[40px] rounded-[6px]  bg-[#fff] border border-[#ddd] cursor-pointer absolute top-[-67px] left-2/4 flex items-center justify-center hidden",onClick:function(t){h.current.scrollTo({top:h.current.scrollHeight,behavior:"smooth"})},children:(0,e.jsx)(St,{className:"text-[16px]"})}),(0,e.jsxs)("div",{className:"flex items-center p-[12px] gap-[10px] box-border border border-[#ccc] bg-[#fff] rounded-[8px]",children:[(0,e.jsx)(Ot,{id:"userValue",className:"placeholder-text-[#aaa] placeholder-text-[14px]",autoSize:{minRows:1,maxRows:6},value:u,disabled:m,onChange:function(t){S(t.target.value)},onPressEnter:b,style:{height:"34px",border:"none",resize:"none",backgroundColor:"transparent"},placeholder:"".concat(o.formatMessage({id:"app.chatroom.content.input"}),"\u2026")}),i?(0,e.jsx)("div",{className:"min-w-[34px] h-[34px] bg-[#000] flex items-center justify-center cursor-pointer rounded-[4px]",onClick:R,children:(0,e.jsx)(Ct,{style:{color:"#fff",fontSize:"20px"}})}):(0,e.jsx)("div",{className:"".concat(m||!u?"bg-[#ddd]":"bg-[#1B64F3]"," min-w-[30px] h-[30px]  flex items-center justify-center cursor-pointer rounded-[6px]"),onClick:(0,Ee.throttle)(function(){if(m||!u)return!1;u||r.open({type:"warning",content:o.formatMessage({id:"app.chatroom.content.input"}),duration:10}),_(!0),n(["INPUT",u]),S("")},300),children:(0,e.jsx)("img",{src:"/icons/send_icon_w.svg",alt:"",className:"w-[18px] h-[18px]"})})]})]})})}),Tt=function s(n){return typeof n=="string"?n:Array.isArray(n)?n.map(s).join(""):a.isValidElement(n)?s(n.props.children):""},$t=function(n){return Tt(n)},Ye=function(n,r){return{code:function(h){var j=h.node,o=h.className,m=h.children,_=mt()(h,Et),w=/language-(\w+)/.exec(o||"");if(w!=null&&w.length){var f=Math.random().toString(36).substr(2,9);return(0,e.jsxs)("div",{className:" rounded-md border overflow-hidden",children:[(0,e.jsxs)("div",{className:"flex h-12 items-center justify-between bg-zinc-100 px-4 bg-zinc-900",children:[(0,e.jsx)("div",{className:"flex items-center gap-2",children:(0,e.jsx)("p",{className:"text-sm  text-[#fff] mb-[0]",children:w[1]})}),(0,e.jsxs)("div",{className:"text-[12px] text-[#fff] mb-[0] cursor-pointer flex gap-x-[5px]",onClick:function(){var u=re()(I()().mark(function S(b){var R;return I()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,R=b.currentTarget,t.next=4,rt()($t(m));case 4:R&&(R.children[1].innerText=r.formatMessage({id:"app.chatroom.content.copySucceed"})),setTimeout(function(){R&&(R.children[1].innerText=r.formatMessage({id:"app.chatroom.content.copycode"}))},200),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),console.error("Failed to copy text: ",t.t0);case 11:case"end":return t.stop()}},S,null,[[0,8]])}));return function(S){return u.apply(this,arguments)}}(),children:[(0,e.jsx)("img",{src:"/icons/chat_copy_w.svg"}),(0,e.jsx)("span",{children:r.formatMessage({id:"app.chatroom.content.copycode"})})]})]}),(0,e.jsx)("div",{className:"overflow-x-auto bg-[#282c34] text-[#abb2bf]",children:(0,e.jsx)("div",{id:"".concat(f).concat(n),className:"p-4",children:m})})]})}else return(0,e.jsx)("code",K()(K()({},_),{},{children:m}))}}},st=(0,a.memo)(function(s){var n=s.messageApi,r=s.index,i=s.idName,h=s.cidName,j=(0,Y.useIntl)(),o=(0,a.useState)(!1),m=c()(o,2),_=m[0],w=m[1];return(0,e.jsx)("div",{className:"flex gap-x-[4px]",children:(0,e.jsxs)("div",{onMouseEnter:function(){w(!0)},onMouseLeave:function(){w(!1)},className:" p-[2px] cursor-pointer rounded-md flex gap-x-[5px] items-center pt-[10px]",onClick:function(){var f=re()(I()().mark(function u(S){var b,R;return I()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return b=S.target.closest("#".concat(i).concat(r)),R=b.querySelector("#".concat(h).concat(r)),t.prev=2,t.next=5,rt()(R.innerText);case 5:n.open({type:"success",content:j.formatMessage({id:"app.chatroom.content.copySucceed"}),duration:2}),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(2),console.error("Failed to copy text: ",t.t0);case 11:case"end":return t.stop()}},u,null,[[2,8]])}));return function(u){return f.apply(this,arguments)}}(),children:[(0,e.jsx)("img",{src:"".concat(_?"/icons/chat_copy_check.svg":"/icons/chat_copy.svg"),className:"w-[16px] h-[16px]"}),(0,e.jsx)("span",{className:"text-[12px] ".concat(_?" text-[#1B64F3]":"text-[#666]"),children:j.formatMessage({id:"app.chatroom.content.copy"})})]})})}),it=function(n){var r=n.id,i=n.index,h=n.idName,j=n.cidName,o=(0,Y.useIntl)(),m=Q(function(R){return R.setSummaryClick}),_=(0,a.useState)(!0),w=c()(_,2),f=w[0],u=w[1],S=Q(function(R){return R.summaryClick});(0,a.useEffect)(function(){u(S)},[S]);var b=Q(function(R){return R.setSummaryParams});return(0,e.jsx)("div",{className:"flex gap-x-[4px] text-[#666] ".concat(f?"cursor-pointer hover:text-[#1B64F3]":"cursor-no-drop"),children:(0,e.jsxs)("div",{className:" p-[2px]  rounded-md flex gap-x-[5px] items-center pt-[10px]",onClick:function(O){if(f){var t=O.target.closest("#".concat(h).concat(i)),P=t.querySelector("#".concat(j).concat(i));b({id:r,message:P.innerText}),m(!1)}},children:[(0,e.jsx)(Rt.Z,{className:"text-[16px]"}),(0,e.jsx)("span",{className:"text-[12px]",children:o.formatMessage({id:"app.chatroom.content.summary"})})]})})},Lt=function(n){var r=n.roomid,i=(0,Y.useIntl)(),h=Q(function(u){return u.setSummaryClick}),j=(0,a.useState)(!0),o=c()(j,2),m=o[0],_=o[1],w=Q(function(u){return u.summaryClick});(0,a.useEffect)(function(){_(w)},[w]);var f=Q(function(u){return u.setSummaryParams});return(0,e.jsx)("div",{className:"bg-[#fff] text-[#999999]   items-center justify-center rounded-[8px] ".concat(m?"cursor-pointer hover:text-[#1B64F3]":"cursor-no-drop"),style:{boxShadow:"0px 0px 4px 0px rgba(0,0,0,0.1)"},children:(0,e.jsxs)("div",{className:" gap-x-[4px] flex items-center justify-center h-[40px] px-[20px]",onClick:function(){m&&(f({id:r}),h(!1))},children:[(0,e.jsx)(It,{className:"text-[16px]"}),(0,e.jsx)("span",{className:"text-[14px]",children:i.formatMessage({id:"app.chatroom.content.meetingSummary"})})]})})},Zt=(0,a.memo)(function(s){var n=s.messageApi,r=s.setCurrentMessageContent,i=s.sendValue,h=s.agentList,j=s.scrollDomRef,o=s.upButtonDom,m=s.setIsStop,_=s.setisEnd,w=s.setSendValue,f=(0,Y.useIntl)(),u=(0,Y.useParams)(),S=u.id,b=Q(function(k){return k.setDisableInput}),R=(0,a.useState)({}),O=c()(R,2),t=O[0],P=O[1],z=(0,a.useRef)(!1),Z=(0,a.useRef)(""),p=Q(function(k){return k.setTruncatable}),T=function(A){var x=A.data;if(x.indexOf("--NEXUSAI-INSTRUCTION-")!==-1){var D=JSON.parse(x.slice(22,-2));switch(D[0]){case"ERROR":b(!1),m(!1),w(""),n.open({type:"error",content:"webSocket-".concat(D[1]),duration:10});break;case"CHAT":var g={content:"".concat(D[1]),is_agent:0};r(function(N){return[].concat(ce()(N),[g])}),setTimeout(function(){j.current.scrollTop=j.current.scrollHeight,o.current.style.display="none"});break;case"STOPPABLE":m(D[1]);break;case"TRUNCATABLE":p(D[1]),D[1]||n.open({type:"success",content:"".concat(f.formatMessage({id:"app.chatroom.sidebar.cleartips"})),duration:3});break;case"TRUNCATEOK":n.open({type:"success",content:"".concat(f.formatMessage({id:"app.chatroom.sidebar.cleartips"})),duration:3});break}}if(x.indexOf("REPLY")!==-1&&x.indexOf("--NEXUSAI-INSTRUCTION-")!==-1){var M=JSON.parse(x.slice(22,-2))[1];Z.current="",z.current=!0;var C=h.current.filter(function(N){return N.agent_id==M})[0];Object.keys(t).length&&r(function(N){return[].concat(ce()(N),[t])}),P(function(N){return K()(K()({},N),{},{is_agent:1,icon:C==null?void 0:C.icon,name:C==null?void 0:C.name})}),m(!0),p(!1)}x.indexOf("--NEXUSAI-INSTRUCTION-")===-1&&z.current&&(j.current.scrollTop=j.current.scrollHeight,o.current.style.display="none",Z.current+=x,P(function(N){return K()(K()({},N),{},{content:Z.current})})),x.indexOf("ENDCHAT")!==-1&&(z.current=!1,Z.current="",b(!1),m(!1),p(!0),Object.keys(t).length&&r(function(N){return[].concat(ce()(N),[t])}),P({}),_(!0),w(""))},V=(0,vt.Z)("chat",T),J=V.runSocket,U=V.sendMessage,W=V.readyState;return(0,a.useEffect)(function(){W==1&&S&&U(JSON.stringify(["ENTER",parseInt(S)]))},[W]),(0,a.useEffect)(function(){i&&W==1&&U(i)},[i]),(0,a.useEffect)(function(){J()},[]),(0,e.jsx)(e.Fragment,{children:t.name?(0,e.jsxs)("div",{className:"w-full flex gap-[15px] pt-[15px] pb-[15px] ".concat(t.is_agent!=1?"flex-row-reverse":""),children:[(0,e.jsx)("div",{className:"w-[40px] h-[40px] bg-[#F4F8F1] rounded-[6px] flex items-center justify-center shrink-0",children:t.is_agent==1?(0,e.jsx)("img",{src:(0,ge.s9)("single",t.icon),alt:"",className:"w-[18px]  h-[18px]"}):(0,e.jsx)("img",{src:"/icons/user_header.svg",className:"w-[18px]  h-[18px]"})}),(0,e.jsxs)("div",{className:"flex1 max-w-[560px] text-right",id:"addcontent",children:[(0,e.jsx)("div",{className:"".concat(t.is_agent==1?"text-left":"text-right"," font-[500] text-[14px] text-[#213044] pb-[8px]"),children:t.name?t.name:(0,ge.Qy)("GET").nickname}),(0,e.jsx)("div",{className:"text-left inline-block markdown-container text-[14px] font-[400] text-[#213044] bg-[#F7F7F7] p-[15px] pb-[1px] leading-[22px]",style:t.is_agent==1?{borderRadius:" 0px 8px 8px 8px"}:{borderRadius:"8px 0px 8px 8px",background:"rgba(27,100,243,0.1)",whiteSpace:"pre-wrap"},id:"addchilContent",children:(0,e.jsx)(we.U,{rehypePlugins:[be.Z],components:Ye("add",f),children:t.content})})]})]}):(0,e.jsx)(e.Fragment,{})})}),Ht=(0,a.memo)(function(s){var n=s.messageApi,r=s.setUserMessage,i=s.sendValue,h=s.agentList,j=s.scrollDomRef,o=s.upButtonDom,m=s.setIsStop,_=s.setSendValue,w=(0,Y.useIntl)(),f=(0,a.useState)([]),u=c()(f,2),S=u[0],b=u[1],R=(0,a.useState)(!1),O=c()(R,2),t=O[0],P=O[1],z=(0,Y.useParams)(),Z=z.id;return(0,a.useEffect)(function(){t&&(r(function(p){return[].concat(ce()(p),ce()(S))}),b([]),setTimeout(function(){P(!1),j.current.scrollTop=j.current.scrollHeight},200))},[t]),(0,e.jsxs)(e.Fragment,{children:[S.length?S.map(function(p,T){return(0,e.jsxs)("div",{className:"w-full flex gap-[15px] pt-[15px] pb-[15px] ".concat(p.is_agent!=1?"flex-row-reverse":""),children:[(0,e.jsx)("div",{className:"w-[40px] h-[40px] bg-[#F4F8F1] rounded-[6px] flex items-center justify-center shrink-0",children:p.is_agent==1?(0,e.jsx)("img",{src:(0,ge.s9)("single",p.icon),alt:"",className:"w-[18px]  h-[18px]"}):(0,e.jsx)("img",{src:"/icons/user_header.svg",className:"w-[18px]  h-[18px]"})}),(0,e.jsxs)("div",{className:"flex1 max-w-[560px] text-right",id:"currentContent".concat(T),children:[(0,e.jsx)("div",{className:"".concat(p.is_agent==1?"text-left":"text-right"," font-[500] text-[14px] text-[#213044] pb-[8px]"),children:p.name?p.name:(0,ge.Qy)("GET").nickname}),(0,e.jsx)("div",{className:"text-left inline-block markdown-container text-[14px] font-[400] text-[#213044] bg-[#F7F7F7] p-[15px] pb-[1px] leading-[22px]",style:p.is_agent==1?{borderRadius:" 0px 8px 8px 8px"}:{borderRadius:"8px 0px 8px 8px",background:"rgba(27,100,243,0.1)",whiteSpace:"pre-wrap"},id:"currentChilContent".concat(T),children:(0,e.jsx)(we.U,{rehypePlugins:[be.Z],components:Ye(T,w),children:p.content})}),p.is_agent==1?(0,e.jsxs)("div",{className:"flex gap-x-[20px]",children:[(0,e.jsx)(st,{messageApi:n,index:T,idName:"currentContent",cidName:"currentChilContent"}),(0,e.jsx)(it,{id:Z,index:T,idName:"currentContent",cidName:"currentChilContent"})]}):(0,e.jsx)(e.Fragment,{})]})]},T)}):(0,e.jsx)(e.Fragment,{}),(0,e.jsx)(Zt,{messageApi:n,setCurrentMessageContent:b,sendValue:i,agentList:h,scrollDomRef:j,upButtonDom:o,setIsStop:m,setisEnd:P,setSendValue:_})]})}),Bt=(0,a.memo)(function(s){var n=s.messageApi,r=s.scrollDomRef,i=s.instruction,h=s.setIsStop,j=s.upButtonDom,o=s.setInstruction,m=s.agentList,_=(0,Y.useIntl)(),w=(0,Y.useParams)(),f=w.id,u=(0,a.useState)([]),S=c()(u,2),b=S[0],R=S[1],O=(0,a.useRef)(!1),t=(0,a.useState)(""),P=c()(t,2),z=P[0],Z=P[1],p=(0,a.useRef)(null),T=(0,a.useRef)(null),V=(0,a.useRef)(!0),J=(0,a.useRef)(2),U=(0,a.useRef)(1),W=(0,a.useRef)(0),k=function(){var M=re()(I()().mark(function C(N){var X,H,q=arguments;return I()().wrap(function(ie){for(;;)switch(ie.prev=ie.next){case 0:if(X=q.length>1&&q[1]!==void 0?q[1]:function(){},!f){ie.next=6;break}return ie.next=4,(0,fe.KH)(f,{page:U.current,page_size:20});case 4:H=ie.sent,H.code==0&&(J.current=H.data.total_pages,R(function(me){return N?ce()(H.data.list):[].concat(ce()(H.data.list),ce()(me))}),N?setTimeout(function(){r.current.scrollTop=r.current.scrollHeight,j.current.style.display="none"}):W.current=H.data.list.length);case 6:case"end":return ie.stop()}},C)}));return function(N){return M.apply(this,arguments)}}(),A=function(C){var N=C.target.scrollHeight-C.target.scrollTop-C.target.clientHeight;if(O.current!==Math.ceil(N)>50&&(O.current=Math.ceil(N)>50,j.current.style.display=O.current?"flex":"none"),C.target.scrollTop==0&&V.current){V.current=!1;var X=p.current.firstChild;U.current=U.current+1,T.current.style.display="flex",J.current,J.current>=U.current?k(!1):T.current.style.display="none"}},x=function(C,N){N==="0"&&(N=Number(N));var X=["".concat(C),N===0||N?N:null];Z(JSON.stringify(X))},D=Q(function(M){return M.disableInput}),g=Q(function(M){return M.clearMemory});return(0,a.useEffect)(function(){g&&g.length&&x(g[0],g[1])},[g]),(0,a.useEffect)(function(){i&&i.length&&(x(i[0],i[1]?i[1]:""),o([]))},[i]),(0,a.useEffect)(function(){W.current&&p.current.children[W.current]&&(r.current.scrollTop=p.current.children[W.current].offsetTop,V.current=!0)},[b]),(0,a.useEffect)(function(){U.current=1,k(!0)},[]),(0,e.jsxs)("div",{className:"flex-1 box-border relative overflow-y-auto chatroom overflow-x-hidden",ref:r,onScroll:A,children:[(0,e.jsx)("div",{className:"text-center justify-center items-center flex",style:{display:"none"},ref:T,children:(0,e.jsx)(Ne.Z,{})}),(0,e.jsxs)("div",{className:"max-w-[920px] mx-auto",style:{minHeight:"calc(100% - 50px)"},ref:p,children:[b.map(function(M,C){return(0,e.jsxs)("div",{id:"c".concat(M.id),className:"w-full flex gap-[15px] pt-[15px] pb-[15px] ".concat(M.is_agent!=1?"flex-row-reverse":""),children:[(0,e.jsx)("div",{className:"w-[40px] h-[40px] bg-[#F4F8F1] rounded-[6px] flex items-center justify-center shrink-0",children:M.is_agent==1?(0,e.jsx)("img",{src:(0,ge.s9)("single",M.icon),alt:"",className:"w-[18px]  h-[18px]"}):(0,e.jsx)("img",{src:"/icons/user_header.svg",className:"w-[18px]  h-[18px]"})}),(0,e.jsxs)("div",{className:"flex1 max-w-[560px] text-right",id:"content".concat(C),children:[(0,e.jsx)("div",{className:"".concat(M.is_agent==1?"text-left":"text-right"," font-[500] text-[14px] text-[#213044] pb-[8px]"),children:M.name?M.name:(0,ge.Qy)("GET").nickname}),(0,e.jsx)("div",{className:"text-left markdown-container inline-block text-[14px] font-[400] text-[#213044] bg-[#F7F7F7] p-[15px] pb-[1px] leading-[22px]",style:M.is_agent==1?{borderRadius:" 0px 8px 8px 8px"}:{borderRadius:"8px 0px 8px 8px",background:"rgba(27,100,243,0.1)",whiteSpace:"pre-wrap"},id:"chilContent".concat(C),children:(0,e.jsx)(we.U,{rehypePlugins:[be.Z],components:Ye(C,_),children:M.content})}),M.is_agent==1?(0,e.jsxs)("div",{className:"flex gap-x-[20px]",children:[(0,e.jsx)(st,{messageApi:n,idName:"content",cidName:"chilContent",index:C}),(0,e.jsx)(it,{id:f,index:C,idName:"content",cidName:"chilContent"})]}):(0,e.jsx)(e.Fragment,{})]})]},C)}),(0,e.jsx)(Ht,{messageApi:n,setUserMessage:R,sendValue:z,agentList:m,scrollDomRef:r,upButtonDom:j,setIsStop:h,setSendValue:Z})]}),(0,e.jsx)("div",{className:"w-full flex justify-center pb-[10px]",children:!D&&b.length?(0,e.jsx)(Lt,{roomid:f}):(0,e.jsx)(e.Fragment,{})})]})}),zt=(0,a.memo)(function(s){var n=s.agentList,r=(0,a.useRef)(null),i=(0,a.useRef)(null),h=(0,a.useState)(!1),j=c()(h,2),o=j[0],m=j[1],_=(0,a.useState)([]),w=c()(_,2),f=w[0],u=w[1],S=Ae.ZP.useMessage(),b=c()(S,2),R=b[0],O=b[1];return(0,e.jsxs)(e.Fragment,{children:[O,(0,e.jsx)("div",{className:"mx-[44px] flex justify-center relative box-border pt-[12px]   overflow-auto",style:{height:"calc(100% )"},children:(0,e.jsxs)("div",{className:"flex flex-col w-full",children:[(0,e.jsx)(Bt,{instruction:f,setInstruction:u,messageApi:R,scrollDomRef:r,setIsStop:m,upButtonDom:i,agentList:n}),(0,e.jsx)(Pt,{setInstruction:u,messageApi:R,isStop:o,upButtonDom:i,scrollDomRef:r})]})})]})}),Vt=l(42881),Ut=function(n){var r=n.children,i=n.className,h=i===void 0?"":i,j=n.dragDirection,o=j===void 0?"left":j,m=n.minWidth,_=m===void 0?415:m,w=n.maxWidth,f=w===void 0?820:w,u=n.minHeight,S=u===void 0?200:u,b=n.maxHeight,R=b===void 0?800:b,O=n.defaultWidth,t=O===void 0?415:O,P=n.defaultHeight,z=P===void 0?300:P,Z=(0,a.useState)(t),p=c()(Z,2),T=p[0],V=p[1],J=(0,a.useState)(z),U=c()(J,2),W=U[0],k=U[1],A=(0,a.useCallback)(function(M,C){V(M),C&&k(C)},[V,k]),x=(0,Vt.W)({direction:["left","right"].includes(o)?"horizontal":"vertical",triggerDirection:o,minWidth:_,maxWidth:f,minHeight:S,maxHeight:R,onResize:A}),D=x.triggerRef,g=x.containerRef;return(0,e.jsxs)("div",{ref:g,style:{width:["left","right"].includes(o)?"".concat(T,"px"):void 0,height:["top","bottom"].includes(o)?"".concat(W,"px"):void 0},className:"flex flex-col p-4 shadow-lg rounded-md border border-blue-300 bg-white z-10 wrapPanel ".concat(h),children:[o==="left"&&(0,e.jsx)("div",{ref:D,className:"absolute top-1/2 -translate-y-1/2 -left-2 w-3 h-6 cursor-col-resize resize-x",children:(0,e.jsx)("div",{className:"w-1 h-6 bg-gray-300 rounded-sm"})}),o==="right"&&(0,e.jsx)("div",{ref:D,className:"absolute top-1/2 -translate-y-1/2 -right-2 flex justify-end w-3 h-6 cursor-col-resize resize-x",children:(0,e.jsx)("div",{className:"w-1 h-6 bg-gray-300 rounded-sm"})}),o==="top"&&(0,e.jsx)("div",{ref:D,className:"absolute left-1/2 -translate-x-1/2 -top-2 h-3 w-6 cursor-row-resize resize-y",children:(0,e.jsx)("div",{className:"h-1 w-6 bg-gray-300 rounded-sm"})}),o==="bottom"&&(0,e.jsx)("div",{ref:D,className:"absolute left-1/2 -translate-x-1/2 -bottom-2 h-3 w-6 cursor-row-resize resize-y",children:(0,e.jsx)("div",{className:"h-1 w-6 bg-gray-300 rounded-sm"})}),r]})},Wt=(0,a.memo)(Ut),Gt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M762 164h-64c-4.4 0-8 3.6-8 8v688c0 4.4 3.6 8 8 8h64c4.4 0 8-3.6 8-8V172c0-4.4-3.6-8-8-8zm-508 0v72.4c0 9.5 4.2 18.4 11.4 24.5L564.6 512 265.4 763.1c-7.2 6.1-11.4 15-11.4 24.5V860c0 6.8 7.9 10.5 13.1 6.1L689 512 267.1 157.9A7.95 7.95 0 00254 164z"}}]},name:"vertical-left",theme:"outlined"},Kt=Gt,Jt=function(n,r){return a.createElement(ke.Z,(0,de.Z)((0,de.Z)({},n),{},{ref:r,icon:Kt}))},Qt=a.forwardRef(Jt),Xt=Qt,Yt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M326 164h-64c-4.4 0-8 3.6-8 8v688c0 4.4 3.6 8 8 8h64c4.4 0 8-3.6 8-8V172c0-4.4-3.6-8-8-8zm444 72.4V164c0-6.8-7.9-10.5-13.1-6.1L335 512l421.9 354.1c5.2 4.4 13.1.7 13.1-6.1v-72.4c0-9.4-4.2-18.4-11.4-24.5L459.4 512l299.2-251.1c7.2-6.1 11.4-15.1 11.4-24.5z"}}]},name:"vertical-right",theme:"outlined"},qt=Yt,ea=function(n,r){return a.createElement(ke.Z,(0,de.Z)((0,de.Z)({},n),{},{ref:r,icon:qt}))},ta=a.forwardRef(ea),aa=ta,na=l(83159),ra=l(66309),lt=l(42237),sa={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M464 144H160c-8.8 0-16 7.2-16 16v304c0 8.8 7.2 16 16 16h304c8.8 0 16-7.2 16-16V160c0-8.8-7.2-16-16-16zm-52 268H212V212h200v200zm452-268H560c-8.8 0-16 7.2-16 16v304c0 8.8 7.2 16 16 16h304c8.8 0 16-7.2 16-16V160c0-8.8-7.2-16-16-16zm-52 268H612V212h200v200zm52 132H560c-8.8 0-16 7.2-16 16v304c0 8.8 7.2 16 16 16h304c8.8 0 16-7.2 16-16V560c0-8.8-7.2-16-16-16zm-52 268H612V612h200v200zM424 712H296V584c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v128H104c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h128v128c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V776h128c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8z"}}]},name:"appstore-add",theme:"outlined"},ia=sa,la=function(n,r){return a.createElement(ke.Z,(0,de.Z)((0,de.Z)({},n),{},{ref:r,icon:ia}))},ca=a.forwardRef(la),oa=ca,ua=l(93696),da=function(n,r){return a.createElement(ke.Z,(0,de.Z)((0,de.Z)({},n),{},{ref:r,icon:ua.Z}))},pa=a.forwardRef(da),xa=pa,qe=l(86),fa=l(34994),ma=l(4981),va=l(2216),ha=l(85877),ga=l(29432),ja=l(39944),ya=l(11551),et=l(29608),ct=l(55927),Sa=(0,a.memo)(function(s){var n=s.progressObj,r=function(){return parseFloat(n.elapsed_time).toFixed(6)},i=function(j){var o=new Date(j),m=o.getFullYear(),_=(o.getMonth()+1).toString().padStart(2,"0"),w=o.getDate().toString().padStart(2,"0"),f=o.getHours().toString().padStart(2,"0"),u=o.getMinutes().toString().padStart(2,"0"),S=o.getSeconds().toString().padStart(2,"0");return(0,e.jsx)(e.Fragment,{children:"".concat(m,".").concat(_,".").concat(w," ").concat(f,":").concat(u,":").concat(S)})};return(0,e.jsx)("div",{className:"inline-flex gap-x-4 justify-end max-w-[100%]",children:(0,e.jsxs)("div",{className:"inline-flex gap-x-[20px] max-w-[100%]",children:[(0,e.jsx)("div",{className:"truncate min-w-[70px]",children:n.created_time&&i(n.created_time)}),(0,e.jsx)("div",{className:"truncate",children:n.apps_name||n.app_name}),(0,e.jsxs)("div",{className:"flex items-center gap-x-[7px] truncate min-w-[50px]",children:[(0,e.jsx)("div",{className:"shrink-0 rounded-full ".concat(n.status==1?"bg-blue-600":n.status==2?"bg-green-500":"bg-red-500"),style:{width:"3px",height:"3px"}}),(0,e.jsxs)("div",{className:"truncate",children:[r(),"S"]})]})]})})}),Na=function(n){var r,i,h,j,o,m,_=(0,Y.useIntl)(),w=n.runid,f=n.id,u=n.setBoxLoading,S=n.scrollDom,b=n.setinputShow,R=(0,a.useState)(null),O=c()(R,2),t=O[0],P=O[1],z=(0,a.useState)(null),Z=c()(z,2),p=Z[0],T=Z[1],V=(0,a.useState)("agent"),J=c()(V,2),U=J[0],W=J[1],k=(0,a.useState)({type:"agent",checkItem:[],show:!1}),A=c()(k,2),x=A[0],D=A[1],g=(0,a.useState)([]),M=c()(g,2),C=M[0],N=M[1],X=(0,a.useState)(""),H=c()(X,2),q=H[0],pe=H[1],ie=(0,a.useState)(!1),me=c()(ie,2),se=me[0],ye=me[1],he=(0,a.useState)(null),y=c()(he,2),v=y[0],F=y[1],oe=(0,a.useState)(null),$=c()(oe,2),le=$[0],Se=$[1],ee=(0,a.useState)(""),xe=c()(ee,2),ue=xe[0],_e=xe[1],Be=(0,a.useRef)(""),De=(0,a.useRef)(null),Ie=(0,a.useRef)(""),ot=(0,a.useRef)(""),Ea=(0,et.Z)(function(L){return L.setDealtWithData}),Oa=(0,et.Z)(function(L){return L.setRunPanelLogRecord}),Pa=[{key:"1",label:(0,e.jsx)("div",{className:"hover:text-[#1B64F3]",onClick:function(){D(function(d){return K()(K()({},d),{},{type:"agent",show:!0})})},children:_.formatMessage({id:"app.summary.SelectAgent"})})},{key:"2",label:(0,e.jsx)("div",{className:"hover:text-[#1B64F3]",onClick:function(){D(function(d){return K()(K()({},d),{},{type:"workflow",show:!0})})},children:_.formatMessage({id:"app.summary.SelectWorkflow"})})}],Ta=function(){var L=re()(I()().mark(function d(E,ae){var B,ne;return I()().wrap(function(te){for(;;)switch(te.prev=te.next){case 0:return te.next=2,(0,fe.xT)(E,ae);case 2:B=te.sent,(B==null?void 0:B.code)==0&&(Ie.current=B==null||(ne=B.data)===null||ne===void 0?void 0:ne.app_run_id);case 4:case"end":return te.stop()}},d)}));return function(E,ae){return L.apply(this,arguments)}}(),$a=function(){var L=re()(I()().mark(function d(E,ae){var B,ne;return I()().wrap(function(te){for(;;)switch(te.prev=te.next){case 0:if(ae=="agent"){te.next=5;break}return te.next=3,(0,lt.zO)(E);case 3:B=te.sent,B.code==0&&T(B==null||(ne=B.data)===null||ne===void 0?void 0:ne.need_confirm_nodes);case 5:Ta(f,{app_id:E,app_run_id:w,status:1,corrected_parameter:""});case 6:case"end":return te.stop()}},d)}));return function(E,ae){return L.apply(this,arguments)}}(),La=function(){D(function(d){return K()(K()({},d),{},{show:!1})})},Za=function(d){u(!0),P(null),D(function(E){return K()(K()({},E),{},{checkItem:d.checkItem})}),W(x.type),$a(d.checkItem[0].app_id,x.type),Be.current=d.checkItem[0].app_id,setTimeout(function(){S.current.scrollTo({top:S.current.scrollHeight})},300)},Ha=function(d){return d.completed_progress?parseInt(d.completed_progress.slice(0,-1)):!1},Ba=function(d){ot.current=ut(d);var E={user:{value:ut(d)}};pe(new ja.z(E))},ut=function L(d){return d.map(function(E){return E.type==="mention"?E.id:E.children?L(E.children):E.text}).join("")},za=function(){var L=re()(I()().mark(function d(){var E,ae;return I()().wrap(function(ne){for(;;)switch(ne.prev=ne.next){case 0:E=Ce==null?void 0:Ce.filter(function(G){return G.type=="workflow_run_progress"&&G.data.app_run_id==Ie.current}).map(function(G){var te=G.data;return te}),E&&E.length&&(ae=E[E.length-1],F(ae),u(!1));case 2:case"end":return ne.stop()}},d)}));return function(){return L.apply(this,arguments)}}(),Va=function(){var L=re()(I()().mark(function d(){var E,ae,B,ne,G;return I()().wrap(function(ze){for(;;)switch(ze.prev=ze.next){case 0:ae=Ce==null?void 0:Ce.filter(function(ve){return ve.type=="workflow_need_human_confirm"&&ve.data.app_run_id==Ie.current}),B=(E=ae.map(function(ve){var Re=ve.data,tt=ve.need_human_confirm;return{data:Re,need_human_confirm:tt}}))===null||E===void 0?void 0:E.filter(function(ve){return ve.data.type!==1}),B&&B.length&&(G=B[B.length-1].data,G.exec_id=G==null||(ne=G.node_exec_data)===null||ne===void 0?void 0:ne.node_exec_id,Se(B[B.length-1]),u(!1));case 3:case"end":return ze.stop()}},d)}));return function(){return L.apply(this,arguments)}}(),Ua=function(){var L=re()(I()().mark(function d(E){var ae,B,ne,G,te;return I()().wrap(function(ve){for(;;)switch(ve.prev=ve.next){case 0:return u(!0),ae=Object.keys(E),B={},ae.forEach(function(Re){De.current.properties[Re]&&(De.current.properties[Re].value=E[Re]),p&&p.forEach(function(tt){tt.node_id==Re&&(B[Re]=E[Re])})}),ne={inputs:De.current,node_confirm_users:B,run_name:"chatroom-".concat(f,"-run-").concat(Ie.current,"-driven"),run_type:1,data_source_run_id:Ie.current},ve.next=7,(0,lt.UE)(Be.current,ne);case 7:G=ve.sent,G.code==0&&(Ie.current=G==null||(te=G.data)===null||te===void 0?void 0:te.app_run_id,ye(!0));case 9:case"end":return ve.stop()}},d)}));return function(E){return L.apply(this,arguments)}}(),Wa=function(){var L=re()(I()().mark(function d(E){var ae,B;return I()().wrap(function(G){for(;;)switch(G.prev=G.next){case 0:return console.log(q),u(!0),ae=Object.keys(E),ae.forEach(function(te){De.current.properties[te]&&(De.current.properties[te].value=E[te])}),G.next=6,(0,ya.LH)({agent_id:x.checkItem[0].agent_id,ability_id:0,input_dict:De.current,prompt:q,data_source_run_id:Ie.current});case 6:B=G.sent,B.code==0&&(_e(B.data.outputs_md),u(!1));case 8:case"end":return G.stop()}},d)}));return function(E){return L.apply(this,arguments)}}(),Ce=(0,ct.Z)(function(L){return L.flowMessage});return(0,a.useEffect)(function(){za(),Va();var L=Ce.filter(function(G){return G.data.app_run_id==w&&G.type.indexOf("generate_meeting_action_items")!==-1});if(L.length!=0){var d,E=(d=L[L.length-1])===null||d===void 0||(d=d.data)===null||d===void 0||(d=d.exec_data)===null||d===void 0||(d=d.outputs)===null||d===void 0?void 0:d.value;if(E){var ae=JSON.parse(E);De.current=ae;var B=Object.keys(ae.properties);if(B.length&&(P(ae.properties),U=="agent")){var ne=B.map(function(G){return{value:"<<".concat(ga.qX,".inputs.").concat(G,">>"),label:G}});N(ne)}b(!1),u(!1)}}},[Ce]),(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)("div",{className:"pt-[24px]  border-[#ddd]",style:{minHeight:x!=null&&(r=x.checkItem)!==null&&r!==void 0&&r.length?S==null||(i=S.current)===null||i===void 0?void 0:i.offsetHeight:"100%"},children:[(0,e.jsxs)("div",{className:"text-[14px] font-[500] flex item-center",children:[(0,e.jsx)("div",{className:"flex-1",children:_.formatMessage({id:"app.summary.Runapp"})}),(0,e.jsx)("div",{className:"px-[10px]",children:!se&&!ue?(0,e.jsx)(na.Z,{menu:{items:Pa},children:(0,e.jsx)(oa,{className:"transition cursor-pointer text-[#999] text-[18px] hover:text-[#1B64F3]"})}):(0,e.jsx)(e.Fragment,{})})]}),(0,e.jsx)("div",{children:x!=null&&(h=x.checkItem)!==null&&h!==void 0&&h.length?(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("div",{className:"py-[6px]",children:(0,e.jsx)(qe.Z,{icon:x==null||(j=x.checkItem[0])===null||j===void 0?void 0:j.icon,title:x==null||(o=x.checkItem[0])===null||o===void 0?void 0:o.name,textDetails:x==null||(m=x.checkItem[0])===null||m===void 0?void 0:m.description,iconType:U=="agent"?"robot_icon":"workflow_icon",handleClick:function(){}})}),!se&&t!=null?(0,e.jsxs)(fa.A,{submitter:{resetButtonProps:!1,submitButtonProps:{className:"w-full",disabled:!ot.current},searchConfig:{submitText:_.formatMessage({id:"workflow.button.run"})}},onFinish:function(d){U=="workflow"?Ua(d):Wa(d)},children:[(0,e.jsx)("div",{className:"py-[6px]",children:(0,e.jsx)(va._,{data:t})}),U=="workflow"?(0,e.jsx)(ma.e,{data:p}):(0,e.jsx)("div",{className:"h-[150px] overflow-y-auto border border-color-[#eee] py-[4px] px-[11px] mb-[8px]",children:(0,e.jsx)(ha.Z,{onChange:function(d){Ba(d)},options:C,placeholder:"\u8BF7\u8F93\u5165\u8FD0\u884C\u6307\u4EE4\uFF0C\u8F93\u5165@\u63D2\u5165\u53D8\u91CF"})})]}):(0,e.jsx)(e.Fragment,{}),ue?(0,e.jsx)("div",{className:"max-h-[400px] overflow-y-auto mt-[16px]",children:(0,e.jsx)("div",{className:"p-[12px]  bg-[#F7F7F7] leading-[22px]",children:(0,e.jsx)(we.U,{rehypePlugins:[be.Z],children:ue})})}):(0,e.jsx)(e.Fragment,{}),le&&le.need_human_confirm!=0?(0,e.jsx)("div",{className:"pt-[12px]",children:(0,e.jsxs)("div",{className:"flex gap-x-[6px] items-center h-[20px] cursor-pointer",onClick:function(){Ea(le.data)},children:[(0,e.jsx)("div",{children:(0,e.jsx)(xa,{className:"text-[#1B64F3] text-[16px]"})}),(0,e.jsx)("span",{children:_.formatMessage({id:"app.summary.backlogTips"})})]})}):(0,e.jsx)(e.Fragment,{}),v?(0,e.jsx)("div",{className:"pt-[10px]",children:(0,e.jsx)(qe.Z,{status:v.status,icon:v.icon,title:(0,e.jsxs)("div",{className:"items-center gap-x-[8px] inline-flex justify-end w-full",children:[(0,e.jsx)("span",{className:"flex-1 truncate",children:v.run_name}),v.need_human_confirm==1?(0,e.jsx)(ra.Z,{className:" text-[12px] flex items-center justify-center margin-0",color:"blue",children:_.formatMessage({id:"app.summaryhistory.tag"})}):(0,e.jsx)(e.Fragment,{})]}),textDetails:(0,e.jsx)(Sa,{progressObj:v}),handleClick:function(){Oa(v)},progress:Ha(v)})}):(0,e.jsx)(e.Fragment,{})]}):(0,e.jsxs)("div",{className:"flex gap-x-[20px] min-h-[70px] items-center px-[20px]",children:[(0,e.jsxs)(je.ZP,{className:"flex-1 text-[14px]",onClick:function(){D(function(d){return K()(K()({},d),{},{type:"agent",show:!0})})},children:[(0,e.jsx)("img",{src:"/icons/robot_icon.svg",alt:"",className:"w-[14px] h-[14px]"}),_.formatMessage({id:"app.summary.SelectAgent"})]}),(0,e.jsxs)(je.ZP,{className:"flex-1 text-[14px]",onClick:function(){D(function(d){return K()(K()({},d),{},{type:"workflow",show:!0})})},children:[(0,e.jsx)("img",{src:"/icons/workflow_icon.svg",alt:"",className:"w-[14px] h-[14px]"}),_.formatMessage({id:"app.summary.SelectWorkflow"})]})]})})]}),(0,e.jsx)(Oe.Z,{show:x.show,nodetype:x.type,popupClose:La,popupSave:Za,checkList:U==x.type?x.checkItem:[],zIndex:99,radio:!0})]})},wa=(0,a.memo)(Na),ba=function(n){var r=n.setShow,i=n.inputShow,h=n.setBoxLoading,j=n.setAppRunId,o=(0,Y.useIntl)(),m=(0,a.useState)(!1),_=c()(m,2),w=_[0],f=_[1],u=(0,a.useState)(""),S=c()(u,2),b=S[0],R=S[1],O=(0,a.useState)(""),t=c()(O,2),P=t[0],z=t[1],Z=(0,a.useRef)(""),p=(0,a.useRef)(""),T=Q(function(k){return k.setSummaryClick}),V=function(){var k=re()(I()().mark(function A(x){var D,g,M,C,N=arguments;return I()().wrap(function(H){for(;;)switch(H.prev=H.next){case 0:return D=N.length>1&&N[1]!==void 0?N[1]:{app_run_id:"",corrected_parameter:""},H.next=3,(0,fe.Rp)(x,D);case 3:g=H.sent,(g==null?void 0:g.code)==0&&(j(g==null||(M=g.data)===null||M===void 0?void 0:M.app_run_id),p.current=g==null||(C=g.data)===null||C===void 0?void 0:C.app_run_id);case 5:case"end":return H.stop()}},A)}));return function(x){return k.apply(this,arguments)}}(),J=function(){var k=re()(I()().mark(function A(x,D){var g,M,C,N,X;return I()().wrap(function(q){for(;;)switch(q.prev=q.next){case 0:return q.next=2,(0,fe.xM)(x,{message:D});case 2:g=q.sent,(g==null?void 0:g.code)==0&&(p.current=g==null||(M=g.data)===null||M===void 0?void 0:M.app_run_id,j(g==null||(C=g.data)===null||C===void 0?void 0:C.app_run_id),g!=null&&(N=g.data)!==null&&N!==void 0&&(N=N.outputs)!==null&&N!==void 0&&N.value&&(R(g==null||(X=g.data)===null||X===void 0||(X=X.outputs)===null||X===void 0?void 0:X.value),r(!0),h(!1),T(!0)));case 4:case"end":return q.stop()}},A)}));return function(x,D){return k.apply(this,arguments)}}(),U=(0,ct.Z)(function(k){return k.flowMessage});(0,a.useEffect)(function(){var k=U.filter(function(D){return D.data.app_run_id==p.current&&D.type.indexOf("generate_meeting_summary")!==-1});if(k.length!=0){var A,x=(A=k[k.length-1])===null||A===void 0||(A=A.data)===null||A===void 0||(A=A.exec_data)===null||A===void 0||(A=A.outputs)===null||A===void 0?void 0:A.value;x&&(R(x),r(!0),T(!0),h(!1))}},[U]);var W=Q(function(k){return k.summaryParams});return(0,a.useEffect)(function(){W&&W.id&&(Z.current=W.id,b&&R(""),f(!0),W.message?(h(!0),J(W.id,W.message)):V(W.id))},[W]),(0,e.jsx)(e.Fragment,{children:w?(0,e.jsxs)("div",{className:"pb-[16px]",children:[(0,e.jsx)("div",{className:"text-[16px] font-[600] pt-[12px]",children:o.formatMessage({id:"app.summary.title"})}),(0,e.jsx)("div",{className:"text-[14px] pt-[12px] leading-[23px] px-[8px]",children:b?(0,e.jsx)("div",{className:" ".concat("max-h-[400px]"," p-[12px]  bg-[#F7F7F7]  relative overflow-y-auto"),children:(0,e.jsx)(we.U,{rehypePlugins:[be.Z],children:b})}):(0,e.jsx)("div",{className:"min-h-[120px] flex items-center justify-center",children:(0,e.jsx)(Ne.Z,{size:"large"})})}),i?(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("div",{className:"pt-[12px]",children:(0,e.jsx)(nt.Z.TextArea,{onChange:function(A){z(A.target.value)},value:P,disabled:!b,rows:4,placeholder:o.formatMessage({id:"app.summary.placeholder"})})}),(0,e.jsx)("div",{className:"flex pt-[12px] gap-x-[4px]",children:(0,e.jsx)(je.ZP,{type:"primary",disabled:!b||!P,className:"bg-[#1B64F3] rounded-[4px] w-[88px] h-[40px] flex-1",onClick:function(){V(Z.current,{app_run_id:String(p.current),corrected_parameter:P}),h(!0),z(""),r("")},children:o.formatMessage({id:"app.summary.submitText"})})})]}):(0,e.jsx)(e.Fragment,{})]}):(0,e.jsx)(e.Fragment,{})})},_a=(0,a.memo)(ba),Ca=(0,a.memo)(function(s){var n=s.progressObj;console.log(n);var r=function(){return parseFloat(n.elapsed_time).toFixed(6)},i=function(j){var o=new Date(j),m=o.getFullYear(),_=(o.getMonth()+1).toString().padStart(2,"0"),w=o.getDate().toString().padStart(2,"0"),f=o.getHours().toString().padStart(2,"0"),u=o.getMinutes().toString().padStart(2,"0"),S=o.getSeconds().toString().padStart(2,"0");return(0,e.jsx)(e.Fragment,{children:"".concat(m,".").concat(_,".").concat(w," ").concat(f,":").concat(u,":").concat(S)})};return(0,e.jsx)("div",{className:"inline-flex gap-x-4 justify-end max-w-[100%]",children:(0,e.jsxs)("div",{className:"inline-flex gap-x-[20px] max-w-[100%]",children:[(0,e.jsx)("div",{className:"truncate min-w-[70px]",children:n.created_time&&i(n.created_time)}),(0,e.jsx)("div",{className:"truncate",children:n.apps_name||n.app_name}),(0,e.jsxs)("div",{className:"flex items-center gap-x-[7px] truncate min-w-[50px]",children:[(0,e.jsx)("div",{className:"shrink-0 rounded-full ".concat(n.status==1?"bg-blue-600":n.status==2?"bg-green-500":"bg-red-500"),style:{width:"3px",height:"3px"}}),(0,e.jsxs)("div",{className:"truncate",children:[r(),"S"]})]})]})})}),Ra=function(n){var r=n.list,i=n.scrollDom,h=(0,Y.useIntl)(),j=(0,a.useState)([]),o=c()(j,2),m=o[0],_=o[1],w=(0,a.useState)("100%"),f=c()(w,2),u=f[0],S=f[1],b=(0,et.Z)(function(t){return t.setRunPanelLogRecord}),R=function(P){var z=new Date(P),Z=z.getMonth()+1,p=z.getDate(),T=z.getHours(),V=z.getMinutes(),J=z.getSeconds();return z.getFullYear()+"-"+(Z<10?"0"+Z:Z)+"-"+(p<10?"0"+p:p)+" "+(T<10?"0"+T:T)+":"+(V<10?"0"+V:V)+":"+(J<10?"0"+J:J)},O=function(P){var z=Object.keys(P),Z=[];return z.forEach(function(p){Z.push(P[p])}),Z};return(0,a.useEffect)(function(){if(i){var t;S(i==null||(t=i.current)===null||t===void 0?void 0:t.offsetHeight)}},[i]),(0,a.useEffect)(function(){_(ce()(r.reverse()))},[r]),(0,e.jsx)(e.Fragment,{children:(0,e.jsx)("div",{className:"px-4",style:{minHeight:u},children:m&&m.length?m.map(function(t){var P,z,Z,p,T,V,J,U,W,k,A,x,D,g,M,C,N,X;return t!=null&&t.source_run&&t!==null&&t!==void 0&&t.source_run.summary?(0,e.jsx)("div",{className:"pt-[16px] border-b-[1px] border-color-[#eee] ",children:(0,e.jsxs)("div",{className:"pb-[60px]",children:[(0,e.jsx)("div",{className:"text-[16px] font-[600] pb-[8px] flex items-center",children:(0,e.jsx)("span",{className:"flex-1",children:h.formatMessage({id:"app.summary.title"})})}),(0,e.jsx)("p",{className:"text-[12px] color-[#eee] mb-[8px]",children:R(t==null||(P=t.source_run)===null||P===void 0?void 0:P.created_time)}),(0,e.jsx)("div",{className:"p-[12px]  leading-[22px] ".concat(t!=null&&t.source_corrections&&(t==null?void 0:t.source_corrections.length)>0?"bg-[#F7F7F7]":"bg-blue-100 rounded-[4px]"),children:(0,e.jsx)(we.U,{rehypePlugins:[be.Z],children:t==null||(z=t.source_run)===null||z===void 0?void 0:z.summary})}),t!=null&&t.source_corrections&&(t==null?void 0:t.source_corrections.length)>0?(0,e.jsxs)("div",{children:[(0,e.jsxs)("div",{className:"text-[16px] font-[600] py-[8px]",children:[h.formatMessage({id:"app.summaryhistory.orientation"}),":"]}),t==null?void 0:t.source_corrections.map(function(H){return(0,e.jsx)("div",{className:"last-of-type:bg-blue-100 rounded-[4px] bg-[#F7F7F7] mb-[16px]",children:(0,e.jsxs)("div",{className:"p-[12px]   leading-[22px]",children:[(0,e.jsxs)("div",{className:"tetx-[14px] font-[600] pb-[12px]",children:[h.formatMessage({id:"app.summaryhistory.userPrompt"}),": ",H.user_prompt]}),(0,e.jsxs)("div",{className:"tetx-[14px] font-[600] pb-[12px]",children:[h.formatMessage({id:"app.summaryhistory.time"}),": ",R(H.created_time)]}),(0,e.jsx)(we.U,{rehypePlugins:[be.Z],children:H==null?void 0:H.corrected_summary})]})},H.created_time)})]}):(0,e.jsx)(e.Fragment,{}),t!=null&&t.target_run?(0,e.jsxs)("div",{className:"py-[12px]",children:[(0,e.jsxs)("div",{className:"text-[16px] font-[600] py-[8px]",children:[h.formatMessage({id:"app.summaryhistory.runapp"}),":"]}),(0,e.jsx)("div",{children:(0,e.jsxs)("div",{className:"text-[14px] py-[6px]",children:[(0,e.jsx)("span",{className:"font-[500] ",children:t!=null&&(Z=t.target_run)!==null&&Z!==void 0&&Z.agent_id?"agent":"workflow"}),(0,e.jsx)("span",{className:"px-[6px]",children:":"}),(0,e.jsx)("span",{children:t==null||(p=t.target_run)===null||p===void 0||(p=p.app)===null||p===void 0?void 0:p.name})]})}),(0,e.jsx)("div",{children:t!=null&&(T=t.target_run)!==null&&T!==void 0&&(T=T.inputs)!==null&&T!==void 0&&T.properties?(0,e.jsxs)("div",{children:[(0,e.jsxs)("div",{className:"text-[16px] color-[#000] font-[600] py-[12px]",children:[h.formatMessage({id:"app.summaryhistory.input"}),":"]}),O(t==null||(V=t.target_run)===null||V===void 0||(V=V.inputs)===null||V===void 0?void 0:V.properties).map(function(H){return(0,e.jsxs)("div",{children:[(0,e.jsx)("div",{className:"pb-[8px] font-[600]",children:H.display_name||H.name}),(0,e.jsx)("div",{className:"py-[4px] px-[11px] text-[14px] leading-[1.5] h-[]",children:H.value})]})})]}):(0,e.jsx)(e.Fragment,{})}),(0,e.jsx)("div",{children:t!=null&&(J=t.target_run)!==null&&J!==void 0&&J.raw_user_prompt?(0,e.jsxs)("div",{children:[(0,e.jsxs)("div",{className:"text-[16px] color-[#000] font-[600] py-[12px] pb-[6px]",children:[h.formatMessage({id:"app.summaryhistory.prompt"}),":"]}),(0,e.jsx)("div",{className:"py-[4px] px-[11px] text-[14px] leading-[1.5] ",children:t==null||(U=t.target_run)===null||U===void 0?void 0:U.raw_user_prompt})]}):(0,e.jsx)(e.Fragment,{})}),(0,e.jsxs)("div",{children:[(0,e.jsxs)("div",{className:"text-[16px] font-[600] py-[8px]",children:[h.formatMessage({id:"app.summaryhistory.results"}),":"]}),(0,e.jsx)("div",{className:"p-[12px]  bg-[#F7F7F7]",children:(t==null||(W=t.target_run)===null||W===void 0?void 0:W.agent_id)!=0?(0,e.jsx)("div",{className:"p-[12px]  bg-[#F7F7F7] leading-[22px]",children:(0,e.jsx)(we.U,{rehypePlugins:[be.Z],children:t==null||(k=t.target_run)===null||k===void 0||(k=k.outputs)===null||k===void 0?void 0:k.value})}):(0,e.jsx)(qe.Z,{status:t==null||(A=t.target_run)===null||A===void 0?void 0:A.status,icon:t==null||(x=t.target_run)===null||x===void 0?void 0:x.icon,title:t==null||(D=t.target_run)===null||D===void 0?void 0:D.name,textDetails:(0,e.jsx)(Ca,{progressObj:{created_time:t==null||(g=t.target_run)===null||g===void 0?void 0:g.created_time,elapsed_time:t==null||(M=t.target_run)===null||M===void 0?void 0:M.elapsed_time,app_name:t==null||(C=t.target_run)===null||C===void 0?void 0:C.app.name,status:t==null||(N=t.target_run)===null||N===void 0?void 0:N.status}}),handleClick:function(){var q,pe,ie,me,se,ye,he,y,v,F;b({app_id:t==null||(q=t.target_run)===null||q===void 0||(q=q.app)===null||q===void 0?void 0:q.id,app_name:t==null||(pe=t.target_run)===null||pe===void 0||(pe=pe.app)===null||pe===void 0?void 0:pe.name,icon:t==null||(ie=t.target_run)===null||ie===void 0?void 0:ie.icon,workflow_id:t==null||(me=t.target_run)===null||me===void 0?void 0:me.workflow_id,type:2,app_run_id:t==null||(se=t.target_run)===null||se===void 0?void 0:se.id,run_name:t==null||(ye=t.target_run)===null||ye===void 0?void 0:ye.name,status:t==null||(he=t.target_run)===null||he===void 0?void 0:he.status,created_time:t==null||(y=t.target_run)===null||y===void 0?void 0:y.created_time,elapsed_time:t==null||(v=t.target_run)===null||v===void 0?void 0:v.elapsed_time,completed_progress:"".concat(t==null||(F=t.target_run)===null||F===void 0?void 0:F.percentage,"%")})},progress:t==null||(X=t.target_run)===null||X===void 0?void 0:X.percentage})})]})]}):(0,e.jsx)(e.Fragment,{})]})},t.source_run.id):(0,e.jsx)(e.Fragment,{})}):(0,e.jsx)(e.Fragment,{})})})},Ma=(0,a.memo)(Ra),Fa=function(n){var r,i=n.id,h=(0,a.useState)(""),j=c()(h,2),o=j[0],m=j[1],_=(0,a.useState)(!1),w=c()(_,2),f=w[0],u=w[1],S=(0,a.useState)([]),b=c()(S,2),R=b[0],O=b[1],t=(0,a.useState)(!1),P=c()(t,2),z=P[0],Z=P[1],p=(0,a.useState)(!1),T=c()(p,2),V=T[0],J=T[1],U=(0,a.useState)(""),W=c()(U,2),k=W[0],A=W[1],x=(0,a.useState)(!1),D=c()(x,2),g=D[0],M=D[1],C=(0,a.useState)(!1),N=c()(C,2),X=N[0],H=N[1],q=(0,a.useState)(!0),pe=c()(q,2),ie=pe[0],me=pe[1],se=(0,a.useRef)(null),ye=function(){var v=re()(I()().mark(function F(){var oe,$,le,Se,ee=arguments;return I()().wrap(function(ue){for(;;)switch(ue.prev=ue.next){case 0:return oe=ee.length>0&&ee[0]!==void 0?ee[0]:!0,ue.next=3,(0,fe.sh)({chatroom_id:i,page:1,page_size:9999});case 3:$=ue.sent,$.code==0&&($!=null&&(le=$.data)!==null&&le!==void 0&&le.list&&$!==null&&$!==void 0&&(Se=$.data)!==null&&Se!==void 0&&(Se=Se.list)!==null&&Se!==void 0&&Se.length&&(O($.data.list),u(!0)),oe||(setTimeout(function(){var _e;se==null||(_e=se.current)===null||_e===void 0||_e.scrollTo({top:se.current.scrollHeight})},200),m(he.id),y({})));case 5:case"end":return ue.stop()}},F)}));return function(){return v.apply(this,arguments)}}();(0,a.useEffect)(function(){ye()},[i]);var he=Q(function(v){return v.summaryParams}),y=Q(function(v){return v.setSummaryParams});return(0,a.useEffect)(function(){he&&he.id&&(u(!0),ie||me(!0),z&&Z(!1),g&&M(!1),J(!0),ye(!1))},[he]),(0,a.useEffect)(function(){console.log(X)},[X]),(0,e.jsx)(e.Fragment,{children:f?(0,e.jsxs)(Wt,{minWidth:400,className:"relative h-full right-0 border-0 returned-0 px-[0] ".concat(g?"translate-x-full flex-[0]":""),children:[X?(0,e.jsx)("div",{className:"h-full w-full absolute top-0 left-0 flex justify-center items-center z-[100] bg-[rgba(255,255,255,0.5)]",children:(0,e.jsx)(Ne.Z,{size:"large"})}):(0,e.jsx)(e.Fragment,{}),(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("div",{onClick:function(){M(function(F){return!F})},className:`
                                        `.concat(g?"right-[100%] top-[4px]":"right-[6px] top-[60px]",`
                                        fixed w-[40px] h-[40px]  flex justify-center items-center cursor-pointer z-[99]
                                    `),children:g?(0,e.jsx)(aa,{className:"text-[20px]"}):(0,e.jsx)(Xt,{className:"text-[20px]"})}),(0,e.jsx)("div",{className:"h-full min-h-full overflow-y-auto flex flex-col-reverse scroll-smooth",ref:se,children:(0,e.jsxs)("div",{children:[R.length?(0,e.jsx)(Ma,{scrollDom:se,list:R}):(0,e.jsx)(e.Fragment,{}),(0,e.jsxs)("div",{className:"w-full px-4 h-full",style:{minHeight:V?se==null||(r=se.current)===null||r===void 0?void 0:r.offsetHeight:""},children:[(0,e.jsx)(_a,{setShow:Z,inputShow:ie,setBoxLoading:H,setAppRunId:A}),z?(0,e.jsx)(wa,{id:o,runid:k,setBoxLoading:H,scrollDom:se,setinputShow:me}):(0,e.jsx)(e.Fragment,{})]})]})})]})]}):(0,e.jsx)(e.Fragment,{})})},ka=(0,a.memo)(Fa),Da=function(n){return(0,e.jsx)("div",{className:"flex items-center h-full justify-center",children:(0,e.jsx)(Me.Z,{image:Me.Z.PRESENTED_IMAGE_SIMPLE})})},Ia=(0,a.memo)(function(){var s=(0,Y.useParams)(),n=s.id,r=(0,a.useRef)([]),i=(0,a.useRef)(null),h=(0,a.useState)(!1),j=c()(h,2),o=j[0],m=j[1],_=function(){var w=re()(I()().mark(function f(){var u;return I()().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:if(!n){b.next=5;break}return b.next=3,(0,fe.cH)({id:n});case 3:u=b.sent,u.code==0?(m(!0),i.current=u.data,r.current=u.data.agent_list):Y.history.replace("/meeting");case 5:case"end":return b.stop()}},f)}));return function(){return w.apply(this,arguments)}}();return(0,a.useEffect)(function(){_()},[]),(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)("div",{className:"w-full flex bg-[#fff] overflow-hidden",style:{height:"calc(100vh - 56px)"},children:[(0,e.jsx)(xt,{roomDetail:i.current,setAgent:r}),(0,e.jsx)("div",{className:"flex-1",children:o?(0,e.jsx)(zt,{agentList:r}):(0,e.jsx)(Da,{})}),(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(ka,{id:n})})]})})}),Aa=Ia}}]);
