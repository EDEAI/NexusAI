"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[446],{83510:function(re,W,e){e.d(W,{LK:function(){return M},bs:function(){return I},go:function(){return B},uy:function(){return P}});var N=e(15009),d=e.n(N),K=e(99289),m=e.n(K),p=e(47520),S="/v1/apps/apps_list",G="/v1/agent/agent_delete/",h="/v1/workflow/workflow_app_delete/",U="/v1/vector/delete_dataset/",v="/v1/skill/delete_skill_by_app_id/",Z="/v1/apps/apps_create",j="/v1/apps/app_update/",B=function(){var f=m()(d()().mark(function t(s){var r;return d()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,(0,p.ZP)("".concat(S),{method:"GET",data:s});case 2:return r=a.sent,a.abrupt("return",r);case 4:case"end":return a.stop()}},t)}));return function(s){return f.apply(this,arguments)}}(),M=function(){var f=m()(d()().mark(function t(s){var r;return d()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return console.log(s),a.next=3,s.mode;case 3:if(a.t0=a.sent,a.t0!=1){a.next=8;break}a.t1=(0,p.ZP)("".concat(G).concat(s.app_id),{method:"DELETE"}),a.next=9;break;case 8:a.t1=s.mode==2?(0,p.ZP)("".concat(h).concat(s.app_id),{method:"DELETE"}):s.mode==3?(0,p.ZP)("".concat(U).concat(s.app_id),{method:"DELETE"}):(0,p.ZP)("".concat(v).concat(s.app_id),{method:"DELETE",data:{is_soft:1}});case 9:return r=a.t1,a.abrupt("return",r);case 11:case"end":return a.stop()}},t)}));return function(s){return f.apply(this,arguments)}}(),P=function(){var f=m()(d()().mark(function t(s){var r;return d()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,(0,p.ZP)("".concat(Z),{method:"POST",data:s});case 2:return r=a.sent,a.abrupt("return",r);case 4:case"end":return a.stop()}},t)}));return function(s){return f.apply(this,arguments)}}(),I=function(){var f=m()(d()().mark(function t(s){var r;return d()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,(0,p.ZP)("".concat(j).concat(s.app_id),{method:"PUT",data:s});case 2:return r=a.sent,a.abrupt("return",r);case 4:case"end":return a.stop()}},t)}));return function(s){return f.apply(this,arguments)}}()},21446:function(re,W,e){var N=e(15009),d=e.n(N),K=e(97857),m=e.n(K),p=e(99289),S=e.n(p),G=e(5574),h=e.n(G),U=e(83510),v=e(29608),Z=e(32332),j=e(35312),B=e(26915),M=e(28036),P=e(85576),I=e(67294),f=e(94840),t=e(85893),s=B.Z.TextArea,r=function(a){var b=a.setIsModalOpen,E=a.isModalOpen,w=a.transformData,n=a.CreationType,X=a.setcreationType,F=a.ModalType,_=(0,j.useIntl)(),H=(0,I.useState)(""),$=h()(H,2),y=$[0],Y=$[1],q=(0,I.useState)(""),z=h()(q,2),V=z[0],C=z[1],ee=(0,I.useState)({id:1,icon:"/icons/headportrait/Android.svg"}),o=h()(ee,2),k=o[0],ae=o[1],J=(0,v.Z)(),te=J.setAgentCreateOpen,O=J.setSkillCreateOpen,l=function(i){Y(i.target.value)},g=function(i){C(i.target.value)},D=function(){var c=S()(d()().mark(function i(){var u,x;return d()().wrap(function(A){for(;;)switch(A.prev=A.next){case 0:if(u={name:y,mode:n.apps_mode,description:V,icon:JSON.stringify(k.id),avatar:k.avatar||null,icon_background:""},n.apps_mode!=2){A.next=8;break}return A.next=4,(0,U.uy)(u);case 4:x=A.sent,x.code===0&&(b(!1),L(x.data.app_id)),A.next=10;break;case 8:(0,Z.Go)("SET",m()(m()({},u),{},{type:!1})),L();case 10:case"end":return A.stop()}},i)}));return function(){return c.apply(this,arguments)}}(),T=function(i){w.map(function(u){u.name==i.name&&(console.log(u,"item"),X(u))})},L=function(i){i?j.history.push("/".concat(n.path,"?app_id=").concat(i,"&&type=false")):j.history.push("/".concat(n.path,"?type=false"))},Q=function(){return(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center",children:[n.apps_mode==1&&(0,t.jsx)(M.ZP,{onClick:function(){te(!0),b(!1)},children:_.formatMessage({id:"agent.creation.button.ai"})}),n.apps_mode==4&&(0,t.jsx)(M.ZP,{onClick:function(){O(!0),b(!1)},children:_.formatMessage({id:"agent.creation.button.skill.ai"})})]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(M.ZP,{onClick:function(){return b(!1)},children:_.formatMessage({id:"agent.modal.button.cancel"})}),(0,t.jsx)(M.ZP,{disabled:y==="",onClick:D,type:"primary",children:_.formatMessage({id:"creation"})})]})]})};return(0,t.jsx)(P.Z,{title:_.formatMessage({id:"creation.addnewapp"}),open:E,okText:_.formatMessage({id:"creation"}),onOk:D,onCancel:function(){return b(!1)},okButtonProps:{disabled:y===""},width:820,footer:(0,t.jsx)(Q,{}),children:(0,t.jsxs)("div",{className:"pb-1",children:[F?(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"font-medium text-xs mb-4 mt-8",children:_.formatMessage({id:"creation.appntype"})}),(0,t.jsx)("div",{className:"flex items-center justify-around gap-y-[24px]",children:w&&w.map(function(c){return(0,t.jsxs)("div",{className:"w-44 h-24 rounded-lg text-center bg-[url('/images/bg.png')] bg-[length:176px_96px] cursor-pointer",style:{border:c.apps_mode===n.apps_mode?"1px solid #1B64F3":"1px solid #eeeeee"},onClick:function(){T(c)},children:[(0,t.jsx)("div",{className:"flex items-center justify-center mt-5 mb-2.5",children:(0,t.jsx)("img",{className:"w-6 h-6",src:c.signicon,alt:""})}),(0,t.jsx)("div",{className:"text-p[#213044] text-base font-normal",children:c.name})]})})})]}):null,(0,t.jsxs)("div",{className:" mt-5",children:[(0,t.jsxs)("div",{className:"mb-5",children:[(0,t.jsxs)("p",{className:"text-xs",children:[n.apps_mode==1?_.formatMessage({id:"creation.agent"}):n.apps_mode==2?_.formatMessage({id:"creation.workflow"}):n.apps_mode==3?_.formatMessage({id:"creation.repository"}):_.formatMessage({id:"creation.skill"}),_.formatMessage({id:"creation.appiconname"})]}),(0,t.jsxs)("div",{className:"flex items-center justify-around",children:[(0,t.jsx)(f.Z,{CardData:k,setCardData:ae}),(0,t.jsx)(B.Z,{showCount:!0,maxLength:50,placeholder:_.formatMessage({id:"creation.placeholder.appname"}),onChange:l})]})]}),(0,t.jsxs)("div",{className:"mb-5 text-xs",children:[(0,t.jsxs)("p",{children:[n.apps_mode==1?_.formatMessage({id:"creation.agent"}):n.apps_mode==2?_.formatMessage({id:"creation.workflow"}):n.apps_mode==3?_.formatMessage({id:"creation.repository"}):_.formatMessage({id:"creation.skill"}),_.formatMessage({id:"creation.appdescribe"})]}),(0,t.jsx)(s,{showCount:!0,maxLength:1e3,rows:4,placeholder:_.formatMessage({id:"creation.placeholder.appdescribe"}),onChange:g})]})]})]})})};W.Z=r},94840:function(re,W,e){var N=e(15009),d=e.n(N),K=e(97857),m=e.n(K),p=e(99289),S=e.n(p),G=e(5574),h=e.n(G),U=e(32332),v=e(45360),Z=e(78367),j=e(55241),B=e(85576),M=e(88484),P=e(67294),I=e(83065),f=e(35312),t=e(42016),s=e(99579),r=e(85893),R=function(b){var E=b.CardData,w=b.setCardData,n=(0,f.useIntl)(),X=(0,P.useState)(!1),F=h()(X,2),_=F[0],H=F[1],$=(0,P.useState)(""),y=h()($,2),Y=y[0],q=y[1],z=(0,P.useState)(null),V=h()(z,2),C=V[0],ee=V[1],o=200;(0,P.useEffect)(function(){},[]);var k=function(l){var g=l.type.startsWith("image/"),D=l.size/1024/1024<2;if(!g)return v.ZP.error(n.formatMessage({id:"workflow.uploadFileErrorType"})),!1;if(!D)return v.ZP.error(n.formatMessage({id:"workflow.uploadFileErrorText"})),!1;var T=new FileReader;return T.readAsDataURL(l),T.onload=function(){q(T.result),H(!0)},!1},ae=function(){if(C){var l=C.getCroppedCanvas({width:o,height:o,minWidth:o,minHeight:o,maxWidth:o,maxHeight:o,imageSmoothingEnabled:!0,imageSmoothingQuality:"high"});l.toBlob(function(){var g=S()(d()().mark(function D(T){var L,Q;return d()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return L=new FormData,L.append("file",T,"avatar.png"),i.next=4,(0,I.M$)();case 4:Q=i.sent,fetch(Q,{method:"POST",headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))},body:L}).then(function(u){return u.json()}).then(function(u){var x;u.code===0&&(x=u.data)!==null&&x!==void 0&&x.path?(w(m()(m()({},E),{},{avatar:u.data.path,avatar_show:u.data.path_show})),v.ZP.success(n.formatMessage({id:"workflow.uploadSuccess"}))):v.ZP.error(n.formatMessage({id:"workflow.uploadError"}))}).catch(function(){v.ZP.error(n.formatMessage({id:"workflow.uploadError"}))});case 6:case"end":return i.stop()}},D)}));return function(D){return g.apply(this,arguments)}}(),"image/png",1),H(!1)}},J=function(){return(0,r.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,r.jsx)("div",{className:"flex justify-start items-center flex-wrap w-40",children:(0,U.s9)("all").map(function(l){return(0,r.jsx)("div",{className:"w-8 h-8 bg-[#F4F8F1] rounded-lg mr-1.5 flex items-center justify-center m-0.5 cursor-pointer",onClick:function(){te(l)},children:(0,r.jsx)("img",{src:l.image,alt:""})},l.id)})}),(0,r.jsx)(Z.Z,{name:"file",accept:".jpg,.png,.jpeg",showUploadList:!1,beforeUpload:k,children:(0,r.jsxs)("div",{className:"w-full flex items-center justify-center p-2 cursor-pointer hover:bg-gray-100 rounded",children:[(0,r.jsx)(M.Z,{className:"mr-2"}),n.formatMessage({id:"workflow.uploadAvatar"})]})})]})},te=function(l){w(m()(m()({},E),{},{icon:l.image,id:l.id,avatar:null,avatar_show:null}))};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(j.Z,{content:J,trigger:"click",placement:"bottomLeft",children:(0,r.jsx)("div",{className:"w-8 h-8 bg-[#F4F8F1] rounded-lg mr-1.5 flex items-center justify-center m-0.5 cursor-pointer",children:(0,r.jsx)("img",{src:E.avatar_show||E.avatar||(0,U.s9)("single",E.id?E.id:E.icon),alt:"",className:"rounded"})})}),(0,r.jsx)(B.Z,{title:n.formatMessage({id:"workflow.cropAvatar"}),open:_,onOk:ae,onCancel:function(){return H(!1)},width:800,children:(0,r.jsx)("div",{className:"w-full h-[400px]",children:(0,r.jsx)(t.Z,{src:Y,style:{height:"100%",width:"100%"},aspectRatio:1,guides:!0,cropBoxResizable:!0,cropBoxMovable:!0,viewMode:2,dragMode:"move",autoCropArea:1,background:!1,responsive:!0,restore:!1,checkCrossOrigin:!1,checkOrientation:!1,modal:!0,highlight:!0,center:!0,zoomOnWheel:!0,wheelZoomRatio:.1,minContainerWidth:o,minContainerHeight:o,minCanvasWidth:o,minCanvasHeight:o,minCropBoxWidth:o,minCropBoxHeight:o,onInitialized:function(l){ee(l),l.setCropBoxData({width:o,height:o})},ready:function(){if(C){var l=C.getImageData(),g=Math.min(l.width,l.height);if(g<o){var D=o/g*1.1;C.scale(D)}C.setData({width:o,height:o})}}})})})]})};W.Z=R}}]);
